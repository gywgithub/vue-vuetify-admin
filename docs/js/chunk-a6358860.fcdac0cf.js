(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a6358860"],{"0159":function(e,t,n){const i=n("bbfd"),r=(e,t,n,r)=>{"string"===typeof n&&(r=n,n=void 0);try{return new i(e,n).inc(t,r).version}catch(o){return null}};e.exports=r},"037c":function(e,t,n){"use strict";n.r(t),n.d(t,"version",(function(){return iD["a"]})),n.d(t,"bandwidthNRD",(function(){return Dr})),n.d(t,"bin",(function(){return Sr})),n.d(t,"bootstrapCI",(function(){return Mr})),n.d(t,"dotbin",(function(){return $r})),n.d(t,"quantiles",(function(){return jr})),n.d(t,"quartiles",(function(){return kr})),n.d(t,"random",(function(){return Cr})),n.d(t,"setRandom",(function(){return Fr})),n.d(t,"randomLCG",(function(){return Tr})),n.d(t,"randomInteger",(function(){return Rr})),n.d(t,"randomKDE",(function(){return Gr})),n.d(t,"randomLogNormal",(function(){return Jr})),n.d(t,"sampleLogNormal",(function(){return Vr})),n.d(t,"densityLogNormal",(function(){return Yr})),n.d(t,"cumulativeLogNormal",(function(){return Zr})),n.d(t,"quantileLogNormal",(function(){return Xr})),n.d(t,"randomMixture",(function(){return Qr})),n.d(t,"randomNormal",(function(){return Hr})),n.d(t,"sampleNormal",(function(){return Br})),n.d(t,"densityNormal",(function(){return Ir})),n.d(t,"cumulativeNormal",(function(){return Ur})),n.d(t,"quantileNormal",(function(){return qr})),n.d(t,"randomUniform",(function(){return io})),n.d(t,"sampleUniform",(function(){return Kr})),n.d(t,"densityUniform",(function(){return eo})),n.d(t,"cumulativeUniform",(function(){return to})),n.d(t,"quantileUniform",(function(){return no})),n.d(t,"regressionLinear",(function(){return uo})),n.d(t,"regressionLog",(function(){return co})),n.d(t,"regressionExp",(function(){return lo})),n.d(t,"regressionPow",(function(){return fo})),n.d(t,"regressionQuad",(function(){return ho})),n.d(t,"regressionPoly",(function(){return po})),n.d(t,"regressionLoess",(function(){return xo})),n.d(t,"sampleCurve",(function(){return ko})),n.d(t,"TIME_UNITS",(function(){return xt})),n.d(t,"YEAR",(function(){return ct})),n.d(t,"QUARTER",(function(){return lt})),n.d(t,"MONTH",(function(){return ft})),n.d(t,"WEEK",(function(){return dt})),n.d(t,"DATE",(function(){return ht})),n.d(t,"DAY",(function(){return pt})),n.d(t,"DAYOFYEAR",(function(){return gt})),n.d(t,"HOURS",(function(){return mt})),n.d(t,"MINUTES",(function(){return vt})),n.d(t,"SECONDS",(function(){return bt})),n.d(t,"MILLISECONDS",(function(){return yt})),n.d(t,"timeUnitSpecifier",(function(){return jt})),n.d(t,"timeUnits",(function(){return _t})),n.d(t,"dayofyear",(function(){return Ft})),n.d(t,"week",(function(){return Mt})),n.d(t,"utcdayofyear",(function(){return zt})),n.d(t,"utcweek",(function(){return Pt})),n.d(t,"timeFloor",(function(){return Yt})),n.d(t,"utcFloor",(function(){return Jt})),n.d(t,"timeInterval",(function(){return fn})),n.d(t,"timeOffset",(function(){return pn})),n.d(t,"timeSequence",(function(){return vn})),n.d(t,"utcInterval",(function(){return dn})),n.d(t,"utcOffset",(function(){return gn})),n.d(t,"utcSequence",(function(){return bn})),n.d(t,"timeBin",(function(){return Pn})),n.d(t,"accessor",(function(){return h["f"]})),n.d(t,"accessorName",(function(){return h["h"]})),n.d(t,"accessorFields",(function(){return h["g"]})),n.d(t,"id",(function(){return h["w"]})),n.d(t,"identity",(function(){return h["x"]})),n.d(t,"zero",(function(){return h["kb"]})),n.d(t,"one",(function(){return h["O"]})),n.d(t,"truthy",(function(){return h["gb"]})),n.d(t,"falsy",(function(){return h["r"]})),n.d(t,"logger",(function(){return h["K"]})),n.d(t,"None",(function(){return h["d"]})),n.d(t,"Error",(function(){return h["b"]})),n.d(t,"Warn",(function(){return h["e"]})),n.d(t,"Info",(function(){return h["c"]})),n.d(t,"Debug",(function(){return h["a"]})),n.d(t,"mergeConfig",(function(){return h["N"]})),n.d(t,"writeConfig",(function(){return h["jb"]})),n.d(t,"panLinear",(function(){return h["Q"]})),n.d(t,"panLog",(function(){return h["R"]})),n.d(t,"panPow",(function(){return h["S"]})),n.d(t,"panSymlog",(function(){return h["T"]})),n.d(t,"zoomLinear",(function(){return h["lb"]})),n.d(t,"zoomLog",(function(){return h["mb"]})),n.d(t,"zoomPow",(function(){return h["nb"]})),n.d(t,"zoomSymlog",(function(){return h["ob"]})),n.d(t,"quarter",(function(){return h["V"]})),n.d(t,"utcquarter",(function(){return h["hb"]})),n.d(t,"array",(function(){return h["i"]})),n.d(t,"clampRange",(function(){return h["j"]})),n.d(t,"compare",(function(){return h["k"]})),n.d(t,"constant",(function(){return h["l"]})),n.d(t,"debounce",(function(){return h["m"]})),n.d(t,"error",(function(){return h["n"]})),n.d(t,"extend",(function(){return h["o"]})),n.d(t,"extent",(function(){return h["p"]})),n.d(t,"extentIndex",(function(){return h["q"]})),n.d(t,"fastmap",(function(){return h["s"]})),n.d(t,"field",(function(){return h["t"]})),n.d(t,"flush",(function(){return h["u"]})),n.d(t,"hasOwnProperty",(function(){return h["v"]})),n.d(t,"inherits",(function(){return h["y"]})),n.d(t,"inrange",(function(){return h["z"]})),n.d(t,"isArray",(function(){return h["A"]})),n.d(t,"isBoolean",(function(){return h["B"]})),n.d(t,"isDate",(function(){return h["C"]})),n.d(t,"isFunction",(function(){return h["D"]})),n.d(t,"isNumber",(function(){return h["E"]})),n.d(t,"isObject",(function(){return h["F"]})),n.d(t,"isRegExp",(function(){return h["G"]})),n.d(t,"isString",(function(){return h["H"]})),n.d(t,"key",(function(){return h["I"]})),n.d(t,"lerp",(function(){return h["J"]})),n.d(t,"lruCache",(function(){return h["L"]})),n.d(t,"merge",(function(){return h["M"]})),n.d(t,"pad",(function(){return h["P"]})),n.d(t,"peek",(function(){return h["U"]})),n.d(t,"repeat",(function(){return h["W"]})),n.d(t,"span",(function(){return h["X"]})),n.d(t,"splitAccessPath",(function(){return h["Y"]})),n.d(t,"stringValue",(function(){return h["Z"]})),n.d(t,"toBoolean",(function(){return h["ab"]})),n.d(t,"toDate",(function(){return h["bb"]})),n.d(t,"toNumber",(function(){return h["cb"]})),n.d(t,"toString",(function(){return h["eb"]})),n.d(t,"toSet",(function(){return h["db"]})),n.d(t,"truncate",(function(){return h["fb"]})),n.d(t,"visitArray",(function(){return h["ib"]})),n.d(t,"loader",(function(){return Kn})),n.d(t,"read",(function(){return Jn})),n.d(t,"inferType",(function(){return ae})),n.d(t,"inferTypes",(function(){return se})),n.d(t,"typeParsers",(function(){return ie})),n.d(t,"format",(function(){return Be})),n.d(t,"formats",(function(){return Ie})),n.d(t,"responseType",(function(){return Ue})),n.d(t,"Bounds",(function(){return gl})),n.d(t,"Gradient",(function(){return Cu})),n.d(t,"GroupItem",(function(){return bl})),n.d(t,"ResourceLoader",(function(){return Ol})),n.d(t,"Item",(function(){return vl})),n.d(t,"Scenegraph",(function(){return Zd})),n.d(t,"Handler",(function(){return oh})),n.d(t,"Renderer",(function(){return uh})),n.d(t,"CanvasHandler",(function(){return Mh})),n.d(t,"CanvasRenderer",(function(){return Uh})),n.d(t,"SVGHandler",(function(){return Vh})),n.d(t,"SVGRenderer",(function(){return _v})),n.d(t,"SVGStringRenderer",(function(){return Lv})),n.d(t,"RenderType",(function(){return Yv})),n.d(t,"renderModule",(function(){return Xv})),n.d(t,"intersect",(function(){return Jv})),n.d(t,"Marks",(function(){return Id})),n.d(t,"boundClip",(function(){return ib})),n.d(t,"boundContext",(function(){return Fl})),n.d(t,"boundStroke",(function(){return kl})),n.d(t,"boundItem",(function(){return Ud})),n.d(t,"boundMark",(function(){return Wd})),n.d(t,"pathCurves",(function(){return Vu})),n.d(t,"pathSymbols",(function(){return hc})),n.d(t,"pathRectangle",(function(){return jc})),n.d(t,"pathTrail",(function(){return kc})),n.d(t,"pathParse",(function(){return Xu})),n.d(t,"pathRender",(function(){return cc})),n.d(t,"point",(function(){return ih})),n.d(t,"domCreate",(function(){return Qd})),n.d(t,"domFind",(function(){return Kd})),n.d(t,"domChild",(function(){return eh})),n.d(t,"domClear",(function(){return th})),n.d(t,"openTag",(function(){return mv})),n.d(t,"closeTag",(function(){return vv})),n.d(t,"font",(function(){return Sd})),n.d(t,"fontFamily",(function(){return Dd})),n.d(t,"fontSize",(function(){return xd})),n.d(t,"lineHeight",(function(){return Od})),n.d(t,"multiLineOffset",(function(){return jd})),n.d(t,"textMetrics",(function(){return pd})),n.d(t,"sceneEqual",(function(){return ob})),n.d(t,"pathEqual",(function(){return ab})),n.d(t,"sceneToJSON",(function(){return Gd})),n.d(t,"sceneFromJSON",(function(){return Vd})),n.d(t,"intersectPath",(function(){return Ul})),n.d(t,"intersectPoint",(function(){return ql})),n.d(t,"intersectRule",(function(){return Hl})),n.d(t,"intersectBoxLine",(function(){return Gl})),n.d(t,"sceneZOrder",(function(){return nf})),n.d(t,"sceneVisit",(function(){return rf})),n.d(t,"scenePickVisit",(function(){return of})),n.d(t,"resetSVGClipId",(function(){return hl})),n.d(t,"resetSVGDefIds",(function(){return ub})),n.d(t,"Dataflow",(function(){return Hi})),n.d(t,"EventStream",(function(){return U})),n.d(t,"Parameters",(function(){return S})),n.d(t,"Pulse",(function(){return wi})),n.d(t,"MultiPulse",(function(){return Di})),n.d(t,"Operator",(function(){return R})),n.d(t,"Transform",(function(){return Yi})),n.d(t,"changeset",(function(){return A})),n.d(t,"ingest",(function(){return O})),n.d(t,"isTuple",(function(){return b})),n.d(t,"definition",(function(){return Ji})),n.d(t,"transform",(function(){return Qi})),n.d(t,"transforms",(function(){return Xi})),n.d(t,"tupleid",(function(){return y})),n.d(t,"scale",(function(){return Qg})),n.d(t,"scheme",(function(){return Om})),n.d(t,"interpolate",(function(){return pm})),n.d(t,"interpolateColors",(function(){return fm})),n.d(t,"interpolateRange",(function(){return lm})),n.d(t,"quantizeInterpolator",(function(){return dm})),n.d(t,"projection",(function(){return Wj})),n.d(t,"View",(function(){return n$})),n.d(t,"formatLocale",(function(){return ut})),n.d(t,"timeFormatLocale",(function(){return Gn})),n.d(t,"locale",(function(){return Yn})),n.d(t,"defaultLocale",(function(){return Zn})),n.d(t,"resetDefaultLocale",(function(){return Xn})),n.d(t,"expressionFunction",(function(){return KF})),n.d(t,"parse",(function(){return EP})),n.d(t,"runtimeContext",(function(){return MM}));var i={};n.r(i),n.d(i,"aggregate",(function(){return So})),n.d(i,"bin",(function(){return Mo})),n.d(i,"collect",(function(){return To})),n.d(i,"compare",(function(){return zo})),n.d(i,"countpattern",(function(){return Lo})),n.d(i,"cross",(function(){return Uo})),n.d(i,"density",(function(){return Xo})),n.d(i,"dotbin",(function(){return ra})),n.d(i,"expression",(function(){return sa})),n.d(i,"extent",(function(){return ca})),n.d(i,"facet",(function(){return ha})),n.d(i,"field",(function(){return ga})),n.d(i,"filter",(function(){return va})),n.d(i,"flatten",(function(){return ya})),n.d(i,"fold",(function(){return Oa})),n.d(i,"formula",(function(){return wa})),n.d(i,"generate",(function(){return ka})),n.d(i,"impute",(function(){return Ca})),n.d(i,"joinaggregate",(function(){return Ta})),n.d(i,"kde",(function(){return za})),n.d(i,"key",(function(){return La})),n.d(i,"load",(function(){return Ia})),n.d(i,"lookup",(function(){return Ha})),n.d(i,"multiextent",(function(){return Va})),n.d(i,"multivalues",(function(){return Za})),n.d(i,"params",(function(){return Ja})),n.d(i,"pivot",(function(){return Qa})),n.d(i,"prefacet",(function(){return is})),n.d(i,"project",(function(){return os})),n.d(i,"proxy",(function(){return us})),n.d(i,"quantile",(function(){return fs})),n.d(i,"relay",(function(){return ps})),n.d(i,"sample",(function(){return ms})),n.d(i,"sequence",(function(){return bs})),n.d(i,"sieve",(function(){return xs})),n.d(i,"subflow",(function(){return fa})),n.d(i,"timeunit",(function(){return _s})),n.d(i,"tupleindex",(function(){return ks})),n.d(i,"values",(function(){return As})),n.d(i,"window",(function(){return Rs}));var r={};n.r(r),n.d(r,"bound",(function(){return cb})),n.d(r,"identifier",(function(){return hb})),n.d(r,"mark",(function(){return mb})),n.d(r,"overlap",(function(){return yb})),n.d(r,"render",(function(){return Db})),n.d(r,"viewlayout",(function(){return oy}));var o={};n.r(o),n.d(o,"axisticks",(function(){return ly})),n.d(o,"datajoin",(function(){return dy})),n.d(o,"encode",(function(){return my})),n.d(o,"legendentries",(function(){return by})),n.d(o,"linkpath",(function(){return ky})),n.d(o,"pie",(function(){return By})),n.d(o,"scale",(function(){return Gy})),n.d(o,"sortitems",(function(){return ax})),n.d(o,"stack",(function(){return dx}));var a={};n.r(a),n.d(a,"contour",(function(){return qx})),n.d(a,"geojson",(function(){return Yx})),n.d(a,"geopath",(function(){return Yj})),n.d(a,"geopoint",(function(){return Jj})),n.d(a,"geoshape",(function(){return Kj})),n.d(a,"graticule",(function(){return ok})),n.d(a,"heatmap",(function(){return uk})),n.d(a,"isocontour",(function(){return Dx})),n.d(a,"kde2d",(function(){return Px})),n.d(a,"projection",(function(){return pk}));var s={};n.r(s),n.d(s,"force",(function(){return Gk}));var u={};n.r(u),n.d(u,"nest",(function(){return nE})),n.d(u,"pack",(function(){return hE})),n.d(u,"partition",(function(){return vE})),n.d(u,"stratify",(function(){return xE})),n.d(u,"tree",(function(){return EE})),n.d(u,"treelinks",(function(){return DE})),n.d(u,"treemap",(function(){return LE}));var c={};n.r(c),n.d(c,"loess",(function(){return UE})),n.d(c,"regression",(function(){return GE}));var l={};n.r(l),n.d(l,"voronoi",(function(){return OA}));var f={};n.r(f),n.d(f,"wordcloud",(function(){return BA}));var d={};n.r(d),n.d(d,"crossfilter",(function(){return KA})),n.d(d,"resolvefilter",(function(){return tD}));var h=n("276f");function p(e){var t=e||h["x"],n=[],i={};return n.add=function(e){var r=t(e);return i[r]||(i[r]=1,n.push(e)),n},n.remove=function(e){var r,o=t(e);return i[o]&&(i[o]=0,(r=n.indexOf(e))>=0&&n.splice(r,1)),n},n}var g=async function(e,t){try{await t(e)}catch(n){e.error(n)}},m=Symbol("vega_id"),v=1;function b(e){return!(!e||!y(e))}function y(e){return e[m]}function x(e,t){return e[m]=t,e}function O(e){var t=e===Object(e)?e:{data:e};return y(t)?t:x(t,v++)}function _(e){return w(e,O({}))}function w(e,t){for(var n in e)t[n]=e[n];return t}function j(e,t){return x(t,y(e))}function k(e,t){return e?t?(n,i)=>e(n,i)||y(t(n))-y(t(i)):(t,n)=>e(t,n)||y(t)-y(n):null}function E(e){return e&&e.constructor===A}function A(){var e=[],t=[],n=[],i=[],r=[],o=null,a=!1;return{constructor:A,insert:function(t){for(var n=Object(h["i"])(t),i=0,r=n.length;i<r;++i)e.push(n[i]);return this},remove:function(e){for(var n=Object(h["D"])(e)?i:t,r=Object(h["i"])(e),o=0,a=r.length;o<a;++o)n.push(r[o]);return this},modify:function(e,t,i){var o={field:t,value:Object(h["l"])(i)};return Object(h["D"])(e)?(o.filter=e,r.push(o)):(o.tuple=e,n.push(o)),this},encode:function(e,t){return Object(h["D"])(e)?r.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean:function(e){return o=e,this},reflow:function(){return a=!0,this},pulse:function(s,u){var c,l,f,d,h,p,g={},m={};for(c=0,l=u.length;c<l;++c)g[y(u[c])]=1;for(c=0,l=t.length;c<l;++c)h=t[c],g[y(h)]=-1;for(c=0,l=i.length;c<l;++c)d=i[c],u.forEach((function(e){d(e)&&(g[y(e)]=-1)}));for(c=0,l=e.length;c<l;++c)h=e[c],p=y(h),g[p]?g[p]=1:s.add.push(O(e[c]));for(c=0,l=u.length;c<l;++c)h=u[c],g[y(h)]<0&&s.rem.push(h);function v(e,t,n){n?e[t]=n(e):s.encode=t,a||(m[y(e)]=e)}for(c=0,l=n.length;c<l;++c)f=n[c],h=f.tuple,d=f.field,p=g[y(h)],p>0&&(v(h,d,f.value),s.modifies(d));for(c=0,l=r.length;c<l;++c)f=r[c],d=f.filter,u.forEach((function(e){d(e)&&g[y(e)]>0&&v(e,f.field,f.value)})),s.modifies(f.field);if(a)s.mod=t.length||i.length?u.filter((function(e){return g[y(e)]>0})):u.slice();else for(p in m)s.mod.push(m[p]);return(o||null==o&&(t.length||i.length))&&s.clean(!0),s}}}var D="_:mod:_";function S(){Object.defineProperty(this,D,{writable:!0,value:{}})}var C=S.prototype;C.set=function(e,t,n,i){var r=this,o=r[e],a=r[D];return null!=t&&t>=0?(o[t]!==n||i)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||i)&&(r[e]=n,a[e]=Object(h["A"])(n)?1+n.length:-1),r},C.modified=function(e,t){var n,i=this[D];if(!arguments.length){for(n in i)if(i[n])return!0;return!1}if(Object(h["A"])(e)){for(n=0;n<e.length;++n)if(i[e[n]])return!0;return!1}return null!=t&&t>=0?t+1<i[e]||!!i[t+":"+e]:!!i[e]},C.clear=function(){return this[D]={},this};var F=0,M="pulse",$=new S,N=1,T=2;function R(e,t,n,i){this.id=++F,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}var z=R.prototype;function P(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}z.targets=function(){return this._targets||(this._targets=p(h["w"]))},z.set=function(e){return this.value!==e?(this.value=e,1):0},z.skip=P(N),z.modified=P(T),z.parameters=function(e,t,n){t=!1!==t;var i,r,o,a,s=this,u=s._argval=s._argval||new S,c=s._argops=s._argops||[],l=[];function f(e,n,i){i instanceof R?(i!==s&&(t&&i.targets().add(s),l.push(i)),c.push({op:i,name:e,index:n})):u.set(e,n,i)}for(i in e)if(r=e[i],i===M)Object(h["i"])(r).forEach((function(e){e instanceof R?e!==s&&(e.targets().add(s),l.push(e)):Object(h["n"])("Pulse parameters must be operator instances.")})),s.source=r;else if(Object(h["A"])(r))for(u.set(i,-1,Array(o=r.length)),a=0;a<o;++a)f(i,a,r[a]);else f(i,-1,r);return this.marshall().clear(),n&&(c.initonly=!0),l},z.marshall=function(e){var t,n,i,r,o,a=this._argval||$,s=this._argops;if(s){for(n=0,i=s.length;n<i;++n)t=s[n],r=t.op,o=r.modified()&&r.stamp===e,a.set(t.name,t.index,r.value,o);if(s.initonly){for(n=0;n<i;++n)t=s[n],t.op.targets().remove(this);this._argops=null,this._update=null}}return a},z.detach=function(){var e,t,n,i,r=this._argops;if(r)for(e=0,t=r.length;e<t;++e)n=r[e],i=n.op,i._targets&&i._targets.remove(this)},z.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},z.run=function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e);var t};var L=function(e,t,n,i){var r,o=1;return e instanceof R?r=e:e&&e.prototype instanceof R?r=new e:Object(h["D"])(e)?r=new R(null,e):(o=0,r=new R(e,t)),this.rank(r),o&&(i=n,n=t),n&&this.connect(r,r.parameters(n,i)),this.touch(r),r},B=function(e,t){var n,i,r=e.rank;for(n=0,i=t.length;n<i;++n)if(r<t[n].rank)return void this.rerank(e)},I=0;function U(e,t,n){this.id=++I,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function q(e,t,n){return new U(e,t,n)}var W=U.prototype;W._filter=h["gb"],W._apply=h["x"],W.targets=function(){return this._targets||(this._targets=p(h["w"]))},W.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},W.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,i=n?n.length:0,r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},W.filter=function(e){var t=q(e);return this.targets().add(t),t},W.apply=function(e){var t=q(null,e);return this.targets().add(t),t},W.merge=function(){var e=q();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},W.throttle=function(e){var t=-1;return this.filter((function(){var n=Date.now();return n-t>e?(t=n,1):0}))},W.debounce=function(e){var t=q();return this.targets().add(q(null,null,Object(h["m"])(e,(function(e){var n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},W.between=function(e,t){var n=!1;return e.targets().add(q(null,null,(function(){n=!0}))),t.targets().add(q(null,null,(function(){n=!1}))),this.filter((function(){return n}))};var H=function(e,t,n,i){var r,o=this,a=q(n,i),s=function(e){e.dataflow=o;try{a.receive(e)}catch(t){o.error(t)}finally{o.run()}};r="string"===typeof e&&"undefined"!==typeof document?document.querySelectorAll(e):Object(h["i"])(e);for(var u=0,c=r.length;u<c;++u)r[u].addEventListener(t,s);return a};const G=/^([A-Za-z]+:)?\/\//,V=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Y=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Z="file://";var X=function(e,t){return function(n){return{options:n||{},sanitize:Q,load:J,fileAccess:!!t,file:K(t),http:te(e)}}};async function J(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function Q(e,t){t=Object(h["o"])({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,a;const s=V.test(e.replace(Y,""));null!=e&&"string"===typeof e&&s||Object(h["n"])("Sanitize failure, invalid URI: "+Object(h["Z"])(e));const u=G.test(e);return(a=t.baseURL)&&!u&&(e.startsWith("/")||"/"===a[a.length-1]||(e="/"+e),e=a+e),o=(r=e.startsWith(Z))||"file"===t.mode||"http"!==t.mode&&!u&&n,r?e=e.slice(Z.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function K(e){return e?function(t){return new Promise((function(n,i){e.readFile(t,(function(e,t){e?i(e):n(t)}))}))}:ee}async function ee(){Object(h["n"])("No file system access.")}function te(e){return e?async function(t,n){const i=Object(h["o"])({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?Object(h["D"])(o[r])?o[r]():o.text():Object(h["n"])(o.status+""+o.statusText)}:ne}async function ne(){Object(h["n"])("No HTTP fetch method available.")}var ie={boolean:h["ab"],integer:h["cb"],number:h["cb"],date:h["bb"],string:h["eb"],unknown:h["x"]},re=[ce,de,fe,le],oe=["boolean","integer","number","date"];function ae(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=re.length,r=re.map((e,t)=>t+1);for(let o,a,s=0,u=0;s<n;++s)for(a=t?e[s][t]:e[s],o=0;o<i;++o)if(r[o]&&ue(a)&&!re[o](a)&&(r[o]=0,++u,u===re.length))return"string";return oe[r.reduce((e,t)=>0===e?t:e,0)-1]}function se(e,t){return t.reduce((function(t,n){return t[n]=ae(e,n),t}),{})}function ue(e){return null!=e&&e===e}function ce(e){return"true"===e||"false"===e||!0===e||!1===e}function le(e){return!Number.isNaN(Date.parse(e))}function fe(e){return!Number.isNaN(+e)&&!(e instanceof Date)}function de(e){return fe(e)&&Number.isInteger(+e)}var he={},pe={},ge=34,me=10,ve=13;function be(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function ye(e,t){var n=be(e);return function(i,r){return t(n(i),r,e)}}function xe(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var i in e)i in t||n.push(t[i]=i)})),n}function Oe(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function _e(e){return e<0?"-"+Oe(-e,6):e>9999?"+"+Oe(e,6):Oe(e,4)}function we(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":_e(e.getUTCFullYear(),4)+"-"+Oe(e.getUTCMonth()+1,2)+"-"+Oe(e.getUTCDate(),2)+(r?"T"+Oe(t,2)+":"+Oe(n,2)+":"+Oe(i,2)+"."+Oe(r,3)+"Z":i?"T"+Oe(t,2)+":"+Oe(n,2)+":"+Oe(i,2)+"Z":n||t?"T"+Oe(t,2)+":"+Oe(n,2)+"Z":"")}var je=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function i(e,t){var n,i,o=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?ye(e,t):be(e)}));return o.columns=i||[],o}function r(e,t){var i,r=[],o=e.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return pe;if(c)return c=!1,he;var t,i,r=a;if(e.charCodeAt(r)===ge){while(a++<o&&e.charCodeAt(a)!==ge||e.charCodeAt(++a)===ge);return(t=a)>=o?u=!0:(i=e.charCodeAt(a++))===me?c=!0:i===ve&&(c=!0,e.charCodeAt(a)===me&&++a),e.slice(r+1,t-1).replace(/""/g,'"')}while(a<o){if((i=e.charCodeAt(t=a++))===me)c=!0;else if(i===ve)c=!0,e.charCodeAt(a)===me&&++a;else if(i!==n)continue;return e.slice(r,t)}return u=!0,e.slice(r,o)}e.charCodeAt(o-1)===me&&--o,e.charCodeAt(o-1)===ve&&--o;while((i=l())!==pe){var f=[];while(i!==he&&i!==pe)f.push(i),i=l();t&&null==(f=t(f,s++))||r.push(f)}return r}function o(t,n){return t.map((function(t){return n.map((function(e){return l(t[e])})).join(e)}))}function a(t,n){return null==n&&(n=xe(t)),[n.map(l).join(e)].concat(o(t,n)).join("\n")}function s(e,t){return null==t&&(t=xe(e)),o(e,t).join("\n")}function u(e){return e.map(c).join("\n")}function c(t){return t.map(l).join(e)}function l(e){return null==e?"":e instanceof Date?we(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:i,parseRows:r,format:a,formatBody:s,formatRows:u,formatRow:c,formatValue:l}};function ke(e){const t=function(t,n){const i={delimiter:e};return Ee(t,n?Object(h["o"])(n,i):i)};return t.responseType="text",t}function Ee(e,t){return t.header&&(e=t.header.map(h["Z"]).join(t.delimiter)+"\n"+e),je(t.delimiter).parse(e+"")}Ee.responseType="text";var Ae=n("9b0d"),De=function(e){return e},Se=function(e){if(null==e)return De;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0);var u=2,c=e.length,l=new Array(c);l[0]=(t+=e[0])*i+o,l[1]=(n+=e[1])*r+a;while(u<c)l[u]=e[u],++u;return l}},Ce=function(e,t){var n,i=e.length,r=i-t;while(r<--i)n=e[r],e[r++]=e[i],e[i]=n},Fe=function(e,t){return"string"===typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return Me(e,t)}))}:Me(e,t)};function Me(e,t){var n=t.id,i=t.bbox,r=null==t.properties?{}:t.properties,o=$e(e,t);return null==n&&null==i?{type:"Feature",properties:r,geometry:o}:null==i?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function $e(e,t){var n=Se(e.transform),i=e.arcs;function r(e,t){t.length&&t.pop();for(var r=i[e<0?~e:e],o=0,a=r.length;o<a;++o)t.push(n(r[o],o));e<0&&Ce(t,a)}function o(e){return n(e)}function a(e){for(var t=[],n=0,i=e.length;n<i;++n)r(e[n],t);return t.length<2&&t.push(t[0]),t}function s(e){var t=a(e);while(t.length<4)t.push(t[0]);return t}function u(e){return e.map(s)}function c(e){var t,n=e.type;switch(n){case"GeometryCollection":return{type:n,geometries:e.geometries.map(c)};case"Point":t=o(e.coordinates);break;case"MultiPoint":t=e.coordinates.map(o);break;case"LineString":t=a(e.arcs);break;case"MultiLineString":t=e.arcs.map(a);break;case"Polygon":t=u(e.arcs);break;case"MultiPolygon":t=e.arcs.map(u);break;default:return null}return{type:n,coordinates:t}}return c(t)}var Ne=function(e,t){var n={},i={},r={},o=[],a=-1;function s(t){var n,i=e.arcs[t<0?~t:t],r=i[0];return e.transform?(n=[0,0],i.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=i[i.length-1],t<0?[n,r]:[r,n]}function u(e,t){for(var i in e){var r=e[i];delete t[r.start],delete r.start,delete r.end,r.forEach((function(e){n[e<0?~e:e]=1})),o.push(r)}}return t.forEach((function(n,i){var r,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(r=t[++a],t[a]=n,t[i]=r)})),t.forEach((function(e){var t,n,o=s(e),a=o[0],u=o[1];if(t=r[a])if(delete r[t.end],t.push(e),t.end=u,n=i[u]){delete i[n.start];var c=n===t?t:t.concat(n);i[c.start=t.start]=r[c.end=n.end]=c}else i[t.start]=r[t.end]=t;else if(t=i[u])if(delete i[t.start],t.unshift(e),t.start=a,n=r[a]){delete r[n.end];var l=n===t?t:n.concat(t);i[l.start=n.start]=r[l.end=t.end]=l}else i[t.start]=r[t.end]=t;else t=[e],i[t.start=a]=r[t.end=u]=t})),u(r,i),u(i,r),t.forEach((function(e){n[e<0?~e:e]||o.push([e])})),o},Te=function(e){return $e(e,Re.apply(this,arguments))};function Re(e,t,n){var i,r,o;if(arguments.length>1)i=ze(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:Ne(e,i)}}function ze(e,t,n){var i,r=[],o=[];function a(e){var t=e<0?~e:e;(o[t]||(o[t]=[])).push({i:e,g:i})}function s(e){e.forEach(a)}function u(e){e.forEach(s)}function c(e){e.forEach(u)}function l(e){switch(i=e,e.type){case"GeometryCollection":e.geometries.forEach(l);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":c(e.arcs);break}}return l(t),o.forEach(null==n?function(e){r.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&r.push(e[0].i)}),r}const Pe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Le(e,t){let n,i,r,o;return e=Object(Ae["a"])(e,t),t&&t.feature?(n=Fe,r=t.feature):t&&t.mesh?(n=Te,r=t.mesh,o=Pe[t.filter]):Object(h["n"])("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):Object(h["n"])("Invalid TopoJSON object: "+r),i&&i.features||[i]}Le.responseType="json";const Be={dsv:Ee,csv:ke(","),tsv:ke("\t"),json:Ae["a"],topojson:Le};function Ie(e,t){return arguments.length>1?(Be[e]=t,this):Object(h["v"])(Be,e)?Be[e]:null}function Ue(e){const t=Ie(e);return t&&t.responseType||"text"}var qe=function(e){const t={};return n=>t[n]||(t[n]=e(n))},We=Math.sqrt(50),He=Math.sqrt(10),Ge=Math.sqrt(2),Ve=function(e,t,n){var i,r,o,a,s=-1;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(r=e,e=t,t=r),0===(a=Ye(e,t,n))||!isFinite(a))return[];if(a>0){e=Math.ceil(e/a),t=Math.floor(t/a),o=new Array(r=Math.ceil(t-e+1));while(++s<r)o[s]=(e+s)*a}else{e=Math.floor(e*a),t=Math.ceil(t*a),o=new Array(r=Math.ceil(e-t+1));while(++s<r)o[s]=(e-s)/a}return i&&o.reverse(),o};function Ye(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=We?10:o>=He?5:o>=Ge?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=We?10:o>=He?5:o>=Ge?2:1)}function Ze(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=We?r*=10:o>=He?r*=5:o>=Ge&&(r*=2),t<e?-r:r}var Xe=n("09b8"),Je=n("d933"),Qe=n("d989"),Ke=n("dad1"),et=n("1231"),tt=n("b170");function nt(e,t){return n=>{var i,r,o=e(n),a=o.indexOf(t);if(a<0)return o;i=it(o,a),r=i<o.length?o.slice(i):"";while(--i>a)if("0"!==o[i]){++i;break}return o.slice(0,i)+r}}function it(e,t){var n,i=e.lastIndexOf("e");if(i>0)return i;for(i=e.length;--i>t;)if(n=e.charCodeAt(i),n>=48&&n<=57)return i+1}function rt(e){const t=qe(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(e){var n=Object(Xe["a"])(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1;break}return nt(t(n),t(".1f")(1)[1])}return t(n)},formatSpan(e,i,r,o){o=Object(Xe["a"])(null==o?",f":o);const a=Ze(e,i,r),s=Math.max(Math.abs(e),Math.abs(i));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=Object(Je["a"])(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=Object(Qe["a"])(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=Object(Ke["a"])(a))||(o.precision=u-2*("%"===o.type));break}return t(o)}}}let ot;function at(){return ot=rt({format:et["a"],formatPrefix:et["b"]})}function st(e){return rt(Object(tt["a"])(e))}function ut(e){return arguments.length?ot=st(e):ot}at();const ct="year",lt="quarter",ft="month",dt="week",ht="date",pt="day",gt="dayofyear",mt="hours",vt="minutes",bt="seconds",yt="milliseconds",xt=[ct,lt,ft,dt,ht,pt,gt,mt,vt,bt,yt],Ot=xt.reduce((e,t,n)=>(e[t]=1+n,e),{});function _t(e){const t=Object(h["i"])(e).slice(),n={};t.length||Object(h["n"])("Missing time unit."),t.forEach(e=>{Object(h["v"])(Ot,e)?n[e]=1:Object(h["n"])(`Invalid time unit: ${e}.`)});const i=(n[dt]||n[pt]?1:0)+(n[lt]||n[ft]||n[ht]?1:0)+(n[gt]?1:0);return i>1&&Object(h["n"])("Incompatible time units: "+e),t.sort((e,t)=>Ot[e]-Ot[t]),t}const wt={[ct]:"%Y ",[lt]:"Q%q ",[ft]:"%b ",[ht]:"%d ",[dt]:"W%U ",[pt]:"%a ",[gt]:"%j ",[mt]:"%H:00",[vt]:"00:%M",[bt]:":%S",[yt]:".%L",[`${ct}-${ft}`]:"%Y-%m ",[`${ct}-${ft}-${ht}`]:"%Y-%m-%d ",[`${mt}-${vt}`]:"%H:%M"};function jt(e,t){const n=Object(h["o"])({},wt,t),i=_t(e),r=i.length;let o,a,s="",u=0;for(u=0;u<r;)for(o=i.length;o>u;--o)if(a=i.slice(u,o).join("-"),null!=n[a]){s+=n[a],u=o;break}return s.trim()}var kt=n("742c"),Et=n("b14c"),At=n("6eb2"),Dt=n("2739");const St=new Date;function Ct(e){return St.setFullYear(e),St.setMonth(0),St.setDate(1),St.setHours(0,0,0,0),St}function Ft(e){return $t(new Date(e))}function Mt(e){return Nt(new Date(e))}function $t(e){return kt["a"].count(Ct(e.getFullYear())-1,e)}function Nt(e){return Et["b"].count(Ct(e.getFullYear())-1,e)}function Tt(e){return Ct(e).getDay()}function Rt(e,t,n,i,r,o,a){if(0<=e&&e<100){var s=new Date(-1,t,n,i,r,o,a);return s.setFullYear(e),s}return new Date(e,t,n,i,r,o,a)}function zt(e){return Lt(new Date(e))}function Pt(e){return Bt(new Date(e))}function Lt(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return At["a"].count(t-1,e)}function Bt(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Dt["b"].count(t-1,e)}function It(e){return St.setTime(Date.UTC(e,0,1)),St.getUTCDay()}function Ut(e,t,n,i,r,o,a){if(0<=e&&e<100){var s=new Date(Date.UTC(-1,t,n,i,r,o,a));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,i,r,o,a))}function qt(e,t,n,i,r){const o=t||1,a=Object(h["U"])(e),s=(e,t,r)=>(r=r||e,Wt(n[r],i[r],e===a&&o,t)),u=new Date,c=Object(h["db"])(e),l=c[ct]?s(ct):Object(h["l"])(2012),f=c[ft]?s(ft):c[lt]?s(lt):h["kb"],d=c[dt]&&c[pt]?s(pt,1,dt+pt):c[dt]?s(dt,1):c[pt]?s(pt,1):c[ht]?s(ht,1):c[gt]?s(gt,1):h["O"],p=c[mt]?s(mt):h["kb"],g=c[vt]?s(vt):h["kb"],m=c[bt]?s(bt):h["kb"],v=c[yt]?s(yt):h["kb"];return function(e){u.setTime(+e);const t=l(u);return r(t,f(u),d(u,t),p(u),g(u),m(u),v(u))}}function Wt(e,t,n,i){const r=n<=1?e:i?(t,r)=>i+n*Math.floor((e(t,r)-i)/n):(t,i)=>n*Math.floor(e(t,i)/n);return t?(e,n)=>t(r(e,n),n):r}function Ht(e,t,n){return t+7*e-(n+6)%7}const Gt={[ct]:e=>e.getFullYear(),[lt]:e=>Math.floor(e.getMonth()/3),[ft]:e=>e.getMonth(),[ht]:e=>e.getDate(),[mt]:e=>e.getHours(),[vt]:e=>e.getMinutes(),[bt]:e=>e.getSeconds(),[yt]:e=>e.getMilliseconds(),[gt]:e=>$t(e),[dt]:e=>Nt(e),[dt+pt]:(e,t)=>Ht(Nt(e),e.getDay(),Tt(t)),[pt]:(e,t)=>Ht(1,e.getDay(),Tt(t))},Vt={[lt]:e=>3*e,[dt]:(e,t)=>Ht(e,0,Tt(t))};function Yt(e,t){return qt(e,t||1,Gt,Vt,Rt)}const Zt={[ct]:e=>e.getUTCFullYear(),[lt]:e=>Math.floor(e.getUTCMonth()/3),[ft]:e=>e.getUTCMonth(),[ht]:e=>e.getUTCDate(),[mt]:e=>e.getUTCHours(),[vt]:e=>e.getUTCMinutes(),[bt]:e=>e.getUTCSeconds(),[yt]:e=>e.getUTCMilliseconds(),[gt]:e=>Lt(e),[dt]:e=>Bt(e),[pt]:(e,t)=>Ht(1,e.getUTCDay(),It(t)),[dt+pt]:(e,t)=>Ht(Bt(e),e.getUTCDay(),It(t))},Xt={[lt]:e=>3*e,[dt]:(e,t)=>Ht(e,0,It(t))};function Jt(e,t){return qt(e,t||1,Zt,Xt,Ut)}var Qt=n("a15a3"),Kt=n("9603"),en=n("b3c3"),tn=n("2c38"),nn=n("5edf"),rn=n("1809"),on=n("77ae"),an=n("55f8"),sn=n("f623"),un=n("f8ee");const cn={[ct]:Qt["a"],[lt]:Kt["a"].every(3),[ft]:Kt["a"],[dt]:Et["b"],[ht]:kt["a"],[pt]:kt["a"],[gt]:kt["a"],[mt]:en["a"],[vt]:tn["a"],[bt]:nn["a"],[yt]:rn["a"]},ln={[ct]:on["a"],[lt]:an["a"].every(3),[ft]:an["a"],[dt]:Dt["b"],[ht]:At["a"],[pt]:At["a"],[gt]:At["a"],[mt]:sn["a"],[vt]:un["a"],[bt]:nn["a"],[yt]:rn["a"]};function fn(e){return cn[e]}function dn(e){return ln[e]}function hn(e,t,n){return e?e.offset(t,n):void 0}function pn(e,t,n){return hn(fn(e),t,n)}function gn(e,t,n){return hn(dn(e),t,n)}function mn(e,t,n,i){return e?e.range(t,n,i):void 0}function vn(e,t,n,i){return mn(fn(e),t,n,i)}function bn(e,t,n,i){return mn(dn(e),t,n,i)}var yn=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},xn=function(e){return 1===e.length&&(e=On(e)),{left:function(t,n,i,r){null==i&&(i=0),null==r&&(r=t.length);while(i<r){var o=i+r>>>1;e(t[o],n)<0?i=o+1:r=o}return i},right:function(t,n,i,r){null==i&&(i=0),null==r&&(r=t.length);while(i<r){var o=i+r>>>1;e(t[o],n)>0?r=o:i=o+1}return i}}};function On(e){return function(t,n){return yn(e(t),n)}}const _n=1e3,wn=60*_n,jn=60*wn,kn=24*jn,En=7*kn,An=30*kn,Dn=365*kn,Sn=[ct,ft,ht,mt,vt,bt,yt],Cn=Sn.slice(0,-1),Fn=Cn.slice(0,-1),Mn=Fn.slice(0,-1),$n=Mn.slice(0,-1),Nn=[ct,dt],Tn=[ct,ft],Rn=[ct],zn=[[Cn,1,_n],[Cn,5,5*_n],[Cn,15,15*_n],[Cn,30,30*_n],[Fn,1,wn],[Fn,5,5*wn],[Fn,15,15*wn],[Fn,30,30*wn],[Mn,1,jn],[Mn,3,3*jn],[Mn,6,6*jn],[Mn,12,12*jn],[$n,1,kn],[Nn,1,En],[Tn,1,An],[Tn,3,3*An],[Rn,1,Dn]];var Pn=function(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Object(h["X"])(t))/n;let r,o,a=xn(e=>e[2]).right(zn,i);return a===zn.length?(r=Rn,o=Ze(t[0]/Dn,t[1]/Dn,n)):a?(a=zn[i/zn[a-1][2]<zn[a][2]/i?a-1:a],r=a[0],o=a[1]):(r=Sn,o=Math.max(Ze(t[0],t[1],n),1)),{units:r,step:o}},Ln=n("4c23"),Bn=n("a591");function In(e,t,n){n=n||{},Object(h["F"])(n)||Object(h["n"])("Invalid time multi-format specifier: "+n);const i=t(bt),r=t(vt),o=t(mt),a=t(ht),s=t(dt),u=t(ft),c=t(lt),l=t(ct),f=e(n[yt]||".%L"),d=e(n[bt]||":%S"),p=e(n[vt]||"%I:%M"),g=e(n[mt]||"%I %p"),m=e(n[ht]||n[pt]||"%a %d"),v=e(n[dt]||"%b %d"),b=e(n[ft]||"%B"),y=e(n[lt]||"%B"),x=e(n[ct]||"%Y");return e=>(i(e)<e?f:r(e)<e?d:o(e)<e?p:a(e)<e?g:u(e)<e?s(e)<e?m:v:l(e)<e?c(e)<e?b:y:x)(e)}function Un(e){const t=qe(e.format),n=qe(e.utcFormat);return{timeFormat:e=>Object(h["H"])(e)?t(e):In(t,fn,e),utcFormat:e=>Object(h["H"])(e)?n(e):In(n,dn,e),timeParse:qe(e.parse),utcParse:qe(e.utcParse)}}let qn;function Wn(){return qn=Un({format:Ln["a"],parse:Ln["b"],utcFormat:Ln["c"],utcParse:Ln["d"]})}function Hn(e){return Un(Object(Bn["a"])(e))}function Gn(e){return arguments.length?qn=Hn(e):qn}Wn();const Vn=(e,t)=>Object(h["o"])({},e,t);function Yn(e,t){const n=e?st(e):ut(),i=t?Hn(t):Gn();return Vn(n,i)}function Zn(e,t){const n=arguments.length;return n&&2!==n&&Object(h["n"])("defaultLocale expects either zero or two arguments."),n?Vn(ut(e),Gn(t)):Vn(ut(),Gn())}function Xn(){return at(),Wn(),Zn()}var Jn=function(e,t,n,i){t=t||{};const r=Ie(t.type||"json");return r||Object(h["n"])("Unknown data format type: "+t.type),e=r(e,t),t.parse&&Qn(e,t.parse,n,i),Object(h["v"])(e,"columns")&&delete e.columns,e};function Qn(e,t,n,i){if(!e.length)return;const r=Gn();n=n||r.timeParse,i=i||r.utcParse;var o,a,s,u,c,l,f,d=e.columns||Object.keys(e[0]);for("auto"===t&&(t=se(e,d)),d=Object.keys(t),o=d.map((function(e){var r,o,a=t[e];if(a&&(a.startsWith("date:")||a.startsWith("utc:"))){r=a.split(/:(.+)?/,2),o=r[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));const e="utc"===r[0]?i:n;return e(o)}if(!ie[a])throw Error("Illegal format pattern: "+e+":"+a);return ie[a]})),u=0,l=e.length,f=d.length;u<l;++u)for(a=e[u],c=0;c<f;++c)s=d[c],a[s]=o[c](a[s])}var Kn=X("undefined"!==typeof fetch&&fetch,null);function ei(e,t){const n=this.locale();return Jn(e,t,n.timeParse,n.utcParse)}function ti(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function ni(e,t){const n=this;let i,r=0;try{i=await n.loader().load(e,{context:"dataflow",response:Ue(t&&t.type)});try{i=n.parse(i,t)}catch(o){r=-2,n.warn("Data ingestion failed",e,o)}}catch(o){r=-1,n.warn("Loading failed",e,o)}return{data:i,status:r}}async function ii(e,t,n){const i=this,r=i._pending||ri(i);r.requests+=1;const o=await i.request(t,n);return i.pulse(e,i.changeset().remove(h["gb"]).insert(o.data||[])),r.done(),o}function ri(e){var t,n=new Promise((function(e){t=e}));return n.requests=0,n.done=function(){0===--n.requests&&(e._pending=null,t(e))},e._pending=n}var oi={skip:!0},ai=function(e,t,n,i,r){var o=e instanceof R?ui:si;return o(this,e,t,n,i,r),this};function si(e,t,n,i,r,o){var a,s,u=Object(h["o"])({},o,oi);Object(h["D"])(n)||(n=Object(h["l"])(n)),void 0===i?a=t=>e.touch(n(t)):Object(h["D"])(i)?(s=new R(null,i,r,!1),a=t=>{s.evaluate(t);const i=n(t),r=s.value;E(r)?e.pulse(i,r,o):e.update(i,r,u)}):a=t=>e.update(n(t),i,u),t.apply(a)}function ui(e,t,n,i,r,o){if(void 0===i)t.targets().add(n);else{const a=o||{},s=new R(null,ci(n,i),r,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function ci(e,t){return t=Object(h["D"])(t)?t:Object(h["l"])(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function li(e){e.rank=++this._rank}function fi(e){var t,n,i,r=[e];while(r.length)if(this.rank(t=r.pop()),n=t._targets)for(i=n.length;--i>=0;)r.push(t=n[i]),t===e&&Object(h["n"])("Cycle detected in dataflow graph.")}const di={},hi=1,pi=2,gi=4,mi=hi|pi,vi=hi|gi,bi=hi|pi|gi,yi=8,xi=16,Oi=32,_i=64;function wi(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}const ji=wi.prototype;function ki(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}function Ei(e,t){var n=[];return Object(h["ib"])(e,t,e=>n.push(e)),n}function Ai(e,t){var n={};return e.visit(t,(function(e){n[y(e)]=1})),e=>n[y(e)]?null:e}function Di(e,t,n,i){var r,o,a,s,u,c=this,l=0;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n,a=0,s=n.length;a<s;++a)if(r=n[a],r.stamp===t){if(r.fields)for(u in o=c.fields||(c.fields={}),r.fields)o[u]=1;r.changed(c.ADD)&&(l|=c.ADD),r.changed(c.REM)&&(l|=c.REM),r.changed(c.MOD)&&(l|=c.MOD)}this.changes=l}ji.StopPropagation=di,ji.ADD=hi,ji.REM=pi,ji.MOD=gi,ji.ADD_REM=mi,ji.ADD_MOD=vi,ji.ALL=bi,ji.REFLOW=yi,ji.SOURCE=xi,ji.NO_SOURCE=Oi,ji.NO_FIELDS=_i,ji.fork=function(e){return new wi(this.dataflow).init(this,e)},ji.clone=function(){const e=this.fork(bi);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(bi|xi)},ji.addAll=function(){let e=this;return e.source&&e.source.length!==e.add.length?(e=new wi(this.dataflow).init(this),e.add=e.source,e):e},ji.init=function(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||t&_i||(n.fields=e.fields),t&hi?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&pi?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&gi?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Oi?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},ji.runAfter=function(e){this.dataflow.runAfter(e)},ji.changed=function(e){var t=e||bi;return t&hi&&this.add.length||t&pi&&this.rem.length||t&gi&&this.mod.length},ji.reflow=function(e){if(e)return this.fork(bi).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(gi,Ai(this,hi))),this},ji.clean=function(e){return arguments.length?(this.cleans=!!e,this):this.cleans},ji.modifies=function(e){var t=this.fields||(this.fields={});return Object(h["A"])(e)?e.forEach(e=>t[e]=!0):t[e]=!0,this},ji.modified=function(e,t){var n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?Object(h["A"])(e)?e.some(e=>n[e]):n[e]:!!n)},ji.filter=function(e,t){var n=this;return e&hi&&(n.addF=ki(n.addF,t)),e&pi&&(n.remF=ki(n.remF,t)),e&gi&&(n.modF=ki(n.modF,t)),e&xi&&(n.srcF=ki(n.srcF,t)),n},ji.materialize=function(e){e=e||bi;var t=this;return e&hi&&t.addF&&(t.add=Ei(t.add,t.addF),t.addF=null),e&pi&&t.remF&&(t.rem=Ei(t.rem,t.remF),t.remF=null),e&gi&&t.modF&&(t.mod=Ei(t.mod,t.modF),t.modF=null),e&xi&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},ji.visit=function(e,t){var n,i,r=this,o=t;return e&xi?(Object(h["ib"])(r.source,r.srcF,o),r):(e&hi&&Object(h["ib"])(r.add,r.addF,o),e&pi&&Object(h["ib"])(r.rem,r.remF,o),e&gi&&Object(h["ib"])(r.mod,r.modF,o),e&yi&&(n=r.source)&&(i=r.add.length+r.mod.length,i===n.length||(i?Object(h["ib"])(n,Ai(r,vi),o):Object(h["ib"])(n,r.srcF,o))),r)};var Si=Object(h["y"])(Di,wi);async function Ci(e,t,n){const i=this,r=[];if(i._pulse)return Ni(i);if(i._pending&&await i._pending,t&&await g(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const o=++i._clock;i._pulse=new wi(i,o,e),i._touched.forEach(e=>i._enqueue(e,!0)),i._touched=p(h["w"]);let a,s,u,c=0;try{while(i._heap.size()>0)a=i._heap.pop(),a.rank===a.qrank?(s=a.run(i._getPulse(a,e)),s.then?s=await s:s.async&&(r.push(s.async),s=di),s!==di&&a._targets&&a._targets.forEach(e=>i._enqueue(e)),++c):i._enqueue(a,!0)}catch(l){i._heap.clear(),u=l}if(i._input={},i._pulse=null,i.debug(`Pulse ${o}: ${c} operators`),u&&(i._postrun=[],i.error(u)),i._postrun.length){const e=i._postrun.sort((e,t)=>t.priority-e.priority);i._postrun=[];for(let t=0;t<e.length;++t)await g(i,e[t].callback)}return n&&await g(i,n),r.length&&Promise.all(r).then(e=>i.runAsync(null,()=>{e.forEach(e=>{try{e(i)}catch(l){i.error(l)}})})),i}async function Fi(e,t,n){while(this._running)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function Mi(e,t,n){return this._pulse?Ni(this):(this.evaluate(e,t,n),this)}function $i(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function Ni(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function Ti(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function Ri(e,t){var n=e.source,i=this._clock;return n&&Object(h["A"])(n)?new Di(this,i,n.map(e=>e.pulse),t):this._input[e.id]||zi(this._pulse,n&&n.pulse)}function zi(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==di&&(e.source=t.source),e)}Si.fork=function(e){var t=new wi(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(function(e){return t.add.push(e)})),e&t.REM&&this.visit(t.REM,(function(e){return t.rem.push(e)})),e&t.MOD&&this.visit(t.MOD,(function(e){return t.mod.push(e)}))),t},Si.changed=function(e){return this.changes&e},Si.modified=function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?Object(h["A"])(e)?e.some((function(e){return n[e]})):n[e]:0},Si.filter=function(){Object(h["n"])("MultiPulse does not support filtering.")},Si.materialize=function(){Object(h["n"])("MultiPulse does not support materialization.")},Si.visit=function(e,t){var n=this,i=n.pulses,r=i.length,o=0;if(e&n.SOURCE)for(;o<r;++o)i[o].visit(e,t);else for(;o<r;++o)i[o].stamp===n.stamp&&i[o].visit(e,t);return n};var Pi={skip:!1,force:!1};function Li(e,t){var n=t||Pi;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Bi(e,t,n){var i=n||Pi;return(e.set(t)||i.force)&&this.touch(e,i),this}function Ii(e,t,n){this.touch(e,n||Pi);var i=new wi(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function Ui(e){var t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),qi(t,0,t.length-1,e)),pop:()=>{var n,i=t.pop();return t.length?(n=t[0],t[0]=i,Wi(t,0,e)):n=i,n}}}function qi(e,t,n,i){var r,o,a;r=e[n];while(n>t){if(a=n-1>>1,o=e[a],!(i(r,o)<0))break;e[n]=o,n=a}return e[n]=r}function Wi(e,t,n){var i,r=t,o=e.length,a=e[t],s=1+(t<<1);while(s<o)i=s+1,i<o&&n(e[s],e[i])>=0&&(s=i),e[t]=e[s],t=s,s=1+(t<<1);return e[t]=a,qi(e,r,t,n)}function Hi(){this.logger(Object(h["K"])()),this.logLevel(h["b"]),this._clock=0,this._rank=0,this._locale=Zn();try{this._loader=Kn()}catch(e){}this._touched=p(h["w"]),this._input={},this._pulse=null,this._heap=Ui((e,t)=>e.qrank-t.qrank),this._postrun=[]}var Gi=Hi.prototype;function Vi(e){return function(){return this._log[e].apply(this,arguments)}}function Yi(e,t){R.call(this,e,null,t)}Gi.stamp=function(){return this._clock},Gi.loader=function(e){return arguments.length?(this._loader=e,this):this._loader},Gi.locale=function(e){return arguments.length?(this._locale=e,this):this._locale},Gi.cleanThreshold=1e4,Gi.add=L,Gi.connect=B,Gi.rank=li,Gi.rerank=fi,Gi.pulse=Ii,Gi.touch=Li,Gi.update=Bi,Gi.changeset=A,Gi.ingest=ti,Gi.parse=ei,Gi.preload=ii,Gi.request=ni,Gi.events=H,Gi.on=ai,Gi.evaluate=Ci,Gi.run=Mi,Gi.runAsync=Fi,Gi.runAfter=$i,Gi._enqueue=Ti,Gi._getPulse=Ri,Gi.logger=function(e){return arguments.length?(this._log=e,this):this._log},Gi.error=Vi("error"),Gi.warn=Vi("warn"),Gi.info=Vi("info"),Gi.debug=Vi("debug"),Gi.logLevel=Vi("level");var Zi=Object(h["y"])(Yi,R);Zi.run=function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(e=>this.pulse=e):t!==e.StopPropagation&&(this.pulse=t),t);var t},Zi.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},Zi.transform=function(){};var Xi={};function Ji(e){var t=Qi(e);return t&&t.Definition||null}function Qi(e){return e=e&&e.toLowerCase(),Object(h["v"])(Xi,e)?Xi[e]:null}function Ki(e){return function(t){for(var n=e.length,i=1,r=String(e[0](t));i<n;++i)r+="|"+e[i](t);return r}}function er(e){return e&&e.length?1===e.length?e[0]:Ki(e):function(){return""}}function tr(e,t,n){return n||e+(t?"_"+t:"")}const nr=()=>{},ir={init:nr,add:nr,rem:nr,idx:0},rr={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},or=Object.keys(rr);function ar(e,t){return n=>Object(h["o"])({name:e,out:n||e},ir,t)}function sr(e,t){return rr[e](t)}function ur(e,t){return e.idx-t.idx}function cr(e){const t={};e.forEach(e=>t[e.name]=e);const n=e=>{e.req&&e.req.forEach(e=>{t[e]||n(t[e]=rr[e]())})};return e.forEach(n),Object.values(t).sort(ur)}function lr(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function fr(e,t){null!=e&&""!==e?e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing}function dr(e,t){null!=e&&""!==e?e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing}function hr(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function pr(e,t){var n=t||h["x"],i=cr(e),r=e.slice().sort(ur);function o(e){this._ops=i,this._out=r,this.cell=e,this.init()}return o.prototype.init=lr,o.prototype.add=fr,o.prototype.rem=dr,o.prototype.set=hr,o.prototype.get=n,o.fields=e.map(e=>e.out),o}or.forEach(e=>{rr[e]=ar(e,rr[e])});var gr=function*(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),null!=i&&""!==i&&(i=+i)>=i&&(yield i)}};function mr(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function vr(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function br(e,t,n=0,i=e.length-1,r=yn){while(i>n){if(i-n>600){const o=i-n+1,a=t-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1),l=Math.max(n,Math.floor(t-a*u/o+c)),f=Math.min(i,Math.floor(t+(o-a)*u/o+c));br(e,t,l,f,r)}const o=e[t];let a=n,s=i;yr(e,n,t),r(e[i],o)>0&&yr(e,n,i);while(a<s){yr(e,a,s),++a,--s;while(r(e[a],o)<0)++a;while(r(e[s],o)>0)--s}0===r(e[n],o)?yr(e,n,s):(++s,yr(e,s,i)),s<=t&&(n=s+1),t<=s&&(i=s-1)}return e}function yr(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}var xr=function(e){return null===e?NaN:+e};function*Or(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(i=+i)>=i&&(yield i)}}function _r(e,t,n){if(e=Float64Array.from(Or(e,n)),i=e.length){if((t=+t)<=0||i<2)return vr(e);if(t>=1)return mr(e);var i,r=(i-1)*t,o=Math.floor(r),a=mr(br(e,o).subarray(0,o+1)),s=vr(e.subarray(o+1));return a+(s-a)*(r-o)}}function wr(e,t,n=xr){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(r-o)}}var jr=function(e,t,n){var i=Float64Array.from(gr(e,n));return i.sort(yn),t.map(e=>wr(i,e))},kr=function(e,t){return jr(e,[.25,.5,.75],t)};function Er(e,t){let n,i=0,r=0,o=0;if(void 0===t)for(let a of e)null!=a&&(a=+a)>=a&&(n=a-r,r+=n/++i,o+=n*(a-r));else{let a=-1;for(let s of e)null!=(s=t(s,++a,e))&&(s=+s)>=s&&(n=s-r,r+=n/++i,o+=n*(s-r))}if(i>1)return o/(i-1)}function Ar(e,t){const n=Er(e,t);return n?Math.sqrt(n):n}var Dr=function(e,t){var n=e.length,i=Ar(e,t),r=kr(e,t),o=(r[2]-r[0])/1.34;return i=Math.min(i,o)||i||Math.abs(r[0])||1,1.06*i*Math.pow(n,-.2)},Sr=function(e){var t,n,i,r,o,a,s,u,c=e.maxbins||20,l=e.base||10,f=Math.log(l),d=e.divide||[5,2],h=e.extent[0],p=e.extent[1],g=e.span||p-h||Math.abs(h)||1;if(e.step)t=e.step;else if(e.steps){for(o=g/c,a=0,s=e.steps.length;a<s&&e.steps[a]<o;++a);t=e.steps[Math.max(0,a-1)]}else{n=Math.ceil(Math.log(c)/f),i=e.minstep||0,t=Math.max(i,Math.pow(l,Math.round(Math.log(g)/f)-n));while(Math.ceil(g/t)>c)t*=l;for(a=0,s=d.length;a<s;++a)o=t/d[a],o>=i&&g/o<=c&&(t=o)}return o=Math.log(t),r=o>=0?0:1+~~(-o/f),u=Math.pow(l,-r-1),(e.nice||void 0===e.nice)&&(o=Math.floor(h/t+u)*t,h=h<o?o-t:o,p=Math.ceil(p/t)*t),{start:h,stop:p===h?h+t:p,step:t}},Cr=Math.random;function Fr(e){Cr=e}var Mr=function(e,t,n,i){if(!e.length)return[void 0,void 0];var r,o,a,s,u=Float64Array.from(gr(e,i)),c=u.length,l=t;for(a=0,s=Array(l);a<l;++a){for(r=0,o=0;o<c;++o)r+=u[~~(Cr()*c)];s[a]=r/c}return s.sort(yn),[_r(s,n/2),_r(s,1-n/2)]},$r=function(e,t,n,i){i=i||(e=>e);let r,o=0,a=1,s=e.length,u=new Float64Array(s),c=i(e[0]),l=c,f=c+t;for(;a<s;++a){if(r=i(e[a]),r>=f){for(l=(c+l)/2;o<a;++o)u[o]=l;f=r+t,c=r}l=r}for(l=(c+l)/2;o<a;++o)u[o]=l;return n?Nr(u,t+t/4):u};function Nr(e,t){let n,i,r=e.length,o=0,a=1;while(e[o]===e[a])++a;while(a<r){n=a+1;while(e[a]===e[n])++n;if(e[a]-e[a-1]<t){i=a+(o+n-a-a>>1);while(i<a)e[i++]=e[a];while(i>a)e[i--]=e[o]}o=a,a=n}return e}var Tr=function(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}},Rr=function(e,t){null==t&&(t=e,e=0);var n,i,r,o={};return o.min=function(e){return arguments.length?(n=e||0,r=i-n,o):n},o.max=function(e){return arguments.length?(i=e||0,r=i-n,o):i},o.sample=function(){return n+Math.floor(r*Cr())},o.pdf=function(e){return e===Math.floor(e)&&e>=n&&e<i?1/r:0},o.cdf=function(e){var t=Math.floor(e);return t<n?0:t>=i?1:(t-n+1)/r},o.icdf=function(e){return e>=0&&e<=1?n-1+Math.floor(e*r):NaN},o.min(e).max(t)};const zr=Math.sqrt(2*Math.PI),Pr=Math.SQRT2;let Lr=NaN;function Br(e,t){e=e||0,t=null==t?1:t;let n,i,r=0,o=0;if(Lr===Lr)r=Lr,Lr=NaN;else{do{r=2*Cr()-1,o=2*Cr()-1,n=r*r+o*o}while(0===n||n>1);i=Math.sqrt(-2*Math.log(n)/n),r*=i,Lr=o*i}return e+r*t}function Ir(e,t,n){n=null==n?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*zr)}function Ur(e,t,n){t=t||0,n=null==n?1:n;let i,r=(e-t)/n,o=Math.abs(r);if(o>37)i=0;else{let e,t=Math.exp(-o*o/2);o<7.07106781186547?(e=.0352624965998911*o+.700383064443688,e=e*o+6.37396220353165,e=e*o+33.912866078383,e=e*o+112.079291497871,e=e*o+221.213596169931,e=e*o+220.206867912376,i=t*e,e=.0883883476483184*o+1.75566716318264,e=e*o+16.064177579207,e=e*o+86.7807322029461,e=e*o+296.564248779674,e=e*o+637.333633378831,e=e*o+793.826512519948,e=e*o+440.413735824752,i/=e):(e=o+.65,e=o+4/e,e=o+3/e,e=o+2/e,e=o+1/e,i=t/e/2.506628274631)}return r>0?1-i:i}function qr(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*Pr*Wr(2*e-1)}function Wr(e){let t,n=-Math.log((1-e)*(1+e));return n<6.25?(n-=3.125,t=-364441206401782e-35,t=t*n-16850591381820166e-35,t=128584807152564e-32+t*n,t=11157877678025181e-33+t*n,t=t*n-1333171662854621e-31,t=20972767875968562e-33+t*n,t=6637638134358324e-30+t*n,t=t*n-4054566272975207e-29,t=t*n-8151934197605472e-29,t=26335093153082323e-28+t*n,t=t*n-12975133253453532e-27,t=t*n-5415412054294628e-26,t=1.0512122733215323e-9+t*n,t=t*n-4.112633980346984e-9,t=t*n-2.9070369957882005e-8,t=4.2347877827932404e-7+t*n,t=t*n-13654692000834679e-22,t=t*n-13882523362786469e-21,t=.00018673420803405714+t*n,t=t*n-.000740702534166267,t=t*n-.006033670871430149,t=.24015818242558962+t*n,t=1.6536545626831027+t*n):n<16?(n=Math.sqrt(n)-3.25,t=2.2137376921775787e-9,t=9.075656193888539e-8+t*n,t=t*n-2.7517406297064545e-7,t=1.8239629214389228e-8+t*n,t=15027403968909828e-22+t*n,t=t*n-4013867526981546e-21,t=29234449089955446e-22+t*n,t=12475304481671779e-21+t*n,t=t*n-47318229009055734e-21,t=6828485145957318e-20+t*n,t=24031110387097894e-21+t*n,t=t*n-.0003550375203628475,t=.0009532893797373805+t*n,t=t*n-.0016882755560235047,t=.002491442096107851+t*n,t=t*n-.003751208507569241,t=.005370914553590064+t*n,t=1.0052589676941592+t*n,t=3.0838856104922208+t*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=-27109920616438573e-27,t=t*n-2.555641816996525e-10,t=1.5076572693500548e-9+t*n,t=t*n-3.789465440126737e-9,t=7.61570120807834e-9+t*n,t=t*n-1.496002662714924e-8,t=2.914795345090108e-8+t*n,t=t*n-6.771199775845234e-8,t=2.2900482228026655e-7+t*n,t=t*n-9.9298272942317e-7,t=4526062597223154e-21+t*n,t=t*n-1968177810553167e-20,t=7599527703001776e-20+t*n,t=t*n-.00021503011930044477,t=t*n-.00013871931833623122,t=1.0103004648645344+t*n,t=4.849906401408584+t*n):t=1/0,t*e}var Hr=function(e,t){var n,i,r={mean:function(e){return arguments.length?(n=e||0,r):n},stdev:function(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>Br(n,i),pdf:e=>Ir(e,n,i),cdf:e=>Ur(e,n,i),icdf:e=>qr(e,n,i)};return r.mean(e).stdev(t)},Gr=function(e,t){var n=Hr(),i={},r=0;return i.data=function(n){return arguments.length?(e=n,r=n?n.length:0,i.bandwidth(t)):e},i.bandwidth=function(n){return arguments.length?(t=n,!t&&e&&(t=Dr(e)),i):t},i.sample=function(){return e[~~(Cr()*r)]+t*n.sample()},i.pdf=function(i){for(var o=0,a=0;a<r;++a)o+=n.pdf((i-e[a])/t);return o/t/r},i.cdf=function(i){for(var o=0,a=0;a<r;++a)o+=n.cdf((i-e[a])/t);return o/r},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(e)};function Vr(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+Br()*t)}function Yr(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*zr*e)}function Zr(e,t,n){return Ur(Math.log(e),t,n)}function Xr(e,t,n){return Math.exp(qr(e,t,n))}var Jr=function(e,t){var n,i,r={mean:function(e){return arguments.length?(n=e||0,r):n},stdev:function(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>Vr(n,i),pdf:e=>Yr(e,n,i),cdf:e=>Zr(e,n,i),icdf:e=>Xr(e,n,i)};return r.mean(e).stdev(t)},Qr=function(e,t){var n,i={},r=0;function o(e){var t,n=[],i=0;for(t=0;t<r;++t)i+=n[t]=null==e[t]?1:+e[t];for(t=0;t<r;++t)n[t]/=i;return n}return i.weights=function(e){return arguments.length?(n=o(t=e||[]),i):t},i.distributions=function(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},i.sample=function(){for(var t=Cr(),i=e[r-1],o=n[0],a=0;a<r-1;o+=n[++a])if(t<o){i=e[a];break}return i.sample()},i.pdf=function(t){for(var i=0,o=0;o<r;++o)i+=n[o]*e[o].pdf(t);return i},i.cdf=function(t){for(var i=0,o=0;o<r;++o)i+=n[o]*e[o].cdf(t);return i},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(e).weights(t)};function Kr(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Cr()}function eo(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function to(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function no(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}var io=function(e,t){var n,i,r={min:function(e){return arguments.length?(n=e||0,r):n},max:function(e){return arguments.length?(i=null==e?1:e,r):i},sample:()=>Kr(n,i),pdf:e=>eo(e,n,i),cdf:e=>to(e,n,i),icdf:e=>no(e,n,i)};return null==t&&(t=null==e?1:e,e=0),r.min(e).max(t)},ro=function(e,t,n,i){const r=i-e*e,o=Math.abs(r)<1e-24?0:(n-e*t)/r,a=t-o*e;return[a,o]};function oo(e,t,n,i){e=e.filter(e=>{let i=t(e),r=n(e);return null!=i&&(i=+i)>=i&&null!=r&&(r=+r)>=r}),i&&e.sort((e,n)=>t(e)-t(n));const r=e.length,o=new Float64Array(r),a=new Float64Array(r);let s,u,c,l=0,f=0,d=0;for(c of e)o[l]=s=+t(c),a[l]=u=+n(c),++l,f+=(s-f)/l,d+=(u-d)/l;for(l=0;l<r;++l)o[l]-=f,a[l]-=d;return[o,a,f,d]}function ao(e,t,n,i){let r,o,a=-1;for(let s of e)r=t(s),o=n(s),null!=r&&(r=+r)>=r&&null!=o&&(o=+o)>=o&&i(r,o,++a)}var so=function(e,t,n,i,r){let o=0,a=0;return ao(e,t,n,(e,t)=>{const n=t-r(e),s=t-i;o+=n*n,a+=s*s}),1-o/a},uo=function(e,t,n){let i=0,r=0,o=0,a=0,s=0;ao(e,t,n,(e,t)=>{++s,i+=(e-i)/s,r+=(t-r)/s,o+=(e*t-o)/s,a+=(e*e-a)/s});const u=ro(i,r,o,a),c=e=>u[0]+u[1]*e;return{coef:u,predict:c,rSquared:so(e,t,n,r,c)}},co=function(e,t,n){let i=0,r=0,o=0,a=0,s=0;ao(e,t,n,(e,t)=>{++s,e=Math.log(e),i+=(e-i)/s,r+=(t-r)/s,o+=(e*t-o)/s,a+=(e*e-a)/s});const u=ro(i,r,o,a),c=e=>u[0]+u[1]*Math.log(e);return{coef:u,predict:c,rSquared:so(e,t,n,r,c)}},lo=function(e,t,n){const[i,r,o,a]=oo(e,t,n);let s,u,c,l=0,f=0,d=0,h=0,p=0;ao(e,t,n,(e,t)=>{s=i[p++],u=Math.log(t),c=s*t,l+=(t*u-l)/p,f+=(c-f)/p,d+=(c*u-d)/p,h+=(s*c-h)/p});const[g,m]=ro(f/a,l/a,d/a,h/a),v=e=>Math.exp(g+m*(e-o));return{coef:[Math.exp(g-m*o),m],predict:v,rSquared:so(e,t,n,a,v)}},fo=function(e,t,n){let i=0,r=0,o=0,a=0,s=0,u=0;ao(e,t,n,(e,t)=>{const n=Math.log(e),c=Math.log(t);++u,i+=(n-i)/u,r+=(c-r)/u,o+=(n*c-o)/u,a+=(n*n-a)/u,s+=(t-s)/u});const c=ro(i,r,o,a),l=e=>c[0]*Math.pow(e,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:so(e,t,n,s,l)}},ho=function(e,t,n){const[i,r,o,a]=oo(e,t,n),s=i.length;let u,c,l,f,d=0,h=0,p=0,g=0,m=0;for(u=0;u<s;)c=i[u],l=r[u++],f=c*c,d+=(f-d)/u,h+=(f*c-h)/u,p+=(f*f-p)/u,g+=(c*l-g)/u,m+=(f*l-m)/u;const v=p-d*d,b=d*v-h*h,y=(m*d-g*h)/b,x=(g*v-m*h)/b,O=-y*d,_=e=>(e-=o,y*e*e+x*e+O+a);return{coef:[O-x*o+y*o*o+a,x-2*y*o,y],predict:_,rSquared:so(e,t,n,a,_)}},po=function(e,t,n,i){if(1===i)return uo(e,t,n);if(2===i)return ho(e,t,n);const[r,o,a,s]=oo(e,t,n),u=r.length,c=[],l=[],f=i+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d)*o[p];for(c.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d+h);m[h]=g}l.push(m)}l.push(c);const v=mo(l),b=e=>{e-=a;let t=s+v[0]+v[1]*e+v[2]*e*e;for(d=3;d<f;++d)t+=v[d]*Math.pow(e,d);return t};return{coef:go(f,v,-a,s),predict:b,rSquared:so(e,t,n,s,b)}};function go(e,t,n,i){const r=Array(e);let o,a,s,u;for(o=0;o<e;++o)r[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,r[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,r[o-a]+=s*Math.pow(n,a)*u;return r[0]+=i,r}function mo(e){const t=e.length-1,n=[];let i,r,o,a,s;for(i=0;i<t;++i){for(a=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][a])&&(a=r);for(o=i;o<t+1;++o)s=e[o][i],e[o][i]=e[o][a],e[o][a]=s;for(r=i+1;r<t;++r)for(o=t;o>=i;o--)e[o][r]-=e[o][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(s=0,o=r+1;o<t;++o)s+=e[o][r]*n[o];n[r]=(e[t][r]-s)/e[r][r]}return n}var vo=function(e,t){return _r(e,.5,t)};const bo=2,yo=1e-12;var xo=function(e,t,n,i){const[r,o,a,s]=oo(e,t,n,!0),u=r.length,c=Math.max(2,~~(i*u)),l=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=bo;){const e=[0,c-1];for(let n=0;n<u;++n){const t=r[n],i=e[0],a=e[1],s=t-r[i]>r[a]-t?i:a;let u=0,c=0,h=0,p=0,g=0,m=1/Math.abs(r[s]-t||1);for(let e=i;e<=a;++e){const n=r[e],i=o[e],a=Oo(Math.abs(t-n)*m)*d[e],s=n*a;u+=a,c+=s,h+=i*a,p+=i*s,g+=n*s}const[v,b]=ro(c/u,h/u,p/u,g/u);l[n]=v+b*t,f[n]=Math.abs(o[n]-l[n]),_o(r,n+1,e)}if(h===bo)break;const t=vo(f);if(Math.abs(t)<yo)break;for(let n,i,r=0;r<u;++r)n=f[r]/(6*t),d[r]=n>=1?yo:(i=1-n*n)*i}return wo(r,l,a,s)};function Oo(e){return(e=1-e*e*e)*e*e}function _o(e,t,n){let i=e[t],r=n[0],o=n[1]+1;if(!(o>=e.length))while(t>r&&e[o]-i<=i-e[r])n[0]=++r,n[1]=o,++o}function wo(e,t,n,i){const r=e.length,o=[];let a,s=0,u=0,c=[];for(;s<r;++s)a=e[s]+n,c[0]===a?c[1]+=(t[s]-c[1])/++u:(u=0,c[1]+=i,c=[a,t[s]],o.push(c));return c[1]+=i,o}const jo=.1*Math.PI/180;var ko=function(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=t=>[t,e(t)],o=t[0],a=t[1],s=a-o,u=s/i,c=[r(o)],l=[];if(n===i){for(let e=1;e<i;++e)c.push(r(o+e/n*s));return c.push(r(a)),c}l.push(r(a));for(let h=n;--h>0;)l.push(r(o+h/n*s));let f=c[0],d=l[l.length-1];while(d){const e=r((f[0]+d[0])/2);e[0]-f[0]>=u&&Eo(f,e,d)>jo?l.push(e):(f=d,c.push(d),l.pop()),d=l[l.length-1]}return c};function Eo(e,t,n){const i=Math.atan2(n[1]-e[1],n[0]-e[0]),r=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(i-r)}function Ao(e){this._key=e?Object(h["t"])(e):y,this.reset()}var Do=Ao.prototype;function So(e){Yi.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Do.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Do.add=function(e){this._add.push(e)},Do.rem=function(e){this._rem.push(e)},Do.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,n,i=this._add,r=this._rem,o=this._key,a=i.length,s=r.length,u=Array(a-s),c={};for(e=0;e<s;++e)c[o(r[e])]=1;for(e=0,t=0;e<a;++e)c[o(n=i[e])]?c[o(n)]=0:u[t++]=n;return this._rem=[],this._add=u},Do.distinct=function(e){var t,n=this.values(),i=n.length,r={},o=0;while(--i>=0)t=e(n[i])+"",Object(h["v"])(r,t)||(r[t]=1,++o);return o},Do.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=Object(h["q"])(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Do.argmin=function(e){return this.extent(e)[0]||{}},Do.argmax=function(e){return this.extent(e)[1]||{}},Do.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},Do.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},Do.quartile=function(e){return this._get===e&&this._q||(this._q=kr(this.values(),e),this._get=e),this._q},Do.q1=function(e){return this.quartile(e)[0]},Do.q2=function(e){return this.quartile(e)[1]},Do.q3=function(e){return this.quartile(e)[2]},Do.ci=function(e){return this._get===e&&this._ci||(this._ci=Mr(this.values(),1e3,.05,e),this._get=e),this._ci},Do.ci0=function(e){return this.ci(e)[0]},Do.ci1=function(e){return this.ci(e)[1]},So.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:or},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var Co=Object(h["y"])(So,Yi);Co.transform=function(e,t){var n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,e=>n.add(e))):(n.value=n.value||n.init(e),t.visit(t.REM,e=>n.rem(e)),t.visit(t.ADD,e=>n.add(e))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},Co.cross=function(){var e=this,t=e.value,n=e._dnames,i=n.map((function(){return{}})),r=n.length;function o(e){var t,o,a,s;for(t in e)for(a=e[t].tuple,o=0;o<r;++o)i[o][s=a[n[o]]]=s}function a(o,s,u){var c,l,f=n[u],d=i[u++];for(c in d)s[f]=d[c],l=o?o+"|"+c:c,u<r?a(l,s,u):t[l]||e.cell(l,s)}o(e._prev),o(t),a("",{},0)},Co.init=function(e){var t=this._inputs=[],n=this._outputs=[],i={};function r(e){for(var n,r=Object(h["i"])(Object(h["g"])(e)),o=0,a=r.length;o<a;++o)i[n=r[o]]||(i[n]=1,t.push(n))}this._dims=Object(h["i"])(e.groupby),this._dnames=this._dims.map((function(e){var t=Object(h["h"])(e);return r(e),n.push(t),t})),this.cellkey=e.key?e.key:er(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var o,a,s,u,c,l,f=e.fields||[null],d=e.ops||["count"],p=e.as||[],g=f.length,m={};for(g!==d.length&&Object(h["n"])("Unmatched number of fields and aggregate ops."),l=0;l<g;++l)o=f[l],a=d[l],null==o&&"count"!==a&&Object(h["n"])("Null aggregate field specified."),u=Object(h["h"])(o),c=tr(a,u,p[l]),n.push(c),"count"!==a?(s=m[u],s||(r(o),s=m[u]=[],s.field=o,this._measures.push(s)),"count"!==a&&(this._countOnly=!1),s.push(sr(a,c))):this._counts.push(c);return this._measures=this._measures.map((function(e){return pr(e,e.field)})),{}},Co.cellkey=er(),Co.cell=function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},Co.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var i,r=this._measures,o=r.length;for(n.agg=Array(o),i=0;i<o;++i)n.agg[i]=new r[i](n)}return n.store&&(n.data=new Ao),n},Co.newtuple=function(e,t){var n,i,r=this._dnames,o=this._dims,a={};for(n=0,i=o.length;n<i;++n)a[r[n]]=o[n](e);return t?j(t.tuple,a):O(a)},Co.clean=function(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},Co.add=function(e){var t,n,i,r=this.cellkey(e),o=this.cell(r,e);if(o.num+=1,!this._countOnly)for(o.store&&o.data.add(e),t=o.agg,n=0,i=t.length;n<i;++n)t[n].add(t[n].get(e),e)},Co.rem=function(e){var t,n,i,r=this.cellkey(e),o=this.cell(r,e);if(o.num-=1,!this._countOnly)for(o.store&&o.data.rem(e),t=o.agg,n=0,i=t.length;n<i;++n)t[n].rem(t[n].get(e),e)},Co.celltuple=function(e){var t,n,i,r=e.tuple,o=this._counts;for(e.store&&e.data.values(),n=0,i=o.length;n<i;++n)r[o[n]]=e.num;if(!this._countOnly)for(t=e.agg,n=0,i=t.length;n<i;++n)t[n].set(r);return r},Co.changes=function(e){var t,n,i,r,o=this._adds,a=this._mods,s=this._prev,u=this._drop,c=e.add,l=e.rem,f=e.mod;if(s)for(n in s)t=s[n],u&&!t.num||l.push(t.tuple);for(i=0,r=this._alen;i<r;++i)c.push(this.celltuple(o[i])),o[i]=null;for(i=0,r=this._mlen;i<r;++i)t=a[i],(0===t.num&&u?l:f).push(this.celltuple(t)),a[i]=null;return this._alen=this._mlen=0,this._prev=null,e};const Fo=1e-14;function Mo(e){Yi.call(this,null,e)}Mo.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var $o=Object(h["y"])(Mo,Yi);$o.transform=function(e,t){var n,i=!1!==e.interval,r=this._bins(e),o=r.start,a=r.step,s=e.as||["bin0","bin1"],u=s[0],c=s[1];return e.modified()?(t=t.reflow(!0),n=t.SOURCE):n=t.modified(Object(h["g"])(e.field))?t.ADD_MOD:t.ADD,t.visit(n,i?function(e){var t=r(e);e[u]=t,e[c]=null==t?null:o+a*(1+(t-o)/a)}:function(e){e[u]=r(e)}),t.modifies(i?s:u)},$o._bins=function(e){if(this.value&&!e.modified())return this.value;var t,n,i=e.field,r=Sr(e),o=r.step,a=r.start,s=a+Math.ceil((r.stop-a)/o)*o;null!=(t=e.anchor)&&(n=t-(a+o*Math.floor((t-a)/o)),a+=n,s+=n);var u=function(e){var t=Object(h["cb"])(i(e));return null==t?null:t<a?-1/0:t>s?1/0:(t=Math.max(a,Math.min(t,s-o)),a+o*Math.floor(Fo+(t-a)/o))};return u.start=a,u.stop=r.stop,u.step=o,this.value=Object(h["f"])(u,Object(h["g"])(i),e.name||"bin_"+Object(h["h"])(i))};var No=function(e,t,n){var i=e,r=t||[],o=n||[],a={},s=0;return{add:function(e){o.push(e)},remove:function(e){a[i(e)]=++s},size:function(){return r.length},data:function(e,t){return s&&(r=r.filter((function(e){return!a[i(e)]})),a={},s=0),t&&e&&r.sort(e),o.length&&(r=e?Object(h["M"])(e,r,o.sort(e)):r.concat(o),o=[]),r}}};function To(e){Yi.call(this,[],e)}To.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};var Ro=Object(h["y"])(To,Yi);function zo(e){R.call(this,null,Po,e)}function Po(e){return this.value&&!e.modified()?this.value:Object(h["k"])(e.fields,e.orders)}function Lo(e){Yi.call(this,null,e)}function Bo(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}Ro.transform=function(e,t){var n=t.fork(t.ALL),i=No(y,this.value,n.materialize(n.ADD).add),r=e.sort,o=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(o),this.value=n.source=i.data(k(r),o),t.source&&t.source.root&&(this.value.root=t.source.root),n},Object(h["y"])(zo,R),Lo.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var Io=Object(h["y"])(Lo,Yi);function Uo(e){Yi.call(this,null,e)}Io.transform=function(e,t){function n(t){return function(n){for(var i,r=Bo(s(n),e.case,o)||[],u=0,c=r.length;u<c;++u)a.test(i=r[u])||t(i)}}var i=this._parameterCheck(e,t),r=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],c=n((function(e){r[e]=1+(r[e]||0)})),l=n((function(e){r[e]-=1}));return i?t.visit(t.SOURCE,c):(t.visit(t.ADD,c),t.visit(t.REM,l)),this._finish(t,u)},Io._parameterCheck=function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},Io._finish=function(e,t){var n,i,r,o=this._counts,a=this._tuples||(this._tuples={}),s=t[0],u=t[1],c=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in o)i=a[n],r=o[n]||0,!i&&r?(a[n]=i=O({}),i[s]=n,i[u]=r,c.add.push(i)):0===r?(i&&c.rem.push(i),o[n]=null,a[n]=null):i[u]!==r&&(i[u]=r,c.mod.push(i));return c.modifies(t)},Uo.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};var qo=Object(h["y"])(Uo,Yi);function Wo(e,t,n,i){for(var r,o,a=[],s={},u=e.length,c=0;c<u;++c)for(s[t]=o=e[c],r=0;r<u;++r)s[n]=e[r],i(s)&&(a.push(O(s)),s={},s[t]=o);return a}qo.transform=function(e,t){var n=t.fork(t.NO_SOURCE),i=this.value,r=e.as||["a","b"],o=r[0],a=r[1],s=!i||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");return s?(i&&(n.rem=i),i=t.materialize(t.SOURCE).source,n.add=this.value=Wo(i,o,a,e.filter||h["gb"])):n.mod=i,n.source=this.value,n.modifies(r)};var Ho={kde:Gr,mixture:Qr,normal:Hr,lognormal:Jr,uniform:io},Go="distributions",Vo="function",Yo="field";function Zo(e,t){var n=e[Vo];Object(h["v"])(Ho,n)||Object(h["n"])("Unknown distribution function: "+n);var i=Ho[n]();for(var r in e)r===Yo?i.data((e.from||t()).map(e[r])):r===Go?i[r](e[r].map((function(e){return Zo(e,t)}))):typeof i[r]===Vo&&i[r](e[r]);return i}function Xo(e){Yi.call(this,null,e)}var Jo=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Qo={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Jo},{name:"weights",type:"number",array:!0}]};Xo.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Jo.concat(Qo)},{name:"as",type:"string",array:!0,default:["value","density"]}]};var Ko=Object(h["y"])(Xo,Yi);function ea(e){return function(){return e.materialize(e.SOURCE).source}}function ta(e,t){return e?e.map((function(e,n){return t[n]||Object(h["h"])(e)})):null}function na(e,t,n){var i,r,o,a,s,u,c=[],l=function(e){return e(a)};if(null==t)c.push(e.map(n));else for(i={},r=0,o=e.length;r<o;++r)a=e[r],s=t.map(l),u=i[s],u||(i[s]=u=[],u.dims=s,c.push(u)),u.push(n(a));return c}Ko.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var i=Zo(e.distribution,ea(t)),r=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200,a=e.method||"pdf";"pdf"!==a&&"cdf"!==a&&Object(h["n"])("Invalid density method: "+a),e.extent||i.data||Object(h["n"])("Missing density extent parameter."),a=i[a];var s=e.as||["value","density"],u=e.extent||Object(h["p"])(i.data()),c=ko(a,u,r,o).map(e=>{var t={};return t[s[0]]=e[0],t[s[1]]=e[1],O(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n};const ia="bin";function ra(e){Yi.call(this,null,e)}ra.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:ia}]};const oa=Object(h["y"])(ra,Yi);function aa(e,t){return Object(h["X"])(Object(h["p"])(e,t))/30}function sa(e){R.call(this,null,ua,e),this.modified(!0)}function ua(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:Object(h["f"])(n=>t(n,e),Object(h["g"])(t),Object(h["h"])(t))}function ca(e){Yi.call(this,[void 0,void 0],e)}oa.transform=function(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=na(t.source,e.groupby,h["x"]),r=e.smooth||!1,o=e.field,a=e.step||aa(n,o),s=k((e,t)=>o(e)-o(t)),u=e.as||ia,c=i.length;let l,f=1/0,d=-1/0,p=0;for(;p<c;++p){const e=i[p].sort(s);l=-1;for(const t of $r(e,a,r,o))t<f&&(f=t),t>d&&(d=t),e[++l][u]=t}return this.value={start:f,stop:d,step:a},t.reflow(!0).modifies(u)},Object(h["y"])(sa,R),ca.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};var la=Object(h["y"])(ca,Yi);function fa(e,t){R.call(this,e),this.parent=t,this.count=0}la.transform=function(e,t){var n,i=this.value,r=e.field,o=i[0],a=i[1];if(n=t.changed()||t.modified(r.fields)||e.modified("field"),(n||null==o)&&(o=1/0,a=-1/0),t.visit(n?t.SOURCE:t.ADD,(function(e){var t=Object(h["cb"])(r(e));null!=t&&(t<o&&(o=t),t>a&&(a=t))})),!Number.isFinite(o)||!Number.isFinite(a)){let e=Object(h["h"])(r);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]};var da=Object(h["y"])(fa,R);function ha(e){Yi.call(this,{},e),this._keys=Object(h["s"])();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,i=t.active;n<i;++n)e(t[n],n,t)}}da.connect=function(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},da.add=function(e){this.count+=1,this.value.add.push(e)},da.rem=function(e){this.count-=1,this.value.rem.push(e)},da.mod=function(e){this.value.mod.push(e)},da.init=function(e){this.value.init(e,e.NO_SOURCE)},da.evaluate=function(){return this.value};const pa=Object(h["y"])(ha,Yi);function ga(e){R.call(this,null,ma,e)}function ma(e){return this.value&&!e.modified()?this.value:Object(h["A"])(e.name)?Object(h["i"])(e.name).map((function(e){return Object(h["t"])(e)})):Object(h["t"])(e.name,e.as)}function va(e){Yi.call(this,Object(h["s"])(),e)}pa.activate=function(e){this._targets[this._targets.active++]=e},pa.subflow=function(e,t,n,i){let r,o,a=this.value,s=Object(h["v"])(a,e)&&a[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=i||(o=this._group[e])&&o.tuple,r=n.dataflow,s=new fa(n.fork(n.NO_SOURCE),this),r.add(s).connect(t(r,e,o)),a[e]=s,this.activate(s)),s},pa.clean=function(){const e=this.value;for(const t in e)if(0===e[t].count){const n=e[t].detachSubflow;n&&n(),delete e[t]}},pa.initTargets=function(){const e=this._targets,t=e.length;for(let n=0;n<t&&null!=e[n];++n)e[n]=null;e.active=0},pa.transform=function(e,t){const n=t.dataflow,i=e.key,r=e.subflow,o=this._keys,a=e.modified("key"),s=e=>this.subflow(e,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,e=>{const t=y(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))}),t.visit(t.ADD,e=>{const t=i(e);o.set(y(e),t),s(t).add(e)}),a||t.modified(i.fields)?t.visit(t.MOD,e=>{const t=y(e),n=o.get(t),r=i(e);n===r?s(r).mod(e):(o.set(t,r),s(n).rem(e),s(r).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,e=>{s(o.get(y(e))).mod(e)}),a&&t.visit(t.REFLOW,e=>{const t=y(e),n=o.get(t),r=i(e);n!==r&&(o.set(t,r),s(n).rem(e),s(r).add(e))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t},Object(h["y"])(ga,R),va.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};var ba=Object(h["y"])(va,Yi);function ya(e){Yi.call(this,[],e)}ba.transform=function(e,t){var n=t.dataflow,i=this.value,r=t.fork(),o=r.add,a=r.rem,s=r.mod,u=e.expr,c=!0;function l(t){var n=y(t),r=u(t,e),l=i.get(n);r&&l?(i.delete(n),o.push(t)):r||l?c&&r&&!l&&s.push(t):(i.set(n,1),a.push(t))}return t.visit(t.REM,(function(e){var t=y(e);i.has(t)?i.delete(t):a.push(e)})),t.visit(t.ADD,(function(t){u(t,e)?o.push(t):i.set(y(t),1)})),t.visit(t.MOD,l),e.modified()&&(c=!1,t.visit(t.REFLOW,l)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r},ya.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};var xa=Object(h["y"])(ya,Yi);function Oa(e){Yi.call(this,[],e)}xa.transform=function(e,t){var n=t.fork(t.NO_SOURCE),i=e.fields,r=ta(i,e.as||[]),o=e.index||null,a=r.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,s,u,c=i.map(t=>t(e)),l=c.reduce((e,t)=>Math.max(e,t.length),0),f=0;f<l;++f){for(s=_(e),t=0;t<a;++t)s[r[t]]=null==(u=c[t][f])?null:u;o&&(s[o]=f),n.add.push(s)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(r)},Oa.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};var _a=Object(h["y"])(Oa,Yi);function wa(e){Yi.call(this,null,e)}_a.transform=function(e,t){var n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(h["h"]),o=e.as||["key","value"],a=o[0],s=o[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,o=0;o<u;++o)t=_(e),t[a]=r[o],t[s]=i[o](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(o)},wa.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};var ja=Object(h["y"])(wa,Yi);function ka(e){Yi.call(this,[],e)}ja.transform=function(e,t){var n=e.expr,i=e.as,r=e.modified(),o=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(o,t=>t[i]=n(t,e))};var Ea=Object(h["y"])(ka,Yi);function Aa(e,t){let n=0,i=0;if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n}Ea.transform=function(e,t){var n,i,r,o=this.value,a=t.fork(t.ALL),s=e.size-o.length,u=e.generator;if(s>0){for(n=[];--s>=0;)n.push(r=O(u(e))),o.push(r);a.add=a.add.length?a.materialize(a.ADD).add.concat(n):n}else i=o.slice(0,-s),a.rem=a.rem.length?a.materialize(a.REM).rem.concat(i):i,o=o.slice(-s);return a.source=this.value=o,a};var Da={value:"value",median:vo,mean:Aa,min:vr,max:mr},Sa=[];function Ca(e){Yi.call(this,[],e)}Ca.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};var Fa=Object(h["y"])(Ca,Yi);function Ma(e){var t,n=e.method||Da.value;if(null!=Da[n])return n===Da.value?(t=void 0!==e.value?e.value:0,function(){return t}):Da[n];Object(h["n"])("Unrecognized imputation method: "+n)}function $a(e){var t=e.field;return function(e){return e?t(e):NaN}}function Na(e,t,n,i){var r,o,a,s,u,c,l,f,d=function(e){return e(f)},h=[],p=i?i.slice():[],g={},m={};for(p.forEach((function(e,t){g[e]=t+1})),s=0,l=e.length;s<l;++s)f=e[s],c=n(f),u=g[c]||(g[c]=p.push(c)),o=(r=t?t.map(d):Sa)+"",(a=m[o])||(a=m[o]=[],h.push(a),a.values=r),a[u-1]=f;return h.domain=p,h}function Ta(e){So.call(this,e)}Fa.transform=function(e,t){var n,i,r,o,a,s,u,c,l,f,d=t.fork(t.ALL),p=Ma(e),g=$a(e),m=Object(h["h"])(e.field),v=Object(h["h"])(e.key),b=(e.groupby||[]).map(h["h"]),y=Na(t.source,e.groupby,e.key,e.keyvals),x=[],_=this.value,w=y.domain.length;for(a=0,c=y.length;a<c;++a)for(n=y[a],r=n.values,i=NaN,u=0;u<w;++u)if(null==n[u]){for(o=y.domain[u],f={_impute:!0},s=0,l=r.length;s<l;++s)f[b[s]]=r[s];f[v]=o,f[m]=Number.isNaN(i)?i=p(n,g):i,x.push(O(f))}return x.length&&(d.add=d.materialize(d.ADD).add.concat(x)),_.length&&(d.rem=d.materialize(d.REM).rem.concat(_)),this.value=x,d},Ta.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:or},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var Ra=Object(h["y"])(Ta,So);function za(e){Yi.call(this,null,e)}Ra.transform=function(e,t){var n,i=this,r=e.modified();return i.value&&(r||t.modified(i._inputs,!0))?(n=i.value=r?i.init(e):{},t.visit(t.SOURCE,(function(e){i.add(e)}))):(n=i.value=i.value||this.init(e),t.visit(t.REM,(function(e){i.rem(e)})),t.visit(t.ADD,(function(e){i.add(e)}))),i.changes(),t.visit(t.SOURCE,(function(e){Object(h["o"])(e,n[i.cellkey(e)].tuple)})),t.reflow(r).modifies(this._outputs)},Ra.changes=function(){var e,t,n=this._adds,i=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(i[e]),i[e]=null;this._alen=this._mlen=0},za.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};var Pa=Object(h["y"])(za,Yi);function La(e){R.call(this,null,Ba,e)}function Ba(e){return this.value&&!e.modified()?this.value:Object(h["I"])(e.fields,e.flat)}function Ia(e){Yi.call(this,[],e),this._pending=null}Pa.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=na(i,e.groupby,e.field),o=(e.groupby||[]).map(h["h"]),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],c=[];let l=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Object(h["n"])("Invalid density method: "+s),"shared"===e.resolve&&(l||(l=Object(h["p"])(i,e.field)),f=d=e.steps||d),r.forEach(t=>{const n=Gr(t,a)[s],i=e.counts?t.length:1,r=l||Object(h["p"])(t);ko(n,r,f,d).forEach(e=>{const n={};for(let i=0;i<o.length;++i)n[o[i]]=t.dims[i];n[u[0]]=e[0],n[u[1]]=e[1]*i,c.push(O(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n},Object(h["y"])(La,R);var Ua=Object(h["y"])(Ia,Yi);function qa(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Wa(e,t,n){n.forEach(O);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function Ha(e){Yi.call(this,{},e)}Ua.transform=function(e,t){const n=t.dataflow;if(this._pending)return Wa(this,t,this._pending);if(qa(e))return t.StopPropagation;if(e.values)return Wa(this,t,n.parse(e.values,e.format));if(e.async){const t=n.request(e.url,e.format).then(e=>(this._pending=Object(h["i"])(e.data),e=>e.touch(this)));return{async:t}}return n.request(e.url,e.format).then(e=>Wa(this,t,Object(h["i"])(e.data)))},Ha.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};var Ga=Object(h["y"])(Ha,Yi);function Va(e){R.call(this,null,Ya,e)}function Ya(e){if(this.value&&!e.modified())return this.value;var t,n,i,r=1/0,o=-1/0,a=e.extents;for(t=0,n=a.length;t<n;++t)i=a[t],i[0]<r&&(r=i[0]),i[1]>o&&(o=i[1]);return[r,o]}function Za(e){R.call(this,null,Xa,e)}function Xa(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function Ja(e){Yi.call(this,null,e)}function Qa(e){So.call(this,e)}Ga.transform=function(e,t){var n,i,r,o=t,a=e.as,s=e.fields,u=e.index,c=e.values,l=null==e.default?null:e.default,f=e.modified(),d=f?t.SOURCE:t.ADD,p=s.length;return c?(i=c.length,p>1&&!a&&Object(h["n"])('Multi-field lookup requires explicit "as" parameter.'),a&&a.length!==p*i&&Object(h["n"])('The "as" parameter has too few output field names.'),a=a||c.map(h["h"]),n=function(e){for(var t,n,r=0,o=0;r<p;++r)if(n=u.get(s[r](e)),null==n)for(t=0;t<i;++t,++o)e[a[o]]=l;else for(t=0;t<i;++t,++o)e[a[o]]=c[t](n)}):(a||Object(h["n"])("Missing output field names."),n=function(e){for(var t,n=0;n<p;++n)t=u.get(s[n](e)),e[a[n]]=null==t?l:t}),f?o=t.reflow(!0):(r=s.some((function(e){return t.modified(e.fields)})),d|=r?t.MOD:0),t.visit(d,n),o.modifies(a)},Object(h["y"])(Va,R),Object(h["y"])(Za,R),Object(h["y"])(Ja,Yi),Ja.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)},Qa.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:or,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var Ka=Object(h["y"])(Qa,So);function es(e,t){var n=e.field,i=e.value,r=("count"===e.op?"__count__":e.op)||"sum",o=Object(h["g"])(n).concat(Object(h["g"])(i)),a=ns(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map((function(){return r})),fields:a.map((function(e){return ts(e,n,i,o)})),as:a.map((function(e){return e+""})),modified:e.modified.bind(e)}}function ts(e,t,n,i){return Object(h["f"])((function(i){return t(i)===e?n(i):NaN}),i,e+"")}function ns(e,t,n){var i={},r=[];return n.visit(n.SOURCE,(function(t){var n=e(t);i[n]||(i[n]=1,r.push(n))})),r.sort((function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)})),t?r.slice(0,t):r}function is(e){ha.call(this,e)}Ka._transform=Ka.transform,Ka.transform=function(e,t){return this._transform(es(e,t),t)};const rs=Object(h["y"])(is,ha);function os(e){Yi.call(this,null,e)}rs.transform=function(e,t){const n=e.subflow,i=e.field,r=e=>this.subflow(y(e),n,t,e);return(e.modified("field")||i&&t.modified(Object(h["g"])(i)))&&Object(h["n"])("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,e=>{const t=r(e);i(e).forEach(e=>t.mod(e))}),t.visit(t.ADD,e=>{const t=r(e);i(e).forEach(e=>t.add(O(e)))}),t.visit(t.REM,e=>{const t=r(e);i(e).forEach(e=>t.rem(e))})):(t.visit(t.MOD,e=>r(e).mod(e)),t.visit(t.ADD,e=>r(e).add(e)),t.visit(t.REM,e=>r(e).rem(e))),t.clean()&&t.runAfter(()=>this.clean()),t},os.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};var as=Object(h["y"])(os,Yi);function ss(e,t,n,i){for(var r=0,o=n.length;r<o;++r)t[i[r]]=n[r](e);return t}function us(e){Yi.call(this,null,e)}as.transform=function(e,t){var n,i,r=e.fields,o=ta(e.fields,e.as||[]),a=r?function(e,t){return ss(e,t,r,o)}:w;return this.value?i=this.value:(t=t.addAll(),i=this.value={}),n=t.fork(t.NO_SOURCE),t.visit(t.REM,(function(e){var t=y(e);n.rem.push(i[t]),i[t]=null})),t.visit(t.ADD,(function(e){var t=a(e,O({}));i[y(e)]=t,n.add.push(t)})),t.visit(t.MOD,(function(e){n.mod.push(a(e,i[y(e)]))})),n};var cs=Object(h["y"])(us,Yi);cs.transform=function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var ls=function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);while(++i<r)o[i]=e+i*n;return o};function fs(e){Yi.call(this,null,e)}fs.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};var ds=Object(h["y"])(fs,Yi),hs=1e-14;function ps(e){Yi.call(this,null,e)}ds.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,o=na(r,e.groupby,e.field),a=(e.groupby||[]).map(h["h"]),s=[],u=e.step||.01,c=e.probs||ls(u/2,1-hs,u),l=c.length;return o.forEach(e=>{const t=jr(e,c);for(let n=0;n<l;++n){const r={};for(let t=0;t<a.length;++t)r[a[t]]=e.dims[t];r[i[0]]=c[n],r[i[1]]=t[n],s.push(O(r))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n};var gs=Object(h["y"])(ps,Yi);function ms(e){Yi.call(this,[],e),this.count=0}gs.transform=function(e,t){var n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,e=>{var t=y(e);n.rem.push(i[t]),i[t]=null}),t.visit(t.ADD,e=>{var t=_(e);i[y(e)]=t,n.add.push(t)}),t.visit(t.MOD,e=>{var t,r=i[y(e)];for(t in e)r[t]=e[t],n.modifies(t);n.mod.push(r)})),n},ms.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};var vs=Object(h["y"])(ms,Yi);function bs(e){Yi.call(this,null,e)}vs.transform=function(e,t){var n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,o=this.value,a=this.count,s=0,u=o.reduce((function(e,t){return e[y(t)]=1,e}),{});function c(e){var t,i;o.length<r?o.push(e):(i=~~((a+1)*Cr()),i<o.length&&i>=s&&(t=o[i],u[y(t)]&&n.rem.push(t),o[i]=e)),++a}if(t.rem.length&&(t.visit(t.REM,(function(e){var t=y(e);u[t]&&(u[t]=-1,n.rem.push(e)),--a})),o=o.filter((function(e){return-1!==u[y(e)]}))),(t.rem.length||i)&&o.length<r&&t.source&&(s=a=o.length,t.visit(t.SOURCE,(function(e){u[y(e)]||c(e)})),s=-1),i&&o.length>r){for(var l=0,f=o.length-r;l<f;++l)u[y(o[l])]=-1,n.rem.push(o[l]);o=o.slice(f)}return t.mod.length&&t.visit(t.MOD,(function(e){u[y(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,c),(t.add.length||s<0)&&(n.add=o.filter((function(e){return!u[y(e)]}))),this.count=a,this.value=n.source=o,n},bs.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};var ys=Object(h["y"])(bs,Yi);function xs(e){Yi.call(this,null,e),this.modified(!0)}ys.transform=function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=ls(e.start,e.stop,e.step||1).map((function(e){var t={};return t[i]=e,O(t)})),n.add=t.add.concat(this.value),n}};var Os=Object(h["y"])(xs,Yi);function _s(e){Yi.call(this,null,e)}Os.transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};const ws=["unit0","unit1"];_s.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:xt,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:ws}]};var js=Object(h["y"])(_s,Yi);function ks(e){Yi.call(this,Object(h["s"])(),e)}js.transform=function(e,t){var n=e.field,i=!1!==e.interval,r="utc"===e.timezone,o=this._floor(e,t),a=(r?dn:fn)(o.unit).offset,s=e.as||ws,u=s[0],c=s[1],l=o.start||1/0,f=o.stop||-1/0,d=o.step,p=t.ADD;return(e.modified()||t.modified(Object(h["g"])(n)))&&(t=t.reflow(!0),p=t.SOURCE,l=1/0,f=-1/0),t.visit(p,(function(e){var t,r,s=n(e);null==s?(e[u]=null,i&&(e[c]=null)):(e[u]=t=r=o(s),i&&(e[c]=r=a(t,d)),t<l&&(l=t),r>f&&(f=r))})),o.start=l,o.stop=f,t.modifies(i?s:u)},js._floor=function(e,t){const n="utc"===e.timezone;let{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:Pn({extent:e.extent||Object(h["p"])(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins});i=_t(i);const o=this.value||{},a=(n?Jt:Yt)(i,r);return a.unit=Object(h["U"])(i),a.units=i,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a};var Es=Object(h["y"])(ks,Yi);function As(e){Yi.call(this,null,e)}Es.transform=function(e,t){var n=t.dataflow,i=e.field,r=this.value,o=!0;function a(e){r.set(i(e),e)}return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,(function(e){r.delete(i(e))})),t.visit(t.ADD,a)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()};var Ds=Object(h["y"])(As,Yi);function Ss(e,t,n,i){let r=Cs[e](t,n);return{init:r.init||h["kb"],update:function(e,t){t[i]=r.next(e)}}}Ds.transform=function(e,t){var n=!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields);n&&(this.value=(e.sort?t.source.slice().sort(k(e.sort)):t.source).map(e.field))};const Cs={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{let n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){let e=Cs.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{let n=t.index,i=t.data,r=t.compare;if(e<n){while(n+1<i.length&&!r(i[n],i[n+1]))++n;e=n}return(1+e)/i.length}}},ntile:function(e,t){t=+t,t>0||Object(h["n"])("ntile num must be greater than zero.");let n=Cs.cume_dist(),i=n.next;return{init:n.init,next:e=>Math.ceil(t*i(e))}},lag:function(e,t){return t=+t||1,{next:n=>{let i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{let i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Object(h["n"])("nth_value nth must be greater than zero."),{next:n=>{let i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{let i=e(n.data[n.index]);return null!=i?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{let r=i.data;return i.index<=n?t:(n=Fs(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function Fs(e,t,n){for(let i=t.length;n<i;++n){let i=e(t[n]);if(null!=i)return n}return-1}var Ms=Object.keys(Cs);function $s(e){let t=this,n=Object(h["i"])(e.ops),i=Object(h["i"])(e.fields),r=Object(h["i"])(e.params),o=Object(h["i"])(e.as),a=t.outputs=[],s=t.windows=[],u={},c={},l=!0,f=[],d=[];function p(e){Object(h["i"])(Object(h["g"])(e)).forEach(e=>u[e]=1)}p(e.sort),n.forEach((function(e,t){let n=i[t],u=Object(h["h"])(n),g=tr(e,u,o[t]);if(p(n),a.push(g),Object(h["v"])(Cs,e))s.push(Ss(e,i[t],r[t],g));else{if(null==n&&"count"!==e&&Object(h["n"])("Null aggregate field specified."),"count"===e)return void f.push(g);l=!1;let t=c[u];t||(t=c[u]=[],t.field=n,d.push(t)),t.push(sr(e,g))}})),(f.length||d.length)&&(t.cell=Ts(d,f,l)),t.inputs=Object.keys(u)}const Ns=$s.prototype;function Ts(e,t,n){e=e.map(e=>pr(e,e.field));let i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,o=i.agg=Array(r),a=0;a<r;++a)o[a]=new e[a](i);if(i.store)var s=i.data=new Ao;return i.add=function(e){if(i.num+=1,!n){s&&s.add(e);for(let t=0;t<r;++t)o[t].add(o[t].get(e),e)}},i.rem=function(e){if(i.num-=1,!n){s&&s.rem(e);for(let t=0;t<r;++t)o[t].rem(o[t].get(e),e)}},i.set=function(e){let r,a;for(s&&s.values(),r=0,a=t.length;r<a;++r)e[t[r]]=i.num;if(!n)for(r=0,a=o.length;r<a;++r)o[r].set(e)},i.init=function(){i.num=0,s&&s.reset();for(let e=0;e<r;++e)o[e].init()},i}function Rs(e){Yi.call(this,{},e),this._mlen=0,this._mods=[]}Ns.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},Ns.update=function(e,t){let n,i=this,r=i.cell,o=i.windows,a=e.data,s=o&&o.length;if(r){for(n=e.p0;n<e.i0;++n)r.rem(a[n]);for(n=e.p1;n<e.i1;++n)r.add(a[n]);r.set(t)}for(n=0;n<s;++n)o[n].update(e,t)},Rs.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Ms.concat(or)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var zs=Object(h["y"])(Rs,Yi);function Ps(e,t,n,i){var r=i.sort,o=r&&!i.ignorePeers,a=i.frame||[null,0],s=e.data(n),u=s.length,c=0,l=o?xn(r):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:r||Object(h["l"])(-1)};for(t.init();c<u;++c)Ls(f,a,c,u),o&&Bs(f,l),t.update(f,s[c])}function Ls(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function Bs(e,t){var n=e.i0,i=e.i1-1,r=e.compare,o=e.data,a=o.length-1;n>0&&!r(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),i<a&&!r(o[i],o[i+1])&&(e.i1=t.right(o,o[i]))}zs.transform=function(e,t){var n,i,r=this,o=r.state,a=e.modified(),s=k(e.sort);this.stamp=t.stamp,o&&!a||(o=r.state=new $s(e));var u=er(e.groupby);function c(e){return r.group(u(e))}for(a||t.modified(o.inputs)?(r.value={},t.visit(t.SOURCE,(function(e){c(e).add(e)}))):(t.visit(t.REM,(function(e){c(e).remove(e)})),t.visit(t.ADD,(function(e){c(e).add(e)}))),n=0,i=r._mlen;n<i;++n)Ps(r._mods[n],o,s,e);return r._mlen=0,r._mods=[],t.reflow(a).modifies(o.outputs)},zs.group=function(e){var t=this,n=t.value[e];return n||(n=t.value[e]=No(y),n.stamp=-1),n.stamp<t.stamp&&(n.stamp=t.stamp,t._mods[t._mlen++]=n),n};const Is="top",Us="left",qs="right",Ws="bottom",Hs="top-left",Gs="top-right",Vs="bottom-left",Ys="bottom-right",Zs="start",Xs="middle",Js="end",Qs="x",Ks="y",eu="group",tu="axis",nu="title",iu="frame",ru="scope",ou="legend",au="row-header",su="row-footer",uu="row-title",cu="column-header",lu="column-footer",fu="column-title",du="padding",hu="symbol",pu="fit",gu="fit-x",mu="fit-y",vu="pad",bu="none",yu="all",xu="each",Ou="flush",_u="column",wu="row";var ju=0;function ku(){ju=0}const Eu="p_";function Au(e){return e&&e.gradient}function Du(e,t,n){let i=e.id,r=e.gradient,o="radial"===r?Eu:"";return i||(i=e.id="gradient_"+ju++,"radial"===r?(e.x1=Su(e.x1,.5),e.y1=Su(e.y1,.5),e.r1=Su(e.r1,0),e.x2=Su(e.x2,.5),e.y2=Su(e.y2,.5),e.r2=Su(e.r2,.5),o=Eu):(e.x1=Su(e.x1,0),e.y1=Su(e.y1,0),e.x2=Su(e.x2,1),e.y2=Su(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+o+i+")"}function Su(e,t){return null!=e?e:t}var Cu=function(e,t){var n,i=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:i,stop:function(e,t){return i.push({offset:e,color:t}),n}}},Fu=n("8c80"),Mu=n("9ae6"),$u=n("d675"),Nu=n("7784"),Tu=n("7792"),Ru=n("b0ad"),zu=n("3b4d"),Pu=n("29c8"),Lu=n("5644"),Bu=n("438d"),Iu=n("4830"),Uu=n("cc3e"),qu=n("a4bd"),Wu=n("a84d"),Hu=n("7bd6"),Gu={basis:{curve:Fu["b"]},"basis-closed":{curve:Mu["a"]},"basis-open":{curve:$u["a"]},bundle:{curve:Nu["a"],tension:"beta",value:.85},cardinal:{curve:Tu["b"],tension:"tension",value:0},"cardinal-open":{curve:Ru["b"],tension:"tension",value:0},"cardinal-closed":{curve:zu["b"],tension:"tension",value:0},"catmull-rom":{curve:Pu["a"],tension:"alpha",value:.5},"catmull-rom-closed":{curve:Lu["a"],tension:"alpha",value:.5},"catmull-rom-open":{curve:Bu["a"],tension:"alpha",value:.5},linear:{curve:Iu["a"]},"linear-closed":{curve:Uu["a"]},monotone:{horizontal:qu["b"],vertical:qu["a"]},natural:{curve:Wu["a"]},step:{curve:Hu["a"]},"step-after":{curve:Hu["b"]},"step-before":{curve:Hu["c"]}};function Vu(e,t,n){var i=Object(h["v"])(Gu,e)&&Gu[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&null!=n&&(r=r[i.tension](n))),r}var Yu={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Zu=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],Xu=function(e){var t,n,i,r,o,a,s,u,c,l,f,d=[];for(t=e.slice().replace(Zu[0],"###$1").split(Zu[1]).slice(1),u=0,l=t.length;u<l;++u){for(n=t[u],i=n.slice(1).trim().replace(Zu[2],"$1###$2").split(Zu[3]),a=n.charAt(0),r=[a],c=0,f=i.length;c<f;++c)(o=+i[c])===o&&r.push(o);if(s=Yu[a.toLowerCase()],r.length-1>s)for(c=1,f=r.length;c<f;c+=s)d.push([a].concat(r.slice(c,c+s)));else d.push(r)}return d};const Ju=Math.PI/180,Qu=1e-14,Ku=Math.PI/2,ec=2*Math.PI,tc=Math.sqrt(3)/2;var nc={},ic={},rc=[].join;function oc(e,t,n,i,r,o,a,s,u){var c=rc.call(arguments);if(nc[c])return nc[c];var l=a*Ju,f=Math.sin(l),d=Math.cos(l);n=Math.abs(n),i=Math.abs(i);var h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5,g=h*h/(n*n)+p*p/(i*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);var m=d/n,v=f/n,b=-f/i,y=d/i,x=m*s+v*u,O=b*s+y*u,_=m*e+v*t,w=b*e+y*t,j=(_-x)*(_-x)+(w-O)*(w-O),k=1/j-.25;k<0&&(k=0);var E=Math.sqrt(k);o==r&&(E=-E);var A=.5*(x+_)-E*(w-O),D=.5*(O+w)+E*(_-x),S=Math.atan2(O-D,x-A),C=Math.atan2(w-D,_-A),F=C-S;F<0&&1===o?F+=ec:F>0&&0===o&&(F-=ec);for(var M=Math.ceil(Math.abs(F/(Ku+.001))),$=[],N=0;N<M;++N){var T=S+N*F/M,R=S+(N+1)*F/M;$[N]=[A,D,T,R,n,i,f,d]}return nc[c]=$}function ac(e){var t=rc.call(e);if(ic[t])return ic[t];var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=c*a,f=-u*s,d=u*a,h=c*s,p=Math.cos(r),g=Math.sin(r),m=Math.cos(o),v=Math.sin(o),b=.5*(o-r),y=Math.sin(.5*b),x=8/3*y*y/Math.sin(b),O=n+p-x*g,_=i+g+x*p,w=n+m,j=i+v,k=w+x*v,E=j-x*m;return ic[t]=[l*O+f*_,d*O+h*_,l*k+f*E,d*k+h*E,l*w+f*j,d*w+h*j]}var sc=["l",0,0,0,0,0,0,0];function uc(e,t,n){var i=sc[0]=e[0];if("a"===i||"A"===i)sc[1]=t*e[1],sc[2]=n*e[2],sc[3]=e[3],sc[4]=e[4],sc[5]=e[5],sc[6]=t*e[6],sc[7]=n*e[7];else if("h"===i||"H"===i)sc[1]=t*e[1];else if("v"===i||"V"===i)sc[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)sc[r]=(r%2==1?t:n)*e[r];return sc}var cc=function(e,t,n,i,r,o){var a,s,u,c,l,f=null,d=0,h=0,p=0,g=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==o&&(o=r),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(a=t[m],1===r&&1===o||(a=uc(a,r,o)),a[0]){case"l":d+=a[1],h+=a[2],e.lineTo(d+n,h+i);break;case"L":d=a[1],h=a[2],e.lineTo(d+n,h+i);break;case"h":d+=a[1],e.lineTo(d+n,h+i);break;case"H":d=a[1],e.lineTo(d+n,h+i);break;case"v":h+=a[1],e.lineTo(d+n,h+i);break;case"V":h=a[1],e.lineTo(d+n,h+i);break;case"m":d+=a[1],h+=a[2],e.moveTo(d+n,h+i);break;case"M":d=a[1],h=a[2],e.moveTo(d+n,h+i);break;case"c":s=d+a[5],u=h+a[6],p=d+a[3],g=h+a[4],e.bezierCurveTo(d+a[1]+n,h+a[2]+i,p+n,g+i,s+n,u+i),d=s,h=u;break;case"C":d=a[5],h=a[6],p=a[3],g=a[4],e.bezierCurveTo(a[1]+n,a[2]+i,p+n,g+i,d+n,h+i);break;case"s":s=d+a[3],u=h+a[4],p=2*d-p,g=2*h-g,e.bezierCurveTo(p+n,g+i,d+a[1]+n,h+a[2]+i,s+n,u+i),p=d+a[1],g=h+a[2],d=s,h=u;break;case"S":s=a[3],u=a[4],p=2*d-p,g=2*h-g,e.bezierCurveTo(p+n,g+i,a[1]+n,a[2]+i,s+n,u+i),d=s,h=u,p=a[1],g=a[2];break;case"q":s=d+a[3],u=h+a[4],p=d+a[1],g=h+a[2],e.quadraticCurveTo(p+n,g+i,s+n,u+i),d=s,h=u;break;case"Q":s=a[3],u=a[4],e.quadraticCurveTo(a[1]+n,a[2]+i,s+n,u+i),d=s,h=u,p=a[1],g=a[2];break;case"t":s=d+a[1],u=h+a[2],null===f[0].match(/[QqTt]/)?(p=d,g=h):"t"===f[0]?(p=2*d-c,g=2*h-l):"q"===f[0]&&(p=2*d-p,g=2*h-g),c=p,l=g,e.quadraticCurveTo(p+n,g+i,s+n,u+i),d=s,h=u,p=d+a[1],g=h+a[2];break;case"T":s=a[1],u=a[2],p=2*d-p,g=2*h-g,e.quadraticCurveTo(p+n,g+i,s+n,u+i),d=s,h=u;break;case"a":lc(e,d+n,h+i,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+h+i]),d+=a[6],h+=a[7];break;case"A":lc(e,d+n,h+i,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+i]),d=a[6],h=a[7];break;case"z":case"Z":e.closePath();break}f=a}};function lc(e,t,n,i){for(var r=oc(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n),o=0;o<r.length;++o){var a=ac(r[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}var fc=.5773502691896257,dc={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,ec)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=tc*n,r=i-n*fc,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=tc*n,r=i-n*fc;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tc*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tc*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tc*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tc*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function hc(e){return Object(h["v"])(dc,e)?dc[e]:gc(e)}var pc={};function gc(e){if(!Object(h["v"])(pc,e)){var t=Xu(e);pc[e]={draw:function(e,n){cc(e,t,0,0,Math.sqrt(n)/2)}}}return pc[e]}var mc=n("eadc");const vc=.448084975506;function bc(e){return e.x}function yc(e){return e.y}function xc(e){return e.width}function Oc(e){return e.height}function _c(e){return"function"===typeof e?e:()=>+e}function wc(e,t,n){return Math.max(t,Math.min(e,n))}var jc=function(){var e=bc,t=yc,n=xc,i=Oc,r=_c(0),o=r,a=r,s=r,u=null;function c(c,l,f){var d,h=null!=l?l:+e.call(this,c),p=null!=f?f:+t.call(this,c),g=+n.call(this,c),m=+i.call(this,c),v=Math.min(g,m)/2,b=wc(+r.call(this,c),0,v),y=wc(+o.call(this,c),0,v),x=wc(+a.call(this,c),0,v),O=wc(+s.call(this,c),0,v);if(u||(u=d=Object(mc["a"])()),b<=0&&y<=0&&x<=0&&O<=0)u.rect(h,p,g,m);else{var _=h+g,w=p+m;u.moveTo(h+b,p),u.lineTo(_-y,p),u.bezierCurveTo(_-vc*y,p,_,p+vc*y,_,p+y),u.lineTo(_,w-O),u.bezierCurveTo(_,w-vc*O,_-vc*O,w,_-O,w),u.lineTo(h+x,w),u.bezierCurveTo(h+vc*x,w,h,w-vc*x,h,w-x),u.lineTo(h,p+b),u.bezierCurveTo(h,p+vc*b,h+vc*b,p,h+b,p),u.closePath()}if(d)return u=null,d+""||null}return c.x=function(t){return arguments.length?(e=_c(t),c):e},c.y=function(e){return arguments.length?(t=_c(e),c):t},c.width=function(e){return arguments.length?(n=_c(e),c):n},c.height=function(e){return arguments.length?(i=_c(e),c):i},c.cornerRadius=function(e,t,n,i){return arguments.length?(r=_c(e),o=null!=t?_c(t):r,s=null!=n?_c(n):r,a=null!=i?_c(i):o,c):r},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c},kc=function(){var e,t,n,i,r,o,a,s,u=null;function c(e,t,n){var i=n/2;if(r){var c=a-t,l=e-o;if(c||l){var f=Math.sqrt(c*c+l*l),d=(c/=f)*s,h=(l/=f)*s,p=Math.atan2(l,c);u.moveTo(o-d,a-h),u.lineTo(e-c*i,t-l*i),u.arc(e,t,i,p-Math.PI,p),u.lineTo(o+d,a+h),u.arc(o,a,s,p,p+Math.PI)}else u.arc(e,t,i,0,ec);u.closePath()}else r=1;o=e,a=t,s=i}function l(o){var a,s,l,f=o.length,d=!1;for(null==u&&(u=l=Object(mc["a"])()),a=0;a<=f;++a)!(a<f&&i(s=o[a],a,o))===d&&(d=!d)&&(r=0),d&&c(+e(s,a,o),+t(s,a,o),+n(s,a,o));if(l)return u=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(i=e,l):i},l.context=function(e){return arguments.length?(u=null==e?null:e,l):u},l},Ec=n("650c"),Ac=n("e38c"),Dc=n("fae8"),Sc=n("9150");function Cc(e,t){return null!=e?e:t}const Fc=e=>e.x||0,Mc=e=>e.y||0,$c=e=>e.width||0,Nc=e=>e.height||0,Tc=e=>(e.x||0)+(e.width||0),Rc=e=>(e.y||0)+(e.height||0),zc=e=>e.startAngle||0,Pc=e=>e.endAngle||0,Lc=e=>e.padAngle||0,Bc=e=>e.innerRadius||0,Ic=e=>e.outerRadius||0,Uc=e=>e.cornerRadius||0,qc=e=>Cc(e.cornerRadiusTopLeft,e.cornerRadius)||0,Wc=e=>Cc(e.cornerRadiusTopRight,e.cornerRadius)||0,Hc=e=>Cc(e.cornerRadiusBottomRight,e.cornerRadius)||0,Gc=e=>Cc(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Vc=e=>Cc(e.size,64),Yc=e=>e.size||1,Zc=e=>!(!1===e.defined),Xc=e=>hc(e.shape||"circle"),Jc=Object(Ec["a"])().startAngle(zc).endAngle(Pc).padAngle(Lc).innerRadius(Bc).outerRadius(Ic).cornerRadius(Uc),Qc=Object(Ac["a"])().x(Fc).y1(Mc).y0(Rc).defined(Zc),Kc=Object(Ac["a"])().y(Mc).x1(Fc).x0(Tc).defined(Zc),el=Object(Dc["a"])().x(Fc).y(Mc).defined(Zc),tl=jc().x(Fc).y(Mc).width($c).height(Nc).cornerRadius(qc,Wc,Hc,Gc),nl=Object(Sc["a"])().type(Xc).size(Vc),il=kc().x(Fc).y(Mc).defined(Zc).size(Yc);function rl(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function ol(e,t){return Jc.context(e)(t)}function al(e,t){var n=t[0],i=n.interpolate||"linear";return("horizontal"===n.orient?Kc:Qc).curve(Vu(i,n.orient,n.tension)).context(e)(t)}function sl(e,t){var n=t[0],i=n.interpolate||"linear";return el.curve(Vu(i,n.orient,n.tension)).context(e)(t)}function ul(e,t,n,i){return tl.context(e)(t,n,i)}function cl(e,t){return(t.mark.shape||t.shape).context(e)(t)}function ll(e,t){return nl.context(e)(t)}function fl(e,t){return il.context(e)(t)}var dl=1;function hl(){dl=1}var pl=function(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+dl++),a=r.clipping[o]||(r.clipping[o]={id:o});return Object(h["D"])(i)?a.path=i(null):rl(n)?a.path=ul(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"};function gl(e){this.clear(),e&&this.union(e)}var ml=gl.prototype;function vl(e){this.mark=e,this.bounds=this.bounds||new gl}function bl(e){vl.call(this,e),this.items=this.items||[]}function yl(e,t){if("undefined"!==typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}function xl(){return"undefined"!==typeof Image?Image:null}function Ol(e){this._pending=0,this._loader=e||Kn()}ml.clone=function(){return new gl(this)},ml.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},ml.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},ml.equals=function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},ml.set=function(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},ml.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},ml.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},ml.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},ml.scale=function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},ml.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},ml.rotate=function(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},ml.rotatedPoints=function(e,t,n){var{x1:i,y1:r,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),c=t-t*s+n*u,l=n-t*u-n*s;return[s*i-u*r+c,u*i+s*r+l,s*i-u*a+c,u*i+s*a+l,s*o-u*r+c,u*o+s*r+l,s*o-u*a+c,u*o+s*a+l]},ml.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},ml.intersect=function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},ml.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},ml.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},ml.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},ml.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},ml.width=function(){return this.x2-this.x1},ml.height=function(){return this.y2-this.y1},Object(h["y"])(bl,vl);var _l=Ol.prototype;function wl(e){e._pending+=1}function jl(e){e._pending-=1}_l.pending=function(){return this._pending},_l.sanitizeURL=function(e){var t=this;return wl(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return jl(t),e})).catch((function(){return jl(t),null}))},_l.loadImage=function(e){const t=this,n=xl();return wl(t),t._loader.sanitize(e,{context:"image"}).then((function(e){const i=e.href;if(!i||!n)throw{url:i};const r=new n,o=Object(h["v"])(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=o&&(r.crossOrigin=o),r.onload=()=>jl(t),r.onerror=()=>jl(t),r.src=i,r})).catch((function(e){return jl(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},_l.ready=function(){var e=this;return new Promise((function(t){function n(i){e.pending()?setTimeout((function(){n(!0)}),10):t(i)}n(!1)}))};var kl=function(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const i=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(i+(n?El(t,i):0))}return e};function El(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}var Al,Dl,Sl,Cl=ec-1e-8;function Fl(e){return Al=e,Fl}function Ml(){}function $l(e,t){Al.add(e,t)}function Nl(e,t){$l(Dl=e,Sl=t)}function Tl(e){$l(e,Al.y1)}function Rl(e){$l(Al.x1,e)}function zl(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function Pl(e,t,n,i,r){const o=i-e+3*t-3*n,a=e+n-2*t,s=e-t;let u,c=0,l=0;Math.abs(o)>Qu?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),c=(-a+u)/o,l=(-a-u)/o)):c=.5*s/a,0<c&&c<1&&r(Ll(c,e,t,n,i)),0<l&&l<1&&r(Ll(l,e,t,n,i))}function Ll(e,t,n,i,r){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*i+s*e*r}Fl.beginPath=Ml,Fl.closePath=Ml,Fl.moveTo=Nl,Fl.lineTo=Nl,Fl.rect=function(e,t,n,i){$l(e+n,t+i),Nl(e,t)},Fl.quadraticCurveTo=function(e,t,n,i){zl(Dl,e,n,Tl),zl(Sl,t,i,Rl),Nl(n,i)},Fl.bezierCurveTo=function(e,t,n,i,r,o){Pl(Dl,e,n,r,Tl),Pl(Sl,t,i,o,Rl),Nl(r,o)},Fl.arc=function(e,t,n,i,r,o){if(Dl=n*Math.cos(r)+e,Sl=n*Math.sin(r)+t,Math.abs(r-i)>Cl)$l(e-n,t-n),$l(e+n,t+n);else{const a=i=>$l(n*Math.cos(i)+e,n*Math.sin(i)+t);let s,u;if(a(i),a(r),r!==i)if(i%=ec,i<0&&(i+=ec),r%=ec,r<0&&(r+=ec),r<i&&(o=!o,s=i,i=r,r=s),o)for(r-=ec,s=i-i%Ku,u=0;u<4&&s>r;++u,s-=Ku)a(s);else for(s=i-i%Ku+Ku,u=0;u<4&&s<r;++u,s+=Ku)a(s)}};var Bl=(Bl=yl(1,1))?Bl.getContext("2d"):null;const Il=new gl;function Ul(e){return function(t,n){if(!Bl)return!0;e(Bl,t),Il.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:a}=Il;for(let e=r;e<=a;++e)for(let t=i;t<=o;++t)if(Bl.isPointInPath(t,e))return!0;return!1}}function ql(e,t){return t.contains(e.x||0,e.y||0)}function Wl(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(Il.set(n,i,n+r,i+o))}function Hl(e,t){const n=e.x||0,i=e.y||0,r=null!=e.x2?e.x2:n,o=null!=e.y2?e.y2:i;return Gl(t,n,i,r,o)}function Gl(e,t,n,i,r){const{x1:o,y1:a,x2:s,y2:u}=e,c=i-t,l=r-n;let f,d,h,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(f=-c,d=-(o-t)),1===p&&(f=c,d=s-t),2===p&&(f=-l,d=-(a-n)),3===p&&(f=l,d=u-n),Math.abs(f)<1e-10&&d<0)return!1;if(h=d/f,f<0){if(h>m)return!1;h>g&&(g=h)}else if(f>0){if(h<g)return!1;h<m&&(m=h)}}return!0}var Vl=function(e,t){e.globalCompositeOperation=t.blend||"source-over"},Yl=function(e,t){return null==e?t:e};function Zl(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}var Xl=function(e,t,n){const i=n.width(),r=n.height();let o;if("radial"===t.gradient)o=e.createRadialGradient(n.x1+Yl(t.x1,.5)*i,n.y1+Yl(t.y1,.5)*r,Math.max(i,r)*Yl(t.r1,0),n.x1+Yl(t.x2,.5)*i,n.y1+Yl(t.y2,.5)*r,Math.max(i,r)*Yl(t.r2,.5));else{const a=Yl(t.x1,0),s=Yl(t.y1,0),u=Yl(t.x2,1),c=Yl(t.y2,0);if(a!==u&&s!==c&&i!==r){const n=yl(Math.ceil(i),Math.ceil(r)),o=n.getContext("2d");return o.scale(i,r),o.fillStyle=Zl(o.createLinearGradient(a,s,u,c),t.stops),o.fillRect(0,0,i,r),e.createPattern(n,"no-repeat")}o=e.createLinearGradient(n.x1+a*i,n.y1+s*r,n.x1+u*i,n.y1+c*r)}return Zl(o,t.stops)},Jl=function(e,t,n){return Au(n)?Xl(e,n,t.bounds):n},Ql=function(e,t,n){return n*=null==t.fillOpacity?1:t.fillOpacity,n>0&&(e.globalAlpha=n,e.fillStyle=Jl(e,t,t.fill),!0)},Kl=[],ef=function(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity,n>0&&(e.globalAlpha=n,e.strokeStyle=Jl(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Kl),e.lineDashOffset=t.strokeDashOffset||0),!0))};function tf(e,t){return e.zindex-t.zindex||e.index-t.index}function nf(e){if(!e.zdirty)return e.zitems;var t,n,i,r=e.items,o=[];for(n=0,i=r.length;n<i;++n)t=r[n],t.index=n,t.zindex&&o.push(t);return e.zdirty=!1,e.zitems=o.sort(tf)}function rf(e,t){var n,i,r=e.items;if(r&&r.length){var o=nf(e);if(o&&o.length){for(n=0,i=r.length;n<i;++n)r[n].zindex||t(r[n]);r=o}for(n=0,i=r.length;n<i;++n)t(r[n])}}function of(e,t){var n,i,r=e.items;if(!r||!r.length)return null;var o=nf(e);for(o&&o.length&&(r=o),i=r.length;--i>=0;)if(n=t(r[i]))return n;if(r===o)for(r=e.items,i=r.length;--i>=0;)if(!r[i].zindex&&(n=t(r[i])))return n;return null}function af(e){return function(t,n,i){rf(n,(function(n){i&&!i.intersects(n.bounds)||uf(e,t,n,n)}))}}function sf(e){return function(t,n,i){!n.items.length||i&&!i.intersects(n.bounds)||uf(e,t,n.items[0],n.items)}}function uf(e,t,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(e(t,i)||(Vl(t,n),n.fill&&Ql(t,n,r)&&t.fill(),n.stroke&&ef(t,n,r)&&t.stroke()))}function cf(e){return e=e||h["gb"],function(t,n,i,r,o,a){return i*=t.pixelRatio,r*=t.pixelRatio,of(n,(function(n){var s=n.bounds;if((!s||s.contains(o,a))&&s)return e(t,n,i,r,o,a)?n:void 0}))}}function lf(e,t){return function(n,i,r,o){var a,s,u=Array.isArray(i)?i[0]:i,c=null==t?u.fill:t,l=u.stroke&&n.isPointInStroke;return l&&(a=u.strokeWidth,s=u.strokeCap,n.lineWidth=null!=a?a:1,n.lineCap=null!=s?s:"butt"),!e(n,i)&&(c&&n.isPointInPath(r,o)||l&&n.isPointInStroke(r,o))}}function ff(e){return cf(lf(e))}function df(e,t){return"translate("+e+","+t+")"}function hf(e){return"rotate("+e+")"}function pf(e,t){return"scale("+e+","+t+")"}function gf(e){return df(e.x||0,e.y||0)}function mf(e){return df(e.x||0,e.y||0)+(e.angle?" "+hf(e.angle):"")+(e.scaleX||e.scaleY?" "+pf(e.scaleX||1,e.scaleY||1):"")}var vf=function(e,t,n){function i(e,n){e("transform",mf(n)),e("d",t(null,n))}function r(e,n){var i=n.x||0,r=n.y||0;return t(Fl(e),n),kl(e,n).translate(i,r),n.angle&&e.rotate(n.angle*Ju,i,r),e}function o(e,n){var i=n.x||0,r=n.y||0,o=n.angle||0;e.translate(i,r),o&&e.rotate(o*=Ju),e.beginPath(),t(e,n),o&&e.rotate(-o),e.translate(-i,-r)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:af(o),pick:ff(o),isect:n||Ul(o)}},bf=vf("arc",ol);function yf(e,t){var n,i,r="horizontal"===e[0].orient?t[1]:t[0],o="horizontal"===e[0].orient?"y":"x",a=e.length,s=1/0;while(--a>=0)!1!==e[a].defined&&(i=Math.abs(e[a][o]-r),i<s&&(s=i,n=e[a]));return n}function xf(e,t){var n,i,r,o=Math.pow(e[0].strokeWidth||1,2),a=e.length;while(--a>=0)if(!1!==e[a].defined&&(n=e[a].x-t[0],i=e[a].y-t[1],r=n*n+i*i,r<o))return e[a];return null}function Of(e,t){var n,i,r,o=e.length;while(--o>=0)if(!1!==e[o].defined&&(n=e[o].x-t[0],i=e[o].y-t[1],r=n*n+i*i,n=e[o].size||1,r<n*n))return e[o];return null}var _f=function(e,t,n){function i(e,n){var i=n.mark.items;i.length&&e("d",t(null,i))}function r(e,n){var i=n.items;return 0===i.length?e:(t(Fl(e),i),kl(e,i[0]))}function o(e,n){e.beginPath(),t(e,n)}var a=lf(o);function s(e,t,n,i,r,o){var s=t.items,u=t.bounds;return!s||!s.length||u&&!u.contains(r,o)?null:(n*=e.pixelRatio,i*=e.pixelRatio,a(e,s,n,i)?s[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:sf(o),pick:s,isect:ql,tip:n}},wf=_f("area",al,yf),jf=function(e,t){var n=t.clip;e.save(),Object(h["D"])(n)?(e.beginPath(),n(e),e.clip()):kf(e,t.group)};function kf(e,t){e.beginPath(),rl(t)?ul(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Ef(e){const t=Yl(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Af(e,t){e("transform",gf(t))}function Df(e,t){const n=Ef(t);e("d",ul(null,t,n,n))}function Sf(e,t){e("class","background"),e("aria-hidden",!0),Df(e,t)}function Cf(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Df(e,t):e("d","")}function Ff(e,t,n){const i=t.clip?pl(n,t,t):null;e("clip-path",i)}function Mf(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let t=0;t<i;++t)e.union(n[t].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),kl(e,t),e.translate(t.x||0,t.y||0)}function $f(e,t,n,i){const r=Ef(t);e.beginPath(),ul(e,t,(n||0)+r,(i||0)+r)}const Nf=lf($f),Tf=lf($f,!1);function Rf(e,t,n){rf(t,t=>{const i=t.x||0,r=t.y||0,o=t.strokeForeground,a=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&a&&($f(e,t,i,r),Vl(e,t),t.fill&&Ql(e,t,a)&&e.fill(),t.stroke&&!o&&ef(e,t,a)&&e.stroke()),e.save(),e.translate(i,r),t.clip&&kf(e,t),n&&n.translate(-i,-r),rf(t,t=>{this.draw(e,t,n)}),n&&n.translate(i,r),e.restore(),o&&t.stroke&&a&&($f(e,t,i,r),Vl(e,t),ef(e,t,a)&&e.stroke())})}function zf(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const a=n*e.pixelRatio,s=i*e.pixelRatio;return of(t,u=>{let c,l,f,d,h,p,g,m,v;if(m=u.bounds,(!m||m.contains(r,o))&&(d=u.x||0,h=u.y||0,p=d+(u.width||0),g=h+(u.height||0),v=u.clip,!v||!(r<d||r>p||o<h||o>g)))return e.save(),e.translate(d,h),d=r-d,h=o-h,v&&rl(u)&&!Nf(e,u,a,s)?(e.restore(),null):(l=u.strokeForeground,f=!1!==t.interactive,f&&l&&u.stroke&&Tf(e,u,a,s)?(e.restore(),u):(c=of(u,e=>Pf(e,d,h)?this.pick(e,n,i,d,h):null),!c&&f&&(u.fill||!l&&u.stroke)&&Nf(e,u,a,s)&&(c=u),e.restore(),c||null))})}function Pf(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}var Lf={type:"group",tag:"g",nested:!1,attr:Af,bound:Mf,draw:Rf,pick:zf,isect:Wl,content:Ff,background:Sf,foreground:Cf},Bf={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};function If(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(t=>{e.image=t,e.image.url=e.url})),n}function Uf(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function qf(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Wf(e,t){return"center"===e?t/2:"right"===e?t:0}function Hf(e,t){return"middle"===e?t/2:"bottom"===e?t:0}function Gf(e,t,n){const i=If(t,n),r=Uf(t,i),o=qf(t,i),a=(t.x||0)-Wf(t.align,r),s=(t.y||0)-Hf(t.baseline,o),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,Bf["xmlns:xlink"],"xlink:href"),e("transform",df(a,s)),e("width",r),e("height",o),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")}function Vf(e,t){const n=t.image,i=Uf(t,n),r=qf(t,n),o=(t.x||0)-Wf(t.align,i),a=(t.y||0)-Hf(t.baseline,r);return e.set(o,a,o+i,a+r)}function Yf(e,t,n){rf(t,t=>{if(n&&!n.intersects(t.bounds))return;let i,r,o,a,s=If(t,this),u=Uf(t,s),c=qf(t,s),l=(t.x||0)-Wf(t.align,u),f=(t.y||0)-Hf(t.baseline,c);!1!==t.aspect&&(r=s.width/s.height,o=t.width/t.height,r===r&&o===o&&r!==o&&(o<r?(a=u/r,f+=(c-a)/2,c=a):(a=c*r,l+=(u-a)/2,u=a))),(s.complete||s.toDataURL)&&(Vl(e,t),e.globalAlpha=null!=(i=t.opacity)?i:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(s,l,f,u,c))})}var Zf={type:"image",tag:"image",nested:!1,attr:Gf,bound:Vf,draw:Yf,pick:cf(),isect:h["gb"],get:If,xOffset:Wf,yOffset:Hf},Xf=_f("line",sl,xf);function Jf(e,t){var n=t.scaleX||1,i=t.scaleY||1;1===n&&1===i||e("vector-effect","non-scaling-stroke"),e("transform",mf(t)),e("d",t.path)}function Qf(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Ju,u=t.pathCache;u&&u.path===n||((t.pathCache=u=Xu(n)).path=n),s&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(s),cc(e,u,0,0,o,a),e.rotate(-s),e.translate(-i,-r)):cc(e,u,i,r,o,a)}function Kf(e,t){return Qf(Fl(e),t)?e.set(0,0,0,0):kl(e,t,!0),t.angle&&e.rotate(t.angle*Ju,t.x||0,t.y||0),e}var ed={type:"path",tag:"path",nested:!1,attr:Jf,bound:Kf,draw:af(Qf),pick:ff(Qf),isect:Ul(Qf)};function td(e,t){e("d",ul(null,t))}function nd(e,t){var n,i;return kl(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function id(e,t){e.beginPath(),ul(e,t)}var rd={type:"rect",tag:"path",nested:!1,attr:td,bound:nd,draw:af(id),pick:ff(id),isect:Wl};function od(e,t){e("transform",gf(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)}function ad(e,t){var n,i;return kl(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)}function sd(e,t,n){var i,r,o,a;return!(!t.stroke||!ef(e,t,n))&&(i=t.x||0,r=t.y||0,o=null!=t.x2?t.x2:i,a=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,a),!0)}function ud(e,t,n){rf(t,(function(t){if(!n||n.intersects(t.bounds)){var i=null==t.opacity?1:t.opacity;i&&sd(e,t,i)&&(Vl(e,t),e.stroke())}}))}function cd(e,t,n,i){return!!e.isPointInStroke&&(sd(e,t,1)&&e.isPointInStroke(n,i))}var ld={type:"rule",tag:"line",nested:!1,attr:od,bound:ad,draw:ud,pick:cf(cd),isect:Hl},fd=vf("shape",cl),dd=vf("symbol",ll,ql);const hd=Object(h["L"])();var pd={height:xd,measureWidth:bd,estimateWidth:md,width:md,canvas:gd};function gd(e){pd.width=e&&Bl?bd:md}function md(e,t){return vd(kd(e,t),xd(e))}function vd(e,t){return~~(.8*e.length*t)}function bd(e,t){return xd(e)<=0||!(t=kd(e,t))?0:yd(t,Sd(e))}function yd(e,t){const n=`(${t}) ${e}`;let i=hd.get(n);return void 0===i&&(Bl.font=t,i=Bl.measureText(e).width,hd.set(n,i)),i}function xd(e){return null!=e.fontSize?+e.fontSize||0:11}function Od(e){return null!=e.lineHeight?e.lineHeight:xd(e)+2}function _d(e){return Object(h["A"])(e)?e.length>1?e:e[0]:e}function wd(e){return _d(e.lineBreak&&e.text&&!Object(h["A"])(e.text)?e.text.split(e.lineBreak):e.text)}function jd(e){const t=wd(e);return(Object(h["A"])(t)?t.length-1:0)*Od(e)}function kd(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?Ad(e,n):n}function Ed(e){if(pd.width===bd){const t=Sd(e);return e=>yd(e,t)}{const t=xd(e);return e=>vd(e,t)}}function Ad(e,t){var n=+e.limit,i=Ed(e);if(i(t)<n)return t;var r,o=e.ellipsis||"",a="rtl"===e.dir,s=0,u=t.length;if(n-=i(o),a){while(s<u)r=s+u>>>1,i(t.slice(r))>n?s=r+1:u=r;return o+t.slice(s)}while(s<u)r=1+(s+u>>>1),i(t.slice(0,r))<n?s=r:u=r-1;return t.slice(0,s)+o}function Dd(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Sd(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+xd(e)+"px "+Dd(e,t)}function Cd(e){var t=e.baseline,n=xd(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*Od(e):"line-bottom"===t?.29*n-.5*Od(e):0)}gd(!0);var Fd={left:"start",center:"middle",right:"end"},Md=new gl;function $d(e){var t,n=e.x||0,i=e.y||0,r=e.radius||0;return r&&(t=(e.theta||0)-Ku,n+=r*Math.cos(t),i+=r*Math.sin(t)),Md.x1=n,Md.y1=i,Md}function Nd(e,t){var n,i=t.dx||0,r=(t.dy||0)+Cd(t),o=$d(t),a=o.x1,s=o.y1,u=t.angle||0;e("text-anchor",Fd[t.align]||"start"),u?(n=df(a,s)+" "+hf(u),(i||r)&&(n+=" "+df(i,r))):n=df(a+i,s+r),e("transform",n)}function Td(e,t,n){var i,r=pd.height(t),o=t.align,a=$d(t),s=a.x1,u=a.y1,c=t.dx||0,l=(t.dy||0)+Cd(t)-Math.round(.8*r),f=wd(t);if(Object(h["A"])(f)?(r+=Od(t)*(f.length-1),i=f.reduce((e,n)=>Math.max(e,pd.width(t,n)),0)):i=pd.width(t,f),"center"===o?c-=i/2:"right"===o&&(c-=i),e.set(c+=s,l+=u,c+i,l+r),t.angle&&!n)e.rotate(t.angle*Ju,s,u);else if(2===n)return e.rotatedPoints(t.angle*Ju,s,u);return e}function Rd(e,t,n){rf(t,(function(t){var i,r,o,a,s,u,c,l=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===l||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=Sd(t),e.textAlign=t.align||"left",i=$d(t),r=i.x1,o=i.y1,t.angle&&(e.save(),e.translate(r,o),e.rotate(t.angle*Ju),r=o=0),r+=t.dx||0,o+=(t.dy||0)+Cd(t),u=wd(t),Vl(e,t),Object(h["A"])(u))for(s=Od(t),a=0;a<u.length;++a)c=kd(t,u[a]),t.fill&&Ql(e,t,l)&&e.fillText(c,r,o),t.stroke&&ef(e,t,l)&&e.strokeText(c,r,o),o+=s;else c=kd(t,u),t.fill&&Ql(e,t,l)&&e.fillText(c,r,o),t.stroke&&ef(e,t,l)&&e.strokeText(c,r,o);t.angle&&e.restore()}}))}function zd(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=$d(t),s=a.x1,u=a.y1,c=Td(Md,t,1),l=-t.angle*Ju,f=Math.cos(l),d=Math.sin(l),h=f*r-d*o+(s-f*s+d*u),p=d*r+f*o+(u-d*s-f*u);return c.contains(h,p)}function Pd(e,t){var n=Td(Md,e,2);return Gl(t,n[0],n[1],n[2],n[3])||Gl(t,n[0],n[1],n[4],n[5])||Gl(t,n[4],n[5],n[6],n[7])||Gl(t,n[2],n[3],n[6],n[7])}var Ld={type:"text",tag:"text",nested:!1,attr:Nd,bound:Td,draw:Rd,pick:cf(zd),isect:Pd},Bd=_f("trail",fl,Of),Id={arc:bf,area:wf,group:Lf,image:Zf,line:Xf,path:ed,rect:rd,rule:ld,shape:fd,symbol:dd,text:Ld,trail:Bd},Ud=function(e,t,n){var i=Id[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new gl),e,n)},qd={mark:null},Wd=function(e,t,n){var i,r,o,a,s=Id[e.marktype],u=s.bound,c=e.items,l=c&&c.length;if(s.nested)return l?o=c[0]:(qd.mark=e,o=qd),a=Ud(o,u,n),t=t&&t.union(a)||a,t;if(t=t||e.bounds&&e.bounds.clear()||new gl,l)for(i=0,r=c.length;i<r;++i)t.union(Ud(c[i],u,n));return e.bounds=t},Hd=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Gd(e,t){return JSON.stringify(e,Hd,t)}function Vd(e){var t="string"===typeof e?JSON.parse(e):e;return Yd(t)}function Yd(e){var t,n,i,r=e.marktype,o=e.items;if(o)for(n=0,i=o.length;n<i;++n)t=r?"mark":"group",o[n][t]=e,o[n].zindex&&(o[n][t].zdirty=!0),"group"===(r||t)&&Yd(o[n]);return r&&Wd(e),e}function Zd(e){arguments.length?this.root=Vd(e):(this.root=Jd({marktype:"group",name:"root",role:"frame"}),this.root.items=[new bl(this.root)])}var Xd=Zd.prototype;function Jd(e,t){const n={bounds:new gl,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Qd(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Kd(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function eh(e,t,n,i){var r,o=e.childNodes[t];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(r=o||null,o=Qd(e.ownerDocument,n,i),e.insertBefore(o,r)),o}function th(e,t){var n=e.childNodes,i=n.length;while(i>t)e.removeChild(n[--i]);return e}function nh(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}Xd.toJSON=function(e){return Gd(this.root,e||0)},Xd.mark=function(e,t,n){t=t||this.root.items[0];var i=Jd(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i};var ih=function(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]},rh=function(e,t,n,i){var r,o,a=e&&e.mark;if(a&&(r=Id[a.marktype]).tip){o=ih(t,n),o[0]-=i[0],o[1]-=i[1];while(e=e.mark.group)o[0]-=e.x||0,o[1]-=e.y||0;e=r.tip(a.items,o)}return e};function oh(e,t){this._active=null,this._handlers={},this._loader=e||Kn(),this._tooltip=t||ah}function ah(e,t,n,i){e.element().setAttribute("title",i||"")}const sh=oh.prototype;function uh(e){this._el=null,this._bgcolor=null,this._loader=new Ol(e)}sh.initialize=function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},sh.element=function(){return this._el},sh.canvas=function(){return this._el&&this._el.firstChild},sh.origin=function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},sh.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},sh.on=function(){},sh.off=function(){},sh._handlerIndex=function(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},sh.handlers=function(e){const t=this._handlers,n=[];if(e)n.push.apply(n,t[this.eventName(e)]);else for(const i in t)n.push.apply(n,t[i]);return n},sh.eventName=function(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},sh.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then(t=>{const n=new MouseEvent(e.type,e),i=Qd(null,"a");for(const e in t)i.setAttribute(e,t[e]);i.dispatchEvent(n)}).catch((function(){}))},sh.handleTooltip=function(e,t,n){if(t&&null!=t.tooltip){t=rh(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},sh.getItemBoundingClientRect=function(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),a=r.height();let s=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;while(e.mark&&(e=e.mark.group))s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}};var ch=uh.prototype;ch.initialize=function(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},ch.element=function(){return this._el},ch.canvas=function(){return this._el&&this._el.firstChild},ch.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},ch.resize=function(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},ch.dirty=function(){},ch.render=function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},ch._render=function(){},ch.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},ch._load=function(e,t){var n=this,i=n._loader[e](t);if(!n._ready){var r=n._call;n._ready=n._loader.ready().then((function(e){e&&r(),n._ready=null}))}return i},ch.sanitizeURL=function(e){return this._load("sanitizeURL",e)},ch.loadImage=function(e){return this._load("loadImage",e)};const lh="keydown",fh="keypress",dh="keyup",hh="dragenter",ph="dragleave",gh="dragover",mh="mousedown",vh="mouseup",bh="mousemove",yh="mouseout",xh="mouseover",Oh="click",_h="dblclick",wh="wheel",jh="mousewheel",kh="touchstart",Eh="touchmove",Ah="touchend",Dh=[lh,fh,dh,hh,ph,gh,mh,vh,bh,yh,xh,Oh,_h,wh,jh,kh,Eh,Ah],Sh=bh,Ch=yh,Fh=Oh;function Mh(e,t){oh.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const $h=Object(h["y"])(Mh,oh);$h.initialize=function(e,t,n){return this._canvas=e&&Kd(e,"canvas"),[Oh,mh,bh,yh,ph].forEach(e=>Th(this,e)),oh.prototype.initialize.call(this,e,t,n)};const Nh=e=>e===kh||e===Eh||e===Ah?[kh,Eh,Ah]:[e];function Th(e,t){Nh(t).forEach(t=>Rh(e,t))}function Rh(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?n=>e[t](n):n=>e.fire(t,n)))}function zh(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r||(r&&r.exit||this.fire(n,i),this._active=o,this.fire(t,i)),this.fire(e,i)}}function Ph(e){return function(t){this.fire(e,t),this._active=null}}function Lh(){return"undefined"!==typeof window&&window.devicePixelRatio||1}$h.canvas=function(){return this._canvas},$h.context=function(){return this._canvas.getContext("2d")},$h.events=Dh,$h.DOMMouseScroll=function(e){this.fire(jh,e)},$h.mousemove=zh(bh,xh,yh),$h.dragover=zh(gh,hh,ph),$h.mouseout=Ph(yh),$h.dragleave=Ph(ph),$h.mousedown=function(e){this._down=this._active,this.fire(mh,e)},$h.click=function(e){this._down===this._active&&(this.fire(Oh,e),this._down=null)},$h.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(kh,e,!0)},$h.touchmove=function(e){this.fire(Eh,e,!0)},$h.touchend=function(e){this.fire(Ah,e,!0),this._touch=null},$h.fire=function(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===Fh&&i&&i.href?this.handleHref(t,i,i.href):e!==Sh&&e!==Ch||this.handleTooltip(t,i,e!==Ch),r)for(let o=0,a=r.length;o<a;++o)r[o].handler.call(this._obj,t,i)},$h.on=function(e,t){const n=this.eventName(e),i=this._handlers,r=this._handlerIndex(i[n],e,t);return r<0&&(Th(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},$h.off=function(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},$h.pickEvent=function(e){const t=ih(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},$h.pick=function(e,t,n,i,r){const o=this.context(),a=Id[e.marktype];return a.pick.call(this,o,e,t,n,i,r)};var Bh=Lh(),Ih=function(e,t,n,i,r,o){const a="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),u=a?Bh:r;e.width=t*u,e.height=n*u;for(const c in o)s[c]=o[c];return a&&1!==u&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*i[0],u*i[1]),e};function Uh(e){uh.call(this,e),this._options={},this._redraw=!1,this._dirty=new gl,this._tempb=new gl}const qh=Object(h["y"])(Uh,uh),Wh=uh.prototype;function Hh(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}qh.initialize=function(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:yl(1,1,this._options.type),e&&this._canvas&&(th(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Wh.initialize.call(this,e,t,n,i,r)},qh.resize=function(e,t,n,i){if(Wh.resize.call(this,e,t,n,i),this._canvas)Ih(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const e=this._options.externalContext;e||Object(h["n"])("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},qh.canvas=function(){return this._canvas},qh.context=function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},qh.dirty=function(e){let t=this._tempb.clear().union(e.bounds),n=e.mark.group;while(n)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)};const Gh=(e,t,n)=>(new gl).set(0,0,t,n).translate(-e[0],-e[1]);function Vh(e,t){oh.call(this,e,t);const n=this;n._hrefHandler=Zh(n,(e,t)=>{t&&t.href&&n.handleHref(e,t,t.href)}),n._tooltipHandler=Zh(n,(e,t)=>{n.handleTooltip(e,t,e.type!==Ch)})}qh._render=function(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,a=Gh(n,i,r);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):Hh(t,a.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,s),t.restore(),o.clear(),this},qh.draw=function(e,t,n){const i=Id[t.marktype];t.clip&&jf(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},qh.clear=function(e,t,n,i){const r=this._options,o=this.context();"pdf"===r.type||r.externalContext||o.clearRect(e,t,n,i),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))};const Yh=Object(h["y"])(Vh,oh);Yh.initialize=function(e,t,n){let i=this._svg;return i&&(i.removeEventListener(Fh,this._hrefHandler),i.removeEventListener(Sh,this._tooltipHandler),i.removeEventListener(Ch,this._tooltipHandler)),this._svg=i=e&&Kd(e,"svg"),i&&(i.addEventListener(Fh,this._hrefHandler),i.addEventListener(Sh,this._tooltipHandler),i.addEventListener(Ch,this._tooltipHandler)),oh.prototype.initialize.call(this,e,t,n)},Yh.canvas=function(){return this._svg};const Zh=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};Yh.on=function(e,t){const n=this.eventName(e),i=this._handlers,r=this._handlerIndex(i[n],e,t);if(r<0){const r={type:e,handler:t,listener:Zh(this,t)};(i[n]||(i[n]=[])).push(r),this._svg&&this._svg.addEventListener(n,r.listener)}return this},Yh.off=function(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this};var Xh=function(e,t,n){var i=e-t+2*n;return e?i>0?i:1:0};const Jh="identity",Qh="linear",Kh="log",ep="pow",tp="sqrt",np="symlog",ip="time",rp="utc",op="sequential",ap="diverging",sp="quantile",up="quantize",cp="threshold",lp="ordinal",fp="point",dp="band",hp="bin-ordinal",pp="continuous",gp="discrete",mp="discretizing",vp="interpolating",bp="temporal";var yp=function(e){return function(t){var n,i=t[0],r=t[1];return r<i&&(n=i,i=r,r=n),[e.invert(i),e.invert(r)]}},xp=function(e){return function(t){var n,i,r,o,a=e.range(),s=t[0],u=t[1],c=-1;for(u<s&&(i=s,s=u,u=i),r=0,o=a.length;r<o;++r)a[r]>=s&&a[r]<=u&&(c<0&&(c=r),n=r);if(!(c<0))return s=e.invertExtent(a[c]),u=e.invertExtent(a[n]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}},Op=xn(yn),_p=Op.right,wp=Op.left,jp=_p;function kp(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ep(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t);break}return this}const Ap=Symbol("implicit");function Dp(){var e=new Map,t=[],n=[],i=Ap;function r(r){var o=r+"",a=e.get(o);if(!a){if(i!==Ap)return i;e.set(o,a=t.push(r))}return n[(a-1)%n.length]}return r.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;for(const i of n){const n=i+"";e.has(n)||e.set(n,t.push(i))}return r},r.range=function(e){return arguments.length?(n=Array.from(e),r):n.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return Dp(t,n).unknown(i)},kp.apply(r,arguments),r}function Sp(){var e,t,n=Dp().unknown(void 0),i=n.domain,r=n.range,o=[0,1],a=!1,s=0,u=0,c=.5;function l(){var n=i().length,l=o[1]<o[0],f=o[l-0],d=o[1-l],h=Xh(n,s,u);e=(d-f)/(h||1),a&&(e=Math.floor(e)),f+=(d-f-e*(n-s))*c,t=e*(1-s),a&&(f=Math.round(f),t=Math.round(t));var p=ls(n).map((function(t){return f+e*t}));return r(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(i(e),l()):i()},n.range=function(e){return arguments.length?(o=[+e[0],+e[1]],l()):o.slice()},n.rangeRound=function(e){return o=[+e[0],+e[1]],a=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(a=!!e,l()):a},n.padding=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),s=u,l()):s},n.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.paddingOuter=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,a,s,u=+e[0],c=+e[1],l=o[1]<o[0],f=l?r().reverse():r(),d=f.length-1;if(u===u&&c===c&&(c<u&&(s=u,u=c,c=s),!(c<f[0]||u>o[1-l])))return n=Math.max(0,_p(f,u)-1),a=u===c?n:_p(f,c)-1,u-f[n]>t+1e-10&&++n,l&&(s=n,n=d-a,a=d-s),n>a?void 0:i().slice(n,a+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return Sp().domain(i()).range(o).round(a).paddingInner(s).paddingOuter(u).align(c)},l()}function Cp(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Cp(t())},e}function Fp(){return Cp(Sp().paddingInner(1))}var Mp=function(e,t,n,i){var r,o=Ze(e,t,n);switch(i=Object(Xe["a"])(null==i?",f":i),i.type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(r=Object(Je["a"])(o,a))||(i.precision=r),Object(et["b"])(i,a);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=Object(Qe["a"])(o,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=Object(Ke["a"])(o))||(i.precision=r-2*("%"===i.type));break}return Object(et["a"])(i)},$p=Array.prototype.map;function Np(e){return $p.call(e,(function(e){return+e}))}var Tp=Array.prototype.slice;function Rp(){var e=[],t=[];function n(n){return null==n||n!==n?void 0:t[(jp(e,n)-1)%t.length]}return n.domain=function(t){return arguments.length?(e=Np(t),n):e.slice()},n.range=function(e){return arguments.length?(t=Tp.call(e),n):t.slice()},n.tickFormat=function(t,n){return Mp(e[0],Object(h["U"])(e),null==t?10:t,n)},n.copy=function(){return Rp().domain(n.domain()).range(n.range())},n}var zp=n("ea1d"),Pp=n("e317"),Lp=n("5857"),Bp=function(e){return function(){return e}},Ip=function(e){return+e},Up=[0,1];function qp(e){return e}function Wp(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Bp(isNaN(t)?NaN:.5)}function Hp(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}function Gp(e,t,n){var i=e[0],r=e[1],o=t[0],a=t[1];return r<i?(i=Wp(r,i),o=n(a,o)):(i=Wp(i,r),o=n(o,a)),function(e){return o(i(e))}}function Vp(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++a<i)r[a]=Wp(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=jp(e,t,1,i)-1;return o[n](r[n](t))}}function Yp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Zp(){var e,t,n,i,r,o,a=Up,s=Up,u=zp["a"],c=qp;function l(){var e=Math.min(a.length,s.length);return c!==qp&&(c=Hp(a[0],a[e-1])),i=e>2?Vp:Gp,r=o=null,f}function f(t){return isNaN(t=+t)?n:(r||(r=i(a.map(e),s,u)))(e(c(t)))}return f.invert=function(n){return c(t((o||(o=i(s,a.map(e),Pp["a"])))(n)))},f.domain=function(e){return arguments.length?(a=Array.from(e,Ip),l()):a.slice()},f.range=function(e){return arguments.length?(s=Array.from(e),l()):s.slice()},f.rangeRound=function(e){return s=Array.from(e),u=Lp["a"],l()},f.clamp=function(e){return arguments.length?(c=!!e||qp,l()):c!==qp},f.interpolate=function(e){return arguments.length?(u=e,l()):u},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,i){return e=n,t=i,l()}}function Xp(){return Zp()(qp,qp)}function Jp(e){var t=e.domain;return e.ticks=function(e){var n=t();return Ve(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var i=t();return Mp(i[0],i[i.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,r=t(),o=0,a=r.length-1,s=r[o],u=r[a];return u<s&&(i=s,s=u,u=i,i=o,o=a,a=i),i=Ye(s,u,n),i>0?(s=Math.floor(s/i)*i,u=Math.ceil(u/i)*i,i=Ye(s,u,n)):i<0&&(s=Math.ceil(s*i)/i,u=Math.floor(u*i)/i,i=Ye(s,u,n)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(u/i)*i,t(r)):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(u*i)/i,t(r)),e},e}function Qp(){var e=Xp();return e.copy=function(){return Yp(e,Qp())},kp.apply(e,arguments),Jp(e)}function Kp(e){var t;function n(e){return isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,Ip),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Kp(e).unknown(t)},e=arguments.length?Array.from(e,Ip):[0,1],Jp(n)}var eg=function(e,t){e=e.slice();var n,i=0,r=e.length-1,o=e[i],a=e[r];return a<o&&(n=i,i=r,r=n,n=o,o=a,a=n),e[i]=t.floor(o),e[r]=t.ceil(a),e};function tg(e){return Math.log(e)}function ng(e){return Math.exp(e)}function ig(e){return-Math.log(-e)}function rg(e){return-Math.exp(-e)}function og(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ag(e){return 10===e?og:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function sg(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function ug(e){return function(t){return-e(-t)}}function cg(e){var t,n,i=e(tg,ng),r=i.domain,o=10;function a(){return t=sg(o),n=ag(o),r()[0]<0?(t=ug(t),n=ug(n),e(ig,rg)):e(tg,ng),i}return i.base=function(e){return arguments.length?(o=+e,a()):o},i.domain=function(e){return arguments.length?(r(e),a()):r()},i.ticks=function(e){var i,a=r(),s=a[0],u=a[a.length-1];(i=u<s)&&(d=s,s=u,u=d);var c,l,f,d=t(s),h=t(u),p=null==e?10:+e,g=[];if(!(o%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),s>0){for(;d<=h;++d)for(l=1,c=n(d);l<o;++l)if(f=c*l,!(f<s)){if(f>u)break;g.push(f)}}else for(;d<=h;++d)for(l=o-1,c=n(d);l>=1;--l)if(f=c*l,!(f<s)){if(f>u)break;g.push(f)}2*g.length<p&&(g=Ve(s,u,p))}else g=Ve(d,h,Math.min(h-d,p)).map(n);return i?g.reverse():g},i.tickFormat=function(e,r){if(null==r&&(r=10===o?".0e":","),"function"!==typeof r&&(r=Object(et["a"])(r)),e===1/0)return r;null==e&&(e=10);var a=Math.max(1,o*e/i.ticks().length);return function(e){var i=e/n(Math.round(t(e)));return i*o<o-.5&&(i*=o),i<=a?r(e):""}},i.nice=function(){return r(eg(r(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},i}function lg(){var e=cg(Zp()).domain([1,10]);return e.copy=function(){return Yp(e,lg()).base(e.base())},kp.apply(e,arguments),e}function fg(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function dg(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function hg(e){return e<0?-e*e:e*e}function pg(e){var t=e(qp,qp),n=1;function i(){return 1===n?e(qp,qp):.5===n?e(dg,hg):e(fg(n),fg(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,i()):n},Jp(t)}function gg(){var e=pg(Zp());return e.copy=function(){return Yp(e,gg()).exponent(e.exponent())},kp.apply(e,arguments),e}function mg(){return gg.apply(null,arguments).exponent(.5)}function vg(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function bg(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function yg(e){var t=1,n=e(vg(t),bg(t));return n.constant=function(n){return arguments.length?e(vg(t=+n),bg(t)):t},Jp(n)}function xg(){var e=yg(Zp());return e.copy=function(){return Yp(e,xg()).constant(e.constant())},kp.apply(e,arguments)}var Og=1e3,_g=60*Og,wg=60*_g,jg=24*wg,kg=7*jg,Eg=30*jg,Ag=365*jg;function Dg(e){return new Date(e)}function Sg(e){return e instanceof Date?+e:+new Date(+e)}function Cg(e,t,n,i,r,o,a,s,u){var c=Xp(),l=c.invert,f=c.domain,d=u(".%L"),h=u(":%S"),p=u("%I:%M"),g=u("%I %p"),m=u("%a %d"),v=u("%b %d"),b=u("%B"),y=u("%Y"),x=[[a,1,Og],[a,5,5*Og],[a,15,15*Og],[a,30,30*Og],[o,1,_g],[o,5,5*_g],[o,15,15*_g],[o,30,30*_g],[r,1,wg],[r,3,3*wg],[r,6,6*wg],[r,12,12*wg],[i,1,jg],[i,2,2*jg],[n,1,kg],[t,1,Eg],[t,3,3*Eg],[e,1,Ag]];function O(s){return(a(s)<s?d:o(s)<s?h:r(s)<s?p:i(s)<s?g:t(s)<s?n(s)<s?m:v:e(s)<s?b:y)(s)}function _(t,n,i){if(null==t&&(t=10),"number"===typeof t){var r,o=Math.abs(i-n)/t,a=xn((function(e){return e[2]})).right(x,o);return a===x.length?(r=Ze(n/Ag,i/Ag,t),t=e):a?(a=x[o/x[a-1][2]<x[a][2]/o?a-1:a],r=a[1],t=a[0]):(r=Math.max(Ze(n,i,t),1),t=s),t.every(r)}return t}return c.invert=function(e){return new Date(l(e))},c.domain=function(e){return arguments.length?f(Array.from(e,Sg)):f().map(Dg)},c.ticks=function(e){var t,n=f(),i=n[0],r=n[n.length-1],o=r<i;return o&&(t=i,i=r,r=t),t=_(e,i,r),t=t?t.range(i,r+1):[],o?t.reverse():t},c.tickFormat=function(e,t){return null==t?O:u(t)},c.nice=function(e){var t=f();return(e=_(e,t[0],t[t.length-1]))?f(eg(t,e)):c},c.copy=function(){return Yp(c,Cg(e,t,n,i,r,o,a,s,u))},c}var Fg=function(){return kp.apply(Cg(Qt["a"],Kt["a"],Et["b"],kt["a"],en["a"],tn["a"],nn["a"],rn["a"],Ln["a"]).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Mg=function(){return kp.apply(Cg(on["a"],an["a"],Dt["b"],At["a"],sn["a"],un["a"],nn["a"],rn["a"],Ln["c"]).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function $g(){var e,t,n,i,r,o=0,a=1,s=qp,u=!1;function c(t){return isNaN(t=+t)?r:s(0===n?.5:(t=(i(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,i;return arguments.length?([n,i]=t,s=e(n,i),c):[s(0),s(1)]}}return c.domain=function(r){return arguments.length?([o,a]=r,e=i(o=+o),t=i(a=+a),n=e===t?0:1/(t-e),c):[o,a]},c.clamp=function(e){return arguments.length?(u=!!e,c):u},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=l(zp["a"]),c.rangeRound=l(Lp["a"]),c.unknown=function(e){return arguments.length?(r=e,c):r},function(r){return i=r,e=r(o),t=r(a),n=e===t?0:1/(t-e),c}}function Ng(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Tg(){var e=Jp($g()(qp));return e.copy=function(){return Ng(e,Tg())},Ep.apply(e,arguments)}function Rg(){var e=cg($g()).domain([1,10]);return e.copy=function(){return Ng(e,Rg()).base(e.base())},Ep.apply(e,arguments)}function zg(){var e=yg($g());return e.copy=function(){return Ng(e,zg()).constant(e.constant())},Ep.apply(e,arguments)}function Pg(){var e=pg($g());return e.copy=function(){return Ng(e,Pg()).exponent(e.exponent())},Ep.apply(e,arguments)}function Lg(){return Pg.apply(null,arguments).exponent(.5)}var Bg=n("ac0c");function Ig(){var e,t,n,i,r,o,a,s=0,u=.5,c=1,l=1,f=qp,d=!1;function h(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(l*e<l*t?i:r),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,i,r;return arguments.length?([n,i,r]=t,f=Object(Bg["a"])(e,[n,i,r]),h):[f(0),f(.5),f(1)]}}return h.domain=function(a){return arguments.length?([s,u,c]=a,e=o(s=+s),t=o(u=+u),n=o(c=+c),i=e===t?0:.5/(t-e),r=t===n?0:.5/(n-t),l=t<e?-1:1,h):[s,u,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(zp["a"]),h.rangeRound=p(Lp["a"]),h.unknown=function(e){return arguments.length?(a=e,h):a},function(a){return o=a,e=a(s),t=a(u),n=a(c),i=e===t?0:.5/(t-e),r=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function Ug(){var e=Jp(Ig()(qp));return e.copy=function(){return Ng(e,Ug())},Ep.apply(e,arguments)}function qg(){var e=cg(Ig()).domain([.1,1,10]);return e.copy=function(){return Ng(e,qg()).base(e.base())},Ep.apply(e,arguments)}function Wg(){var e=yg(Ig());return e.copy=function(){return Ng(e,Wg()).constant(e.constant())},Ep.apply(e,arguments)}function Hg(){var e=pg(Ig());return e.copy=function(){return Ng(e,Hg()).exponent(e.exponent())},Ep.apply(e,arguments)}function Gg(){return Hg.apply(null,arguments).exponent(.5)}function Vg(){var e,t=[],n=[],i=[];function r(){var e=0,r=Math.max(1,n.length);i=new Array(r-1);while(++e<r)i[e-1]=_r(t,e/r);return o}function o(t){return isNaN(t=+t)?e:n[jp(i,t)]}return o.invertExtent=function(e){var r=n.indexOf(e);return r<0?[NaN,NaN]:[r>0?i[r-1]:t[0],r<i.length?i[r]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(yn),r()},o.range=function(e){return arguments.length?(n=Array.from(e),r()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return i.slice()},o.copy=function(){return Vg().domain(t).range(n).unknown(e)},kp.apply(o,arguments)}function Yg(){var e,t=0,n=1,i=1,r=[.5],o=[0,1];function a(t){return t<=t?o[jp(r,t,0,i)]:e}function s(){var e=-1;r=new Array(i);while(++e<i)r[e]=((e+1)*n-(e-i)*t)/(i+1);return a}return a.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},a.range=function(e){return arguments.length?(i=(o=Array.from(e)).length-1,s()):o.slice()},a.invertExtent=function(e){var a=o.indexOf(e);return a<0?[NaN,NaN]:a<1?[t,r[0]]:a>=i?[r[i-1],n]:[r[a-1],r[a]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return r.slice()},a.copy=function(){return Yg().domain([t,n]).range(o).unknown(e)},kp.apply(Jp(a),arguments)}function Zg(){var e,t=[.5],n=[0,1],i=1;function r(r){return r<=r?n[jp(t,r,0,i)]:e}return r.domain=function(e){return arguments.length?(t=Array.from(e),i=Math.min(t.length,n.length-1),r):t.slice()},r.range=function(e){return arguments.length?(n=Array.from(e),i=Math.min(t.length,n.length-1),r):n.slice()},r.invertExtent=function(e){var i=n.indexOf(e);return[t[i-1],t[i]]},r.unknown=function(t){return arguments.length?(e=t,r):e},r.copy=function(){return Zg().domain(t).range(n).unknown(e)},kp.apply(r,arguments)}const Xg={};function Jg(e,t,n){const i=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?yp(n):n.invertExtent?xp(n):void 0),n.type=e,n};return i.metadata=Object(h["db"])(Object(h["i"])(n)),i}function Qg(e,t,n){return arguments.length>1?(Xg[e]=Jg(e,t,n),this):Kg(e)?Xg[e]:void 0}function Kg(e){return Object(h["v"])(Xg,e)}function em(e,t){const n=Xg[e];return n&&n.metadata[t]}function tm(e){return em(e,pp)}function nm(e){return em(e,gp)}function im(e){return em(e,mp)}function rm(e){return em(e,Kh)}function om(e){return em(e,bp)}function am(e){return em(e,vp)}function sm(e){return em(e,sp)}Qg(Jh,Kp),Qg(Qh,Qp,pp),Qg(Kh,lg,[pp,Kh]),Qg(ep,gg,pp),Qg(tp,mg,pp),Qg(np,xg,pp),Qg(ip,Fg,[pp,bp]),Qg(rp,Mg,[pp,bp]),Qg(op,Tg,[pp,vp]),Qg(`${op}-${Qh}`,Tg,[pp,vp]),Qg(`${op}-${Kh}`,Rg,[pp,vp,Kh]),Qg(`${op}-${ep}`,Pg,[pp,vp]),Qg(`${op}-${tp}`,Lg,[pp,vp]),Qg(`${op}-${np}`,zg,[pp,vp]),Qg(`${ap}-${Qh}`,Ug,[pp,vp]),Qg(`${ap}-${Kh}`,qg,[pp,vp,Kh]),Qg(`${ap}-${ep}`,Hg,[pp,vp]),Qg(`${ap}-${tp}`,Gg,[pp,vp]),Qg(`${ap}-${np}`,Wg,[pp,vp]),Qg(sp,Vg,[mp,sp]),Qg(up,Yg,mp),Qg(cp,Zg,mp),Qg(hp,Rp,[gp,mp]),Qg(lp,Dp,gp),Qg(dp,Sp,gp),Qg(fp,Fp,gp);var um=n("a43d");const cm=["clamp","base","constant","exponent"];function lm(e,t){var n=t[0],i=Object(h["U"])(t)-n;return function(t){return e(n+t*i)}}function fm(e,t,n){return Bg["a"](pm(t||"rgb",n),e)}function dm(e,t){for(var n=new Array(t),i=t+1,r=0;r<t;)n[r]=e(++r/i);return n}function hm(e,t,n){var i,r,o,a=n-t;return a&&Number.isFinite(a)?(i=(r=e.type).indexOf("-"),r=i<0?r:r.slice(i+1),o=Qg(r)().domain([t,n]).range([0,1]),cm.forEach(t=>e[t]?o[t](e[t]()):0),o):Object(h["l"])(.5)}function pm(e,t){var n=um[gm(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function gm(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}const mm={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},vm={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function bm(e){var t=e.length/6|0,n=new Array(t),i=0;while(i<t)n[i]="#"+e.slice(6*i,6*++i);return n}function ym(e,t){for(let n in e)Om(n,t(e[n]))}const xm={};function Om(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(xm[e]=t,this):xm[e]}ym(vm,bm),ym(mm,e=>fm(bm(e)));var _m="symbol",wm="discrete",jm="gradient";const km=e=>Object(h["A"])(e)?e.map(e=>String(e)):String(e),Em=(e,t)=>e[1]-t[1],Am=(e,t)=>t[1]-e[1];function Dm(e,t,n){var i;return Object(h["E"])(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Object(h["X"])(e.domain())/n||1)))),Object(h["F"])(t)&&(i=t.step,t=t.interval),Object(h["H"])(t)&&(t=e.type===ip?fn(t):e.type==rp?dn(t):Object(h["n"])("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function Sm(e,t,n){let i=e.range(),r=i[0],o=Object(h["U"])(i),a=Em;if(r>o&&(i=o,o=r,r=i,a=Am),r=Math.floor(r),o=Math.ceil(o),t=t.map(t=>[t,e(t)]).filter(e=>r<=e[1]&&e[1]<=o).sort(a).map(e=>e[0]),n>0&&t.length>1){const e=[t[0],Object(h["U"])(t)];while(t.length>n&&t.length>=3)t=t.filter((e,t)=>!(t%2));t.length<3&&(t=e)}return t}function Cm(e,t){return e.bins?Sm(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Fm(e,t,n,i,r,o){var a=t.type;let s=km;if(a===ip||r===ip)s=e.timeFormat(i);else if(a===rp||r===rp)s=e.utcFormat(i);else if(rm(a)){const r=e.formatFloat(i);if(o||t.bins)s=r;else{const e=Mm(t,n,!1);s=t=>e(t)?r(t):""}}else if(t.tickFormat){const r=t.domain();s=e.formatSpan(r[0],r[r.length-1],n,i)}else i&&(s=e.format(i));return s}function Mm(e,t,n){const i=Cm(e,t),r=e.base(),o=Math.log(r),a=Math.max(1,r*t/i.length),s=e=>{let t=e/Math.pow(r,Math.round(Math.log(e)/o));return t*r<r-.5&&(t*=r),t<=a};return n?i.filter(s):s}const $m={[sp]:"quantiles",[up]:"thresholds",[cp]:"domain"},Nm={[sp]:"quantiles",[up]:"domain"};function Tm(e,t){return e.bins?Pm(e.bins):e.type===Kh?Mm(e,t,!0):$m[e.type]?zm(e[$m[e.type]]()):Cm(e,t)}function Rm(e,t,n){var i,r=t[Nm[t.type]](),o=r.length,a=o>1?r[1]-r[0]:r[0];for(i=1;i<o;++i)a=Math.min(a,r[i]-r[i-1]);return e.formatSpan(0,a,30,n)}function zm(e){const t=[-1/0].concat(e);return t.max=1/0,t}function Pm(e){const t=e.slice(0,-1);return t.max=Object(h["U"])(e),t}function Lm(e){return $m[e.type]||e.bins}function Bm(e,t,n,i,r,o,a){const s=Nm[t.type]&&o!==ip&&o!==rp?Rm(e,t,r):Fm(e,t,n,r,o,a);return i===_m&&Lm(t)?Im(s):i===wm?qm(s):Wm(s)}function Im(e){return(t,n,i)=>{var r=Um(i[n+1],Um(i.max,1/0)),o=Hm(t,e),a=Hm(r,e);return o&&a?o+"  "+a:a?"< "+a:" "+o}}function Um(e,t){return null!=e?e:t}function qm(e){return(t,n)=>n?e(t):null}function Wm(e){return t=>e(t)}function Hm(e,t){return Number.isFinite(e)?t(e):null}function Gm(e){var t=e.domain(),n=t.length-1,i=+t[0],r=+Object(h["U"])(t),o=r-i;if(e.type===cp){const e=n?o/n:.1;i-=e,r+=e,o=r-i}return e=>(e-i)/o}function Vm(e,t,n,i){const r=i||t.type;return Object(h["H"])(n)&&om(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||r!==ip?n||r!==rp?Bm(e,t,5,null,n,i,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function Ym(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=Vm(e,t,n.format,n.formatType);if(im(t.type)){const e=Tm(t).slice(1).map(r),n=e.length;return`${n} boundar${1===n?"y":"ies"}: ${e.join(", ")}`}if(nm(t.type)){const e=t.domain(),n=e.length,o=n>i?e.slice(0,i-2).map(r).join(", ")+", ending with "+e.slice(-1).map(r):e.map(r).join(", ");return`${n} value${1===n?"":"s"}: ${o}`}{const e=t.domain();return`values from ${r(e[0])} to ${r(Object(h["U"])(e))}`}}const Zm="aria-hidden",Xm="aria-label",Jm="role",Qm="aria-roledescription",Km="graphics-object",ev="graphics-symbol",tv=(e,t,n)=>({[Jm]:e,[Qm]:t,[Xm]:n||void 0}),nv=Object(h["db"])(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),iv={axis:{desc:"axis",caption:lv},legend:{desc:"legend",caption:fv},"title-text":{desc:"title",caption:e=>`Title text '${cv(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${cv(e)}'`}},rv={ariaRole:Jm,ariaRoleDescription:Qm,description:Xm};function ov(e,t){const n=!1===t.aria;if(e(Zm,n||void 0),n||null==t.description)for(const i in rv)e(rv[i],void 0);else{const n=t.mark.marktype;e(Xm,t.description),e(Jm,t.ariaRole||("group"===n?Km:ev)),e(Qm,t.ariaRoleDescription||n+" mark")}}function av(e){return!1===e.aria?{[Zm]:!0}:nv[e.role]?null:iv[e.role]?uv(e,iv[e.role]):sv(e)}function sv(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(e=>null!=e.description&&!1!==e.aria);return tv(n?Km:ev,t+" mark container",e.description)}function uv(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return tv(t.role||ev,t.desc,n.description||i(n))}catch(n){return null}}function cv(e){return Object(h["i"])(e.text).join(" ")}function lv(e){const t=e.datum,n=e.orient,i=t.title?dv(e):null,r=e.context,o=r.scales[t.scale].value,a=r.dataflow.locale(),s=o.type,u="left"===n||"right"===n?"Y":"X";return u+"-axis"+(i?` titled '${i}'`:"")+` for a ${nm(s)?"discrete":s} scale with `+Ym(a,o,e)}function fv(e){const t=e.datum,n=t.title?dv(e):null,i=((t.type||"")+" legend").trim(),r=t.scales,o=Object.keys(r),a=e.context,s=a.scales[r[o[0]]].value,u=a.dataflow.locale();return pv(i)+(n?` titled '${n}'`:"")+" for "+hv(o)+" with "+Ym(u,s,e)}function dv(e){try{return Object(h["i"])(Object(h["U"])(e.items).items[0].text).join(" ")}catch(t){return null}}function hv(e){return e=e.map(e=>e+("fill"===e||"stroke"===e?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Object(h["U"])(e)}function pv(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const gv=e=>(e+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;");function mv(e,t,n){var i,r,o="<"+e;if(t)for(i in t)r=t[i],null!=r&&(o+=" "+i+'="'+gv(r)+'"');return n&&(o+=" "+n),o+">"}function vv(e){return"</"+e+">"}const bv={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},yv={fill:"none","stroke-miterlimit":10},xv=0,Ov=Bf.xmlns;function _v(e){uh.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var wv=Object(h["y"])(_v,uh),jv=uh.prototype;function kv(e,t,n){var i,r,o;if("radial"===t.gradient){var a=eh(e,n++,"pattern",Ov);a.setAttribute("id",Eu+t.id),a.setAttribute("viewBox","0,0,1,1"),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("preserveAspectRatio","xMidYMid slice"),a=eh(a,0,"rect",Ov),a.setAttribute("width","1"),a.setAttribute("height","1"),a.setAttribute("fill","url("+Pv()+"#"+t.id+")"),e=eh(e,n++,"radialGradient",Ov),e.setAttribute("id",t.id),e.setAttribute("fx",t.x1),e.setAttribute("fy",t.y1),e.setAttribute("fr",t.r1),e.setAttribute("cx",t.x2),e.setAttribute("cy",t.y2),e.setAttribute("r",t.r2)}else e=eh(e,n++,"linearGradient",Ov),e.setAttribute("id",t.id),e.setAttribute("x1",t.x1),e.setAttribute("x2",t.x2),e.setAttribute("y1",t.y1),e.setAttribute("y2",t.y2);for(i=0,r=t.stops.length;i<r;++i)o=eh(e,i,"stop",Ov),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return th(e,i),n}function Ev(e,t,n){var i;return e=eh(e,n,"clipPath",Ov),e.setAttribute("id",t.id),t.path?(i=eh(e,0,"path",Ov),i.setAttribute("d",t.path)):(i=eh(e,0,"rect",Ov),i.setAttribute("x",0),i.setAttribute("y",0),i.setAttribute("width",t.width),i.setAttribute("height",t.height)),th(e,1),n+1}function Av(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function Dv(e,t,n){t=t.lastChild.previousSibling;let i,r=0;rf(n,n=>{i=e.draw(t,n,i),++r}),th(t,1+r)}function Sv(e,t,n,i,r){let o,a=e._svg;if(!a&&(o=t.ownerDocument,a=Qd(o,i,Ov),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},"g"===i))){const t=Qd(o,"path",Ov);a.appendChild(t),t.__data__=e;const n=Qd(o,"g",Ov);a.appendChild(n),n.__data__=e;const i=Qd(o,"path",Ov);a.appendChild(i),i.__data__=e,i.__values__={fill:"default"}}return(a.ownerSVGElement!==r||Cv(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function Cv(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}wv.initialize=function(e,t,n,i){if(this._defs={gradient:{},clipping:{}},e){this._svg=eh(e,0,"svg",Ov),this._svg.setAttribute("class","marks"),th(e,1),this._root=eh(this._svg,xv,"g",Ov);for(const e in yv)this._root.setAttribute(e,yv[e]);th(this._svg,xv+1)}return this.background(this._bgcolor),jv.initialize.call(this,e,t,n,i)},wv.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),jv.background.apply(this,arguments)},wv.resize=function(e,t,n,i){return jv.resize.call(this,e,t,n,i),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},wv.canvas=function(){return this._svg},wv.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in Bf)e[t]=Bf[t];var n=this._bgcolor?mv("rect",{width:this._width,height:this._height,fill:this._bgcolor})+vv("rect"):"";return mv("svg",e)+(this._defs.el?this._defs.el.outerHTML:"")+n+this._root.outerHTML+vv("svg")},wv._render=function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),th(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},wv.updateDefs=function(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=eh(e,xv,"defs",Ov)),i=kv(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=eh(e,xv,"defs",Ov)),i=Ev(n,t.clipping[r],i);n&&(0===i?(e.removeChild(n),t.el=null):th(n,i))},wv._resetDefs=function(){var e=this._defs;e.gradient={},e.clipping={}},wv.dirty=function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},wv.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},wv._dirtyCheck=function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,i,r,o,a,s,u=++this._dirtyID;for(o=0,a=e.length;o<a;++o)t=e[o],n=t.mark,n.marktype!==i&&(i=n.marktype,r=Id[i]),n.zdirty&&n.dirty!==u&&(this._dirtyAll=!1,Av(t,u),n.items.forEach((function(e){e.dirty=u}))),n.zdirty||(t.exit?(r.nested&&n.items.length?(s=n.items[0],s._svg&&this._update(r,s._svg,s)):t._svg&&(s=t._svg.parentNode,s&&s.removeChild(t._svg)),t._svg=null):(t=r.nested?n.items[0]:t,t._update!==u&&(t._svg&&t._svg.ownerSVGElement?this._update(r,t._svg,t):(this._dirtyAll=!1,Av(t,u)),t._update=u)));return!this._dirtyAll},wv.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var i,r=this._svg,o=Id[t.marktype],a=!1===t.interactive?"none":null,s="g"===o.tag,u=null,c=0;i=Sv(t,e,n,"g",r),i.setAttribute("class",nh(t));const l=av(t);for(const d in l)Rv(i,d,l[d]);s||Rv(i,"pointer-events",a),Rv(i,"clip-path",t.clip?pl(this,t,t.group):null);const f=e=>{const t=this.isDirty(e),n=Sv(e,i,u,o.tag,r);t&&(this._update(o,n,e),s&&Dv(this,n,e)),u=n,++c};return o.nested?t.items.length&&f(t.items[0]):rf(t,f),th(i,c),i};var Fv=null,Mv=null,$v={group:function(e,t,n){const i=Fv=t.childNodes[2];Mv=i.__values__,e.foreground(Tv,n,this),Mv=t.__values__,Fv=t.childNodes[1],e.content(Tv,n,this);const r=Fv=t.childNodes[0];e.background(Tv,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==Mv.events&&(Rv(i,"pointer-events",o),Rv(r,"pointer-events",o),Mv.events=o),n.strokeForeground&&n.stroke){const e=n.fill;Rv(i,"display",null),this.style(r,n),Rv(r,"stroke",null),e&&(n.fill=null),Mv=i.__values__,this.style(i,n),e&&(n.fill=e),Fv=null}else Rv(i,"display","none")},image:function(e,t,n){!1===n.smooth?(Nv(t,"image-rendering","optimizeSpeed"),Nv(t,"image-rendering","pixelated")):Nv(t,"image-rendering",null)},text:function(e,t,n){let i,r,o,a,s=wd(n);Object(h["A"])(s)?(r=s.map(e=>kd(n,e)),i=r.join("\n"),i!==Mv.text&&(th(t,0),o=t.ownerDocument,a=Od(n),r.forEach((e,i)=>{const r=Qd(o,"tspan",Ov);r.__data__=n,r.textContent=e,i&&(r.setAttribute("x",0),r.setAttribute("dy",a)),t.appendChild(r)}),Mv.text=i)):(r=kd(n,s),r!==Mv.text&&(t.textContent=r,Mv.text=r)),Rv(t,"font-family",Dd(n)),Rv(t,"font-size",xd(n)+"px"),Rv(t,"font-style",n.fontStyle),Rv(t,"font-variant",n.fontVariant),Rv(t,"font-weight",n.fontWeight)}};function Nv(e,t,n){n!==Mv[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Mv[t]=n)}function Tv(e,t,n){t!==Mv[e]&&(n?zv(Fv,e,t,n):Rv(Fv,e,t),Mv[e]=t)}function Rv(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function zv(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function Pv(){let e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Lv(e){uh.call(this,e),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}wv._update=function(e,t,n){Fv=t,Mv=t.__values__,ov(Tv,n),e.attr(Tv,n,this);const i=$v[e.type];i&&i.call(this,e,t,n),Fv&&this.style(Fv,n)},wv.style=function(e,t){if(null!=t)for(const n in bv){let i="font"===n?Dd(t):t[n];if(i===Mv[n])continue;const r=bv[n];null==i?e.removeAttribute(r):(Au(i)&&(i=Du(i,this._defs.gradient,Pv())),e.setAttribute(r,i+"")),Mv[n]=i}};var Bv=Object(h["y"])(Lv,uh),Iv=uh.prototype;function Uv(e,t,n,i,r){if(null==t)return e;if("bgrect"===i&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===i&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===i&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===i&&(e["font-family"]=Dd(t),e["font-size"]=xd(t)+"px",t.fontStyle&&(e["font-style"]=t.fontStyle),t.fontVariant&&(e["font-variant"]=t.fontVariant),t.fontWeight&&(e["font-weight"]=t.fontWeight));for(const o in bv){let n=t[o];const i=bv[o];("transparent"!==n||"fill"!==i&&"stroke"!==i)&&null!=n&&(Au(n)&&(n=Du(n,r.gradient,"")),e[i]=n)}return e}function qv(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}Bv.resize=function(e,t,n,i){Iv.resize.call(this,e,t,n,i);var r=this._origin,o=this._text,a={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var s in Bf)a[s]=Bf[s];o.head=mv("svg",a);var u=this._bgcolor;return"transparent"!==u&&"none"!==u||(u=null),o.bg=u?mv("rect",{width:this._width,height:this._height,fill:u})+vv("rect"):"",o.root=mv("g",Object(h["o"])({},yv,{transform:"translate("+r+")"})),o.foot=vv("g")+vv("svg"),this},Bv.background=function(){var e=Iv.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),e},Bv.svg=function(){var e=this._text;return e.head+e.defs+e.bg+e.root+e.body+e.foot},Bv._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},Bv.buildDefs=function(){let e,t="";for(const n in this._defs.gradient){const i=this._defs.gradient[n],r=i.stops;"radial"===i.gradient?(t+=mv(e="pattern",{id:Eu+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t+=mv("rect",{width:"1",height:"1",fill:"url(#"+n+")"})+vv("rect"),t+=vv(e),t+=mv(e="radialGradient",{id:n,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})):t+=mv(e="linearGradient",{id:n,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2});for(let e=0;e<r.length;++e)t+=mv("stop",{offset:r[e].offset,"stop-color":r[e].color})+vv("stop");t+=vv(e)}for(const n in this._defs.clipping){const e=this._defs.clipping[n];t+=mv("clipPath",{id:n}),e.path?t+=mv("path",{d:e.path})+vv("path"):t+=mv("rect",{x:0,y:0,width:e.width,height:e.height})+vv("rect"),t+=vv("clipPath")}return t?mv("defs")+t+vv("defs"):""},Bv.attr=function(e,t,n,i){const r={},o=(e,t,n,i)=>{r[i||e]=t};return Array.isArray(n)?n.forEach(e=>e(o,t,this)):n(o,t,this),i&&Uv(r,t,e,i,this._defs),r},Bv.href=function(e){var t,n=this,i=e.href;if(i){if(t=n._hrefs&&n._hrefs[i])return t;n.sanitizeURL(i).then(e=>{e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[i]=e})}return null},Bv.mark=function(e){const t=Id[e.marktype],n=t.tag,i=[ov,t.attr];let r="";r+=mv("g",Object(h["o"])({class:nh(e),"clip-path":e.clip?pl(this,e,e.group):null},av(e),{"pointer-events":"g"!==n&&!1===e.interactive?"none":null}));const o=o=>{const a=this.href(o);if(a&&(r+=mv("a",a)),r+=mv(n,this.attr(e,o,i,"g"!==n?n:null)),"text"===n){const e=wd(o);if(Object(h["A"])(e)){const t={x:0,dy:Od(o)};for(let n=0;n<e.length;++n)r+=mv("tspan",n?t:null)+qv(kd(o,e[n]))+vv("tspan")}else r+=qv(kd(o,e))}else if("g"===n){const n=o.strokeForeground,i=o.fill,a=o.stroke;n&&a&&(o.stroke=null),r+=mv("path",this.attr(e,o,t.background,"bgrect"))+vv("path"),r+=mv("g",this.attr(e,o,t.content))+this.markGroup(o)+vv("g"),n&&a?(i&&(o.fill=null),o.stroke=a,r+=mv("path",this.attr(e,o,t.foreground,"bgrect"))+vv("path"),i&&(o.fill=i)):r+=mv("path",this.attr(e,o,t.foreground,"bgfore"))+vv("path")}r+=vv(n),a&&(r+=vv("a"))};return t.nested?e.items&&e.items.length&&o(e.items[0]):rf(e,o),r+vv("g")},Bv.markGroup=function(e){let t="";return rf(e,e=>{t+=this.mark(e)}),t};var Wv="canvas",Hv="png",Gv="svg",Vv="none",Yv={Canvas:Wv,PNG:Hv,SVG:Gv,None:Vv},Zv={};function Xv(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Zv[e]=t,this):Zv[e]}function Jv(e,t,n){const i=[],r=(new gl).union(t),o=e.marktype;return o?Qv(e,r,n,i):"group"===o?eb(e,r,n,i):Object(h["n"])("Intersect scene must be mark node or group item.")}function Qv(e,t,n,i){if(Kv(e,t,n)){const r=e.items,o=e.marktype,a=r.length;let s=0;if("group"===o)for(;s<a;++s)eb(r[s],t,n,i);else for(const e=Id[o].isect;s<a;++s){let n=r[s];tb(n,t,e)&&i.push(n)}}return i}function Kv(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}function eb(e,t,n,i){n&&n(e.mark)&&tb(e,t,Id.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let e=0;e<o;++e)Qv(r[e],t,n,i);t.translate(a,s)}return i}function tb(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}Zv[Wv]=Zv[Hv]={renderer:Uh,headless:Uh,handler:Mh},Zv[Gv]={renderer:_v,headless:Lv,handler:Vh},Zv[Vv]={};var nb=new gl,ib=function(e){var t=e.clip;if(Object(h["D"])(t))t(Fl(nb.clear()));else{if(!t)return;nb.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(nb)},rb=1e-9;function ob(e,t,n){return e===t||("path"===n?ab(e,t):e instanceof Date&&t instanceof Date?+e===+t:Object(h["E"])(e)&&Object(h["E"])(t)?Math.abs(e-t)<=rb:e&&t&&(Object(h["F"])(e)||Object(h["F"])(t))?null!=e&&null!=t&&sb(e,t):e==t)}function ab(e,t){return ob(Xu(e),Xu(t))}function sb(e,t){var n,i,r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(r.sort(),o.sort(),i=r.length-1;i>=0;i--)if(r[i]!=o[i])return!1;for(i=r.length-1;i>=0;i--)if(n=r[i],!ob(e[n],t[n],n))return!1;return typeof e===typeof t}function ub(){hl(),ku()}function cb(e){Yi.call(this,null,e)}var lb=Object(h["y"])(cb,Yi);function fb(e,t,n){return t(e.bounds.clear(),e,n)}lb.transform=function(e,t){var n,i=t.dataflow,r=e.mark,o=r.marktype,a=Id[o],s=a.bound,u=r.bounds;if(a.nested)r.items.length&&i.dirty(r.items[0]),u=fb(r,s),r.items.forEach((function(e){e.bounds.clear().union(u)}));else if(o===eu||e.modified())switch(t.visit(t.MOD,e=>i.dirty(e)),u.clear(),r.items.forEach(e=>u.union(fb(e,s))),r.role){case tu:case ou:case nu:t.reflow()}else n=t.changed(t.REM),t.visit(t.ADD,e=>{u.union(fb(e,s))}),t.visit(t.MOD,e=>{n=n||u.alignsWith(e.bounds),i.dirty(e),u.union(fb(e,s))}),n&&(u.clear(),r.items.forEach(e=>u.union(e.bounds)));return ib(r),t.modifies("bounds")};var db=":vega_identifier:";function hb(e){Yi.call(this,0,e)}hb.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};var pb=Object(h["y"])(hb,Yi);function gb(e){var t=e._signals[db];return t||(e._signals[db]=t=e.add(0)),t}function mb(e){Yi.call(this,null,e)}pb.transform=function(e,t){var n=gb(t.dataflow),i=n.value,r=e.as;return t.visit(t.ADD,e=>{e[r]||(e[r]=++i)}),n.set(this.value=i),t};var vb=Object(h["y"])(mb,Yi);function bb(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function yb(e){Yi.call(this,null,e)}vb.transform=function(e,t){var n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,bb(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var i=n.marktype===eu?bl:vl;return t.visit(t.ADD,e=>i.call(e,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t};var xb=Object(h["y"])(yb,Yi),Ob={parity:e=>e.filter((e,t)=>t%2?e.opacity=0:1),greedy:(e,t)=>{var n;return e.filter((e,i)=>i&&_b(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1))}};function _b(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)}function wb(e,t){for(var n,i=1,r=e.length,o=e[0].bounds;i<r;o=n,++i)if(_b(o,n=e[i].bounds,t))return!0}function jb(e){var t=e.bounds;return t.width()>1&&t.height()>1}function kb(e,t,n){var i=e.range(),r=new gl;return t===Is||t===Ws?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),e=>r.encloses(e.bounds)}function Eb(e){return e.forEach(e=>e.opacity=1),e}function Ab(e,t){return e.reflow(t.modified()).modifies("opacity")}function Db(e){Yi.call(this,null,e)}xb.transform=function(e,t){var n,i,r,o=Ob[e.method]||Ob.parity,a=t.materialize(t.SOURCE).source,s=e.separation||0;if(a&&a.length){if(!e.method)return e.modified("method")&&(Eb(a),t=Ab(t,e)),t;if(a=a.filter(jb),a.length){if(e.sort&&(a=a.slice().sort(e.sort)),n=Eb(a),t=Ab(t,e),n.length>=3&&wb(n,s)){do{n=o(n,s)}while(n.length>=3&&wb(n,s));n.length<3&&!Object(h["U"])(a).opacity&&(n.length>1&&(Object(h["U"])(n).opacity=0),Object(h["U"])(a).opacity=1)}return e.boundScale&&e.boundTolerance>=0&&(i=kb(e.boundScale,e.boundOrient,+e.boundTolerance),a.forEach(e=>{i(e)||(e.opacity=0)})),r=n[0].mark.bounds.clear(),a.forEach(e=>{e.opacity&&r.union(e.bounds)}),t}}};var Sb=Object(h["y"])(Db,Yi);Sb.transform=function(e,t){var n=t.dataflow;if(t.visit(t.ALL,e=>n.dirty(e)),t.fields&&t.fields["zindex"]){var i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}};const Cb=new gl;function Fb(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Mb(e){var t=e.items[0].orient;return t===Us||t===qs}function $b(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Nb(e,t,n,i){var r,o,a=t.items[0],s=a.datum,u=null!=a.translate?a.translate:.5,c=a.orient,l=$b(s),f=a.range,d=a.offset,h=a.position,p=a.minExtent,g=a.maxExtent,m=s.title&&a.items[l[2]].items[0],v=a.titlePadding,b=a.bounds,y=m&&jd(m),x=0,O=0;switch(Cb.clear().union(b),b.clear(),(r=l[0])>-1&&b.union(a.items[r].bounds),(r=l[1])>-1&&b.union(a.items[r].bounds),c){case Is:x=h||0,O=-d,o=Math.max(p,Math.min(g,-b.y1)),b.add(0,-o).add(f,0),m&&Tb(e,m,o,v,y,0,-1,b);break;case Us:x=-d,O=h||0,o=Math.max(p,Math.min(g,-b.x1)),b.add(-o,0).add(0,f),m&&Tb(e,m,o,v,y,1,-1,b);break;case qs:x=n+d,O=h||0,o=Math.max(p,Math.min(g,b.x2)),b.add(0,0).add(o,f),m&&Tb(e,m,o,v,y,1,1,b);break;case Ws:x=h||0,O=i+d,o=Math.max(p,Math.min(g,b.y2)),b.add(0,0).add(f,o),m&&Tb(e,m,o,v,0,0,1,b);break;default:x=a.x,O=a.y}return kl(b.translate(x,O),a),Fb(a,"x",x+u)|Fb(a,"y",O+u)&&(a.bounds=Cb,e.dirty(a),a.bounds=b,e.dirty(a)),a.mark.bounds.clear().union(b)}function Tb(e,t,n,i,r,o,a,s){const u=t.bounds;if(t.auto){const s=a*(n+r+i);let c=0,l=0;e.dirty(t),o?c=(t.x||0)-(t.x=s):l=(t.y||0)-(t.y=s),t.mark.bounds.clear().union(u.translate(-c,-l)),e.dirty(t)}s.union(u)}const Rb=(e,t)=>Math.floor(Math.min(e,t)),zb=(e,t)=>Math.ceil(Math.max(e,t));function Pb(e){for(var t,n,i=e.items,r=i.length,o=0,a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};o<r;++o)if(t=i[o],n=t.items,t.marktype===eu)switch(t.role){case tu:case ou:case nu:break;case au:a.rowheaders.push(...n);break;case su:a.rowfooters.push(...n);break;case cu:a.colheaders.push(...n);break;case lu:a.colfooters.push(...n);break;case uu:a.rowtitle=n[0];break;case fu:a.coltitle=n[0];break;default:a.marks.push(...n)}return a}function Lb(e){return(new gl).set(0,0,e.width||0,e.height||0)}function Bb(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Ib(e,t,n){var i=Object(h["F"])(e)?e[t]:e;return null!=i?i:void 0!==n?n:0}function Ub(e){return e<0?Math.ceil(-e):0}function qb(e,t,n){var i,r,o,a,s,u,c,l,f,d,h,p=!n.nodirty,g=n.bounds===Ou?Lb:Bb,m=Cb.set(0,0,0,0),v=Ib(n.align,_u),b=Ib(n.align,wu),y=Ib(n.padding,_u),x=Ib(n.padding,wu),O=n.columns||t.length,_=O<=0?1:Math.ceil(t.length/O),w=t.length,j=Array(w),k=Array(O),E=0,A=Array(w),D=Array(_),S=0,C=Array(w),F=Array(w),M=Array(w);for(r=0;r<O;++r)k[r]=0;for(r=0;r<_;++r)D[r]=0;for(r=0;r<w;++r)u=t[r],s=M[r]=g(u),u.x=u.x||0,C[r]=0,u.y=u.y||0,F[r]=0,o=r%O,a=~~(r/O),E=Math.max(E,c=Math.ceil(s.x2)),S=Math.max(S,l=Math.ceil(s.y2)),k[o]=Math.max(k[o],c),D[a]=Math.max(D[a],l),j[r]=y+Ub(s.x1),A[r]=x+Ub(s.y1),p&&e.dirty(t[r]);for(r=0;r<w;++r)r%O===0&&(j[r]=0),r<O&&(A[r]=0);if(v===xu)for(o=1;o<O;++o){for(h=0,r=o;r<w;r+=O)h<j[r]&&(h=j[r]);for(r=o;r<w;r+=O)j[r]=h+k[o-1]}else if(v===yu){for(h=0,r=0;r<w;++r)r%O&&h<j[r]&&(h=j[r]);for(r=0;r<w;++r)r%O&&(j[r]=h+E)}else for(v=!1,o=1;o<O;++o)for(r=o;r<w;r+=O)j[r]+=k[o-1];if(b===xu)for(a=1;a<_;++a){for(h=0,r=a*O,i=r+O;r<i;++r)h<A[r]&&(h=A[r]);for(r=a*O;r<i;++r)A[r]=h+D[a-1]}else if(b===yu){for(h=0,r=O;r<w;++r)h<A[r]&&(h=A[r]);for(r=O;r<w;++r)A[r]=h+S}else for(b=!1,a=1;a<_;++a)for(r=a*O,i=r+O;r<i;++r)A[r]+=D[a-1];for(f=0,r=0;r<w;++r)f=j[r]+(r%O?f:0),C[r]+=f-t[r].x;for(o=0;o<O;++o)for(d=0,r=o;r<w;r+=O)d+=A[r],F[r]+=d-t[r].y;if(v&&Ib(n.center,_u)&&_>1)for(r=0;r<w;++r)s=v===yu?E:k[r%O],f=s-M[r].x2-t[r].x-C[r],f>0&&(C[r]+=f/2);if(b&&Ib(n.center,wu)&&1!==O)for(r=0;r<w;++r)s=b===yu?S:D[~~(r/O)],d=s-M[r].y2-t[r].y-F[r],d>0&&(F[r]+=d/2);for(r=0;r<w;++r)m.union(M[r].translate(C[r],F[r]));switch(f=Ib(n.anchor,Qs),d=Ib(n.anchor,Ks),Ib(n.anchor,_u)){case Js:f-=m.width();break;case Xs:f-=m.width()/2}switch(Ib(n.anchor,wu)){case Js:d-=m.height();break;case Xs:d-=m.height()/2}for(f=Math.round(f),d=Math.round(d),m.clear(),r=0;r<w;++r)t[r].mark.bounds.clear();for(r=0;r<w;++r)u=t[r],u.x+=C[r]+=f,u.y+=F[r]+=d,m.union(u.mark.bounds.union(u.bounds.translate(C[r],F[r]))),p&&e.dirty(u);return m}function Wb(e,t,n){var i,r,o,a,s,u,c,l=Pb(t),f=l.marks,d=n.bounds===Ou?Hb:Gb,h=n.offset,p=n.columns||f.length,g=p<=0?1:Math.ceil(f.length/p),m=g*p;const v=qb(e,f,n);v.empty()&&v.set(0,0,0,0),l.rowheaders&&(u=Ib(n.headerBand,wu,null),i=Vb(e,l.rowheaders,f,p,g,-Ib(h,"rowHeader"),Rb,0,d,"x1",0,p,1,u)),l.colheaders&&(u=Ib(n.headerBand,_u,null),r=Vb(e,l.colheaders,f,p,p,-Ib(h,"columnHeader"),Rb,1,d,"y1",0,1,p,u)),l.rowfooters&&(u=Ib(n.footerBand,wu,null),o=Vb(e,l.rowfooters,f,p,g,Ib(h,"rowFooter"),zb,0,d,"x2",p-1,p,1,u)),l.colfooters&&(u=Ib(n.footerBand,_u,null),a=Vb(e,l.colfooters,f,p,p,Ib(h,"columnFooter"),zb,1,d,"y2",m-p,1,p,u)),l.rowtitle&&(s=Ib(n.titleAnchor,wu),c=Ib(h,"rowTitle"),c=s===Js?o+c:i-c,u=Ib(n.titleBand,wu,.5),Yb(e,l.rowtitle,c,0,v,u)),l.coltitle&&(s=Ib(n.titleAnchor,_u),c=Ib(h,"columnTitle"),c=s===Js?a+c:r-c,u=Ib(n.titleBand,_u,.5),Yb(e,l.coltitle,c,1,v,u))}function Hb(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function Gb(e,t){return e.bounds[t]}function Vb(e,t,n,i,r,o,a,s,u,c,l,f,d,h){var p,g,m,v,b,y,x,O,_,w=n.length,j=0,k=0;if(!w)return j;for(p=l;p<w;p+=f)n[p]&&(j=a(j,u(n[p],c)));if(!t.length)return j;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),j+=o,g=0,v=t.length;g<v;++g)e.dirty(t[g]),t[g].mark.bounds.clear();for(p=l,g=0,v=t.length;g<v;++g,p+=f){for(y=t[g],b=y.mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=d);s?(O=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),_=j):(O=j,_=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),b.union(y.bounds.translate(O-(y.x||0),_-(y.y||0))),y.x=O,y.y=_,e.dirty(y),k=a(k,b[c])}return k}function Yb(e,t,n,i,r,o){if(t){e.dirty(t);var a=n,s=n;i?a=Math.round(r.x1+o*r.width()):s=Math.round(r.y1+o*r.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function Zb(e,t){const n=e[t]||{};return(t,i)=>null!=n[t]?n[t]:null!=e[t]?e[t]:i}function Xb(e,t){var n=-1/0;return e.forEach(e=>{null!=e.offset&&(n=Math.max(n,e.offset))}),n>-1/0?n:t}function Jb(e,t,n,i,r,o,a){const s=Zb(n,t),u=Xb(e,s("offset",0)),c=s("anchor",Zs),l=c===Js?1:c===Xs?.5:0,f={align:xu,bounds:s("bounds",Ou),columns:"vertical"===s("direction")?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case Us:f.anchor={x:Math.floor(i.x1)-u,column:Js,y:l*(a||i.height()+2*i.y1),row:c};break;case qs:f.anchor={x:Math.ceil(i.x2)+u,y:l*(a||i.height()+2*i.y1),row:c};break;case Is:f.anchor={y:Math.floor(r.y1)-u,row:Js,x:l*(o||r.width()+2*r.x1),column:c};break;case Ws:f.anchor={y:Math.ceil(r.y2)+u,x:l*(o||r.width()+2*r.x1),column:c};break;case Hs:f.anchor={x:u,y:u};break;case Gs:f.anchor={x:o-u,y:u,column:Js};break;case Vs:f.anchor={x:u,y:a-u,row:Js};break;case Ys:f.anchor={x:o-u,y:a-u,column:Js,row:Js};break}return f}function Qb(e,t){var n,i,r=t.items[0],o=r.datum,a=r.orient,s=r.bounds,u=r.x,c=r.y;return r._bounds?r._bounds.clear().union(s):r._bounds=s.clone(),s.clear(),ey(e,r,r.items[0].items[0]),s=Kb(r,s),n=2*r.padding,i=2*r.padding,s.empty()||(n=Math.ceil(s.width()+n),i=Math.ceil(s.height()+i)),o.type===hu&&iy(r.items[0].items[0].items[0].items),a!==bu&&(r.x=u=0,r.y=c=0),r.width=n,r.height=i,kl(s.set(u,c,u+n,c+i),r),r.mark.bounds.clear().union(s),r}function Kb(e,t){return e.items.forEach(e=>t.union(e.bounds)),t.x1=e.padding,t.y1=e.padding,t}function ey(e,t,n){var i=t.padding,r=i-n.x,o=i-n.y;if(t.datum.title){var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,c=i-a.x,l=i-a.y;switch(a.orient){case Us:r+=Math.ceil(a.bounds.width())+u;break;case qs:case Ws:break;default:o+=a.bounds.height()+u}switch((r||o)&&ny(e,n,r,o),a.orient){case Us:l+=ty(t,n,a,s,1,1);break;case qs:c+=ty(t,n,a,Js,0,0)+u,l+=ty(t,n,a,s,1,1);break;case Ws:c+=ty(t,n,a,s,0,0),l+=ty(t,n,a,Js,-1,0,1)+u;break;default:c+=ty(t,n,a,s,0,0)}(c||l)&&ny(e,a,c,l),(c=Math.round(a.bounds.x1-i))<0&&(ny(e,n,-c,0),ny(e,a,-c,0))}else(r||o)&&ny(e,n,r,o)}function ty(e,t,n,i,r,o,a){const s="symbol"!==e.datum.type,u=n.datum.vgrad,c=!s||!o&&u||a?t:t.items[0],l=c.bounds[r?"y2":"x2"]-e.padding,f=u&&o?l:0,d=u&&o?0:l,h=r<=0?0:jd(n);return Math.round(i===Zs?f:i===Js?d-h:.5*(l-h))}function ny(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function iy(e){var t=e.reduce((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e),{});e.forEach(e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y})}function ry(e,t,n,i,r){var o,a=t.items[0],s=a.frame,u=a.orient,c=a.anchor,l=a.offset,f=a.padding,d=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],p=u===Us||u===qs?i:n,g=0,m=0,v=0,b=0,y=0;if(s!==eu?u===Us?(g=r.y2,p=r.y1):u===qs?(g=r.y1,p=r.y2):(g=r.x1,p=r.x2):u===Us&&(g=i,p=0),o=c===Zs?g:c===Js?p:(g+p)/2,h&&h.text){switch(u){case Is:case Ws:y=d.bounds.height()+f;break;case Us:b=d.bounds.width()+f;break;case qs:b=-d.bounds.width()-f;break}Cb.clear().union(h.bounds),Cb.translate(b-(h.x||0),y-(h.y||0)),Fb(h,"x",b)|Fb(h,"y",y)&&(e.dirty(h),h.bounds.clear().union(Cb),h.mark.bounds.clear().union(Cb),e.dirty(h)),Cb.clear().union(h.bounds)}else Cb.clear();switch(Cb.union(d.bounds),u){case Is:m=o,v=r.y1-Cb.height()-l;break;case Us:m=r.x1-Cb.width()-l,v=o;break;case qs:m=r.x2+Cb.width()+l,v=o;break;case Ws:m=o,v=r.y2+l;break;default:m=a.x,v=a.y}return Fb(a,"x",m)|Fb(a,"y",v)&&(Cb.translate(m,v),e.dirty(a),a.bounds.clear().union(Cb),t.bounds.clear().union(Cb),e.dirty(a)),a.bounds}function oy(e){Yi.call(this,null,e)}var ay=Object(h["y"])(oy,Yi);function sy(e){return e&&"legend-entry"!==e.mark.role}function uy(e,t,n){var i,r,o,a,s,u,c=t.items,l=Math.max(0,t.width||0),f=Math.max(0,t.height||0),d=(new gl).set(0,0,l,f),h=d.clone(),p=d.clone(),g=[];for(s=0,u=c.length;s<u;++s)switch(r=c[s],r.role){case tu:a=Mb(r)?h:p,a.union(Nb(e,r,l,f));break;case nu:i=r;break;case ou:g.push(Qb(e,r));break;case iu:case ru:case au:case su:case uu:case cu:case lu:case fu:h.union(r.bounds),p.union(r.bounds);break;default:d.union(r.bounds)}if(g.length){const t={};g.forEach(e=>{o=e.orient||qs,o!==bu&&(t[o]||(t[o]=[])).push(e)});for(let i in t){const r=t[i];qb(e,r,Jb(r,i,n.legends,h,p,l,f))}g.forEach(t=>{const i=t.bounds;if(i.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=i,e.dirty(t)),n.autosize&&n.autosize.type===pu)switch(t.orient){case Us:case qs:d.add(i.x1,0).add(i.x2,0);break;case Is:case Ws:d.add(0,i.y1).add(0,i.y2)}else d.union(i)})}d.union(h).union(p),i&&d.union(ry(e,i,l,f,d)),t.clip&&d.set(0,0,t.width||0,t.height||0),cy(e,t,d,n)}function cy(e,t,n,i){const r=i.autosize||{},o=r.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,Math.ceil(n.x2-u)),f=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1)),h=Math.max(0,Math.ceil(n.y2-f));if(r.contains===du){const t=e.padding();a-=t.left+t.right,s-=t.top+t.bottom}o===bu?(c=0,d=0,u=a,f=s):o===pu?(u=Math.max(0,a-c-l),f=Math.max(0,s-d-h)):o===gu?(u=Math.max(0,a-c-l),s=f+d+h):o===mu?(a=u+c+l,f=Math.max(0,s-d-h)):o===vu&&(a=u+c+l,s=f+d+h),e._resizeView(a,s,u,f,[c,d],r.resize)}function ly(e){Yi.call(this,null,e)}ay.transform=function(e,t){var n=t.dataflow;return e.mark.items.forEach(t=>{e.layout&&Wb(n,t,e.layout),uy(n,t,e)}),sy(e.mark.group)?t.reflow():t};var fy=Object(h["y"])(ly,Yi);function dy(e){Yi.call(this,null,e)}fy.transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,a=null==e.count?e.values?e.values.length:10:e.count,s=Dm(o,a,e.minstep),u=e.format||Fm(n,o,s,e.formatSpecifier,e.formatType,!!e.values),c=e.values?Sm(o,e.values,s):Cm(o,s);return r&&(i.rem=r),r=c.map((function(e,t){return O({index:t/(c.length-1||1),value:e,label:u(e)})})),e.extra&&r.length&&r.push(O({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i};var hy=Object(h["y"])(dy,Yi);function py(){return O({})}function gy(e){const t=Object(h["s"])().test(e=>e.exit);return t.lookup=n=>t.get(e(n)),t}function my(e){Yi.call(this,null,e)}hy.transform=function(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||py,o=e.key||y,a=this.value;return Object(h["A"])(i.encode)&&(i.encode=null),a&&(e.modified("key")||t.modified(o))&&Object(h["n"])("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=gy(o)),t.visit(t.ADD,e=>{const t=o(e);let n=a.get(t);n?n.exit?(a.empty--,i.add.push(n)):i.mod.push(n):(n=r(e),a.set(t,n),i.add.push(n)),n.datum=e,n.exit=!1}),t.visit(t.MOD,e=>{const t=o(e),n=a.get(t);n&&(n.datum=e,i.mod.push(n))}),t.visit(t.REM,e=>{const t=o(e),n=a.get(t);e!==n.datum||n.exit||(i.rem.push(n),n.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),i};var vy=Object(h["y"])(my,Yi);function by(e){Yi.call(this,[],e)}vy.transform=function(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,o=t.encode;if(Object(h["A"])(o)){if(!n.changed()&&!o.every((function(e){return r[e]})))return t.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=r.update||h["r"],u=r.enter||h["r"],c=r.exit||h["r"],l=(o&&!a?r[o]:s)||h["r"];if(t.changed(t.ADD)&&(t.visit(t.ADD,(function(t){u(t,e),s(t,e)})),n.modifies(u.output),n.modifies(s.output),l!==h["r"]&&l!==s&&(t.visit(t.ADD,(function(t){l(t,e)})),n.modifies(l.output))),t.changed(t.REM)&&c!==h["r"]&&(t.visit(t.REM,(function(t){c(t,e)})),n.modifies(c.output)),a||l!==h["r"]){var f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,(function(t){var r=u(t,e)||i;(l(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(u.output)):t.visit(f,(function(t){(l(t,e)||i)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:t.StopPropagation};var yy=Object(h["y"])(by,Yi);yy.transform=function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,i,r,o,a,s=t.dataflow.locale(),u=t.fork(t.NO_SOURCE|t.NO_FIELDS),c=this.value,l=e.type||_m,f=e.scale,d=+e.limit,p=Dm(f,null==e.count?5:e.count,e.minstep),g=!!e.values||l===_m,m=e.format||Bm(s,f,p,l,e.formatSpecifier,e.formatType,g),v=e.values||Tm(f,p);return c&&(u.rem=c),l===_m?(d&&v.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=v.slice(0,d-1),a=!0):c=v,Object(h["D"])(r=e.size)?(e.values||0!==f(c[0])||(c=c.slice(1)),o=c.reduce((function(t,n){return Math.max(t,r(n,e))}),0)):r=Object(h["l"])(o=r||8),c=c.map((function(t,n){return O({index:n,label:m(t,n,c),value:t,offset:o,size:r(t,e)})})),a&&(a=v[c.length],c.push(O({index:c.length,label:`${v.length-c.length} entries`,value:a,offset:o,size:r(a,e)})))):l===jm?(n=f.domain(),i=hm(f,n[0],Object(h["U"])(n)),v.length<3&&!e.values&&n[0]!==Object(h["U"])(n)&&(v=[n[0],Object(h["U"])(n)]),c=v.map((function(e,t){return O({index:t,label:m(e,t,v),value:e,perc:i(e)})}))):(r=v.length-1,i=Gm(f),c=v.map((function(e,t){return O({index:t,label:m(e,t,v),value:e,perc:t?i(e):0,perc2:t===r?1:i(v[t+1])})}))),u.source=c,u.add=c,this.value=c,u};var xy=Object(h["s"])({line:Ay,"line-radial":Dy,arc:Sy,"arc-radial":Cy,curve:Fy,"curve-radial":My,"orthogonal-horizontal":$y,"orthogonal-vertical":Ny,"orthogonal-radial":Ty,"diagonal-horizontal":Ry,"diagonal-vertical":zy,"diagonal-radial":Py});function Oy(e){return e.source.x}function _y(e){return e.source.y}function wy(e){return e.target.x}function jy(e){return e.target.y}function ky(e){Yi.call(this,{},e)}ky.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};var Ey=Object(h["y"])(ky,Yi);function Ay(e,t,n,i){return"M"+e+","+t+"L"+n+","+i}function Dy(e,t,n,i){return Ay(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n))}function Sy(e,t,n,i){var r=n-e,o=i-t,a=Math.sqrt(r*r+o*o)/2,s=180*Math.atan2(o,r)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+s+" 0 1 "+n+","+i}function Cy(e,t,n,i){return Sy(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n))}function Fy(e,t,n,i){var r=n-e,o=i-t,a=.2*(r+o),s=.2*(o-r);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(i-a)+" "+n+","+i}function My(e,t,n,i){return Fy(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n))}function $y(e,t,n,i){return"M"+e+","+t+"V"+i+"H"+n}function Ny(e,t,n,i){return"M"+e+","+t+"H"+n+"V"+i}function Ty(e,t,n,i){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*s+"L"+i*a+","+i*s}function Ry(e,t,n,i){var r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i}function zy(e,t,n,i){var r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i}function Py(e,t,n,i){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*o+"C"+u*r+","+u*o+" "+u*a+","+u*s+" "+i*a+","+i*s}function Ly(e,t){let n=0;if(void 0===t)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function By(e){Yi.call(this,null,e)}Ey.transform=function(e,t){var n=e.sourceX||Oy,i=e.sourceY||_y,r=e.targetX||wy,o=e.targetY||jy,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",c=xy.get(u+"-"+s)||xy.get(u);return c||Object(h["n"])("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(function(e){e[a]=c(n(e),i(e),r(e),o(e))})),t.reflow(e.modified()).modifies(a)},By.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};var Iy=Object(h["y"])(By,Yi);Iy.transform=function(e,t){var n,i,r,o=e.as||["startAngle","endAngle"],a=o[0],s=o[1],u=e.field||h["O"],c=e.startAngle||0,l=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(u),p=d.length,g=c,m=(l-c)/Ly(d),v=ls(p);for(e.sort&&v.sort((function(e,t){return d[e]-d[t]})),n=0;n<p;++n)r=d[v[n]],i=f[v[n]],i[a]=g,i[s]=g+=r*m;return this.value=d,t.reflow(e.modified()).modifies(o)};var Uy=5;function qy(e){const t=e.type;return!e.bins&&(t===Qh||t===ep||t===tp)}function Wy(e){return tm(e)&&e!==op}var Hy=Object(h["db"])(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Gy(e){Yi.call(this,null,e),this.modified(!0)}var Vy=Object(h["y"])(Gy,Yi);function Yy(e){var t,n=e.type,i="";return n===op?op+"-"+Qh:(Zy(e)&&(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0,i=2===t?op+"-":3===t?ap+"-":""),(i+n||Qh).toLowerCase())}function Zy(e){const t=e.type;return tm(t)&&t!==ip&&t!==rp&&(e.scheme||e.range&&e.range.length&&e.range.every(h["H"]))}function Xy(e,t,n){var i=Jy(e,t.domainRaw,n);if(i>-1)return i;var r,o,a=t.domain,s=e.type,u=t.zero||void 0===t.zero&&qy(e);if(!a)return 0;if(Wy(s)&&t.padding&&a[0]!==Object(h["U"])(a)&&(a=Qy(s,a,t.range,t.padding,t.exponent,t.constant)),(u||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(r=(a=a.slice()).length-1||1,u&&(a[0]>0&&(a[0]=0),a[r]<0&&(a[r]=0)),null!=t.domainMin&&(a[0]=t.domainMin),null!=t.domainMax&&(a[r]=t.domainMax),null!=t.domainMid)){o=t.domainMid;const e=o>a[r]?r+1:o<a[0]?0:r;e!==r&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(e,0,o)}return e.domain(Ky(s,a,n)),s===lp&&e.unknown(t.domainImplicit?Ap:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&Dm(e,t.nice)||null),a.length}function Jy(e,t,n){return t?(e.domain(Ky(e.type,t,n)),t.length):-1}function Qy(e,t,n,i,r,o){var a=Math.abs(Object(h["U"])(n)-n[0]),s=a/(a-2*i),u=e===Kh?Object(h["mb"])(t,null,s):e===tp?Object(h["nb"])(t,null,s,.5):e===ep?Object(h["nb"])(t,null,s,r||1):e===np?Object(h["ob"])(t,null,s,o||1):Object(h["lb"])(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function Ky(e,t,n){if(rm(e)){var i=Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0));i!==t.length&&n.warn("Log scale domain includes zero: "+Object(h["Z"])(t))}return t}function ex(e,t,n){let i=t.bins;if(i&&!Object(h["A"])(i)){let t=e.domain(),n=t[0],r=Object(h["U"])(t),o=null==i.start?n:i.start,a=null==i.stop?r:i.stop,s=i.step;s||Object(h["n"])("Scale bins parameter missing step property."),o<n&&(o=s*Math.ceil(n/s)),a>r&&(a=s*Math.floor(r/s)),i=ls(o,a+s/2,s)}return i?e.bins=i:e.bins&&delete e.bins,e.type===hp&&(i?t.domain||t.domainRaw||(e.domain(i),n=i.length):e.bins=e.domain()),n}function tx(e,t,n){var i=e.type,r=t.round||!1,o=t.range;if(null!=t.rangeStep)o=nx(i,t,n);else if(t.scheme&&(o=ix(i,t,n),Object(h["D"])(o))){if(e.interpolator)return e.interpolator(o);Object(h["n"])(`Scale type ${i} does not support interpolating color schemes.`)}if(o&&am(i))return e.interpolator(fm(ox(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(pm(t.interpolate,t.interpolateGamma)):Object(h["D"])(e.round)?e.round(r):Object(h["D"])(e.rangeRound)&&e.interpolate(r?Lp["a"]:zp["a"]),o&&e.range(ox(o,t.reverse))}function nx(e,t,n){e!==dp&&e!==fp&&Object(h["n"])("Only band and point scales support rangeStep.");var i=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,r=e===fp?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*Xh(n,r,i)]}function ix(e,t,n){var i,r,o=t.schemeExtent;return Object(h["A"])(t.scheme)?r=fm(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),r=Om(i),r||Object(h["n"])("Unrecognized scheme name: "+t.scheme)),n=e===cp?n+1:e===hp?n-1:e===sp||e===up?+t.schemeCount||Uy:n,am(e)?rx(r,o,t.reverse):Object(h["D"])(r)?dm(rx(r,o),n):e===lp?r:r.slice(0,n)}function rx(e,t,n){return Object(h["D"])(e)&&(t||n)?lm(e,ox(t||[0,1],n)):e}function ox(e,t){return t?e.slice().reverse():e}function ax(e){Yi.call(this,null,e)}Vy.transform=function(e,t){var n=t.dataflow,i=this.value,r=Yy(e);for(r in i&&r===i.type||(this.value=i=Qg(r)()),e)if(!Hy[r]){if("padding"===r&&Wy(i.type))continue;Object(h["D"])(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return tx(i,e,ex(i,e,Xy(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var sx=Object(h["y"])(ax,Yi);sx.transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(k(e.sort)),this.modified(n),t};var ux="zero",cx="center",lx="normalize",fx=["y0","y1"];function dx(e){Yi.call(this,null,e)}dx.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:ux,values:[ux,cx,lx]},{name:"as",type:"string",array:!0,length:2,default:fx}]};var hx=Object(h["y"])(dx,Yi);function px(e,t,n,i,r){for(var o,a=(t-e.sum)/2,s=e.length,u=0;u<s;++u)o=e[u],o[i]=a,o[r]=a+=Math.abs(n(o))}function gx(e,t,n,i,r){for(var o,a=1/e.sum,s=0,u=e.length,c=0,l=0;c<u;++c)o=e[c],o[i]=s,o[r]=s=a*(l+=Math.abs(n(o)))}function mx(e,t,n,i,r){for(var o,a,s=0,u=0,c=e.length,l=0;l<c;++l)a=e[l],o=+n(a),o<0?(a[i]=u,a[r]=u+=o):(a[i]=s,a[r]=s+=o)}function vx(e,t,n,i){var r,o,a,s,u,c,l,f,d,h=[],p=function(e){return e(u)};if(null==t)h.push(e.slice());else for(r={},o=0,a=e.length;o<a;++o)u=e[o],c=t.map(p),l=r[c],l||(r[c]=l=[],h.push(l)),l.push(u);for(c=0,d=0,s=h.length;c<s;++c){for(l=h[c],o=0,f=0,a=l.length;o<a;++o)f+=Math.abs(i(l[o]));l.sum=f,f>d&&(d=f),n&&l.sort(n)}return h.max=d,h}function bx(){}hx.transform=function(e,t){var n,i,r,o,a=e.as||fx,s=a[0],u=a[1],c=k(e.sort),l=e.field||h["O"],f=e.offset===cx?px:e.offset===lx?gx:mx;for(n=vx(t.source,e.groupby,c,l),i=0,r=n.length,o=n.max;i<r;++i)f(n[i],o,l,s,u);return t.reflow(e.modified()).modifies(a)};const yx=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];var xx=function(){var e=1,t=1,n=s;function i(e,t){return t.map(t=>r(e,t))}function r(e,t){var i=[],r=[];return o(e,t,(function(o){n(o,e,t),Ox(o)>0?i.push([o]):r.push(o)})),r.forEach((function(e){for(var t,n=0,r=i.length;n<r;++n)if(-1!==_x((t=i[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:t,coordinates:i}}function o(n,i,r){var o,s,u,c,l,f,d=new Array,h=new Array;o=s=-1,c=n[0]>=i,yx[c<<1].forEach(p);while(++o<e-1)u=c,c=n[o+1]>=i,yx[u|c<<1].forEach(p);yx[c<<0].forEach(p);while(++s<t-1){o=-1,c=n[s*e+e]>=i,l=n[s*e]>=i,yx[c<<1|l<<2].forEach(p);while(++o<e-1)u=c,c=n[s*e+e+o+1]>=i,f=l,l=n[s*e+o+1]>=i,yx[u|c<<1|l<<2|f<<3].forEach(p);yx[c|l<<3].forEach(p)}o=-1,l=n[s*e]>=i,yx[l<<2].forEach(p);while(++o<e-1)f=l,l=n[s*e+o+1]>=i,yx[l<<2|f<<3].forEach(p);function p(e){var t,n,i=[e[0][0]+o,e[0][1]+s],u=[e[1][0]+o,e[1][1]+s],c=a(i),l=a(u);(t=h[c])?(n=d[l])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(u),r(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(u),h[t.end=l]=t):(t=d[l])?(n=h[c])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(u),r(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(i),d[t.start=c]=t):d[c]=h[l]={start:c,end:l,ring:[i,u]}}yx[l<<3].forEach(p)}function a(t){return 2*t[0]+t[1]*(e+1)*4}function s(n,i,r){n.forEach((function(n){var o,a=n[0],s=n[1],u=0|a,c=0|s,l=i[c*e+u];a>0&&a<e&&u===a&&(o=i[c*e+u-1],n[0]=a+(r-o)/(l-o)-.5),s>0&&s<t&&c===s&&(o=i[(c-1)*e+u],n[1]=s+(r-o)/(l-o)-.5)}))}return i.contour=r,i.size=function(n){if(!arguments.length)return[e,t];var r=Math.floor(n[0]),o=Math.floor(n[1]);return r>=0&&o>=0||Object(h["n"])("invalid size"),e=r,t=o,i},i.smooth=function(e){return arguments.length?(n=e?s:bx,i):n===s},i};function Ox(e){var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];while(++t<n)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function _x(e,t){var n,i=-1,r=t.length;while(++i<r)if(n=wx(e,t[i]))return n;return 0}function wx(e,t){for(var n=t[0],i=t[1],r=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],c=u[0],l=u[1],f=e[s],d=f[0],h=f[1];if(jx(u,f,t))return 0;l>i!==h>i&&n<(d-c)*(i-l)/(h-l)+c&&(r=-r)}return r}function jx(e,t,n){var i;return kx(e,t,n)&&Ex(e[i=+(e[0]===t[0])],n[i],t[i])}function kx(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function Ex(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}var Ax=function(e,t,n){return function(i){var r=Object(h["p"])(i),o=n?Math.min(r[0],0):r[0],a=r[1],s=a-o,u=t?Ze(o,a,e):s/(e+1);return ls(u,a,u)}};function Dx(e){Yi.call(this,null,e)}Dx.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};var Sx=Object(h["y"])(Dx,Yi);function Cx(e,t,n){const i=Ax(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?i:i(e.map(e=>mr(t(e).values)))}function Fx(e,t,n,i){let r=i.scale||t.scale,o=i.translate||t.translate;if(Object(h["D"])(r)&&(r=r(n,i)),Object(h["D"])(o)&&(o=o(n,i)),(1===r||null==r)&&!o)return;const a=(Object(h["E"])(r)?r:r[0])||1,s=(Object(h["E"])(r)?r:r[1])||1,u=o&&o[0]||0,c=o&&o[1]||0;e.forEach(Mx(t,a,s,u,c))}function Mx(e,t,n,i,r){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(e){e.forEach(c)}function c(e){s&&e.reverse(),e.forEach(l)}function l(e){e[0]=(e[0]-o)*t+i,e[1]=(e[1]-a)*n+r}return function(e){return e.coordinates.forEach(u),e}}function $x(e,t,n){const i=e>=0?e:Dr(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Nx(e){return Object(h["D"])(e)?e:Object(h["l"])(+e)}Sx.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||h["x"],o=xx().smooth(!1!==e.smooth),a=e.thresholds||Cx(i,r,e),s=null===e.as?null:e.as||"contour",u=[];return i.forEach(t=>{const n=r(t),i=o.size([n.width,n.height])(n.values,Object(h["A"])(a)?a:a(n.values));Fx(i,n,t,e),i.forEach(e=>{u.push(w(t,O(null!=s?{[s]:e}:e)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n};var Tx=function(){var e=e=>e[0],t=e=>e[1],n=h["O"],i=[-1,-1],r=960,o=500,a=2;function s(s,u){const c=$x(i[0],s,e)>>a,l=$x(i[1],s,t)>>a,f=c?c+2:0,d=l?l+2:0,h=2*f+(r>>a),p=2*d+(o>>a),g=new Float32Array(h*p),m=new Float32Array(h*p);let v=g;s.forEach(i=>{const r=f+(+e(i)>>a),o=d+(+t(i)>>a);r>=0&&r<h&&o>=0&&o<p&&(g[r+o*h]+=+n(i))}),c>0&&l>0?(Rx(h,p,g,m,c),zx(h,p,m,g,l),Rx(h,p,g,m,c),zx(h,p,m,g,l),Rx(h,p,g,m,c),zx(h,p,m,g,l)):c>0?(Rx(h,p,g,m,c),Rx(h,p,m,g,c),Rx(h,p,g,m,c),v=m):l>0&&(zx(h,p,g,m,l),zx(h,p,m,g,l),zx(h,p,g,m,l),v=m);let b=u?Math.pow(2,-2*a):1/Ly(v);for(let e=0,t=h*p;e<t;++e)v[e]*=b;return{values:v,scale:1<<a,width:h,height:p,x1:f,y1:d,x2:f+(r>>a),y2:d+(o>>a)}}return s.x=function(t){return arguments.length?(e=Nx(t),s):e},s.y=function(e){return arguments.length?(t=Nx(e),s):t},s.weight=function(e){return arguments.length?(n=Nx(e),s):n},s.size=function(e){if(!arguments.length)return[r,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||Object(h["n"])("invalid size"),r=t,o=n,s},s.cellSize=function(e){return arguments.length?((e=+e)>=1||Object(h["n"])("invalid cell size"),a=Math.floor(Math.log(e)/Math.LN2),s):1<<a},s.bandwidth=function(e){return arguments.length?(e=Object(h["i"])(e),1===e.length&&(e=[+e[0],+e[0]]),2!==e.length&&Object(h["n"])("invalid bandwidth"),i=e,s):i},s};function Rx(e,t,n,i,r){const o=1+(r<<1);for(let a=0;a<t;++a)for(let t=0,s=0;t<e+r;++t)t<e&&(s+=n[t+a*e]),t>=r&&(t>=o&&(s-=n[t-o+a*e]),i[t-r+a*e]=s/Math.min(t+1,e-1+o-t,o))}function zx(e,t,n,i,r){const o=1+(r<<1);for(let a=0;a<e;++a)for(let s=0,u=0;s<t+r;++s)s<t&&(u+=n[a+s*e]),s>=r&&(s>=o&&(u-=n[a+(s-o)*e]),i[a+(s-r)*e]=u/Math.min(s+1,t-1+o-s,o))}function Px(e){Yi.call(this,null,e)}Px.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var Lx=Object(h["y"])(Px,Yi);const Bx=["x","y","weight","size","cellSize","bandwidth"];function Ix(e,t){return Bx.forEach(n=>null!=t[n]?e[n](t[n]):0),e}function Ux(e,t){var n,i,r,o,a,s,u=[],c=e=>e(o);if(null==t)u.push(e);else for(n={},i=0,r=e.length;i<r;++i)o=e[i],a=t.map(c),s=n[a],s||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u}function qx(e){Yi.call(this,null,e)}Lx.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=Ux(i,e.groupby),o=(e.groupby||[]).map(h["h"]),a=Ix(Tx(),e),s=e.as||"grid",u=[];function c(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e}return u=r.map(t=>O(c({[s]:a(t,e.counts)},t.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n},qx.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};var Wx=Object(h["y"])(qx,Yi);Wx.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,i,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=xx().smooth(!1!==e.smooth),a=e.values,s=e.thresholds||Ax(e.count||10,e.nice,!!a),u=e.size;return a||(a=t.materialize(t.SOURCE).source,n=Ix(Tx(),e)(a,!0),i=Mx(n,n.scale||1,n.scale||1,0,0),u=[n.width,n.height],a=n.values),s=Object(h["A"])(s)?s:s(a),a=o.size(u)(a,s),i&&a.forEach(i),this.value&&(r.rem=this.value),this.value=r.source=r.add=(a||[]).map(O),r};var Hx="Feature",Gx="FeatureCollection",Vx="MultiPoint";function Yx(e){Yi.call(this,null,e)}Yx.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};var Zx=Object(h["y"])(Yx,Yi);Zx.transform=function(e,t){var n,i=this._features,r=this._points,o=e.fields,a=o&&o[0],s=o&&o[1],u=e.geojson||!o&&h["x"],c=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(Object(h["g"])(u))||a&&t.modified(Object(h["g"])(a))||s&&t.modified(Object(h["g"])(s)),this.value&&!n||(c=t.SOURCE,this._features=i=[],this._points=r=[]),u&&t.visit(c,(function(e){i.push(u(e))})),a&&s&&(t.visit(c,(function(e){var t=a(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&r.push([t,n])})),i=i.concat({type:Hx,geometry:{type:Vx,coordinates:r}})),this.value={type:Gx,features:i}};var Xx=function(e){return e};function Jx(e,t){e&&Kx.hasOwnProperty(e.type)&&Kx[e.type](e,t)}var Qx={Feature:function(e,t){Jx(e.geometry,t)},FeatureCollection:function(e,t){var n=e.features,i=-1,r=n.length;while(++i<r)Jx(n[i].geometry,t)}},Kx={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var n=e.coordinates,i=-1,r=n.length;while(++i<r)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){eO(e.coordinates,t,0)},MultiLineString:function(e,t){var n=e.coordinates,i=-1,r=n.length;while(++i<r)eO(n[i],t,0)},Polygon:function(e,t){tO(e.coordinates,t)},MultiPolygon:function(e,t){var n=e.coordinates,i=-1,r=n.length;while(++i<r)tO(n[i],t)},GeometryCollection:function(e,t){var n=e.geometries,i=-1,r=n.length;while(++i<r)Jx(n[i],t)}};function eO(e,t,n){var i,r=-1,o=e.length-n;t.lineStart();while(++r<o)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function tO(e,t){var n=-1,i=e.length;t.polygonStart();while(++n<i)eO(e[n],t,1);t.polygonEnd()}var nO=function(e,t){e&&Qx.hasOwnProperty(e.type)?Qx[e.type](e,t):Jx(e,t)},iO=function(){return new rO};function rO(){this.reset()}rO.prototype={constructor:rO,reset:function(){this.s=this.t=0},add:function(e){aO(oO,e,this.t),aO(this,oO.s,this.s),this.s?this.t+=oO.t:this.s=oO.t},valueOf:function(){return this.s}};var oO=new rO;function aO(e,t,n){var i=e.s=t+n,r=i-t,o=i-r;e.t=t-o+(n-r)}var sO=1e-6,uO=1e-12,cO=Math.PI,lO=cO/2,fO=cO/4,dO=2*cO,hO=180/cO,pO=cO/180,gO=Math.abs,mO=Math.atan,vO=Math.atan2,bO=Math.cos,yO=Math.ceil,xO=Math.exp,OO=(Math.floor,Math.log),_O=Math.pow,wO=Math.sin,jO=Math.sign||function(e){return e>0?1:e<0?-1:0},kO=Math.sqrt,EO=Math.tan;function AO(e){return e>1?0:e<-1?cO:Math.acos(e)}function DO(e){return e>1?lO:e<-1?-lO:Math.asin(e)}function SO(){}var CO,FO,MO,$O,NO=iO(),TO=iO(),RO={point:SO,lineStart:SO,lineEnd:SO,polygonStart:function(){RO.lineStart=zO,RO.lineEnd=BO},polygonEnd:function(){RO.lineStart=RO.lineEnd=RO.point=SO,NO.add(gO(TO)),TO.reset()},result:function(){var e=NO/2;return NO.reset(),e}};function zO(){RO.point=PO}function PO(e,t){RO.point=LO,CO=MO=e,FO=$O=t}function LO(e,t){TO.add($O*e-MO*t),MO=e,$O=t}function BO(){LO(CO,FO)}var IO=RO,UO=1/0,qO=UO,WO=-UO,HO=WO,GO={point:VO,lineStart:SO,lineEnd:SO,polygonStart:SO,polygonEnd:SO,result:function(){var e=[[UO,qO],[WO,HO]];return WO=HO=-(qO=UO=1/0),e}};function VO(e,t){e<UO&&(UO=e),e>WO&&(WO=e),t<qO&&(qO=t),t>HO&&(HO=t)}var YO,ZO,XO,JO,QO=GO,KO=0,e_=0,t_=0,n_=0,i_=0,r_=0,o_=0,a_=0,s_=0,u_={point:c_,lineStart:l_,lineEnd:h_,polygonStart:function(){u_.lineStart=p_,u_.lineEnd=g_},polygonEnd:function(){u_.point=c_,u_.lineStart=l_,u_.lineEnd=h_},result:function(){var e=s_?[o_/s_,a_/s_]:r_?[n_/r_,i_/r_]:t_?[KO/t_,e_/t_]:[NaN,NaN];return KO=e_=t_=n_=i_=r_=o_=a_=s_=0,e}};function c_(e,t){KO+=e,e_+=t,++t_}function l_(){u_.point=f_}function f_(e,t){u_.point=d_,c_(XO=e,JO=t)}function d_(e,t){var n=e-XO,i=t-JO,r=kO(n*n+i*i);n_+=r*(XO+e)/2,i_+=r*(JO+t)/2,r_+=r,c_(XO=e,JO=t)}function h_(){u_.point=c_}function p_(){u_.point=m_}function g_(){v_(YO,ZO)}function m_(e,t){u_.point=v_,c_(YO=XO=e,ZO=JO=t)}function v_(e,t){var n=e-XO,i=t-JO,r=kO(n*n+i*i);n_+=r*(XO+e)/2,i_+=r*(JO+t)/2,r_+=r,r=JO*e-XO*t,o_+=r*(XO+e),a_+=r*(JO+t),s_+=3*r,c_(XO=e,JO=t)}var b_=u_;function y_(e){this._context=e}y_.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,dO);break}},result:SO};var x_,O_,__,w_,j_,k_=iO(),E_={point:SO,lineStart:function(){E_.point=A_},lineEnd:function(){x_&&D_(O_,__),E_.point=SO},polygonStart:function(){x_=!0},polygonEnd:function(){x_=null},result:function(){var e=+k_;return k_.reset(),e}};function A_(e,t){E_.point=D_,O_=w_=e,__=j_=t}function D_(e,t){w_-=e,j_-=t,k_.add(kO(w_*w_+j_*j_)),w_=e,j_=t}var S_=E_;function C_(){this._string=[]}function F_(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}C_.prototype={_radius:4.5,_circle:F_(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=F_(this._radius)),this._string.push("M",e,",",t,this._circle);break}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var M_=function(e,t){var n,i,r=4.5;function o(e){return e&&("function"===typeof r&&i.pointRadius(+r.apply(this,arguments)),nO(e,n(i))),i.result()}return o.area=function(e){return nO(e,n(IO)),IO.result()},o.measure=function(e){return nO(e,n(S_)),S_.result()},o.bounds=function(e){return nO(e,n(QO)),QO.result()},o.centroid=function(e){return nO(e,n(b_)),b_.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,Xx):(e=t).stream,o):e},o.context=function(e){return arguments.length?(i=null==e?(t=null,new C_):new y_(t=e),"function"!==typeof r&&i.pointRadius(r),o):t},o.pointRadius=function(e){return arguments.length?(r="function"===typeof e?e:(i.pointRadius(+e),+e),o):r},o.projection(e).context(t)},$_=function(){var e,t=[];return{point:function(t,n,i){e.push([t,n,i])},lineStart:function(){t.push(e=[])},lineEnd:SO,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},N_=function(e,t){return gO(e[0]-t[0])<sO&&gO(e[1]-t[1])<sO};function T_(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}var R_=function(e,t,n,i,r){var o,a,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,i=e[0],a=e[t];if(N_(i,a)){if(!i[2]&&!a[2]){for(r.lineStart(),o=0;o<t;++o)r.point((i=e[o])[0],i[1]);return void r.lineEnd()}a[0]+=2*sO}s.push(n=new T_(i,e,null,!0)),u.push(n.o=new T_(i,null,n,!1)),s.push(n=new T_(a,e,null,!1)),u.push(n.o=new T_(a,null,n,!0))}})),s.length){for(u.sort(t),z_(s),z_(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;var c,l,f=s[0];while(1){var d=f,h=!0;while(d.v)if((d=d.n)===f)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,a=c.length;o<a;++o)r.point((l=c[o])[0],l[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,o=c.length-1;o>=0;--o)r.point((l=c[o])[0],l[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}};function z_(e){if(t=e.length){var t,n,i=0,r=e[0];while(++i<t)r.n=n=e[i],n.p=r,r=n;r.n=n=e[0],n.p=r}}function P_(e){return[vO(e[1],e[0]),DO(e[2])]}function L_(e){var t=e[0],n=e[1],i=bO(n);return[i*bO(t),i*wO(t),wO(n)]}function B_(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function I_(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function U_(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function q_(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function W_(e){var t=kO(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var H_=iO();function G_(e){return gO(e[0])<=cO?e[0]:jO(e[0])*((gO(e[0])+cO)%dO-cO)}var V_=function(e,t){var n=G_(t),i=t[1],r=wO(i),o=[wO(n),-bO(n),0],a=0,s=0;H_.reset(),1===r?i=lO+sO:-1===r&&(i=-lO-sO);for(var u=0,c=e.length;u<c;++u)if(f=(l=e[u]).length)for(var l,f,d=l[f-1],h=G_(d),p=d[1]/2+fO,g=wO(p),m=bO(p),v=0;v<f;++v,h=y,g=O,m=_,d=b){var b=l[v],y=G_(b),x=b[1]/2+fO,O=wO(x),_=bO(x),w=y-h,j=w>=0?1:-1,k=j*w,E=k>cO,A=g*O;if(H_.add(vO(A*j*wO(k),m*_+A*bO(k))),a+=E?w+j*dO:w,E^h>=n^y>=n){var D=I_(L_(d),L_(b));W_(D);var S=I_(o,D);W_(S);var C=(E^w>=0?-1:1)*DO(S[2]);(i>C||i===C&&(D[0]||D[1]))&&(s+=E^w>=0?1:-1)}}return(a<-sO||a<sO&&H_<-sO)^1&s},Y_=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Z_=function(e){return 1===e.length&&(e=X_(e)),{left:function(t,n,i,r){null==i&&(i=0),null==r&&(r=t.length);while(i<r){var o=i+r>>>1;e(t[o],n)<0?i=o+1:r=o}return i},right:function(t,n,i,r){null==i&&(i=0),null==r&&(r=t.length);while(i<r){var o=i+r>>>1;e(t[o],n)>0?r=o:i=o+1}return i}}};function X_(e){return function(t,n){return Y_(e(t),n)}}var J_=Z_(Y_);J_.right,J_.left;var Q_=Array.prototype,K_=(Q_.slice,Q_.map,function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);while(++i<r)o[i]=e+i*n;return o});Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var ew=function(e){var t,n,i,r=e.length,o=-1,a=0;while(++o<r)a+=e[o].length;n=new Array(a);while(--r>=0){i=e[r],t=i.length;while(--t>=0)n[--a]=i[t]}return n};var tw=function(e,t,n,i){return function(r){var o,a,s,u=t(r),c=$_(),l=t(c),f=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=b,d.lineEnd=y,a=[],o=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,a=ew(a);var e=V_(o,i);a.length?(f||(r.polygonStart(),f=!0),R_(a,iw,e,n,r)):e&&(f||(r.polygonStart(),f=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),f&&(r.polygonEnd(),f=!1),a=o=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(t,n){e(t,n)&&r.point(t,n)}function p(e,t){u.point(e,t)}function g(){d.point=p,u.lineStart()}function m(){d.point=h,u.lineEnd()}function v(e,t){s.push([e,t]),l.point(e,t)}function b(){l.lineStart(),s=[]}function y(){v(s[0][0],s[0][1]),l.lineEnd();var e,t,n,i,u=l.clean(),d=c.result(),h=d.length;if(s.pop(),o.push(s),s=null,h)if(1&u){if(n=d[0],(t=n.length-1)>0){for(f||(r.polygonStart(),f=!0),r.lineStart(),e=0;e<t;++e)r.point((i=n[e])[0],i[1]);r.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(nw))}return d}};function nw(e){return e.length>1}function iw(e,t){return((e=e.x)[0]<0?e[1]-lO-sO:lO-e[1])-((t=t.x)[0]<0?t[1]-lO-sO:lO-t[1])}var rw=tw((function(){return!0}),ow,sw,[-cO,-lO]);function ow(e){var t,n=NaN,i=NaN,r=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,a){var s=o>0?cO:-cO,u=gO(o-n);gO(u-cO)<sO?(e.point(n,i=(i+a)/2>0?lO:-lO),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(s,i),e.point(o,i),t=0):r!==s&&u>=cO&&(gO(n-r)<sO&&(n-=r*sO),gO(o-s)<sO&&(o-=s*sO),i=aw(n,i,o,a),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(s,i),t=0),e.point(n=o,i=a),r=s},lineEnd:function(){e.lineEnd(),n=i=NaN},clean:function(){return 2-t}}}function aw(e,t,n,i){var r,o,a=wO(e-n);return gO(a)>sO?mO((wO(t)*(o=bO(i))*wO(n)-wO(i)*(r=bO(t))*wO(e))/(r*o*a)):(t+i)/2}function sw(e,t,n,i){var r;if(null==e)r=n*lO,i.point(-cO,r),i.point(0,r),i.point(cO,r),i.point(cO,0),i.point(cO,-r),i.point(0,-r),i.point(-cO,-r),i.point(-cO,0),i.point(-cO,r);else if(gO(e[0]-t[0])>sO){var o=e[0]<t[0]?cO:-cO;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}var uw=function(e,t){function n(n,i){return n=e(n,i),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,i){return n=t.invert(n,i),n&&e.invert(n[0],n[1])}),n};function cw(e,t){return[gO(e)>cO?e+Math.round(-e/dO)*dO:e,t]}function lw(e,t,n){return(e%=dO)?t||n?uw(dw(e),hw(t,n)):dw(e):t||n?hw(t,n):cw}function fw(e){return function(t,n){return t+=e,[t>cO?t-dO:t<-cO?t+dO:t,n]}}function dw(e){var t=fw(e);return t.invert=fw(-e),t}function hw(e,t){var n=bO(e),i=wO(e),r=bO(t),o=wO(t);function a(e,t){var a=bO(t),s=bO(e)*a,u=wO(e)*a,c=wO(t),l=c*n+s*i;return[vO(u*r-l*o,s*n-c*i),DO(l*r+u*o)]}return a.invert=function(e,t){var a=bO(t),s=bO(e)*a,u=wO(e)*a,c=wO(t),l=c*r-u*o;return[vO(u*r+c*o,s*n+l*i),DO(l*n-s*i)]},a}cw.invert=cw;var pw=function(e){function t(t){return t=e(t[0]*pO,t[1]*pO),t[0]*=hO,t[1]*=hO,t}return e=lw(e[0]*pO,e[1]*pO,e.length>2?e[2]*pO:0),t.invert=function(t){return t=e.invert(t[0]*pO,t[1]*pO),t[0]*=hO,t[1]*=hO,t},t};function gw(e,t,n,i,r,o){if(n){var a=bO(t),s=wO(t),u=i*n;null==r?(r=t+i*dO,o=t-u/2):(r=mw(a,r),o=mw(a,o),(i>0?r<o:r>o)&&(r+=i*dO));for(var c,l=r;i>0?l>o:l<o;l-=u)c=P_([a,-s*bO(l),-s*wO(l)]),e.point(c[0],c[1])}}function mw(e,t){t=L_(t),t[0]-=e,W_(t);var n=AO(-t[1]);return((-t[2]<0?-n:n)+dO-sO)%dO}var vw=function(e){var t=bO(e),n=6*pO,i=t>0,r=gO(t)>sO;function o(t,i,r,o){gw(o,e,n,r,t,i)}function a(e,n){return bO(e)*bO(n)>t}function s(e){var t,n,o,s,l;return{lineStart:function(){s=o=!1,l=1},point:function(f,d){var h,p=[f,d],g=a(f,d),m=i?g?0:c(f,d):g?c(f+(f<0?cO:-cO),d):0;if(!t&&(s=o=g)&&e.lineStart(),g!==o&&(h=u(t,p),(!h||N_(t,h)||N_(p,h))&&(p[2]=1)),g!==o)l=0,g?(e.lineStart(),h=u(p,t),e.point(h[0],h[1])):(h=u(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(r&&t&&i^g){var v;m&n||!(v=u(p,t,!0))||(l=0,i?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1],3)))}!g||t&&N_(t,p)||e.point(p[0],p[1]),t=p,o=g,n=m},lineEnd:function(){o&&e.lineEnd(),t=null},clean:function(){return l|(s&&o)<<1}}}function u(e,n,i){var r=L_(e),o=L_(n),a=[1,0,0],s=I_(r,o),u=B_(s,s),c=s[0],l=u-c*c;if(!l)return!i&&e;var f=t*u/l,d=-t*c/l,h=I_(a,s),p=q_(a,f),g=q_(s,d);U_(p,g);var m=h,v=B_(p,m),b=B_(m,m),y=v*v-b*(B_(p,p)-1);if(!(y<0)){var x=kO(y),O=q_(m,(-v-x)/b);if(U_(O,p),O=P_(O),!i)return O;var _,w=e[0],j=n[0],k=e[1],E=n[1];j<w&&(_=w,w=j,j=_);var A=j-w,D=gO(A-cO)<sO,S=D||A<sO;if(!D&&E<k&&(_=k,k=E,E=_),S?D?k+E>0^O[1]<(gO(O[0]-w)<sO?k:E):k<=O[1]&&O[1]<=E:A>cO^(w<=O[0]&&O[0]<=j)){var C=q_(m,(-v+x)/b);return U_(C,p),[O,P_(C)]}}}function c(t,n){var r=i?e:cO-e,o=0;return t<-r?o|=1:t>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return tw(a,s,o,i?[0,-e]:[-cO,e-cO])},bw=function(e,t,n,i,r,o){var a,s=e[0],u=e[1],c=t[0],l=t[1],f=0,d=1,h=c-s,p=l-u;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<f)return;a<d&&(d=a)}else if(h>0){if(a>d)return;a>f&&(f=a)}if(a=r-s,h||!(a<0)){if(a/=h,h<0){if(a>d)return;a>f&&(f=a)}else if(h>0){if(a<f)return;a<d&&(d=a)}if(a=i-u,p||!(a>0)){if(a/=p,p<0){if(a<f)return;a<d&&(d=a)}else if(p>0){if(a>d)return;a>f&&(f=a)}if(a=o-u,p||!(a<0)){if(a/=p,p<0){if(a>d)return;a>f&&(f=a)}else if(p>0){if(a<f)return;a<d&&(d=a)}return f>0&&(e[0]=s+f*h,e[1]=u+f*p),d<1&&(t[0]=s+d*h,t[1]=u+d*p),!0}}}}},yw=1e9,xw=-yw;function Ow(e,t,n,i){function r(r,o){return e<=r&&r<=n&&t<=o&&o<=i}function o(r,o,s,c){var l=0,f=0;if(null==r||(l=a(r,s))!==(f=a(o,s))||u(r,o)<0^s>0)do{c.point(0===l||3===l?e:n,l>1?i:t)}while((l=(l+s+4)%4)!==f);else c.point(o[0],o[1])}function a(i,r){return gO(i[0]-e)<sO?r>0?0:3:gO(i[0]-n)<sO?r>0?2:1:gO(i[1]-t)<sO?r>0?1:0:r>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=a(e,1),i=a(t,1);return n!==i?n-i:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(a){var u,c,l,f,d,h,p,g,m,v,b,y=a,x=$_(),O={point:_,lineStart:E,lineEnd:A,polygonStart:j,polygonEnd:k};function _(e,t){r(e,t)&&y.point(e,t)}function w(){for(var t=0,n=0,r=c.length;n<r;++n)for(var o,a,s=c[n],u=1,l=s.length,f=s[0],d=f[0],h=f[1];u<l;++u)o=d,a=h,f=s[u],d=f[0],h=f[1],a<=i?h>i&&(d-o)*(i-a)>(h-a)*(e-o)&&++t:h<=i&&(d-o)*(i-a)<(h-a)*(e-o)&&--t;return t}function j(){y=x,u=[],c=[],b=!0}function k(){var e=w(),t=b&&e,n=(u=ew(u)).length;(t||n)&&(a.polygonStart(),t&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),n&&R_(u,s,e,o,a),a.polygonEnd()),y=a,u=c=l=null}function E(){O.point=D,c&&c.push(l=[]),v=!0,m=!1,p=g=NaN}function A(){u&&(D(f,d),h&&m&&x.rejoin(),u.push(x.result())),O.point=_,m&&y.lineEnd()}function D(o,a){var s=r(o,a);if(c&&l.push([o,a]),v)f=o,d=a,h=s,v=!1,s&&(y.lineStart(),y.point(o,a));else if(s&&m)y.point(o,a);else{var u=[p=Math.max(xw,Math.min(yw,p)),g=Math.max(xw,Math.min(yw,g))],x=[o=Math.max(xw,Math.min(yw,o)),a=Math.max(xw,Math.min(yw,a))];bw(u,x,e,t,n,i)?(m||(y.lineStart(),y.point(u[0],u[1])),y.point(x[0],x[1]),s||y.lineEnd(),b=!1):s&&(y.lineStart(),y.point(o,a),b=!1)}p=o,g=a,m=s}return O}}function _w(e){return function(t){var n=new ww;for(var i in e)n[i]=e[i];return n.stream=t,n}}function ww(){}function jw(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),nO(n,e.stream(QO)),t(QO.result()),null!=i&&e.clipExtent(i),e}function kw(e,t,n){return jw(e,(function(n){var i=t[1][0]-t[0][0],r=t[1][1]-t[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),a=+t[0][0]+(i-o*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(r-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([a,s])}),n)}function Ew(e,t,n){return kw(e,[[0,0],t],n)}function Aw(e,t,n){return jw(e,(function(n){var i=+t,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,a=-r*n[0][1];e.scale(150*r).translate([o,a])}),n)}function Dw(e,t,n){return jw(e,(function(n){var i=+t,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],a=(i-r*(n[1][1]+n[0][1]))/2;e.scale(150*r).translate([o,a])}),n)}ww.prototype={constructor:ww,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Sw=16,Cw=bO(30*pO),Fw=function(e,t){return+t?$w(e,t):Mw(e)};function Mw(e){return _w({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function $w(e,t){function n(i,r,o,a,s,u,c,l,f,d,h,p,g,m){var v=c-i,b=l-r,y=v*v+b*b;if(y>4*t&&g--){var x=a+d,O=s+h,_=u+p,w=kO(x*x+O*O+_*_),j=DO(_/=w),k=gO(gO(_)-1)<sO||gO(o-f)<sO?(o+f)/2:vO(O,x),E=e(k,j),A=E[0],D=E[1],S=A-i,C=D-r,F=b*S-v*C;(F*F/y>t||gO((v*S+b*C)/y-.5)>.3||a*d+s*h+u*p<Cw)&&(n(i,r,o,a,s,u,A,D,k,x/=w,O/=w,_,g,m),m.point(A,D),n(A,D,k,x,O,_,c,l,f,d,h,p,g,m))}}return function(t){var i,r,o,a,s,u,c,l,f,d,h,p,g={point:m,lineStart:v,lineEnd:y,polygonStart:function(){t.polygonStart(),g.lineStart=x},polygonEnd:function(){t.polygonEnd(),g.lineStart=v}};function m(n,i){n=e(n,i),t.point(n[0],n[1])}function v(){l=NaN,g.point=b,t.lineStart()}function b(i,r){var o=L_([i,r]),a=e(i,r);n(l,f,c,d,h,p,l=a[0],f=a[1],c=i,d=o[0],h=o[1],p=o[2],Sw,t),t.point(l,f)}function y(){g.point=m,t.lineEnd()}function x(){v(),g.point=O,g.lineEnd=_}function O(e,t){b(i=e,t),r=l,o=f,a=d,s=h,u=p,g.point=b}function _(){n(l,f,c,d,h,p,r,o,i,a,s,u,Sw,t),g.lineEnd=y,y()}return g}}var Nw=_w({point:function(e,t){this.stream.point(e*pO,t*pO)}});function Tw(e){return _w({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function Rw(e,t,n,i,r){function o(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return o.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},o}function zw(e,t,n,i,r,o){var a=bO(o),s=wO(o),u=a*e,c=s*e,l=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function p(e,o){return e*=i,o*=r,[u*e-c*o+t,n-c*e-u*o]}return p.invert=function(e,t){return[i*(l*e-f*t+d),r*(h-f*e-l*t)]},p}function Pw(e){return Lw((function(){return e}))()}function Lw(e){var t,n,i,r,o,a,s,u,c,l,f=150,d=480,h=250,p=0,g=0,m=0,v=0,b=0,y=0,x=1,O=1,_=null,w=rw,j=null,k=Xx,E=.5;function A(e){return u(e[0]*pO,e[1]*pO)}function D(e){return e=u.invert(e[0],e[1]),e&&[e[0]*hO,e[1]*hO]}function S(){var e=zw(f,0,0,x,O,y).apply(null,t(p,g)),i=(y?zw:Rw)(f,d-e[0],h-e[1],x,O,y);return n=lw(m,v,b),s=uw(t,i),u=uw(n,s),a=Fw(s,E),C()}function C(){return c=l=null,A}return A.stream=function(e){return c&&l===e?c:c=Nw(Tw(n)(w(a(k(l=e)))))},A.preclip=function(e){return arguments.length?(w=e,_=void 0,C()):w},A.postclip=function(e){return arguments.length?(k=e,j=i=r=o=null,C()):k},A.clipAngle=function(e){return arguments.length?(w=+e?vw(_=e*pO):(_=null,rw),C()):_*hO},A.clipExtent=function(e){return arguments.length?(k=null==e?(j=i=r=o=null,Xx):Ow(j=+e[0][0],i=+e[0][1],r=+e[1][0],o=+e[1][1]),C()):null==j?null:[[j,i],[r,o]]},A.scale=function(e){return arguments.length?(f=+e,S()):f},A.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],S()):[d,h]},A.center=function(e){return arguments.length?(p=e[0]%360*pO,g=e[1]%360*pO,S()):[p*hO,g*hO]},A.rotate=function(e){return arguments.length?(m=e[0]%360*pO,v=e[1]%360*pO,b=e.length>2?e[2]%360*pO:0,S()):[m*hO,v*hO,b*hO]},A.angle=function(e){return arguments.length?(y=e%360*pO,S()):y*hO},A.reflectX=function(e){return arguments.length?(x=e?-1:1,S()):x<0},A.reflectY=function(e){return arguments.length?(O=e?-1:1,S()):O<0},A.precision=function(e){return arguments.length?(a=Fw(s,E=e*e),C()):kO(E)},A.fitExtent=function(e,t){return kw(A,e,t)},A.fitSize=function(e,t){return Ew(A,e,t)},A.fitWidth=function(e,t){return Aw(A,e,t)},A.fitHeight=function(e,t){return Dw(A,e,t)},function(){return t=e.apply(this,arguments),A.invert=t.invert&&D,S()}}function Bw(e){var t=0,n=cO/3,i=Lw(e),r=i(t,n);return r.parallels=function(e){return arguments.length?i(t=e[0]*pO,n=e[1]*pO):[t*hO,n*hO]},r}function Iw(e){var t=bO(e);function n(e,n){return[e*t,wO(n)/t]}return n.invert=function(e,n){return[e/t,DO(n*t)]},n}function Uw(e,t){var n=wO(e),i=(n+wO(t))/2;if(gO(i)<sO)return Iw(e);var r=1+n*(2*i-n),o=kO(r)/i;function a(e,t){var n=kO(r-2*i*wO(t))/i;return[n*wO(e*=i),o-n*bO(e)]}return a.invert=function(e,t){var n=o-t,a=vO(e,gO(n))*jO(n);return n*i<0&&(a-=cO*jO(e)*jO(n)),[a/i,DO((r-(e*e+n*n)*i*i)/(2*i))]},a}var qw=function(){return Bw(Uw).scale(155.424).center([0,33.6442])},Ww=function(){return qw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function Hw(e){var t=e.length;return{point:function(n,i){var r=-1;while(++r<t)e[r].point(n,i)},sphere:function(){var n=-1;while(++n<t)e[n].sphere()},lineStart:function(){var n=-1;while(++n<t)e[n].lineStart()},lineEnd:function(){var n=-1;while(++n<t)e[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<t)e[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<t)e[n].polygonEnd()}}}var Gw=function(){var e,t,n,i,r,o,a=Ww(),s=qw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=qw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){o=[e,t]}};function l(e){var t=e[0],a=e[1];return o=null,n.point(t,a),o||(i.point(t,a),o)||(r.point(t,a),o)}function f(){return e=t=null,l}return l.invert=function(e){var t=a.scale(),n=a.translate(),i=(e[0]-n[0])/t,r=(e[1]-n[1])/t;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?s:r>=.166&&r<.234&&i>=-.214&&i<-.115?u:a).invert(e)},l.stream=function(n){return e&&t===n?e:e=Hw([a.stream(t=n),s.stream(n),u.stream(n)])},l.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),u.precision(e),f()):a.precision()},l.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),u.scale(e),l.translate(a.translate())):a.scale()},l.translate=function(e){if(!arguments.length)return a.translate();var t=a.scale(),o=+e[0],l=+e[1];return n=a.translate(e).clipExtent([[o-.455*t,l-.238*t],[o+.455*t,l+.238*t]]).stream(c),i=s.translate([o-.307*t,l+.201*t]).clipExtent([[o-.425*t+sO,l+.12*t+sO],[o-.214*t-sO,l+.234*t-sO]]).stream(c),r=u.translate([o-.205*t,l+.212*t]).clipExtent([[o-.214*t+sO,l+.166*t+sO],[o-.115*t-sO,l+.234*t-sO]]).stream(c),f()},l.fitExtent=function(e,t){return kw(l,e,t)},l.fitSize=function(e,t){return Ew(l,e,t)},l.fitWidth=function(e,t){return Aw(l,e,t)},l.fitHeight=function(e,t){return Dw(l,e,t)},l.scale(1070)};function Vw(e){return function(t,n){var i=bO(t),r=bO(n),o=e(i*r);return[o*r*wO(t),o*wO(n)]}}function Yw(e){return function(t,n){var i=kO(t*t+n*n),r=e(i),o=wO(r),a=bO(r);return[vO(t*o,i*a),DO(i&&n*o/i)]}}var Zw=Vw((function(e){return kO(2/(1+e))}));Zw.invert=Yw((function(e){return 2*DO(e/2)}));var Xw=function(){return Pw(Zw).scale(124.75).clipAngle(179.999)},Jw=Vw((function(e){return(e=AO(e))&&e/wO(e)}));Jw.invert=Yw((function(e){return e}));var Qw=function(){return Pw(Jw).scale(79.4188).clipAngle(179.999)};function Kw(e,t){return[e,OO(EO((lO+t)/2))]}Kw.invert=function(e,t){return[e,2*mO(xO(t))-lO]};var ej=function(){return tj(Kw).scale(961/dO)};function tj(e){var t,n,i,r=Pw(e),o=r.center,a=r.scale,s=r.translate,u=r.clipExtent,c=null;function l(){var o=cO*a(),s=r(pw(r.rotate()).invert([0,0]));return u(null==c?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:e===Kw?[[Math.max(s[0]-o,c),t],[Math.min(s[0]+o,n),i]]:[[c,Math.max(s[1]-o,t)],[n,Math.min(s[1]+o,i)]])}return r.scale=function(e){return arguments.length?(a(e),l()):a()},r.translate=function(e){return arguments.length?(s(e),l()):s()},r.center=function(e){return arguments.length?(o(e),l()):o()},r.clipExtent=function(e){return arguments.length?(null==e?c=t=n=i=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],i=+e[1][1]),l()):null==c?null:[[c,t],[n,i]]},l()}function nj(e){return EO((lO+e)/2)}function ij(e,t){var n=bO(e),i=e===t?wO(e):OO(n/bO(t))/OO(nj(t)/nj(e)),r=n*_O(nj(e),i)/i;if(!i)return Kw;function o(e,t){r>0?t<-lO+sO&&(t=-lO+sO):t>lO-sO&&(t=lO-sO);var n=r/_O(nj(t),i);return[n*wO(i*e),r-n*bO(i*e)]}return o.invert=function(e,t){var n=r-t,o=jO(i)*kO(e*e+n*n),a=vO(e,gO(n))*jO(n);return n*i<0&&(a-=cO*jO(e)*jO(n)),[a/i,2*mO(_O(r/o,1/i))-lO]},o}var rj=function(){return Bw(ij).scale(109.5).parallels([30,30])};function oj(e,t){return[e,t]}oj.invert=oj;var aj=function(){return Pw(oj).scale(152.63)};function sj(e,t){var n=bO(e),i=e===t?wO(e):(n-bO(t))/(t-e),r=n/i+e;if(gO(i)<sO)return oj;function o(e,t){var n=r-t,o=i*e;return[n*wO(o),r-n*bO(o)]}return o.invert=function(e,t){var n=r-t,o=vO(e,gO(n))*jO(n);return n*i<0&&(o-=cO*jO(e)*jO(n)),[o/i,r-jO(i)*kO(e*e+n*n)]},o}var uj=function(){return Bw(sj).scale(131.154).center([0,13.9389])},cj=1.340264,lj=-.081106,fj=893e-6,dj=.003796,hj=kO(3)/2,pj=12;function gj(e,t){var n=DO(hj*wO(t)),i=n*n,r=i*i*i;return[e*bO(n)/(hj*(cj+3*lj*i+r*(7*fj+9*dj*i))),n*(cj+lj*i+r*(fj+dj*i))]}gj.invert=function(e,t){for(var n,i,r,o=t,a=o*o,s=a*a*a,u=0;u<pj;++u)if(i=o*(cj+lj*a+s*(fj+dj*a))-t,r=cj+3*lj*a+s*(7*fj+9*dj*a),o-=n=i/r,a=o*o,s=a*a*a,gO(n)<uO)break;return[hj*e*(cj+3*lj*a+s*(7*fj+9*dj*a))/bO(o),DO(wO(o)/hj)]};var mj=function(){return Pw(gj).scale(177.158)};function vj(e,t){var n=bO(t),i=bO(e)*n;return[n*wO(e)/i,wO(t)/i]}vj.invert=Yw(mO);var bj=function(){return Pw(vj).scale(144.049).clipAngle(60)},yj=function(){var e,t,n,i,r,o,a,s=1,u=0,c=0,l=1,f=1,d=0,h=null,p=1,g=1,m=_w({point:function(e,t){var n=y([e,t]);this.stream.point(n[0],n[1])}}),v=Xx;function b(){return p=s*l,g=s*f,o=a=null,y}function y(n){var i=n[0]*p,r=n[1]*g;if(d){var o=r*e-i*t;i=i*e+r*t,r=o}return[i+u,r+c]}return y.invert=function(n){var i=n[0]-u,r=n[1]-c;if(d){var o=r*e+i*t;i=i*e-r*t,r=o}return[i/p,r/g]},y.stream=function(e){return o&&a===e?o:o=m(v(a=e))},y.postclip=function(e){return arguments.length?(v=e,h=n=i=r=null,b()):v},y.clipExtent=function(e){return arguments.length?(v=null==e?(h=n=i=r=null,Xx):Ow(h=+e[0][0],n=+e[0][1],i=+e[1][0],r=+e[1][1]),b()):null==h?null:[[h,n],[i,r]]},y.scale=function(e){return arguments.length?(s=+e,b()):s},y.translate=function(e){return arguments.length?(u=+e[0],c=+e[1],b()):[u,c]},y.angle=function(n){return arguments.length?(d=n%360*pO,t=wO(d),e=bO(d),b()):d*hO},y.reflectX=function(e){return arguments.length?(l=e?-1:1,b()):l<0},y.reflectY=function(e){return arguments.length?(f=e?-1:1,b()):f<0},y.fitExtent=function(e,t){return kw(y,e,t)},y.fitSize=function(e,t){return Ew(y,e,t)},y.fitWidth=function(e,t){return Aw(y,e,t)},y.fitHeight=function(e,t){return Dw(y,e,t)},y};function xj(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}xj.invert=function(e,t){var n,i=t,r=25;do{var o=i*i,a=o*o;i-=n=(i*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-t)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(gO(n)>sO&&--r>0);return[e/(.8707+(o=i*i)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),i]};var Oj=function(){return Pw(xj).scale(175.295)};function _j(e,t){return[bO(t)*wO(e),wO(t)]}_j.invert=Yw(DO);var wj=function(){return Pw(_j).scale(249.5).clipAngle(90+sO)};function jj(e,t){var n=bO(t),i=1+bO(e)*n;return[n*wO(e)/i,wO(t)/i]}jj.invert=Yw((function(e){return 2*mO(e)}));var kj=function(){return Pw(jj).scale(250).clipAngle(142)};function Ej(e,t){return[OO(EO((lO+t)/2)),-e]}Ej.invert=function(e,t){return[-t,2*mO(xO(e))-lO]};var Aj=function(){var e=tj(Ej),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90]).scale(159.155)},Dj=Math.abs,Sj=(Math.atan,Math.atan2,Math.ceil,Math.cos),Cj=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),Fj=(Math.tan,1e-6),Mj=Math.PI,$j=Mj/2,Nj=(Math.SQRT1_2,Rj(2));Rj(Mj);function Tj(e){return e>1?$j:e<-1?-$j:Math.asin(e)}function Rj(e){return e>0?Math.sqrt(e):0}function zj(e,t){var n,i=e*Cj(t),r=30;do{t-=n=(t+Cj(t)-i)/(1+Sj(t))}while(Dj(n)>Fj&&--r>0);return t/2}function Pj(e,t,n){function i(i,r){return[e*i*Sj(r=zj(n,r)),t*Cj(r)]}return i.invert=function(i,r){return r=Tj(r/t),[i/(e*Sj(r)),Tj((2*r+Cj(2*r))/n)]},i}var Lj=Pj(Nj/$j,Nj,Mj),Bj=function(){return Pw(Lj).scale(169.529)},Ij=M_(),Uj=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function qj(e,t){return function n(){var i=t();return i.type=e,i.path=M_().projection(i),i.copy=i.copy||function(){var e=n();return Uj.forEach((function(t){i[t]&&e[t](i[t]())})),e.path.pointRadius(i.path.pointRadius()),e},i}}function Wj(e,t){if(!e||"string"!==typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Gj[e]=qj(e,t),this):Gj[e]||null}function Hj(e){return e&&e.path||Ij}var Gj={albers:Ww,albersusa:Gw,azimuthalequalarea:Xw,azimuthalequidistant:Qw,conicconformal:rj,conicequalarea:qw,conicequidistant:uj,equalEarth:mj,equirectangular:aj,gnomonic:bj,identity:yj,mercator:ej,mollweide:Bj,naturalEarth1:Oj,orthographic:wj,stereographic:kj,transversemercator:Aj};for(var Vj in Gj)Wj(Vj,Gj[Vj]);function Yj(e){Yi.call(this,null,e)}Yj.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};var Zj=Object(h["y"])(Yj,Yi);function Xj(e,t){var n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}function Jj(e){Yi.call(this,null,e)}Zj.transform=function(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||h["x"],o=e.as||"path",a=n.SOURCE;function s(e){e[o]=i(r(e))}!i||e.modified()?(this.value=i=Hj(e.projection),n.materialize().reflow()):a=r===h["x"]||t.modified(r.fields)?n.ADD_MOD:n.ADD;var u=Xj(i,e.pointRadius);return n.visit(a,s),i.pointRadius(u),n.modifies(o)},Jj.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};var Qj=Object(h["y"])(Jj,Yi);function Kj(e){Yi.call(this,null,e)}Qj.transform=function(e,t){var n,i=e.projection,r=e.fields[0],o=e.fields[1],a=e.as||["x","y"],s=a[0],u=a[1];function c(e){var t=i([r(e),o(e)]);t?(e[s]=t[0],e[u]=t[1]):(e[s]=void 0,e[u]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,c):(n=t.modified(r.fields)||t.modified(o.fields),t.visit(n?t.ADD_MOD:t.ADD,c)),t.modifies(a)},Kj.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};var ek=Object(h["y"])(Kj,Yi);function tk(e,t,n){var i=null==n?function(n){return e(t(n))}:function(i){var r=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(r),o};return i.context=function(t){return e.context(t),i},i}function nk(e,t,n){var i=K_(e,t-sO,n).concat(t);return function(e){return i.map((function(t){return[e,t]}))}}function ik(e,t,n){var i=K_(e,t-sO,n).concat(t);return function(e){return i.map((function(t){return[t,e]}))}}function rk(){var e,t,n,i,r,o,a,s,u,c,l,f,d=10,h=d,p=90,g=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:b()}}function b(){return K_(yO(i/p)*p,n,p).map(l).concat(K_(yO(s/g)*g,a,g).map(f)).concat(K_(yO(t/d)*d,e,d).filter((function(e){return gO(e%p)>sO})).map(u)).concat(K_(yO(o/h)*h,r,h).filter((function(e){return gO(e%g)>sO})).map(c))}return v.lines=function(){return b().map((function(e){return{type:"LineString",coordinates:e}}))},v.outline=function(){return{type:"Polygon",coordinates:[l(i).concat(f(a).slice(1),l(n).reverse().slice(1),f(s).reverse().slice(1))]}},v.extent=function(e){return arguments.length?v.extentMajor(e).extentMinor(e):v.extentMinor()},v.extentMajor=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],i>n&&(e=i,i=n,n=e),s>a&&(e=s,s=a,a=e),v.precision(m)):[[i,s],[n,a]]},v.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],o=+n[0][1],r=+n[1][1],t>e&&(n=t,t=e,e=n),o>r&&(n=o,o=r,r=n),v.precision(m)):[[t,o],[e,r]]},v.step=function(e){return arguments.length?v.stepMajor(e).stepMinor(e):v.stepMinor()},v.stepMajor=function(e){return arguments.length?(p=+e[0],g=+e[1],v):[p,g]},v.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],v):[d,h]},v.precision=function(d){return arguments.length?(m=+d,u=nk(o,r,90),c=ik(t,e,m),l=nk(s,a,90),f=ik(i,n,m),v):m},v.extentMajor([[-180,-90+sO],[180,90-sO]]).extentMinor([[-180,-80-sO],[180,80+sO]])}function ok(e){Yi.call(this,[],e),this.generator=rk()}ek.transform=function(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",o=n.ADD;return i&&!e.modified()||(this.value=i=tk(Hj(e.projection),e.field||Object(h["t"])("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(function(e){e[r]=i})),n.modifies(r)},ok.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};var ak=Object(h["y"])(ok,Yi);ak.transform=function(e,t){var n,i=this.value,r=this.generator;if(!i.length||e.modified())for(var o in e)Object(h["D"])(r[o])&&r[o](e[o]);return n=r(),i.length?t.mod.push(j(i[0],n)):t.add.push(O(n)),i[0]=n,t};var sk=n("166a");function uk(e){Yi.call(this,null,e)}uk.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};var ck=Object(h["y"])(uk,Yi);function lk(e,t){let n;return Object(h["D"])(e)?(n=n=>Object(sk["g"])(e(n,t)),n.dep=dk(e)):n=Object(h["l"])(Object(sk["g"])(e||"#888")),n}function fk(e,t){let n;return Object(h["D"])(e)?(n=n=>e(n,t),n.dep=dk(e)):e?n=Object(h["l"])(e):(n=e=>e.$value/e.$max||0,n.dep=!0),n}function dk(e){if(!Object(h["D"])(e))return!1;const t=Object(h["db"])(Object(h["g"])(e));return t.$x||t.$y||t.$value||t.$max}function hk(e,t,n,i){const r=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||r,c=e.y2||o,l=e.values,f=l?e=>l[e]:h["kb"],d=yl(u-a,c-s),p=d.getContext("2d"),g=p.getImageData(0,0,u-a,c-s),m=g.data;for(let h=s,v=0;h<c;++h){t.$y=h-s;for(let e=a,o=h*r;e<u;++e,v+=4){t.$x=e-a,t.$value=f(e+o);const r=n(t);m[v+0]=r.r,m[v+1]=r.g,m[v+2]=r.b,m[v+3]=~~(255*i(t))}}return p.putImageData(g,0,0),d}function pk(e){Yi.call(this,null,e),this.modified(!0)}ck.transform=function(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i="shared"===e.resolve,r=e.field||h["x"],o=fk(e.opacity,e),a=lk(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?mr(n.map(e=>mr(r(e).values))):0};return n.forEach(e=>{const t=r(e),n=Object(h["o"])({},e,u);i||(n.$max=mr(t.values||[])),e[s]=hk(t,n,a.dep?a:Object(h["l"])(a(n)),o.dep?o:Object(h["l"])(o(n)))}),t.reflow(!0).modifies(s)};var gk=Object(h["y"])(pk,Yi);function mk(e,t){var n=yk(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function vk(e){var t=Wj((e||"mercator").toLowerCase());return t||Object(h["n"])("Unrecognized projection type: "+e),t()}function bk(e,t,n){Object(h["D"])(e[t])&&e[t](n)}function yk(e){return e=Object(h["i"])(e),1===e.length?e[0]:{type:Gx,features:e.reduce((e,t)=>e.concat(xk(t)),[])}}function xk(e){return e.type===Gx?e.features:Object(h["i"])(e).filter(e=>null!=e).map(e=>e.type===Hx?e:{type:Hx,geometry:e})}gk.transform=function(e,t){var n=this.value;return!n||e.modified("type")?(this.value=n=vk(e.type),Uj.forEach((function(t){null!=e[t]&&bk(n,t,e[t])}))):Uj.forEach((function(t){e.modified(t)&&bk(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&mk(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var Ok=function(e,t){var n;function i(){var i,r,o=n.length,a=0,s=0;for(i=0;i<o;++i)r=n[i],a+=r.x,s+=r.y;for(a=a/o-e,s=s/o-t,i=0;i<o;++i)r=n[i],r.x-=a,r.y-=s}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i},_k=n("cfa1"),wk=function(e){return function(){return e}},jk=function(){return 1e-6*(Math.random()-.5)};function kk(e){return e.x+e.vx}function Ek(e){return e.y+e.vy}var Ak=function(e){var t,n,i=1,r=1;function o(){for(var e,o,s,u,c,l,f,d=t.length,h=0;h<r;++h)for(o=Object(_k["a"])(t,kk,Ek).visitAfter(a),e=0;e<d;++e)s=t[e],l=n[s.index],f=l*l,u=s.x+s.vx,c=s.y+s.vy,o.visit(p);function p(e,t,n,r,o){var a=e.data,d=e.r,h=l+d;if(!a)return t>u+h||r<u-h||n>c+h||o<c-h;if(a.index>s.index){var p=u-a.x-a.vx,g=c-a.y-a.vy,m=p*p+g*g;m<h*h&&(0===p&&(p=jk(),m+=p*p),0===g&&(g=jk(),m+=g*g),m=(h-(m=Math.sqrt(m)))/m*i,s.vx+=(p*=m)*(h=(d*=d)/(f+d)),s.vy+=(g*=m)*h,a.vx-=p*(h=1-h),a.vy-=g*h)}}}function a(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function s(){if(t){var i,r,o=t.length;for(n=new Array(o),i=0;i<o;++i)r=t[i],n[r.index]=+e(r,i,t)}}return"function"!==typeof e&&(e=wk(null==e?1:+e)),o.initialize=function(e){t=e,s()},o.iterations=function(e){return arguments.length?(r=+e,o):r},o.strength=function(e){return arguments.length?(i=+e,o):i},o.radius=function(t){return arguments.length?(e="function"===typeof t?t:wk(+t),s(),o):e},o};function Dk(e){return e.index}function Sk(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}var Ck=function(e){var t,n,i,r,o,a=Dk,s=l,u=wk(30),c=1;function l(e){return 1/Math.min(r[e.source.index],r[e.target.index])}function f(i){for(var r=0,a=e.length;r<c;++r)for(var s,u,l,f,d,h,p,g=0;g<a;++g)s=e[g],u=s.source,l=s.target,f=l.x+l.vx-u.x-u.vx||jk(),d=l.y+l.vy-u.y-u.vy||jk(),h=Math.sqrt(f*f+d*d),h=(h-n[g])/h*i*t[g],f*=h,d*=h,l.vx-=f*(p=o[g]),l.vy-=d*p,u.vx+=f*(p=1-p),u.vy+=d*p}function d(){if(i){var s,u,c=i.length,l=e.length,f=new Map(i.map((e,t)=>[a(e,t,i),e]));for(s=0,r=new Array(c);s<l;++s)u=e[s],u.index=s,"object"!==typeof u.source&&(u.source=Sk(f,u.source)),"object"!==typeof u.target&&(u.target=Sk(f,u.target)),r[u.source.index]=(r[u.source.index]||0)+1,r[u.target.index]=(r[u.target.index]||0)+1;for(s=0,o=new Array(l);s<l;++s)u=e[s],o[s]=r[u.source.index]/(r[u.source.index]+r[u.target.index]);t=new Array(l),h(),n=new Array(l),p()}}function h(){if(i)for(var n=0,r=e.length;n<r;++n)t[n]=+s(e[n],n,e)}function p(){if(i)for(var t=0,r=e.length;t<r;++t)n[t]=+u(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e){i=e,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(a=e,f):a},f.iterations=function(e){return arguments.length?(c=+e,f):c},f.strength=function(e){return arguments.length?(s="function"===typeof e?e:wk(+e),h(),f):s},f.distance=function(e){return arguments.length?(u="function"===typeof e?e:wk(+e),p(),f):u},f},Fk=n("c68f"),Mk=n("74f4");function $k(e){return e.x}function Nk(e){return e.y}var Tk=10,Rk=Math.PI*(3-Math.sqrt(5)),zk=function(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,u=Object(Mk["c"])(l),c=Object(Fk["a"])("tick","end");function l(){f(),c.call("tick",t),n<i&&(u.stop(),c.call("end",t))}function f(i){var u,c,l=e.length;void 0===i&&(i=1);for(var f=0;f<i;++f)for(n+=(o-n)*r,s.forEach((function(e){e(n)})),u=0;u<l;++u)c=e[u],null==c.fx?c.x+=c.vx*=a:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=a:(c.y=c.fy,c.vy=0);return t}function d(){for(var t,n=0,i=e.length;n<i;++n){if(t=e[n],t.index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var r=Tk*Math.sqrt(n),o=n*Rk;t.x=r*Math.cos(o),t.y=r*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function h(t){return t.initialize&&t.initialize(e),t}return null==e&&(e=[]),d(),t={tick:f,restart:function(){return u.restart(l),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,d(),s.forEach(h),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(i=+e,t):i},alphaDecay:function(e){return arguments.length?(r=+e,t):+r},alphaTarget:function(e){return arguments.length?(o=+e,t):o},velocityDecay:function(e){return arguments.length?(a=1-e,t):1-a},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,h(n)),t):s.get(e)},find:function(t,n,i){var r,o,a,s,u,c=0,l=e.length;for(null==i?i=1/0:i*=i,c=0;c<l;++c)s=e[c],r=t-s.x,o=n-s.y,a=r*r+o*o,a<i&&(u=s,i=a);return u},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}},Pk=function(){var e,t,n,i,r=wk(-30),o=1,a=1/0,s=.81;function u(i){var r,o=e.length,a=Object(_k["a"])(e,$k,Nk).visitAfter(l);for(n=i,r=0;r<o;++r)t=e[r],a.visit(f)}function c(){if(e){var t,n,o=e.length;for(i=new Array(o),t=0;t<o;++t)n=e[t],i[n.index]=+r(n,t,e)}}function l(e){var t,n,r,o,a,s=0,u=0;if(e.length){for(r=o=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(s+=t.value,u+=n,r+=n*t.x,o+=n*t.y);e.x=r/u,e.y=o/u}else{t=e,t.x=t.data.x,t.y=t.data.y;do{s+=i[t.data.index]}while(t=t.next)}e.value=s}function f(e,r,u,c){if(!e.value)return!0;var l=e.x-t.x,f=e.y-t.y,d=c-r,h=l*l+f*f;if(d*d/s<h)return h<a&&(0===l&&(l=jk(),h+=l*l),0===f&&(f=jk(),h+=f*f),h<o&&(h=Math.sqrt(o*h)),t.vx+=l*e.value*n/h,t.vy+=f*e.value*n/h),!0;if(!(e.length||h>=a)){(e.data!==t||e.next)&&(0===l&&(l=jk(),h+=l*l),0===f&&(f=jk(),h+=f*f),h<o&&(h=Math.sqrt(o*h)));do{e.data!==t&&(d=i[e.data.index]*n/h,t.vx+=l*d,t.vy+=f*d)}while(e=e.next)}}return u.initialize=function(t){e=t,c()},u.strength=function(e){return arguments.length?(r="function"===typeof e?e:wk(+e),c(),u):r},u.distanceMin=function(e){return arguments.length?(o=e*e,u):Math.sqrt(o)},u.distanceMax=function(e){return arguments.length?(a=e*e,u):Math.sqrt(a)},u.theta=function(e){return arguments.length?(s=e*e,u):Math.sqrt(s)},u},Lk=function(e){var t,n,i,r=wk(.1);function o(e){for(var r,o=0,a=t.length;o<a;++o)r=t[o],r.vx+=(i[o]-r.x)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),i=new Array(a),o=0;o<a;++o)n[o]=isNaN(i[o]=+e(t[o],o,t))?0:+r(t[o],o,t)}}return"function"!==typeof e&&(e=wk(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(r="function"===typeof e?e:wk(+e),a(),o):r},o.x=function(t){return arguments.length?(e="function"===typeof t?t:wk(+t),a(),o):e},o},Bk=function(e){var t,n,i,r=wk(.1);function o(e){for(var r,o=0,a=t.length;o<a;++o)r=t[o],r.vy+=(i[o]-r.y)*n[o]*e}function a(){if(t){var o,a=t.length;for(n=new Array(a),i=new Array(a),o=0;o<a;++o)n[o]=isNaN(i[o]=+e(t[o],o,t))?0:+r(t[o],o,t)}}return"function"!==typeof e&&(e=wk(null==e?0:+e)),o.initialize=function(e){t=e,a()},o.strength=function(e){return arguments.length?(r="function"===typeof e?e:wk(+e),a(),o):r},o.y=function(t){return arguments.length?(e="function"===typeof t?t:wk(+t),a(),o):e},o},Ik={center:Ok,collide:Ak,nbody:Pk,link:Ck,x:Lk,y:Bk},Uk="forces",qk=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Wk=["static","iterations"],Hk=["x","y","vx","vy"];function Gk(e){Yi.call(this,null,e)}Gk.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Hk}]};var Vk=Object(h["y"])(Gk,Yi);function Yk(e,t){return function(){e.touch(t).run()}}function Zk(e,t){var n=zk(e),i=!1,r=n.stop,o=n.restart;return n.stopped=function(){return i},n.restart=function(){return i=!1,o()},n.stop=function(){return i=!0,r()},Xk(n,t,!0).on("end",(function(){i=!0}))}function Xk(e,t,n,i){var r,o,a,s,u=Object(h["i"])(t.forces);for(r=0,o=qk.length;r<o;++r)a=qk[r],a!==Uk&&t.modified(a)&&e[a](t[a]);for(r=0,o=u.length;r<o;++r)s=Uk+r,a=n||t.modified(Uk,r)?Qk(u[r]):i&&Jk(u[r],i)?e.force(s):null,a&&e.force(s,a);for(o=e.numForces||0;r<o;++r)e.force(Uk+r,null);return e.numForces=u.length,e}function Jk(e,t){var n,i;for(n in e)if(Object(h["D"])(i=e[n])&&t.modified(Object(h["g"])(i)))return 1;return 0}function Qk(e){var t,n;for(n in Object(h["v"])(Ik,e.force)||Object(h["n"])("Unrecognized force: "+e.force),t=Ik[e.force](),e)Object(h["D"])(t[n])&&Kk(t[n],e[n],e);return t}function Kk(e,t,n){e(Object(h["D"])(t)?function(e){return t(e,n)}:t)}Vk.transform=function(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(qk),o=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&Xk(n,e,0,t)):(this.value=n=Zk(t.source,e),n.on("tick",Yk(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(Wk)||t.changed()&&e.restart)if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation;return this.finish(e,t)},Vk.finish=function(e,t){for(var n,i=t.dataflow,r=this._argops,o=0,a=r.length;o<a;++o)if(n=r[o],n.name===Uk&&"link"===n.op._argval.force)for(var s,u=n.op._argops,c=0,l=u.length;c<l;++c)if("links"===u[c].name&&(s=u[c].op.source)){i.pulse(s,i.changeset().reflow());break}return t.reflow(e.modified()).modifies(Hk)};var eE=function(e,t,n){var i={};return e.each((function(e){var r=e.data;n(r)&&(i[t(r)]=e)})),e.lookup=i,e},tE=n("6bcb");function nE(e){Yi.call(this,null,e)}nE.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var iE=Object(h["y"])(nE,Yi);function rE(e){return e.values}function oE(){var e,t=[];function n(e,i){if(i>=t.length)return e;var r,o,a,s=-1,u=e.length,c=t[i++],l={},f={};while(++s<u)r=c(o=e[s])+"",(a=l[r])?a.push(o):l[r]=[o];for(r in l)f[r]=n(l[r],i);return f}function i(e,n){if(++n>t.length)return e;var r,o=[];for(r in e)o.push({key:r,values:i(e[r],n)});return o}return e={entries:e=>i(n(e,0),0),key:n=>(t.push(n),e)}}function aE(e){Yi.call(this,null,e)}iE.transform=function(e,t){t.source||Object(h["n"])("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),o=this.value;return(!o||i||t.changed())&&(o&&o.each(e=>{e.children&&b(e.data)&&r.rem.push(e.data)}),this.value=o=Object(tE["c"])({values:Object(h["i"])(e.keys).reduce((e,t)=>(e.key(t),e),oE()).entries(r.source)},rE),n&&o.each(e=>{e.children&&(e=O(e.data),r.add.push(e),r.source.push(e))}),eE(o,y,y)),r.source.root=o,r};var sE=Object(h["y"])(aE,Yi);function uE(e,t,n){for(var i,r=0,o=t.length;r<o;++r)i=t[r],i in n&&e[i](n[i])}function cE(e,t,n){for(var i=e.data,r=0,o=t.length-1;r<o;++r)i[n[r]]=e[t[r]];i[n[o]]=e.children?e.children.length:0}function lE(e,t){return e.parent===t.parent?1:2}sE.transform=function(e,t){t.source&&t.source.root||Object(h["n"])(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),i=this.fields,r=t.source.root,o=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(k(e.sort,e=>e.data)),uE(n,this.params,e),n.separation&&n.separation(!1!==e.separation?lE:h["O"]);try{this.value=n(r)}catch(a){Object(h["n"])(a)}return r.each((function(e){cE(e,i,o)})),t.reflow(e.modified()).modifies(o).modifies("leaf")};var fE=n("2373"),dE=["x","y","r","depth","children"];function hE(e){aE.call(this,e)}hE.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:dE.length,default:dE}]};var pE=Object(h["y"])(hE,aE);pE.layout=fE["a"],pE.params=["radius","size","padding"],pE.fields=dE;var gE=n("f8d7"),mE=["x0","y0","x1","y1","depth","children"];function vE(e){aE.call(this,e)}vE.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:mE.length,default:mE}]};var bE=Object(h["y"])(vE,aE);bE.layout=gE["a"],bE.params=["size","round","padding"],bE.fields=mE;var yE=n("354e");function xE(e){Yi.call(this,null,e)}xE.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};var OE=Object(h["y"])(xE,Yi);OE.transform=function(e,t){t.source||Object(h["n"])("Stratify transform requires an upstream data source.");var n=this.value,i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),o=!this.value||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),o&&(n=r.source.length?eE(Object(yE["a"])().id(e.key).parentId(e.parentKey)(r.source),e.key,h["gb"]):eE(Object(yE["a"])()([{}]),e.key,e.key)),r.source.root=this.value=n,r};var _E=n("5070"),wE=n("ce97"),jE={tidy:_E["a"],cluster:wE["a"]},kE=["x","y","depth","children"];function EE(e){aE.call(this,e)}EE.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:kE.length,default:kE}]};var AE=Object(h["y"])(EE,aE);function DE(e){Yi.call(this,[],e)}AE.layout=function(e){var t=e||"tidy";if(Object(h["v"])(jE,t))return jE[t]();Object(h["n"])("Unrecognized Tree layout method: "+t)},AE.params=["size","nodeSize"],AE.fields=kE,DE.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};var SE=Object(h["y"])(DE,Yi);SE.transform=function(e,t){var n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),o={};return i||Object(h["n"])("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,(function(e){o[y(e)]=1})),i.each((function(e){var t=e.data,n=e.parent&&e.parent.data;n&&o[y(t)]&&o[y(n)]&&r.add.push(O({source:n,target:t}))})),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,(function(e){o[y(e)]=1})),n.forEach((function(e){(o[y(e.source)]||o[y(e.target)])&&r.mod.push(e)}))),r};var CE=n("8af3"),FE=n("14f3"),ME=n("ec83"),$E=n("0830"),NE=n("2388"),TE=n("d426"),RE=n("b6f4"),zE={binary:CE["a"],dice:FE["a"],slice:ME["a"],slicedice:$E["a"],squarify:NE["a"],resquarify:TE["a"]},PE=["x0","y0","x1","y1","depth","children"];function LE(e){aE.call(this,e)}LE.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:PE.length,default:PE}]};var BE=Object(h["y"])(LE,aE);BE.layout=function(){var e=Object(RE["a"])();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){Object(h["v"])(zE,t)?e.tile(zE[t]):Object(h["n"])("Unrecognized Treemap layout method: "+t)},e},BE.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],BE.fields=PE;var IE=function(e,t){var n,i,r,o,a,s,u=[],c=function(e){return e(o)};if(null==t)u.push(e);else for(n={},i=0,r=e.length;i<r;++i)o=e[i],a=t.map(c),s=n[a],s||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u};function UE(e){Yi.call(this,null,e)}UE.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};var qE=Object(h["y"])(UE,Yi);qE.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=IE(i,e.groupby),o=(e.groupby||[]).map(h["h"]),a=o.length,s=e.as||[Object(h["h"])(e.x),Object(h["h"])(e.y)],u=[];r.forEach(t=>{xo(t,e.x,e.y,e.bandwidth||.3).forEach(e=>{const n={};for(let i=0;i<a;++i)n[o[i]]=t.dims[i];n[s[0]]=e[0],n[s[1]]=e[1],u.push(O(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n};const WE={linear:uo,log:co,exp:lo,pow:fo,quad:ho,poly:po};function HE(e,t){return"poly"===e?t:"quad"===e?2:1}function GE(e){Yi.call(this,null,e)}GE.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(WE)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};var VE=Object(h["y"])(GE,Yi);VE.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=IE(i,e.groupby),o=(e.groupby||[]).map(h["h"]),a=e.method||"linear",s=e.order||3,u=HE(a,s),c=e.as||[Object(h["h"])(e.x),Object(h["h"])(e.y)],l=WE[a],f=[];let d=e.extent;Object(h["v"])(WE,a)||Object(h["n"])("Invalid regression method: "+a),null!=d&&"log"===a&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(n=>{const i=n.length;if(i<=u)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const r=l(n,e.x,e.y,s);if(e.params)return void f.push(O({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const p=d||Object(h["p"])(n,e.x),g=e=>{const t={};for(let i=0;i<o.length;++i)t[o[i]]=n.dims[i];t[c[0]]=e[0],t[c[1]]=e[1],f.push(O(t))};"linear"===a?p.forEach(e=>g([e,r.predict(e)])):ko(r.predict,p,25,200).forEach(g)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n};const YE=Math.pow(2,-52),ZE=new Uint32Array(512);class XE{static from(e,t=aA,n=sA){const i=e.length,r=new Float64Array(2*i);for(let o=0;o<i;o++){const i=e[o];r[2*o]=t(i),r[2*o+1]=n(i)}return new XE(r)}constructor(e){const t=e.length>>1;if(t>0&&"number"!==typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:i,_hullHash:r}=this,o=e.length>>1;let a=1/0,s=1/0,u=-1/0,c=-1/0;for(let k=0;k<o;k++){const t=e[2*k],n=e[2*k+1];t<a&&(a=t),n<s&&(s=n),t>u&&(u=t),n>c&&(c=n),this._ids[k]=k}const l=(a+u)/2,f=(s+c)/2;let d,h,p,g=1/0;for(let k=0;k<o;k++){const t=QE(l,f,e[2*k],e[2*k+1]);t<g&&(d=k,g=t)}const m=e[2*d],v=e[2*d+1];g=1/0;for(let k=0;k<o;k++){if(k===d)continue;const t=QE(m,v,e[2*k],e[2*k+1]);t<g&&t>0&&(h=k,g=t)}let b=e[2*h],y=e[2*h+1],x=1/0;for(let k=0;k<o;k++){if(k===d||k===h)continue;const t=nA(m,v,b,y,e[2*k],e[2*k+1]);t<x&&(p=k,x=t)}let O=e[2*p],_=e[2*p+1];if(x===1/0){for(let i=0;i<o;i++)this._dists[i]=e[2*i]-e[0]||e[2*i+1]-e[1];rA(this._ids,this._dists,0,o-1);const t=new Uint32Array(o);let n=0;for(let e=0,i=-1/0;e<o;e++){const r=this._ids[e];this._dists[r]>i&&(t[n++]=r,i=this._dists[r])}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(eA(m,v,b,y,O,_)){const e=h,t=b,n=y;h=p,b=O,y=_,p=e,O=t,_=n}const w=iA(m,v,b,y,O,_);this._cx=w.x,this._cy=w.y;for(let k=0;k<o;k++)this._dists[k]=QE(e[2*k],e[2*k+1],w.x,w.y);rA(this._ids,this._dists,0,o-1),this._hullStart=d;let j=3;n[d]=t[p]=h,n[h]=t[d]=p,n[p]=t[h]=d,i[d]=0,i[h]=1,i[p]=2,r.fill(-1),r[this._hashKey(m,v)]=d,r[this._hashKey(b,y)]=h,r[this._hashKey(O,_)]=p,this.trianglesLen=0,this._addTriangle(d,h,p,-1,-1,-1);for(let k,E,A=0;A<this._ids.length;A++){const o=this._ids[A],a=e[2*o],s=e[2*o+1];if(A>0&&Math.abs(a-k)<=YE&&Math.abs(s-E)<=YE)continue;if(k=a,E=s,o===d||o===h||o===p)continue;let u=0;for(let e=0,t=this._hashKey(a,s);e<this._hashSize;e++)if(u=r[(t+e)%this._hashSize],-1!==u&&u!==n[u])break;u=t[u];let c,l=u;while(c=n[l],!eA(a,s,e[2*l],e[2*l+1],e[2*c],e[2*c+1]))if(l=c,l===u){l=-1;break}if(-1===l)continue;let f=this._addTriangle(l,o,n[l],-1,-1,i[l]);i[o]=this._legalize(f+2),i[l]=f,j++;let g=n[l];while(c=n[g],eA(a,s,e[2*g],e[2*g+1],e[2*c],e[2*c+1]))f=this._addTriangle(g,o,c,i[o],-1,i[g]),i[o]=this._legalize(f+2),n[g]=g,j--,g=c;if(l===u)while(c=t[l],eA(a,s,e[2*c],e[2*c+1],e[2*l],e[2*l+1]))f=this._addTriangle(c,o,l,-1,i[l],i[c]),this._legalize(f+2),i[c]=f,n[l]=l,j--,l=c;this._hullStart=t[o]=l,n[l]=t[g]=o,n[o]=g,r[this._hashKey(a,s)]=o,r[this._hashKey(e[2*l],e[2*l+1])]=l}this.hull=new Uint32Array(j);for(let k=0,E=this._hullStart;k<j;k++)this.hull[k]=E,E=n[E];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(JE(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:i}=this;let r=0,o=0;while(1){const a=n[e],s=e-e%3;if(o=s+(e+2)%3,-1===a){if(0===r)break;e=ZE[--r];continue}const u=a-a%3,c=s+(e+1)%3,l=u+(a+2)%3,f=t[o],d=t[e],h=t[c],p=t[l],g=tA(i[2*f],i[2*f+1],i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1]);if(g){t[e]=p,t[a]=f;const i=n[l];if(-1===i){let t=this._hullStart;do{if(this._hullTri[t]===l){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,i),this._link(a,n[o]),this._link(o,l);const s=u+(a+1)%3;r<ZE.length&&(ZE[r++]=s)}else{if(0===r)break;e=ZE[--r]}}return o}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,r,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=n,this._link(a,i),this._link(a+1,r),this._link(a+2,o),this.trianglesLen+=3,a}}function JE(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function QE(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function KE(e,t,n,i,r,o){const a=(i-t)*(r-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function eA(e,t,n,i,r,o){const a=KE(r,o,e,t,n,i)||KE(e,t,n,i,r,o)||KE(n,i,r,o,e,t);return a<0}function tA(e,t,n,i,r,o,a,s){const u=e-a,c=t-s,l=n-a,f=i-s,d=r-a,h=o-s,p=u*u+c*c,g=l*l+f*f,m=d*d+h*h;return u*(f*m-g*h)-c*(l*m-g*d)+p*(l*h-f*d)<0}function nA(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,c=o-t,l=a*a+s*s,f=u*u+c*c,d=.5/(a*c-s*u),h=(c*l-s*f)*d,p=(a*f-u*l)*d;return h*h+p*p}function iA(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,c=o-t,l=a*a+s*s,f=u*u+c*c,d=.5/(a*c-s*u),h=e+(c*l-s*f)*d,p=t+(a*f-u*l)*d;return{x:h,y:p}}function rA(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const i=e[r],o=t[i];let a=r-1;while(a>=n&&t[e[a]]>o)e[a+1]=e[a--];e[a+1]=i}else{const r=n+i>>1;let o=n+1,a=i;oA(e,r,o),t[e[n]]>t[e[i]]&&oA(e,n,i),t[e[o]]>t[e[i]]&&oA(e,o,i),t[e[n]]>t[e[o]]&&oA(e,n,o);const s=e[o],u=t[s];while(1){do{o++}while(t[e[o]]<u);do{a--}while(t[e[a]]>u);if(a<o)break;oA(e,o,a)}e[n+1]=e[a],e[a]=s,i-o+1>=a-n?(rA(e,t,o,i),rA(e,t,n,a-1)):(rA(e,t,n,a-1),rA(e,t,o,i))}}function oA(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function aA(e){return e[0]}function sA(e){return e[1]}const uA=1e-6;class cA{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){e=+e,t=+t,n=+n;const i=e+n,r=t;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${i},${r}`:(Math.abs(this._x1-i)>uA||Math.abs(this._y1-r)>uA)&&(this._+="L"+i+","+r),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=i},${this._y1=r}`)}rect(e,t,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class lA{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class fA{constructor(e,[t,n,i,r]=[0,0,960,500]){if(!((i=+i)>=(t=+t))||!((r=+r)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=i,this.xmin=t,this.ymax=r,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:i}=this,r=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let d,h,p=0,g=0,m=n.length;p<m;p+=3,g+=2){const t=2*n[p],i=2*n[p+1],o=2*n[p+2],a=e[t],s=e[t+1],u=e[i],c=e[i+1],l=e[o],f=e[o+1],m=u-a,v=c-s,b=l-a,y=f-s,x=m*m+v*v,O=b*b+y*y,_=2*(m*y-v*b);if(_)if(Math.abs(_)<1e-8)d=(a+l)/2,h=(s+f)/2;else{const e=1/_;d=a+(y*x-v*O)*e,h=s+(m*O-b*x)*e}else d=(a+l)/2-1e8*y,h=(s+f)/2+1e8*b;r[g]=d,r[g+1]=h}let o,a,s,u=t[t.length-1],c=4*u,l=e[2*u],f=e[2*u+1];i.fill(0);for(let d=0;d<t.length;++d)u=t[d],o=c,a=l,s=f,c=4*u,l=e[2*u],f=e[2*u+1],i[o+2]=i[c]=s-f,i[o+3]=i[c+1]=l-a}render(e){const t=null==e?e=new cA:void 0,{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:o,vectors:a}=this;if(r.length<=1)return null;for(let c=0,l=n.length;c<l;++c){const t=n[c];if(t<c)continue;const i=2*Math.floor(c/3),r=2*Math.floor(t/3),a=o[i],s=o[i+1],u=o[r],l=o[r+1];this._renderSegment(a,s,u,l,e)}let s,u=r[r.length-1];for(let c=0;c<r.length;++c){s=u,u=r[c];const t=2*Math.floor(i[u]/3),n=o[t],l=o[t+1],f=4*s,d=this._project(n,l,a[f+2],a[f+3]);d&&this._renderSegment(n,l,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new cA:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new cA:void 0,i=this._clip(e);if(null===i||!i.length)return;t.moveTo(i[0],i[1]);let r=i.length;while(i[0]===i[r-2]&&i[1]===i[r-1]&&r>1)r-=2;for(let o=2;o<r;o+=2)i[o]===i[o-2]&&i[o+1]===i[o-1]||t.lineTo(i[o],i[o+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new lA;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,i,r){let o;const a=this._regioncode(e,t),s=this._regioncode(n,i);0===a&&0===s?(r.moveTo(e,t),r.lineTo(n,i)):(o=this._clipSegment(e,t,n,i,a,s))&&(r.moveTo(o[0],o[1]),r.lineTo(o[2],o[3]))}contains(e,t,n){return t=+t,t===t&&(n=+n,n===n)&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let i=0,r=t.length;i<r;i+=2)for(let o=0,a=e.length;o<a;o+=2)if(t[i]==e[o]&&t[i+1]==e[o+1]&&t[(i+2)%r]==e[(o+a-2)%a]&&t[(i+3)%r]==e[(o+a-1)%a]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:i,triangles:r}}=this,o=n[e];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(t[2*n],t[2*n+1]),s=s%3===2?s-2:s+1,r[s]!==e)break;s=i[s]}while(s!==o&&-1!==s);return a}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,i=4*e;return n[i]||n[i+1]?this._clipInfinite(e,t,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,t)}_clipFinite(e,t){const n=t.length;let i,r,o,a,s,u=null,c=t[n-2],l=t[n-1],f=this._regioncode(c,l);for(let d=0;d<n;d+=2)if(i=c,r=l,c=t[d],l=t[d+1],o=f,f=this._regioncode(c,l),0===o&&0===f)a=s,s=0,u?u.push(c,l):u=[c,l];else{let t,n,d,h,p;if(0===o){if(null===(t=this._clipSegment(i,r,c,l,o,f)))continue;[n,d,h,p]=t}else{if(null===(t=this._clipSegment(c,l,i,r,f,o)))continue;[h,p,n,d]=t,a=s,s=this._edgecode(n,d),a&&s&&this._edge(e,a,s,u,u.length),u?u.push(n,d):u=[n,d]}a=s,s=this._edgecode(h,p),a&&s&&this._edge(e,a,s,u,u.length),u?u.push(h,p):u=[h,p]}if(u)a=s,s=this._edgecode(u[0],u[1]),a&&s&&this._edge(e,a,s,u,u.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(e,t,n,i,r,o){while(1){if(0===r&&0===o)return[e,t,n,i];if(r&o)return null;let a,s,u=r||o;8&u?(a=e+(n-e)*(this.ymax-t)/(i-t),s=this.ymax):4&u?(a=e+(n-e)*(this.ymin-t)/(i-t),s=this.ymin):2&u?(s=t+(i-t)*(this.xmax-e)/(n-e),a=this.xmax):(s=t+(i-t)*(this.xmin-e)/(n-e),a=this.xmin),r?(e=a,t=s,r=this._regioncode(e,t)):(n=a,i=s,o=this._regioncode(n,i))}}_clipInfinite(e,t,n,i,r,o){let a,s=Array.from(t);if((a=this._project(s[0],s[1],n,i))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],r,o))&&s.push(a[0],a[1]),s=this._clipFinite(e,s))for(let u,c=0,l=s.length,f=this._edgecode(s[l-2],s[l-1]);c<l;c+=2)u=f,f=this._edgecode(s[c],s[c+1]),u&&f&&(c=this._edge(e,u,f,s,c),l=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,n,i,r){while(t!==n){let n,o;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,o=this.ymin;break}i[r]===n&&i[r+1]===o||!this.contains(e,n,o)||(i.splice(r,0,n,o),r+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const e=(o+2)%i.length,t=(o+4)%i.length;(i[o]===i[e]&&i[e]===i[t]||i[o+1]===i[e+1]&&i[e+1]===i[t+1])&&(i.splice(e,2),o-=2)}return r}_project(e,t,n,i){let r,o,a,s=1/0;if(i<0){if(t<=this.ymin)return null;(r=(this.ymin-t)/i)<s&&(a=this.ymin,o=e+(s=r)*n)}else if(i>0){if(t>=this.ymax)return null;(r=(this.ymax-t)/i)<s&&(a=this.ymax,o=e+(s=r)*n)}if(n>0){if(e>=this.xmax)return null;(r=(this.xmax-e)/n)<s&&(o=this.xmax,a=t+(s=r)*i)}else if(n<0){if(e<=this.xmin)return null;(r=(this.xmin-e)/n)<s&&(o=this.xmin,a=t+(s=r)*i)}return[o,a]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}const dA=2*Math.PI,hA=Math.pow;function pA(e){return e[0]}function gA(e){return e[1]}function mA(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const e=2*t[i],r=2*t[i+1],o=2*t[i+2],a=(n[o]-n[e])*(n[r+1]-n[e+1])-(n[r]-n[e])*(n[o+1]-n[e+1]);if(a>1e-10)return!1}return!0}function vA(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class bA{static from(e,t=pA,n=gA,i){return new bA("length"in e?yA(e,t,n,i):Float64Array.from(xA(e,t,n,i)))}constructor(e){this._delaunator=new XE(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&mA(e)){this.collinear=Int32Array.from({length:t.length/2},(e,t)=>t).sort((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]);const e=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],r=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let o=0,a=t.length/2;o<a;++o){const e=vA(t[2*o],t[2*o+1],r);t[2*o]=e[0],t[2*o+1]=e[1]}this._delaunator=new XE(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,r=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,u=n.length;s<u;++s){const e=r[s%3===2?s-2:s+1];-1!==n[s]&&-1!==o[e]||(o[e]=s)}for(let s=0,u=i.length;s<u;++s)a[i[s]]=s;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,2===i.length&&(o[i[1]]=0))}voronoi(e){return new fA(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:i,halfedges:r,triangles:o,collinear:a}=this;if(a){const t=a.indexOf(e);return t>0&&(yield a[t-1]),void(t<a.length-1&&(yield a[t+1]))}const s=t[e];if(-1===s)return;let u=s,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=r[u],-1===u){const t=n[(i[e]+1)%n.length];return void(t!==c&&(yield t))}}while(u!==s)}find(e,t,n=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const i=n;let r;while((r=this._step(n,e,t))>=0&&r!==n&&r!==i)n=r;return r}_step(e,t,n){const{inedges:i,hull:r,_hullIndex:o,halfedges:a,triangles:s,points:u}=this;if(-1===i[e]||!u.length)return(e+1)%(u.length>>1);let c=e,l=hA(t-u[2*e],2)+hA(n-u[2*e+1],2);const f=i[e];let d=f;do{let i=s[d];const f=hA(t-u[2*i],2)+hA(n-u[2*i+1],2);if(f<l&&(l=f,c=i),d=d%3===2?d-2:d+1,s[d]!==e)break;if(d=a[d],-1===d){if(d=r[(o[e]+1)%r.length],d!==i&&hA(t-u[2*d],2)+hA(n-u[2*d+1],2)<l)return d;break}}while(d!==f);return c}render(e){const t=null==e?e=new cA:void 0,{points:n,halfedges:i,triangles:r}=this;for(let o=0,a=i.length;o<a;++o){const t=i[o];if(t<o)continue;const a=2*r[o],s=2*r[t];e.moveTo(n[a],n[a+1]),e.lineTo(n[s],n[s+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t=2){const n=null==e?e=new cA:void 0,{points:i}=this;for(let r=0,o=i.length;r<o;r+=2){const n=i[r],o=i[r+1];e.moveTo(n+t,o),e.arc(n,o,t,0,dA)}return n&&n.value()}renderHull(e){const t=null==e?e=new cA:void 0,{hull:n,points:i}=this,r=2*n[0],o=n.length;e.moveTo(i[r],i[r+1]);for(let a=1;a<o;++a){const t=2*n[a];e.lineTo(i[t],i[t+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new lA;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new cA:void 0,{points:i,triangles:r}=this,o=2*r[e*=3],a=2*r[e+1],s=2*r[e+2];return t.moveTo(i[o],i[o+1]),t.lineTo(i[a],i[a+1]),t.lineTo(i[s],i[s+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new lA;return this.renderTriangle(e,t),t.value()}}function yA(e,t,n,i){const r=e.length,o=new Float64Array(2*r);for(let a=0;a<r;++a){const r=e[a];o[2*a]=t.call(i,r,a,e),o[2*a+1]=n.call(i,r,a,e)}return o}function*xA(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}function OA(e){Yi.call(this,null,e)}OA.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const _A=Object(h["y"])(OA,Yi),wA=[-1e5,-1e5,1e5,1e5];function jA(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}_A.transform=function(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:wA;const o=this.value=bA.from(i,e.x,e.y).voronoi(r);for(let a=0,s=i.length;a<s;++a){const e=o.cellPolygon(a);i[a][n]=e?jA(e):null}return t.reflow(e.modified()).modifies(n)};var kA=Math.PI/180,EA=64,AA=2048,DA=function(){var e,t,n,i,r,o,a,s=[256,256],u=$A,c=[],l=Math.random,f={};function d(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(EA<<5)/t,e.height=AA/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}function h(e,t,n){var i,r,o,a=t.x,c=t.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=u(s),h=l()<.5?1:-1,p=-h;while(i=d(p+=h)){if(r=~~i[0],o=~~i[1],Math.min(Math.abs(r),Math.abs(o))>=f)break;if(t.x=a+r,t.y=c+o,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1])&&(!n||!CA(t,e,s[0]))&&(!n||MA(t,n))){for(var g,m=t.sprite,v=t.width>>5,b=s[0]>>5,y=t.x-(v<<4),x=127&y,O=32-x,_=t.y1-t.y0,w=(t.y+t.y0)*b+(y>>5),j=0;j<_;j++){g=0;for(var k=0;k<=v;k++)e[w+k]|=g<<O|(k<v?(g=m[j*v+k])>>>x:0);w+=b}return t.sprite=null,!0}}return!1}return f.layout=function(){var u=d(yl()),f=TA((s[0]>>5)*s[1]),p=null,g=c.length,m=-1,v=[],b=c.map((function(s){return{text:e(s),font:t(s),style:i(s),weight:r(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}})).sort((function(e,t){return t.size-e.size}));while(++m<g){var y=b[m];y.x=s[0]*(l()+.5)>>1,y.y=s[1]*(l()+.5)>>1,SA(u,y,b,m),y.hasText&&h(f,y,p)&&(v.push(y),p?FA(p,y):p=[{x:y.x+y.x0,y:y.y+y.y0},{x:y.x+y.x1,y:y.y+y.y1}],y.x-=s[0]>>1,y.y-=s[1]>>1)}return v},f.words=function(e){return arguments.length?(c=e,f):c},f.size=function(e){return arguments.length?(s=[+e[0],+e[1]],f):s},f.font=function(e){return arguments.length?(t=RA(e),f):t},f.fontStyle=function(e){return arguments.length?(i=RA(e),f):i},f.fontWeight=function(e){return arguments.length?(r=RA(e),f):r},f.rotate=function(e){return arguments.length?(o=RA(e),f):o},f.text=function(t){return arguments.length?(e=RA(t),f):e},f.spiral=function(e){return arguments.length?(u=zA[e]||e,f):u},f.fontSize=function(e){return arguments.length?(n=RA(e),f):n},f.padding=function(e){return arguments.length?(a=RA(e),f):a},f.random=function(e){return arguments.length?(l=e,f):l},f};function SA(e,t,n,i){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,(EA<<5)/o,AA/o);var a,s,u,c,l,f=0,d=0,h=0,p=n.length;--i;while(++i<p){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,a=r.measureText(t.text+"m").width*o,u=t.size<<1,t.rotate){var g=Math.sin(t.rotate*kA),m=Math.cos(t.rotate*kA),v=a*m,b=a*g,y=u*m,x=u*g;a=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,u=~~Math.max(Math.abs(b+y),Math.abs(b-y))}else a=a+31>>5<<5;if(u>h&&(h=u),f+a>=EA<<5&&(f=0,d+=h,h=0),d+u>=AA)break;r.translate((f+(a>>1))/o,(d+(u>>1))/o),t.rotate&&r.rotate(t.rotate*kA),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=a,t.height=u,t.xoff=f,t.yoff=d,t.x1=a>>1,t.y1=u>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=a}var O=r.getImageData(0,0,(EA<<5)/o,AA/o).data,_=[];while(--i>=0)if(t=n[i],t.hasText){for(a=t.width,s=a>>5,u=t.y1-t.y0,c=0;c<u*s;c++)_[c]=0;if(f=t.xoff,null==f)return;d=t.yoff;var w=0,j=-1;for(l=0;l<u;l++){for(c=0;c<a;c++){var k=s*l+(c>>5),E=O[(d+l)*(EA<<5)+(f+c)<<2]?1<<31-c%32:0;_[k]|=E,w|=E}w?j=l:(t.y0++,u--,l--,d++)}t.y1=t.y0+j,t.sprite=_.slice(0,(t.y1-t.y0)*s)}}}function CA(e,t,n){n>>=5;for(var i,r=e.sprite,o=e.width>>5,a=e.x-(o<<4),s=127&a,u=32-s,c=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),f=0;f<c;f++){i=0;for(var d=0;d<=o;d++)if((i<<u|(d<o?(i=r[f*o+d])>>>s:0))&t[l+d])return!0;l+=n}return!1}function FA(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function MA(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function $A(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function NA(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(e){var o=e<0?-1:1;switch(Math.sqrt(1+4*o*e)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function TA(e){var t=[],n=-1;while(++n<e)t[n]=0;return t}function RA(e){return"function"===typeof e?e:function(){return e}}var zA={archimedean:$A,rectangular:NA},PA=["x","y","font","fontSize","fontStyle","fontWeight","angle"],LA=["text","font","rotate","fontSize","fontStyle","fontWeight"];function BA(e){Yi.call(this,DA(),e)}BA.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:PA}]};var IA=Object(h["y"])(BA,Yi);function UA(e){return new Uint8Array(e)}function qA(e){return new Uint16Array(e)}function WA(e){return new Uint32Array(e)}function HA(){var e=8,t=[],n=WA(0),i=VA(0,e),r=VA(0,e);return{data:function(){return t},seen:function(){return n=GA(n,t.length)},add:function(e){for(var n,i=0,r=t.length,o=e.length;i<o;++i)n=e[i],n._index=r++,t.push(n)},remove:function(e,n){var o,a,s,u=t.length,c=Array(u-e),l=t;for(a=0;!n[a]&&a<u;++a)c[a]=t[a],l[a]=a;for(s=a;a<u;++a)o=t[a],n[a]?l[a]=-1:(l[a]=s,i[s]=i[a],r[s]=r[a],c[s]=o,o._index=s++),i[a]=0;return t=c,l},size:function(){return t.length},curr:function(){return i},prev:function(){return r},reset:function(e){r[e]=i[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){i[e]|=t},clear:function(e,t){i[e]&=~t},resize:function(t,n){var o=i.length;(t>o||n>e)&&(e=Math.max(n,e),i=VA(t,e,i),r=VA(t,e))}}}function GA(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function VA(e,t,n){var i=(t<257?UA:t<65537?qA:WA)(e);return n&&i.set(n),i}IA.transform=function(e,t){function n(n){var i=e[n];return Object(h["D"])(i)&&t.modified(i.fields)}!e.size||e.size[0]&&e.size[1]||Object(h["n"])("Wordcloud size dimensions must be non-zero.");var i=e.modified();if(i||t.changed(t.ADD_REM)||LA.some(n)){var r,o=t.materialize(t.SOURCE).source,a=this.value,s=e.as||PA,u=e.fontSize||14;if(Object(h["D"])(u)?r=e.fontSizeRange:u=Object(h["l"])(u),r){var c=u,l=Qg("sqrt")().domain(Object(h["p"])(o,c)).range(r);u=function(e){return l(c(e))}}o.forEach((function(e){e[s[0]]=NaN,e[s[1]]=NaN,e[s[3]]=0}));for(var f,d,p=a.words(o).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(Cr).layout(),g=a.size(),m=g[0]>>1,v=g[1]>>1,b=0,y=p.length;b<y;++b)f=p[b],d=f.datum,d[s[0]]=f.x+m,d[s[1]]=f.y+v,d[s[2]]=f.font,d[s[3]]=f.size,d[s[4]]=f.style,d[s[5]]=f.weight,d[s[6]]=f.rotate;return t.reflow(i).modifies(s)}};var YA=function(e,t,n){var i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n,r=this,o=r.bisect(r.range,e.value),a=e.index,s=o[0],u=o[1],c=a.length;for(n=0;n<s;++n)t[a[n]]|=i;for(n=u;n<c;++n)t[a[n]]|=i;return r}}},ZA=function(e,t){return Array.from(t,t=>e[t])};function XA(){var e=WA(0),t=[],n=0;function i(i,r,o){if(!r.length)return[];var a,s,u,c=n,l=r.length,f=Array(l),d=WA(l);for(u=0;u<l;++u)f[u]=i(r[u]),d[u]=u;if(f=JA(f,d),c)a=t,s=e,t=Array(c+l),e=WA(c+l),QA(o,a,s,c,f,d,l,t,e);else{if(o>0)for(u=0;u<l;++u)d[u]+=o;t=f,e=d}return n=c+l,{index:d,value:f}}function r(i,r){var o,a,s,u=n;for(a=0;!r[e[a]]&&a<u;++a);for(s=a;a<u;++a)r[o=e[a]]||(e[s]=o,t[s]=t[a],++s);n=u-i}function o(t){for(var i=0,r=n;i<r;++i)e[i]=t[e[i]]}function a(e,i){var r;return i?r=i.length:(i=t,r=n),[wp(i,e[0],0,r),_p(i,e[1],0,r)]}return{insert:i,remove:r,bisect:a,reindex:o,index:function(){return e},size:function(){return n}}}function JA(e,t){return e.sort.call(t,(function(t,n){var i=e[t],r=e[n];return i<r?-1:i>r?1:0})),ZA(e,t)}function QA(e,t,n,i,r,o,a,s,u){var c,l=0,f=0;for(c=0;l<i&&f<a;++c)t[l]<r[f]?(s[c]=t[l],u[c]=n[l++]):(s[c]=r[f],u[c]=o[f++]+e);for(;l<i;++l,++c)s[c]=t[l],u[c]=n[l];for(;f<a;++f,++c)s[c]=r[f],u[c]=o[f]+e}function KA(e){Yi.call(this,HA(),e),this._indices=null,this._dims=null}KA.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var eD=Object(h["y"])(KA,Yi);function tD(e){Yi.call(this,null,e)}eD.transform=function(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}));return n?this.reinit(e,t):this.eval(e,t)}return this.init(e,t)},eD.init=function(e,t){for(var n,i,r=e.fields,o=e.query,a=this._indices={},s=this._dims=[],u=o.length,c=0;c<u;++c)n=r[c].fname,i=a[n]||(a[n]=XA()),s.push(YA(i,c,o[c]));return this.eval(e,t)},eD.reinit=function(e,t){var n,i,r,o,a,s,u,c,l,f=t.materialize().fork(),d=e.fields,h=e.query,p=this._indices,g=this._dims,m=this.value,v=m.curr(),b=m.prev(),y=m.all(),x=f.rem=f.add,O=f.mod,_=h.length,w={};if(b.set(v),t.rem.length&&(a=this.remove(e,t,f)),t.add.length&&m.add(t.add),t.mod.length)for(s={},o=t.mod,u=0,c=o.length;u<c;++u)s[o[u]._index]=1;for(u=0;u<_;++u)l=d[u],(!g[u]||e.modified("fields",u)||t.modified(l.fields))&&(r=l.fname,(n=w[r])||(p[r]=i=XA(),w[r]=n=i.insert(l,t.source,0)),g[u]=YA(i,u,h[u]).onAdd(n,v));for(u=0,c=m.data().length;u<c;++u)a[u]||(b[u]!==v[u]?x.push(u):s[u]&&v[u]!==y&&O.push(u));return m.mask=(1<<_)-1,f},eD.eval=function(e,t){var n=t.materialize().fork(),i=this._dims.length,r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},eD.insert=function(e,t,n){var i,r,o,a=t.add,s=this.value,u=this._dims,c=this._indices,l=e.fields,f={},d=n.add,h=s.size(),p=h+a.length,g=u.length;s.resize(p,g),s.add(a);var m=s.curr(),v=s.prev(),b=s.all();for(i=0;i<g;++i)r=l[i].fname,o=f[r]||(f[r]=c[r].insert(l[i],a,h)),u[i].onAdd(o,m);for(;h<p;++h)v[h]=b,m[h]!==b&&d.push(h)},eD.modify=function(e,t){var n,i,r,o=t.mod,a=this.value,s=a.curr(),u=a.all(),c=e.mod;for(n=0,i=c.length;n<i;++n)r=c[n]._index,s[r]!==u&&o.push(r)},eD.remove=function(e,t,n){var i,r,o,a,s=this._indices,u=this.value,c=u.curr(),l=u.prev(),f=u.all(),d={},h=n.rem,p=t.rem;for(i=0,r=p.length;i<r;++i)o=p[i]._index,d[o]=1,l[o]=a=c[o],c[o]=f,a!==f&&h.push(o);for(o in s)s[o].remove(r,d);return this.reindex(t,r,d),d},eD.reindex=function(e,t,n){var i=this._indices,r=this.value;e.runAfter((function(){var e=r.remove(t,n);for(var o in i)i[o].reindex(e)}))},eD.update=function(e,t,n){var i,r,o=this._dims,a=e.query,s=t.stamp,u=o.length,c=0;for(n.filters=0,r=0;r<u;++r)e.modified("query",r)&&(i=r,++c);if(1===c)c=o[i].one,this.incrementOne(o[i],a[i],n.add,n.rem);else for(r=0,c=0;r<u;++r)e.modified("query",r)&&(c|=o[r].one,this.incrementAll(o[r],a[r],s,n.add),n.rem=n.add);return c},eD.incrementAll=function(e,t,n,i){var r,o,a,s=this.value,u=s.seen(),c=s.curr(),l=s.prev(),f=e.index(),d=e.bisect(e.range),h=e.bisect(t),p=h[0],g=h[1],m=d[0],v=d[1],b=e.one;if(p<m)for(r=p,o=Math.min(m,g);r<o;++r)a=f[r],u[a]!==n&&(l[a]=c[a],u[a]=n,i.push(a)),c[a]^=b;else if(p>m)for(r=m,o=Math.min(p,v);r<o;++r)a=f[r],u[a]!==n&&(l[a]=c[a],u[a]=n,i.push(a)),c[a]^=b;if(g>v)for(r=Math.max(p,v),o=g;r<o;++r)a=f[r],u[a]!==n&&(l[a]=c[a],u[a]=n,i.push(a)),c[a]^=b;else if(g<v)for(r=Math.max(m,g),o=v;r<o;++r)a=f[r],u[a]!==n&&(l[a]=c[a],u[a]=n,i.push(a)),c[a]^=b;e.range=t.slice()},eD.incrementOne=function(e,t,n,i){var r,o,a,s=this.value,u=s.curr(),c=e.index(),l=e.bisect(e.range),f=e.bisect(t),d=f[0],h=f[1],p=l[0],g=l[1],m=e.one;if(d<p)for(r=d,o=Math.min(p,h);r<o;++r)a=c[r],u[a]^=m,n.push(a);else if(d>p)for(r=p,o=Math.min(d,g);r<o;++r)a=c[r],u[a]^=m,i.push(a);if(h>g)for(r=Math.max(d,g),o=h;r<o;++r)a=c[r],u[a]^=m,n.push(a);else if(h<g)for(r=Math.max(p,h),o=g;r<o;++r)a=c[r],u[a]^=m,i.push(a);e.range=t.slice()},tD.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};var nD=Object(h["y"])(tD,Yi);nD.transform=function(e,t){var n=~(e.ignore||0),i=e.filter,r=i.mask;if(0===(r&n))return t.StopPropagation;var o=t.fork(t.ALL),a=i.data(),s=i.curr(),u=i.prev(),c=function(e){return s[e]&n?null:a[e]};return o.filter(o.MOD,c),r&r-1?(o.filter(o.ADD,(function(e){var t=s[e]&n,i=!t&&t^u[e]&n;return i?a[e]:null})),o.filter(o.REM,(function(e){var t=s[e]&n,i=t&&!(t^t^u[e]&n);return i?a[e]:null}))):(o.filter(o.ADD,c),o.filter(o.REM,(function(e){return(s[e]&n)===r?a[e]:null}))),o.filter(o.SOURCE,(function(e){return c(e._index)}))};var iD=n("f161");function rD(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),oD(t,e.description()))}function oD(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}var aD=function(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})};const sD="default";var uD=function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:sD,item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){const i=t.value,r=i?Object(h["H"])(i)?i:i.user:sD,o=n.item&&n.item.cursor||null;return i&&r===i.user&&o==i.item?i:{user:r,item:o}})),e.add(null,(function(t){let n=t.cursor,i=this.value;return Object(h["H"])(n)||(i=n.item,n=n.user),cD(e,n&&n!==sD?n:i||n),i}),{cursor:t})};function cD(e,t){const n=e.globalCursor()?"undefined"!==typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function lD(e,t){var n=e._runtime.data;return Object(h["v"])(n,t)||Object(h["n"])("Unrecognized data set: "+t),n[t]}function fD(e,t){return arguments.length<2?lD(this,e).values.value:dD.call(this,e,A().remove(h["gb"]).insert(t))}function dD(e,t){E(t)||Object(h["n"])("Second argument to changes must be a changeset.");var n=lD(this,e);return n.modified=!0,this.pulse(n.input,t)}function hD(e,t){return dD.call(this,e,A().insert(t))}function pD(e,t){return dD.call(this,e,A().remove(t))}function gD(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function mD(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function vD(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function bD(e){var t=vD(e),n=gD(e),i=mD(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach((function(t){try{t(n,i)}catch(r){e.error(r)}}))}var yD=function(e,t,n){var i,r,o,a=e._renderer,s=a&&a.canvas();return s&&(o=vD(e),r=t.changedTouches?t.changedTouches[0]:t,i=ih(r,s),i[0]-=o[0],i[1]-=o[1]),t.dataflow=e,t.item=n,t.vega=xD(e,n,i),t};function xD(e,t,n){var i=t?"group"===t.mark.marktype?t:t.mark.group:null;function r(e){var n,r=i;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){r=n;break}return r&&r.mark&&r.mark.interactive?r:{}}function o(e){if(!e)return n;Object(h["H"])(e)&&(e=r(e));var t=n.slice();while(e)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:Object(h["l"])(e),item:Object(h["l"])(t||{}),group:r,xy:o,x:function(e){return o(e)[0]},y:function(e){return o(e)[1]}}}const OD="view",_D="timer",wD="window",jD={trap:!1};function kD(e){const t=Object(h["o"])({defaults:{}},e),n=(e,t)=>{t.forEach(t=>{Object(h["A"])(e[t])&&(e[t]=Object(h["db"])(e[t]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function ED(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return!1!==i&&!0!==r&&(!0===i||!1===r||(i?i[t]:r?!r[t]:e.preventDefault()))}function AD(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return!(!1===i||Object(h["F"])(i)&&!i[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1)}function DD(e,t,n){var i,r=this,o=new U(n),a=function(n,i){r.runAsync(null,()=>{e===OD&&ED(r,t)&&n.preventDefault(),o.receive(yD(r,n,i))})};if(e===_D)AD(r,"timer",t)&&r.timer(a,t);else if(e===OD)AD(r,"view",t)&&r.addEventListener(t,a,jD);else if(e===wD?AD(r,"window",t)&&"undefined"!==typeof window&&(i=[window]):"undefined"!==typeof document&&AD(r,"selector",t)&&(i=document.querySelectorAll(e)),i){for(var s=0,u=i.length;s<u;++s)i[s].addEventListener(t,a);r._eventListeners.push({type:t,sources:i,handler:a})}else r.warn("Can not resolve event source: "+e);return o}function SD(e){return e.item}function CD(e){return e.item.mark.source}function FD(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}var MD=function(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",SD),CD,FD(e)),this.on(this.events("view","mouseout",SD),CD,FD(t)),this},$D=function(){var e,t,n,i=this._tooltip,r=this._timers,o=this._eventListeners;e=r.length;while(--e>=0)r[e].stop();e=o.length;while(--e>=0){n=o[e],t=n.sources.length;while(--t>=0)n.sources[t].removeEventListener(n.type,n.handler)}return i&&i.call(this,this._handler,null,null,null),this},ND=function(e,t,n){var i=document.createElement(e);for(var r in t)i.setAttribute(r,t[r]);return null!=n&&(i.textContent=n),i};const TD="vega-bind",RD="vega-bind-name",zD="vega-bind-radio";var PD=function(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:t=>{t!==e.signal(i.signal)&&e.runAsync(null,(function(){r.source=!0,e.signal(i.signal,t)}))}},i.debounce&&(r.update=Object(h["m"])(i.debounce,r.update))),LD(r,t,i,e.signal(i.signal)),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r};function LD(e,t,n,i){const r=ND("div",{class:TD}),o="radio"===n.input?r:r.appendChild(ND("label"));o.appendChild(ND("span",{class:RD},n.name||n.signal)),t.appendChild(r);let a=BD;switch(n.input){case"checkbox":a=ID;break;case"select":a=UD;break;case"radio":a=qD;break;case"range":a=WD;break}a(e,o,n,i)}function BD(e,t,n,i){const r=ND("input");for(const o in n)"signal"!==o&&"element"!==o&&r.setAttribute("input"===o?"type":o,n[o]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=e=>r.value=e}function ID(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const o=ND("input",r);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=e=>o.checked=!!e||null}function UD(e,t,n,i){const r=ND("select",{name:n.signal}),o=n.labels||[];n.options.forEach((e,t)=>{const n={value:e};HD(e,i)&&(n.selected=!0),r.appendChild(ND("option",n,(o[t]||e)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=e=>{for(let t=0,i=n.options.length;t<i;++t)if(HD(n.options[t],e))return void(r.selectedIndex=t)}}function qD(e,t,n,i){const r=ND("span",{class:zD}),o=n.labels||[];t.appendChild(r),e.elements=n.options.map((t,a)=>{const s={type:"radio",name:n.signal,value:t};HD(t,i)&&(s.checked=!0);const u=ND("input",s);u.addEventListener("change",()=>e.update(t));const c=ND("label",{},(o[a]||t)+"");return c.prepend(u),r.appendChild(c),u}),e.set=t=>{const n=e.elements,i=n.length;for(let e=0;e<i;++e)HD(n[e].value,t)&&(n[e].checked=!0)}}function WD(e,t,n,i){i=void 0!==i?i:(+n.max+ +n.min)/2;const r=null!=n.max?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,a=n.step||Ze(o,r,100),s=ND("input",{type:"range",name:n.signal,min:o,max:r,step:a});s.value=i;const u=ND("span",{},+i);t.appendChild(s),t.appendChild(u);const c=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",c),s.addEventListener("change",c),e.elements=[s],e.set=e=>{s.value=e,u.textContent=e}}function HD(e,t){return e===t||e+""===t+""}var GD=function(e,t,n,i,r,o){return t=t||new i(e.loader()),t.initialize(n,gD(e),mD(e),vD(e),r,o).background(e.background())},VD=function(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null},YD=function(e,t,n,i){var r=new i(e.loader(),VD(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,vD(e),e);return t&&t.handlers().forEach((function(e){r.on(e.type,e.handler)})),r},ZD=function(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,o=Xv(i);e=n._el=e?XD(n,e):null,rD(n),o||n.error("Unrecognized renderer type: "+i);const a=o.handler||Mh,s=e?o.renderer:o.headless;return n._renderer=s?GD(n,n._renderer,e,s):null,n._handler=YD(n,n._handler,e,a),n._redraw=!0,e&&"none"!==r&&(t=t?n._elBind=XD(n,t):e.appendChild(ND("form",{class:"vega-bindings"})),n._bind.forEach((function(e){e.param.element&&"container"!==r&&(e.element=XD(n,e.param.element))})),n._bind.forEach((function(e){PD(n,e.element||t,e)}))),n};function XD(e,t){if("string"===typeof t){if("undefined"===typeof document)return e.error("DOM document instance not found."),null;if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}if(t)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}const JD=e=>+e||0,QD=e=>({top:e,bottom:e,left:e,right:e});var KD=function(e){return Object(h["F"])(e)?{top:JD(e.top),bottom:JD(e.bottom),left:JD(e.left),right:JD(e.right)}:QD(JD(e))},eS=async function(e,t,n,i){const r=Xv(t),o=r&&r.headless;return o||Object(h["n"])("Unrecognized renderer type: "+t),await e.runAsync(),GD(e,null,null,o,n,i).renderAsync(e._scenegraph.root)},tS=async function(e,t){e!==Yv.Canvas&&e!==Yv.SVG&&e!==Yv.PNG&&Object(h["n"])("Unrecognized image type: "+e);const n=await eS(this,e,t);return e===Yv.SVG?nS(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")};function nS(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}var iS=async function(e,t){const n=await eS(this,Yv.Canvas,e,t);return n.canvas()},rS=async function(e){const t=await eS(this,Yv.SVG,e);return t.svg()};function oS(e){const t=this.context.data[e];return t?t.values.value:[]}function aS(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r?r.count:r}function sS(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(h["gb"]).insert(t)),1}var uS=function(e,t,n){if(e){const n=this.context.dataflow,i=e.mark.source;n.pulse(i,n.changeset().encode(e,t))}return void 0!==n?n:e};const cS=e=>function(t,n){const i=this.context.dataflow.locale();return i[e](n)(t)},lS=cS("format"),fS=cS("timeFormat"),dS=cS("utcFormat"),hS=cS("timeParse"),pS=cS("utcParse");var gS=new Date(2e3,0,1);function mS(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(gS.setYear(2e3),gS.setMonth(e),gS.setDate(t),fS.call(this,gS,n)):""}function vS(e){return mS.call(this,e,1,"%B")}function bS(e){return mS.call(this,e,1,"%b")}function yS(e){return mS.call(this,0,2+e,"%A")}function xS(e){return mS.call(this,0,2+e,"%a")}const OS=":",_S="@",wS="%",jS="$";var kS=n("8e31");function ES(e,t,n,i){t[0].type!==kS["b"]&&Object(h["n"])("First argument to data functions must be a string literal.");const r=t[0].value,o=OS+r;if(!Object(h["v"])(o,i))try{i[o]=n.getData(r).tuplesRef()}catch(a){}}function AS(e,t,n,i){t[0].type!==kS["b"]&&Object(h["n"])("First argument to indata must be a string literal."),t[1].type!==kS["b"]&&Object(h["n"])("Second argument to indata must be a string literal.");const r=t[0].value,o=t[1].value,a=_S+o;Object(h["v"])(a,i)||(i[a]=n.getData(r).indataRef(n,o))}function DS(e,t,n,i){if(t[0].type===kS["b"])SS(n,i,t[0].value);else for(e in n.scales)SS(n,i,e)}function SS(e,t,n){const i=wS+n;if(!Object(h["v"])(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function CS(e,t){let n;return Object(h["D"])(e)?e:Object(h["H"])(e)?(n=t.scales[e])&&n.value:void 0}function FS(e,t,n){t.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,n._bandwidth=DS,n._range=DS,n._scale=DS;const i=t=>"_["+(t.type===kS["b"]?Object(h["Z"])(wS+t.value):Object(h["Z"])(wS)+"+"+e(t))+"]";return{_bandwidth:e=>`this.__bandwidth(${i(e[0])})`,_range:e=>i(e[0])+".range()",_scale:t=>`${i(t[0])}(${e(t[1])})`}}var MS,$S,NS,TS,RS,zS=iO(),PS=iO(),LS={point:SO,lineStart:SO,lineEnd:SO,polygonStart:function(){zS.reset(),LS.lineStart=BS,LS.lineEnd=IS},polygonEnd:function(){var e=+zS;PS.add(e<0?dO+e:e),this.lineStart=this.lineEnd=this.point=SO},sphere:function(){PS.add(dO)}};function BS(){LS.point=US}function IS(){qS(MS,$S)}function US(e,t){LS.point=qS,MS=e,$S=t,e*=pO,t*=pO,NS=e,TS=bO(t=t/2+fO),RS=wO(t)}function qS(e,t){e*=pO,t*=pO,t=t/2+fO;var n=e-NS,i=n>=0?1:-1,r=i*n,o=bO(t),a=wO(t),s=RS*a,u=TS*o+s*bO(r),c=s*i*wO(r);zS.add(vO(c,u)),NS=e,TS=o,RS=a}var WS,HS,GS,VS,YS,ZS,XS,JS,QS,KS,eC=function(e){return PS.reset(),nO(e,LS),2*PS},tC=iO(),nC={point:iC,lineStart:oC,lineEnd:aC,polygonStart:function(){nC.point=sC,nC.lineStart=uC,nC.lineEnd=cC,tC.reset(),LS.polygonStart()},polygonEnd:function(){LS.polygonEnd(),nC.point=iC,nC.lineStart=oC,nC.lineEnd=aC,zS<0?(WS=-(GS=180),HS=-(VS=90)):tC>sO?VS=90:tC<-sO&&(HS=-90),KS[0]=WS,KS[1]=GS},sphere:function(){WS=-(GS=180),HS=-(VS=90)}};function iC(e,t){QS.push(KS=[WS=e,GS=e]),t<HS&&(HS=t),t>VS&&(VS=t)}function rC(e,t){var n=L_([e*pO,t*pO]);if(JS){var i=I_(JS,n),r=[i[1],-i[0],0],o=I_(r,i);W_(o),o=P_(o);var a,s=e-YS,u=s>0?1:-1,c=o[0]*hO*u,l=gO(s)>180;l^(u*YS<c&&c<u*e)?(a=o[1]*hO,a>VS&&(VS=a)):(c=(c+360)%360-180,l^(u*YS<c&&c<u*e)?(a=-o[1]*hO,a<HS&&(HS=a)):(t<HS&&(HS=t),t>VS&&(VS=t))),l?e<YS?lC(WS,e)>lC(WS,GS)&&(GS=e):lC(e,GS)>lC(WS,GS)&&(WS=e):GS>=WS?(e<WS&&(WS=e),e>GS&&(GS=e)):e>YS?lC(WS,e)>lC(WS,GS)&&(GS=e):lC(e,GS)>lC(WS,GS)&&(WS=e)}else QS.push(KS=[WS=e,GS=e]);t<HS&&(HS=t),t>VS&&(VS=t),JS=n,YS=e}function oC(){nC.point=rC}function aC(){KS[0]=WS,KS[1]=GS,nC.point=iC,JS=null}function sC(e,t){if(JS){var n=e-YS;tC.add(gO(n)>180?n+(n>0?360:-360):n)}else ZS=e,XS=t;LS.point(e,t),rC(e,t)}function uC(){LS.lineStart()}function cC(){sC(ZS,XS),LS.lineEnd(),gO(tC)>sO&&(WS=-(GS=180)),KS[0]=WS,KS[1]=GS,JS=null}function lC(e,t){return(t-=e)<0?t+360:t}function fC(e,t){return e[0]-t[0]}function dC(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var hC,pC,gC,mC,vC,bC,yC,xC,OC,_C,wC,jC,kC,EC,AC,DC,SC=function(e){var t,n,i,r,o,a,s;if(VS=GS=-(WS=HS=1/0),QS=[],nO(e,nC),n=QS.length){for(QS.sort(fC),t=1,i=QS[0],o=[i];t<n;++t)r=QS[t],dC(i,r[0])||dC(i,r[1])?(lC(i[0],r[1])>lC(i[0],i[1])&&(i[1]=r[1]),lC(r[0],i[1])>lC(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-1/0,n=o.length-1,t=0,i=o[n];t<=n;i=r,++t)r=o[t],(s=lC(i[1],r[0]))>a&&(a=s,WS=r[0],GS=i[1])}return QS=KS=null,WS===1/0||HS===1/0?[[NaN,NaN],[NaN,NaN]]:[[WS,HS],[GS,VS]]},CC={sphere:SO,point:FC,lineStart:$C,lineEnd:RC,polygonStart:function(){CC.lineStart=zC,CC.lineEnd=PC},polygonEnd:function(){CC.lineStart=$C,CC.lineEnd=RC}};function FC(e,t){e*=pO,t*=pO;var n=bO(t);MC(n*bO(e),n*wO(e),wO(t))}function MC(e,t,n){++hC,gC+=(e-gC)/hC,mC+=(t-mC)/hC,vC+=(n-vC)/hC}function $C(){CC.point=NC}function NC(e,t){e*=pO,t*=pO;var n=bO(t);EC=n*bO(e),AC=n*wO(e),DC=wO(t),CC.point=TC,MC(EC,AC,DC)}function TC(e,t){e*=pO,t*=pO;var n=bO(t),i=n*bO(e),r=n*wO(e),o=wO(t),a=vO(kO((a=AC*o-DC*r)*a+(a=DC*i-EC*o)*a+(a=EC*r-AC*i)*a),EC*i+AC*r+DC*o);pC+=a,bC+=a*(EC+(EC=i)),yC+=a*(AC+(AC=r)),xC+=a*(DC+(DC=o)),MC(EC,AC,DC)}function RC(){CC.point=FC}function zC(){CC.point=LC}function PC(){BC(jC,kC),CC.point=FC}function LC(e,t){jC=e,kC=t,e*=pO,t*=pO,CC.point=BC;var n=bO(t);EC=n*bO(e),AC=n*wO(e),DC=wO(t),MC(EC,AC,DC)}function BC(e,t){e*=pO,t*=pO;var n=bO(t),i=n*bO(e),r=n*wO(e),o=wO(t),a=AC*o-DC*r,s=DC*i-EC*o,u=EC*r-AC*i,c=kO(a*a+s*s+u*u),l=DO(c),f=c&&-l/c;OC+=f*a,_C+=f*s,wC+=f*u,pC+=l,bC+=l*(EC+(EC=i)),yC+=l*(AC+(AC=r)),xC+=l*(DC+(DC=o)),MC(EC,AC,DC)}var IC=function(e){hC=pC=gC=mC=vC=bC=yC=xC=OC=_C=wC=0,nO(e,CC);var t=OC,n=_C,i=wC,r=t*t+n*n+i*i;return r<uO&&(t=bC,n=yC,i=xC,pC<sO&&(t=gC,n=mC,i=vC),r=t*t+n*n+i*i,r<uO)?[NaN,NaN]:[vO(n,t)*hO,DO(i/kO(r))*hO]};function UC(e,t){return function(n,i,r){if(n){const t=CS(n,(r||this).context);return t&&t.path[e](i)}return t(i)}}const qC=UC("area",eC),WC=UC("bounds",SC),HC=UC("centroid",IC);var GC=function(e){let t=this.context.group,n=!1;if(t)while(e){if(e===t){n=!0;break}e=e.mark.group}return n};function VC(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function YC(){return VC(this.context.dataflow,"warn",arguments)}function ZC(){return VC(this.context.dataflow,"info",arguments)}function XC(){return VC(this.context.dataflow,"debug",arguments)}function JC(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function QC(e){const t=Object(sk["g"])(e),n=JC(t.r),i=JC(t.g),r=JC(t.b);return.2126*n+.7152*i+.0722*r}function KC(e,t){const n=QC(e),i=QC(t),r=Math.max(n,i),o=Math.min(n,i);return(r+.05)/(o+.05)}var eF=function(){var e=[].slice.call(arguments);return e.unshift({}),h["o"].apply(null,e)};function tF(e,t){return e===t||e!==e&&t!==t||(Object(h["A"])(e)?!(!Object(h["A"])(t)||e.length!==t.length)&&nF(e,t):!(!Object(h["F"])(e)||!Object(h["F"])(t))&&iF(e,t))}function nF(e,t){for(let n=0,i=e.length;n<i;++n)if(!tF(e[n],t[n]))return!1;return!0}function iF(e,t){for(let n in e)if(!tF(e[n],t[n]))return!1;return!0}function rF(e){return t=>iF(e,t)}var oF=function(e,t,n,i,r,o){let a,s,u=this.context.dataflow,c=this.context.data[e],l=c.input,f=c.changes,d=u.stamp();if(!1===u._trigger||!(l.value.length||t||i))return 0;if((!f||f.stamp<d)&&(c.changes=f=u.changeset(),f.stamp=d,u.runAfter((function(){c.modified=!0,u.pulse(l,f).run()}),!0,1)),n&&(a=!0===n?h["gb"]:Object(h["A"])(n)||b(n)?n:rF(n),f.remove(a)),t&&f.insert(t),i&&(a=rF(i),l.value.some(a)?f.remove(a):f.insert(i)),r)for(s in o)f.modify(r,s,o[s]);return 1};function aF(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function sF(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}function uF(e,t,n){return Xh(e||0,t||0,n||0)}function cF(e,t){const n=CS(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function lF(e,t){const n=CS(e,(t||this).context);return n?n.copy():void 0}function fF(e,t){const n=CS(e,(t||this).context);return n?n.domain():[]}function dF(e,t,n){const i=CS(e,(n||this).context);return i?Object(h["A"])(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function hF(e,t){const n=CS(e,(t||this).context);return n&&n.range?n.range():[]}function pF(e,t,n){const i=CS(e,(n||this).context);return i?i(t):void 0}var gF=function(e,t,n,i,r){e=CS(e,(r||this).context);const o=Cu(t,n);let a=e.domain(),s=a[0],u=Object(h["U"])(a),c=h["x"];return u-s?c=hm(e,s,u):e=(e.interpolator?Qg("sequential")().interpolator(e.interpolator()):Qg("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+i||15),s!==a[0]&&a.unshift(s),u!==Object(h["U"])(a)&&a.push(u)),a.forEach(t=>o.stop(c(t),e(t))),o};function mF(e,t,n){const i=CS(e,(n||this).context);return function(e){return i?i.path.context(e)(t):""}}function vF(e){let t=null;return function(n){return n?cc(n,t=t||Xu(e)):e}}const bF=e=>e.data;function yF(e,t){const n=oS.call(t,e);return n.root&&n.root.lookup||{}}function xF(e,t,n){const i=yF(e,this),r=i[t],o=i[n];return r&&o?r.path(o).map(bF):void 0}function OF(e,t){const n=yF(e,this)[t];return n?n.ancestors().map(bF):void 0}const _F=()=>"undefined"!==typeof window&&window||null;function wF(){const e=_F();return e?e.screen:{}}function jF(){const e=_F();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function kF(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}const EF="intersect",AF="union",DF="vlMulti",SF="or",CF="and";var FF="E",MF="R",$F="R-E",NF="R-LE",TF="R-RE",RF="index:unit";function zF(e,t){for(var n,i,r=t.fields,o=t.values,a=r.length,s=0;s<a;++s)if(i=r[s],i.getter=h["t"].getter||Object(h["t"])(i.field),n=i.getter(e),Object(h["C"])(n)&&(n=Object(h["cb"])(n)),Object(h["C"])(o[s])&&(o[s]=Object(h["cb"])(o[s])),Object(h["C"])(o[s][0])&&(o[s]=o[s].map(h["cb"])),i.type===FF){if(Object(h["A"])(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if(i.type===MF){if(!Object(h["z"])(n,o[s]))return!1}else if(i.type===TF){if(!Object(h["z"])(n,o[s],!0,!1))return!1}else if(i.type===$F){if(!Object(h["z"])(n,o[s],!1,!1))return!1}else if(i.type===NF&&!Object(h["z"])(n,o[s],!1,!0))return!1;return!0}function PF(e,t,n){for(var i,r,o,a,s,u=this.context.data[e],c=u?u.values.value:[],l=u?u[RF]&&u[RF].value:void 0,f=n===EF,d=c.length,h=0;h<d;++h)if(i=c[h],l&&f){if(r=r||{},o=r[a=i.unit]||0,-1===o)continue;if(s=zF(t,i),r[a]=s?-1:++o,s&&1===l.size)return!0;if(!s&&o===l.get(a).count)return!1}else if(s=zF(t,i),f^s)return s;return d&&f}function LF(e,t,n){for(var i,r,o,a,s,u,c,l,f,d,p,g=this.context.data[e],m=g?g.values.value:[],v={},b={},y={},x=m.length,O=0;O<x;++O){for(i=m[O],a=i.unit,r=i.fields,o=i.values,d=0,p=r.length;d<p;++d)s=r[d],u=v[s.field]||(v[s.field]={}),c=u[a]||(u[a]=[]),y[s.field]=l=s.type.charAt(0),f=BF[l+"_union"],u[a]=f(c,Object(h["i"])(o[d]));n&&(c=b[a]||(b[a]=[]),c.push(Object(h["i"])(o).reduce((e,t,n)=>(e[r[n].field]=t,e),{})))}return t=t||AF,Object.keys(v).forEach((function(e){v[e]=Object.keys(v[e]).map(t=>v[e][t]).reduce((n,i)=>void 0===n?i:BF[y[e]+"_"+t](n,i))})),m=Object.keys(b),n&&m.length&&(v[DF]=t===AF?{[SF]:m.reduce((e,t)=>(e.push.apply(e,b[t]),e),[])}:{[CF]:m.map(e=>({[SF]:b[e]}))}),v}var BF={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((function(e){return t.indexOf(e)>=0})):t},R_union:function(e,t){var n=Object(h["cb"])(t[0]),i=Object(h["cb"])(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=Object(h["cb"])(t[0]),i=Object(h["cb"])(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const IF=":",UF="@";function qF(e,t,n,i){t[0].type!==kS["b"]&&Object(h["n"])("First argument to selection functions must be a string literal.");const r=t[0].value,o=t.length>=2&&Object(h["U"])(t).value,a="unit",s=UF+a,u=IF+r;o!==EF||Object(h["v"])(i,s)||(i[s]=n.getData(r).indataRef(n,a)),Object(h["v"])(i,u)||(i[u]=n.getData(r).tuplesRef())}var WF=n("62f0"),HF=function(e,t,n){if(!e)return[];const[i,r]=e,o=(new gl).set(i[0],i[1],r[0],r[1]),a=n||this.context.dataflow.scenegraph().root;return Jv(a,o,GF(t))};function GF(e){let t=null;if(e){const n=Object(h["i"])(e.marktype),i=Object(h["i"])(e.markname);t=e=>(!n.length||n.some(t=>e.marktype===t))&&(!i.length||i.some(t=>e.name===t))}return t}const VF={random:function(){return Cr()},cumulativeNormal:Ur,cumulativeLogNormal:Zr,cumulativeUniform:to,densityNormal:Ir,densityLogNormal:Yr,densityUniform:eo,quantileNormal:qr,quantileLogNormal:Xr,quantileUniform:no,sampleNormal:Br,sampleLogNormal:Vr,sampleUniform:Kr,isArray:h["A"],isBoolean:h["B"],isDate:h["C"],isDefined:function(e){return void 0!==e},isNumber:h["E"],isObject:h["F"],isRegExp:h["G"],isString:h["H"],isTuple:b,isValid:function(e){return null!=e&&e===e},toBoolean:h["ab"],toDate:h["bb"],toNumber:h["cb"],toString:h["eb"],flush:h["u"],lerp:h["J"],merge:eF,pad:h["P"],peek:h["U"],span:h["X"],inrange:h["z"],truncate:h["fb"],rgb:sk["g"],lab:WF["a"],hcl:WF["b"],hsl:sk["f"],luminance:QC,contrast:KC,sequence:ls,format:lS,utcFormat:dS,utcParse:pS,utcOffset:gn,utcSequence:bn,timeFormat:fS,timeParse:hS,timeOffset:pn,timeSequence:vn,timeUnitSpecifier:jt,monthFormat:vS,monthAbbrevFormat:bS,dayFormat:yS,dayAbbrevFormat:xS,quarter:h["V"],utcquarter:h["hb"],week:Mt,utcweek:Pt,dayofyear:Ft,utcdayofyear:zt,warn:YC,info:ZC,debug:XC,extent:h["p"],inScope:GC,intersect:HF,clampRange:h["j"],pinchDistance:aF,pinchAngle:sF,screen:wF,containerSize:kF,windowSize:jF,bandspace:uF,setdata:sS,pathShape:vF,panLinear:h["Q"],panLog:h["R"],panPow:h["S"],panSymlog:h["T"],zoomLinear:h["lb"],zoomLog:h["mb"],zoomPow:h["nb"],zoomSymlog:h["ob"],encode:uS,modify:oF},YF=["view","item","group","xy","x","y"],ZF="event.vega.",XF="this.",JF={};function QF(e){const t=Object(kS["e"])(e);YF.forEach(e=>t[e]=ZF+e);for(let n in VF)t[n]=XF+n;return Object(h["o"])(t,FS(e,VF,JF)),t}function KF(e,t,n){return 1===arguments.length?VF[e]:(VF[e]=t,n&&(JF[e]=n),tM&&(tM.functions[e]=XF+e),this)}KF("bandwidth",cF,DS),KF("copy",lF,DS),KF("domain",fF,DS),KF("range",hF,DS),KF("invert",dF,DS),KF("scale",pF,DS),KF("gradient",gF,DS),KF("geoArea",qC,DS),KF("geoBounds",WC,DS),KF("geoCentroid",HC,DS),KF("geoShape",mF,DS),KF("indata",aS,AS),KF("data",oS,ES),KF("treePath",xF,ES),KF("treeAncestors",OF,ES),KF("vlSelectionTest",PF,qF),KF("vlSelectionResolve",LF,qF);const eM={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_["+Object(h["Z"])(jS+e)+"]",functions:QF,constants:kS["d"],visitors:JF};var tM=Object(kS["c"])(eM),nM=function(e,t){var n,i,r={};try{e=Object(h["H"])(e)?e:Object(h["Z"])(e)+"",n=Object(kS["f"])(e)}catch(o){Object(h["n"])("Expression parse error: "+e)}return n.visit(e=>{if(e.type===kS["a"]){var n=e.callee.name,i=eM.visitors[n];i&&i(n,e.arguments,t,r)}}),i=tM(n),i.globals.forEach(e=>{var n=jS+e;!Object(h["v"])(r,n)&&t.getSignal(e)&&(r[n]=t.signalRef(e))}),{$expr:Object(h["o"])({code:i.code},t.options.ast?{ast:n}:null),$fields:i.fields,$params:r}},iM=function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(e=>t.parseOperator(e)),n.forEach(e=>t.parseOperatorParameters(e)),(e.streams||[]).forEach(e=>t.parseStream(e)),(e.updates||[]).forEach(e=>t.parseUpdate(e)),t.resolve()};const rM=Object(h["db"])(["rule"]),oM=Object(h["db"])(["group","image","rect"]);function aM(e,t){let n="";return rM[t]||(e.x2&&(e.x?(oM[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(oM[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function sM(e){return(e+"").toLowerCase()}function uM(e){return"operator"===sM(e)}function cM(e){return"collect"===sM(e)}function lM(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");var i=Function.apply(null,t.concat(n));return e&&e.functions?i.bind(e.functions):i}function fM(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${i}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${i} : `}var dM={operator:(e,t)=>lM(e,["_"],t.code),parameter:(e,t)=>lM(e,["datum","_"],t.code),event:(e,t)=>lM(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return lM(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const o in i){const e="o["+Object(h["Z"])(o)+"]";r+=`$=${i[o].code};if(${e}!==$)${e}=$,m=1;`}return r+=aM(i,n),r+="return m;",lM(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(h["Z"]).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(e,i)=>{const r=t[i];let o,a;return e.path?(o="a"+e.path,a="b"+e.path):((n=n||{})["f"+i]=e,o=`this.f${i}(a)`,a=`this.f${i}(b)`),fM(o,a,-r,r)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function hM(e){const t=this;uM(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function pM(e){const t=this;if(e.params){const n=t.get(e.id);n||Object(h["n"])("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function gM(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Object(h["A"])(r)?r.map(e=>mM(e,n,t)):mM(r,n,t)}return t}function mM(e,t,n){if(!e||!Object(h["F"])(e))return e;for(let i,r=0,o=vM.length;r<o;++r)if(i=vM[r],Object(h["v"])(e,i.key))return i.parse(e,t,n);return e}var vM=[{key:"$ref",parse:bM},{key:"$key",parse:xM},{key:"$expr",parse:yM},{key:"$field",parse:OM},{key:"$encode",parse:wM},{key:"$compare",parse:_M},{key:"$context",parse:jM},{key:"$subflow",parse:kM},{key:"$tupleid",parse:EM}];function bM(e,t){return t.get(e.$ref)||Object(h["n"])("Operator not defined: "+e.$ref)}function yM(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=Object(h["f"])(t.parameterExpression(e.$expr),e.$fields,e.$name))}function xM(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Object(h["I"])(e.$key,e.$flat,t.expr.codegen))}function OM(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Object(h["t"])(e.$field,e.$name,t.expr.codegen))}function _M(e,t){const n="c:"+e.$compare+"_"+e.$order,i=Object(h["i"])(e.$compare).map(e=>e&&e.$tupleid?y:e);return t.fn[n]||(t.fn[n]=Object(h["k"])(i,e.$order,t.expr.codegen))}function wM(e,t){const n=e.$encode,i={};for(const r in n){const e=n[r];i[r]=Object(h["f"])(t.encodeExpression(e.$expr),e.$fields),i[r].output=e.$output}return i}function jM(e,t){return t}function kM(e,t){const n=e.$subflow;return function(e,i,r){const o=t.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(r),a.detachSubflow=()=>t.detach(o),a}}function EM(){return y}var AM=function(e){var t,n=this,i=null!=e.filter?n.eventExpression(e.filter):void 0,r=null!=e.stream?n.get(e.stream):void 0;e.source?r=n.events(e.source,e.type,i):e.merge&&(t=e.merge.map(e=>n.get(e)),r=t[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map(e=>n.get(e)),r=r.between(t[0],t[1])),e.filter&&(r=r.filter(i)),null!=e.throttle&&(r=r.throttle(+e.throttle)),null!=e.debounce&&(r=r.debounce(+e.debounce)),null==r&&Object(h["n"])("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),n.stream(e,r)},DM=function(e){var t=this,n=Object(h["F"])(n=e.source)?n.$ref:n,i=t.get(n),r=null,o=e.update,a=void 0;i||Object(h["n"])("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(a=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,i,r,o,a)},SM={skip:!0};function CM(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(n=>{var r=t.signals[n];e.signals(n,r)&&(i[n]=r.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(n=>{var i=t.data[n];e.data(n,i)&&(r[n]=i.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(t=>t.getState(e))),n}function FM(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(e=>{n.update(t.signals[e],r[e],SM)}),Object.keys(i||{}).forEach(e=>{n.pulse(t.data[e].input,n.changeset().remove(h["gb"]).insert(i[e]))}),(e.subcontext||[]).forEach((e,n)=>{var i=t.subcontext[n];i&&i.setState(e)})}var MM=function(e,t,n,i){return new $M(e,t,n,i)};function $M(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||dM,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function NM(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}$M.prototype=NM.prototype={fork(){const e=new NM(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(t=>t!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),cM(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){var o=n.get(e.parent.$ref);o?(i.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),i.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const i=n.data[a]||(n.data[a]={});e.data[a].forEach(e=>i[e]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[sM(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:iM,parseOperator:hM,parseOperatorParameters:pM,parseParameters:gM,parseStream:AM,parseUpdate:DM,getState:CM,setState:FM};var TM=function(e,t,n){return MM(e,Xi,VF,n).parse(t)};function RM(e){var t=this._runtime.scales;return Object(h["v"])(t,e)||Object(h["n"])("Unrecognized scale or projection: "+e),t[e].value}var zM="width",PM="height",LM="padding",BM={skip:!0};function IM(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===LM?i.left+i.right:0)}function UM(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===LM?i.top+i.bottom:0)}function qM(e){var t=e._signals,n=t[zM],i=t[PM],r=t[LM];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size,e._viewWidth=IM(e,t.size),o()}),{size:n}),e._resizeHeight=e.add(null,(function(t){e._height=t.size,e._viewHeight=UM(e,t.size),o()}),{size:i});var a=e.add(null,o,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,a.rank=r.rank+1}function WM(e,t,n,i,r,o){this.runAfter((function(a){var s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(zM,n,BM),a._resizeWidth.skip(!0)),a.height()!==i&&(s=1,a.signal(PM,i,BM),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),a._origin[0]===r[0]&&a._origin[1]===r[1]||(a._resize=1,a._origin=r),s&&a.run("enter"),o&&a.runAfter(e=>e.resize())}),!1,1)}function HM(e){return this._runtime.getState(e||{data:GM,signals:VM,recurse:!0})}function GM(e,t){return t.modified&&Object(h["A"])(t.input.value)&&e.indexOf("_:vega:_")}function VM(e,t){return!("parent"===e||t instanceof Xi.proxy)}function YM(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},e=>{e._trigger=!0}),this}var ZM=n("d5bc"),XM=function(e,t){function n(t){e({timestamp:Date.now(),elapsed:t})}this._timers.push(Object(ZM["a"])(n,t))},JM=function(e,t,n,i){var r=e.element();r&&r.setAttribute("title",QM(i))};function QM(e){return null==e?"":Object(h["A"])(e)?e$(e):Object(h["F"])(e)&&!Object(h["C"])(e)?KM(e):e+""}function KM(e){return Object.keys(e).map((function(t){var n=e[t];return t+": "+(Object(h["A"])(n)?e$(n):t$(n))})).join("\n")}function e$(e){return"["+e.map(t$).join(", ")+"]"}function t$(e){return Object(h["A"])(e)?"[]":Object(h["F"])(e)&&!Object(h["C"])(e)?"{}":e}function n$(e,t){const n=this;if(t=t||{},Hi.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const i=Object(h["o"])({},e.locale,t.locale);n.locale(Yn(i.number,i.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Yv.Canvas,n._scenegraph=new Zd;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||JM,n._redraw=!0,n._handler=(new Mh).scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=kD(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=TM(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(e=>({state:null,param:Object(h["o"])({},e)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=IM(n,n._width),n._viewHeight=UM(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,qM(n),aD(n),uD(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}var i$=Object(h["y"])(n$,Hi);function r$(e,t){return Object(h["v"])(e._signals,t)?e._signals[t]:Object(h["n"])("Unrecognized signal name: "+Object(h["Z"])(t))}function o$(e,t){const n=(e._targets||[]).filter(e=>e._update&&e._update.handler===t);return n.length?n[0]:null}function a$(e,t,n,i){var r=o$(n,i);return r||(r=VD(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function s$(e,t,n){var i=o$(t,n);return i&&t._targets.remove(i),e}i$.evaluate=async function(e,t,n){if(await Hi.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,bD(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&g(this,n),this},i$.dirty=function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},i$.description=function(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&oD(this._el,this._desc=t),this}return this._desc},i$.container=function(){return this._el},i$.scenegraph=function(){return this._scenegraph},i$.origin=function(){return this._origin.slice()},i$.signal=function(e,t,n){var i=r$(this,e);return 1===arguments.length?i.value:this.update(i,t,n)},i$.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")},i$.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")},i$.padding=function(e){return arguments.length?this.signal("padding",KD(e)):KD(this.signal("padding"))},i$.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},i$.background=function(e){return arguments.length?this.signal("background",e):this.signal("background")},i$.renderer=function(e){return arguments.length?(Xv(e)||Object(h["n"])("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},i$.tooltip=function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},i$.loader=function(e){return arguments.length?(e!==this._loader&&(Hi.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},i$.resize=function(){return this._autosize=1,this.touch(r$(this,"autosize"))},i$._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},i$._resizeView=WM,i$.addEventListener=function(e,t,n){var i=t;return n&&!1===n.trap||(i=VD(this,t),i.raw=t),this._handler.on(e,i),this},i$.removeEventListener=function(e,t){var n,i,r=this._handler.handlers(e),o=r.length;while(--o>=0)if(i=r[o].type,n=r[o].handler,e===i&&(t===n||t===n.raw)){this._handler.off(i,n);break}return this},i$.addResizeListener=function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},i$.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},i$.addSignalListener=function(e,t){return a$(this,e,r$(this,e),t)},i$.removeSignalListener=function(e,t){return s$(this,r$(this,e),t)},i$.addDataListener=function(e,t){return a$(this,e,lD(this,e).values,t)},i$.removeDataListener=function(e,t){return s$(this,lD(this,e).values,t)},i$.globalCursor=function(e){if(arguments.length){if(this._globalCursor!==!!e){const t=cD(this,null);this._globalCursor=!!e,t&&cD(this,t)}return this}return this._globalCursor},i$.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},i$.timer=XM,i$.events=DD,i$.finalize=$D,i$.hover=MD,i$.data=fD,i$.change=dD,i$.insert=hD,i$.remove=pD,i$.scale=RM,i$.initialize=ZD,i$.toImageURL=tS,i$.toCanvas=iS,i$.toSVG=rS,i$.getState=HM,i$.setState=YM;var u$=function(e){return Object(h["F"])(e)?e:{type:e||"pad"}};const c$=e=>+e||0,l$=e=>({top:e,bottom:e,left:e,right:e});var f$=function(e){return Object(h["F"])(e)?e.signal?e:{top:c$(e.top),bottom:c$(e.bottom),left:c$(e.left),right:c$(e.right)}:l$(c$(e))};const d$=e=>Object(h["F"])(e)&&!Object(h["A"])(e)?Object(h["o"])({},e):{value:e};function h$(e,t,n,i){return null!=n?(Object(h["F"])(n)&&!Object(h["A"])(n)?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function p$(e,t,n){for(const i in t)h$(e,i,t[i]);for(const i in n)h$(e,i,n[i],"update")}function g$(e,t,n){for(const i in t)n&&Object(h["v"])(n,i)||(e[i]=Object(h["o"])(e[i]||{},t[i]));return e}function m$(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var v$="mark",b$="frame",y$="scope",x$="axis",O$="axis-domain",_$="axis-grid",w$="axis-label",j$="axis-tick",k$="axis-title",E$="legend",A$="legend-band",D$="legend-entry",S$="legend-gradient",C$="legend-label",F$="legend-symbol",M$="legend-title",$$="title",N$="title-text",T$="title-subtitle",R$=function(e,t,n,i,r){const o={},a={};let s,u,c,l;for(u in u="lineBreak","text"!==t||null==r[u]||m$(u,e)||z$(o,u,r[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),l=n===b$?r.group:n===v$?Object(h["o"])({},r.mark,r[t]):null,l)c=m$(u,e)||("fill"===u||"stroke"===u)&&(m$("fill",e)||m$("stroke",e)),c||z$(o,u,l[u]);for(u in Object(h["i"])(i).forEach(t=>{const n=r.style&&r.style[t];for(const i in n)m$(i,e)||z$(o,i,n[i])}),e=Object(h["o"])({},e),o)l=o[u],l.signal?(s=s||{})[u]=l:a[u]=l;return e.enter=Object(h["o"])(a,e.enter),s&&(e.update=Object(h["o"])(s,e.update)),e};function z$(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const P$=e=>Object(h["H"])(e)?Object(h["Z"])(e):e.signal?`(${e.signal})`:W$(e);function L$(e){if(null!=e.gradient)return U$(e);let t=e.signal?`(${e.signal})`:e.color?I$(e.color):null!=e.field?W$(e.field):void 0!==e.value?Object(h["Z"])(e.value):void 0;return null!=e.scale&&(t=G$(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${q$(e.exponent)})`),null!=e.mult&&(t+="*"+q$(e.mult)),null!=e.offset&&(t+="+"+q$(e.offset)),e.round&&(t=`round(${t})`),t}const B$=(e,t,n,i)=>`(${e}(${[t,n,i].map(L$).join(",")})+'')`;function I$(e){return e.c?B$("hcl",e.h,e.c,e.l):e.h||e.s?B$("hsl",e.h,e.s,e.l):e.l||e.a?B$("lab",e.l,e.a,e.b):e.r||e.g||e.b?B$("rgb",e.r,e.g,e.b):null}function U$(e){const t=[e.start,e.stop,e.count].map(e=>null==e?null:Object(h["Z"])(e));while(t.length&&null==Object(h["U"])(t))t.pop();return t.unshift(P$(e.gradient)),`gradient(${t.join(",")})`}function q$(e){return Object(h["F"])(e)?"("+L$(e)+")":e}function W$(e){return H$(Object(h["F"])(e)?e:{datum:e})}function H$(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){n=Math.max(1,e.level||1),t="item";while(n-- >0)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):Object(h["n"])("Invalid field reference: "+Object(h["Z"])(e));return e.signal||(i=Object(h["H"])(i)?Object(h["Y"])(i).map(h["Z"]).join("]["):H$(i)),t+"["+i+"]"}function G$(e,t){const n=P$(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1===+e.band?"":"*"+q$(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0")),t}var V$=function(e){let t="";return e.forEach(e=>{const n=L$(e);t+=e.test?`(${e.test})?${n}:`:n}),":"===Object(h["U"])(t)&&(t+="null"),t},Y$=function(e,t,n,i,r,o){const a={};o=o||{},o.encoders={$encode:a},e=R$(e,t,n,i,r.config);for(const s in e)a[s]=Z$(e[s],t,o,r);return o};function Z$(e,t,n,i){const r={},o={};for(const a in e)null!=e[a]&&(r[a]=J$(X$(e[a]),i,n,o));return{$expr:{marktype:t,channels:r},$fields:Object.keys(o),$output:Object.keys(e)}}function X$(e){return Object(h["A"])(e)?V$(e):L$(e)}function J$(e,t,n,i){const r=nM(e,t);return r.$fields.forEach(e=>i[e]=1),Object(h["o"])(n,r.$params),r.$expr}var Q$="outer",K$=["value","update","init","react","bind"];function eN(e,t){Object(h["n"])(e+' for "outer" push: '+Object(h["Z"])(t))}var tN=function(e,t){var n=e.name;if(e.push===Q$)t.signals[n]||eN("No prior signal definition",n),K$.forEach((function(t){void 0!==e[t]&&eN("Invalid property ",t)}));else{var i=t.addSignal(n,e.value);!1===e.react&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}};function nN(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function iN(e,t,n,i){return new nN(e,t,n,i)}function rN(e,t){return iN("operator",e,t)}function oN(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function aN(e,t){return t?{$field:e,$name:t}:{$field:e}}var sN=aN("key");function uN(e,t){return{$compare:e,$order:t}}function cN(e,t){var n={$key:e};return t&&(n.$flat=!0),n}var lN="ascending",fN="descending";function dN(e){return Object(h["F"])(e)?(e.order===fN?"-":"+")+hN(e.op,e.field):""}function hN(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var pN="scope",gN="view";function mN(e){return e&&e.signal}function vN(e){return e&&e.expr}function bN(e){if(mN(e))return!0;if(Object(h["F"])(e))for(var t in e)if(bN(e[t]))return!0;return!1}function yN(e,t){return null!=e?e:t}function xN(e){return e&&e.signal||e}var ON="timer";function _N(e,t){var n=e.merge?jN:e.stream?kN:e.type?EN:Object(h["n"])("Invalid stream specification: "+Object(h["Z"])(e));return n(e,t)}function wN(e){return e===pN?gN:e||gN}function jN(e,t){var n=e.merge.map(e=>_N(e,t)),i=AN({merge:n},e,t);return t.addStream(i).id}function kN(e,t){var n=_N(e.stream,t),i=AN({stream:n},e,t);return t.addStream(i).id}function EN(e,t){var n,i;return e.type===ON?(n=t.event(ON,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(wN(e.source),e.type),i=AN({stream:n},e,t),1===Object.keys(i).length?n:t.addStream(i).id}function AN(e,t,n){var i=t.between;return i&&(2!==i.length&&Object(h["n"])('Stream "between" parameter must have 2 entries: '+Object(h["Z"])(t)),e.between=[_N(i[0],n),_N(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(DN(t.marktype,t.markname,t.markrole)),t.source===pN&&i.push("inScope(event.item)"),i.length&&(e.filter=nM("("+i.join(")&&(")+")",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function DN(e,t,n){var i="event.item";return i+(e&&"*"!==e?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}var SN=n("f127");const CN={code:"_.$value",ast:{type:"Identifier",value:"value"}};var FN=function(e,t,n){var i=e.events,r=e.update,o=e.encode,a=[],s={target:n};i||Object(h["n"])("Signal update missing events specification."),Object(h["H"])(i)&&(i=Object(SN["a"])(i,t.isSubscope()?pN:gN)),i=Object(h["i"])(i).filter(e=>e.signal||e.scale?(a.push(e),0):1),a.length>1&&(a=[$N(a)]),i.length&&a.push(i.length>1?{merge:i}:i[0]),null!=o&&(r&&Object(h["n"])("Signal encode and update are mutually exclusive."),r="encode(item(),"+Object(h["Z"])(o)+")"),s.update=Object(h["H"])(r)?nM(r,t):null!=r.expr?nM(r.expr,t):null!=r.value?r.value:null!=r.signal?{$expr:CN,$params:{$value:t.signalRef(r.signal)}}:Object(h["n"])("Invalid signal update specification."),e.force&&(s.options={force:!0}),a.forEach((function(e){t.addUpdate(Object(h["o"])(MN(e,t),s))}))};function MN(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):_N(e,t)}}function $N(e){return{signal:"["+e.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"}}var NN=function(e,t){var n=t.getSignal(e.name),i=e.update;e.init&&(i?Object(h["n"])("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=nM(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach((function(e){FN(e,t,n.id)}))};const TN=e=>(t,n,i)=>iN(e,n,t||void 0,i);var RN=TN("aggregate"),zN=TN("axisticks"),PN=TN("bound"),LN=TN("collect"),BN=TN("compare"),IN=TN("datajoin"),UN=TN("encode"),qN=TN("expression"),WN=(TN("extent"),TN("facet")),HN=TN("field"),GN=TN("key"),VN=TN("legendentries"),YN=TN("load"),ZN=TN("mark"),XN=TN("multiextent"),JN=TN("multivalues"),QN=TN("overlap"),KN=TN("params"),eT=TN("prefacet"),tT=TN("projection"),nT=TN("proxy"),iT=TN("relay"),rT=TN("render"),oT=TN("scale"),aT=TN("sieve"),sT=TN("sortitems"),uT=TN("viewlayout"),cT=TN("values"),lT=0,fT={min:"min",max:"max",count:"sum"};function dT(e,t){var n=e.type||"linear";Kg(n)||Object(h["n"])("Unrecognized scale type: "+Object(h["Z"])(n)),t.addScale(e.name,{type:n,domain:void 0})}function hT(e,t){var n,i=t.getScale(e.name).params;for(n in i.domain=vT(e.domain,e,t),null!=e.range&&(i.range=ST(e,t,i)),null!=e.interpolate&&DT(e.interpolate,i),null!=e.nice&&(i.nice=AT(e.nice)),null!=e.bins&&(i.bins=ET(e.bins,t)),e)Object(h["v"])(i,n)||"name"===n||(i[n]=pT(e[n],t))}function pT(e,t){return Object(h["F"])(e)?e.signal?t.signalRef(e.signal):Object(h["n"])("Unsupported object: "+Object(h["Z"])(e)):e}function gT(e,t){return e.signal?t.signalRef(e.signal):e.map(e=>pT(e,t))}function mT(e){Object(h["n"])("Can not find data set: "+Object(h["Z"])(e))}function vT(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(Object(h["A"])(e)?bT:e.fields?xT:yT)(e,t,n);null==t.domainMin&&null==t.domainMax||Object(h["n"])("No scale domain defined for domainMin/domainMax to override.")}function bT(e,t,n){return e.map((function(e){return pT(e,n)}))}function yT(e,t,n){var i=n.getData(e.data);return i||mT(e.data),nm(t.type)?i.valuesRef(n,e.field,wT(e.sort,!1)):sm(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function xT(e,t,n){var i=e.data,r=e.fields.reduce((function(e,t){return t=Object(h["H"])(t)?{data:i,field:t}:Object(h["A"])(t)||t.signal?OT(t,n):t,e.push(t),e}),[]);return(nm(t.type)?_T:sm(t.type)?jT:kT)(e,n,r)}function OT(e,t){var n="_:vega:_"+lT++,i=LN({});if(Object(h["A"])(e))i.value={$ingest:e};else if(e.signal){var r="setdata("+Object(h["Z"])(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,aT({})]),{data:n,field:"data"}}function _T(e,t,n){var i,r,o,a,s,u=wT(e.sort,!0);return i=n.map((function(e){var n=t.getData(e.data);return n||mT(e.data),n.countsRef(t,e.field,u)})),r={groupby:sN,pulse:i},u&&(o=u.op||"count",s=u.field?hN(o,u.field):"count",r.ops=[fT[o]],r.fields=[t.fieldRef(s)],r.as=[s]),o=t.add(RN(r)),a=t.add(LN({pulse:oN(o)})),s=t.add(cT({field:sN,sort:t.sortRef(u),pulse:oN(a)})),oN(s)}function wT(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!fT[e.op]&&Object(h["n"])("Multiple domain scales can not be sorted using "+e.op):Object(h["n"])("No field provided for sort aggregate op: "+e.op):Object(h["F"])(e)?e.field="key":e={field:"key"}),e}function jT(e,t,n){var i=n.map((function(e){var n=t.getData(e.data);return n||mT(e.data),n.domainRef(t,e.field)}));return oN(t.add(JN({values:i})))}function kT(e,t,n){var i=n.map((function(e){var n=t.getData(e.data);return n||mT(e.data),n.extentRef(t,e.field)}));return oN(t.add(XN({extents:i})))}function ET(e,t){return e.signal||Object(h["A"])(e)?gT(e,t):t.objectProperty(e)}function AT(e){return Object(h["F"])(e)?{interval:pT(e.interval),step:pT(e.step)}:pT(e)}function DT(e,t){t.interpolate=pT(e.type||e),null!=e.gamma&&(t.interpolateGamma=pT(e.gamma))}function ST(e,t,n){var i=e.range,r=t.config.range;if(i.signal)return t.signalRef(i.signal);if(Object(h["H"])(i)){if(r&&Object(h["v"])(r,i))return e=Object(h["o"])({},e,{range:r[i]}),ST(e,t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=nm(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Object(h["n"])("Unrecognized scale range value: "+Object(h["Z"])(i))}else{if(i.scheme)return n.scheme=Object(h["A"])(i.scheme)?gT(i.scheme,t):pT(i.scheme,t),i.extent&&(n.schemeExtent=gT(i.extent,t)),void(i.count&&(n.schemeCount=pT(i.count,t)));if(i.step)return void(n.rangeStep=pT(i.step,t));if(nm(e.type)&&!Object(h["A"])(i))return vT(i,e,t);Object(h["A"])(i)||Object(h["n"])("Unsupported range type: "+Object(h["Z"])(i))}return i.map(e=>(Object(h["A"])(e)?gT:pT)(e,t))}var CT=function(e,t){var n=t.config.projection||{},i={};for(var r in e)"name"!==r&&(i[r]=FT(e[r],r,t));for(r in n)null==i[r]&&(i[r]=FT(n[r],r,t));t.addProjection(e.name,i)};function FT(e,t,n){return Object(h["A"])(e)?e.map((function(e){return FT(e,t,n)})):Object(h["F"])(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Object(h["n"])("Unsupported parameter object: "+Object(h["Z"])(e)):e}const MT="top",$T="left",NT="right",TT="bottom",RT="center",zT="vertical",PT="start",LT="middle",BT="end",IT="index",UT="label",qT="offset",WT="perc",HT="perc2",GT="value",VT="guide-label",YT="guide-title",ZT="group-title",XT="group-subtitle",JT="symbol",QT="gradient",KT="discrete",eR="size",tR="shape",nR="fill",iR="stroke",rR="strokeWidth",oR="strokeDash",aR="opacity",sR=[eR,tR,nR,iR,rR,oR,aR],uR={name:1,style:1,interactive:1},cR={value:0},lR={value:1};var fR="group",dR="rect",hR="rule",pR="symbol",gR="text",mR=function(e){return e.type=fR,e.interactive=e.interactive||!1,e};function vR(e,t){const n=(n,i)=>yN(e[n],yN(t[n],i));return n.isVertical=n=>zT===yN(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>yN(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>yN(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>yN(e.columns,yN(t.columns,+n.isVertical(!0))),n}function bR(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function yR(e,t,n){var i=t.config.style[n];return i&&i[e]}function xR(e,t,n){return`item.anchor === '${PT}' ? ${e} : item.anchor === '${BT}' ? ${t} : ${n}`}const OR=xR(Object(h["Z"])($T),Object(h["Z"])(NT),Object(h["Z"])(RT));function _R(e){let t,n,i=e("tickBand"),r=e("tickOffset");return i?i.signal?(t={signal:`(${i.signal}) === 'extent' ? 1 : 0.5`},n={signal:`(${i.signal}) === 'extent'`},Object(h["F"])(r)||(r={signal:`(${i.signal}) === 'extent' ? 0 : ${r}`})):"extent"===i?(t=1,n=!0,r=0):(t=.5,n=!1):(t=e("bandPosition"),n=e("tickExtra")),{extra:n,band:t,offset:r}}function wR(e,t){return t?e?Object(h["F"])(e)?Object.assign({},e,{offset:wR(e.offset,t)}):{value:e,offset:t}:t:e}var jR=function(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=g$(e.encode,t,uR)):e.interactive=!1,e},kR=function(e,t,n,i){var r,o,a,s,u,c,l=vR(e,n),f=l.isVertical(),d=l.gradientThickness(),p=l.gradientLength();return f?(a=[0,1],s=[0,0],u=d,c=p):(a=[0,0],s=[1,0],u=p,c=d),r={enter:o={opacity:cR,x:cR,y:cR,width:d$(u),height:d$(c)},update:Object(h["o"])({},o,{opacity:lR,fill:{gradient:t,start:a,stop:s}}),exit:{opacity:cR}},p$(r,{stroke:l("gradientStrokeColor"),strokeWidth:l("gradientStrokeWidth")},{opacity:l("gradientOpacity")}),jR({type:dR,role:S$,encode:r},i)},ER=function(e,t,n,i,r){var o,a,s,u,c,l,f=vR(e,n),d=f.isVertical(),p=f.gradientThickness(),g=f.gradientLength(),m="";return d?(s="y",c="y2",u="x",l="width",m="1-"):(s="x",c="x2",u="y",l="height"),a={opacity:cR,fill:{scale:t,field:GT}},a[s]={signal:m+"datum."+WT,mult:g},a[u]=cR,a[c]={signal:m+"datum."+HT,mult:g},a[l]=d$(p),o={enter:a,update:Object(h["o"])({},a,{opacity:lR}),exit:{opacity:cR}},p$(o,{stroke:f("gradientStrokeColor"),strokeWidth:f("gradientStrokeWidth")},{opacity:f("gradientOpacity")}),jR({type:dR,role:A$,key:GT,from:r,encode:o},i)};const AR=`datum.${WT}<=0?"${$T}":datum.${WT}>=1?"${NT}":"${RT}"`,DR=`datum.${WT}<=0?"${TT}":datum.${WT}>=1?"${MT}":"${LT}"`;var SR=function(e,t,n,i){var r,o,a,s,u,c=vR(e,t),l=c.isVertical(),f=d$(c.gradientThickness()),d=c.gradientLength(),h=c("labelOverlap"),p="";return r={enter:o={opacity:cR},update:a={opacity:lR,text:{field:UT}},exit:{opacity:cR}},p$(r,{fill:c("labelColor"),fillOpacity:c("labelOpacity"),font:c("labelFont"),fontSize:c("labelFontSize"),fontStyle:c("labelFontStyle"),fontWeight:c("labelFontWeight"),limit:yN(e.labelLimit,t.gradientLabelLimit)}),l?(o.align={value:"left"},o.baseline=a.baseline={signal:DR},s="y",u="x",p="1-"):(o.align=a.align={signal:AR},o.baseline={value:"top"},s="x",u="y"),o[s]=a[s]={signal:p+"datum."+WT,mult:d},o[u]=a[u]=f,f.offset=yN(e.labelOffset,t.gradientLabelOffset)||0,h=h?{separation:c("labelSeparation"),method:h,order:"datum."+IT}:void 0,jR({type:gR,role:C$,style:VT,key:GT,from:i,encode:r,overlap:h},n)},CR=function(e,t,n,i,r){var o,a,s,u,c,l,f,d=vR(e,t),h=n.entries,p=!(!h||!h.interactive),g=h?h.name:void 0,m=d("clipHeight"),v=d("symbolOffset"),b={data:"value"},y={},x=`(${r}) ? datum.${qT} : datum.${eR}`,O=m?d$(m):{field:eR},_="datum."+IT,w=`max(1, ${r})`;O.mult=.5,y={enter:o={opacity:cR,x:{signal:x,mult:.5,offset:v},y:O},update:a={opacity:lR,x:o.x,y:o.y},exit:{opacity:cR}};var j=null,k=null;return e.fill||(j=t.symbolBaseFillColor,k=t.symbolBaseStrokeColor),p$(y,{fill:d("symbolFillColor",j),shape:d("symbolType"),size:d("symbolSize"),stroke:d("symbolStrokeColor",k),strokeDash:d("symbolDash"),strokeDashOffset:d("symbolDashOffset"),strokeWidth:d("symbolStrokeWidth")},{opacity:d("symbolOpacity")}),sR.forEach((function(t){e[t]&&(a[t]=o[t]={scale:e[t],field:GT})})),u=jR({type:pR,role:F$,key:GT,from:b,clip:!!m||void 0,encode:y},n.symbols),s=d$(v),s.offset=d("labelOffset"),y={enter:o={opacity:cR,x:{signal:x,offset:s},y:O},update:a={opacity:lR,text:{field:UT},x:o.x,y:o.y},exit:{opacity:cR}},p$(y,{align:d("labelAlign"),baseline:d("labelBaseline"),fill:d("labelColor"),fillOpacity:d("labelOpacity"),font:d("labelFont"),fontSize:d("labelFontSize"),fontStyle:d("labelFontStyle"),fontWeight:d("labelFontWeight"),limit:d("labelLimit")}),c=jR({type:gR,role:C$,style:VT,key:GT,from:b,encode:y},n.labels),y={enter:{noBound:{value:!m},width:cR,height:m?d$(m):cR,opacity:cR},exit:{opacity:cR},update:a={opacity:lR,row:{signal:null},column:{signal:null}}},d.isVertical(!0)?(l=`ceil(item.mark.items.length / ${w})`,a.row.signal=`${_}%${l}`,a.column.signal=`floor(${_} / ${l})`,f={field:["row",_]}):(a.row.signal=`floor(${_} / ${w})`,a.column.signal=`${_} % ${w}`,f={field:_}),a.column.signal=`(${r})?${a.column.signal}:${_}`,i={facet:{data:i,name:"value",groupby:IT}},mR({role:y$,from:i,encode:g$(y,h,uR),marks:[u,c],name:g,interactive:p,sort:f})};function FR(e,t){const n=vR(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const MR='item.orient === "left"',$R='item.orient === "right"',NR=`(${MR} || ${$R})`,TR="datum.vgrad && "+NR,RR=xR('"top"','"bottom"','"middle"'),zR=xR('"right"','"left"','"center"'),PR=`datum.vgrad && ${$R} ? (${zR}) : (${NR} && !(datum.vgrad && ${MR})) ? "left" : ${OR}`,LR=`item._anchor || (${NR} ? "middle" : "start")`,BR=`${TR} ? (${MR} ? -90 : 90) : 0`,IR=`${NR} ? (datum.vgrad ? (${$R} ? "bottom" : "top") : ${RR}) : "top"`;var UR=function(e,t,n,i){var r,o=vR(e,t);return r={enter:{opacity:cR},update:{opacity:lR,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:cR}},p$(r,{orient:o("titleOrient"),_anchor:o("titleAnchor"),anchor:{signal:LR},angle:{signal:BR},align:{signal:PR},baseline:{signal:IR},text:e.title,fill:o("titleColor"),fillOpacity:o("titleOpacity"),font:o("titleFont"),fontSize:o("titleFontSize"),fontStyle:o("titleFontStyle"),fontWeight:o("titleFontWeight"),limit:o("titleLimit"),lineHeight:o("titleLineHeight")},{align:o("titleAlign"),baseline:o("titleBaseline")}),jR({type:gR,role:M$,style:YT,from:i,encode:r},n)},qR=function(e,t){var n;return Object(h["F"])(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+WR(e.path)+")":e.sphere&&(n="geoShape("+WR(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e};function WR(e){return Object(h["F"])(e)&&e.signal?e.signal:Object(h["Z"])(e)}var HR=function(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===fR?y$:t||v$:t},GR=function(e){return{marktype:e.type,name:e.name||void 0,role:e.role||HR(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}},VR=function(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e},YR=function(e,t){var n=Ji(e.type);n||Object(h["n"])("Unrecognized transform type: "+Object(h["Z"])(e.type));var i=iN(n.type.toLowerCase(),null,ZR(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i};function ZR(e,t,n){var i,r,o,a={};for(r=0,o=e.params.length;r<o;++r)i=e.params[r],a[i.name]=XR(i,t,n);return a}function XR(e,t,n){var i=e.type,r=t[e.name];return"index"===i?QR(e,t,n):void 0!==r?"param"===i?KR(e,t,n):"projection"===i?n.projectionRef(t[e.name]):e.array&&!mN(r)?r.map((function(t){return JR(e,t,n)})):JR(e,r,n):void(e.required&&Object(h["n"])("Missing required "+Object(h["Z"])(t.type)+" parameter: "+Object(h["Z"])(e.name)))}function JR(e,t,n){var i=e.type;if(mN(t))return rz(i)?Object(h["n"])("Expression references can not be signals."):oz(i)?n.fieldRef(t):az(i)?n.compareRef(t):n.signalRef(t.signal);var r=e.expr||oz(i);return r&&tz(t)?n.exprRef(t.expr,t.as):r&&nz(t)?aN(t.field,t.as):rz(i)?nM(t,n):iz(i)?oN(n.getData(t).values):oz(i)?aN(t):az(i)?n.compareRef(t):t}function QR(e,t,n){return Object(h["H"])(t.from)||Object(h["n"])('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function KR(e,t,n){var i=t[e.name];return e.array?(Object(h["A"])(i)||Object(h["n"])("Expected an array of sub-parameters. Instead: "+Object(h["Z"])(i)),i.map((function(t){return ez(e,t,n)}))):ez(e,i,n)}function ez(e,t,n){var i,r,o,a,s;for(a=0,s=e.params.length;a<s;++a){for(o in r=e.params[a],r.key)if(r.key[o]!==t[o]){r=null;break}if(r)break}return r||Object(h["n"])("Unsupported parameter: "+Object(h["Z"])(t)),i=Object(h["o"])(ZR(r,t,n),r.key),oN(n.add(KN(i)))}function tz(e){return e&&e.expr}function nz(e){return e&&e.field}function iz(e){return"data"===e}function rz(e){return"expr"===e}function oz(e){return"field"===e}function az(e){return"compare"===e}var sz=function(e,t,n){var i,r,o,a,s;return e?(i=e.facet)&&(t||Object(h["n"])("Only group marks can be faceted."),null!=i.field?a=s=uz(i,n):(e.data?s=oN(n.getData(e.data).aggregate):(o=YR(Object(h["o"])({type:"aggregate",groupby:Object(h["i"])(i.groupby)},i.aggregate),n),o.params.key=n.keyRef(i.groupby),o.params.pulse=uz(i,n),a=s=oN(n.add(o))),r=n.keyRef(i.groupby,!0))):a=oN(n.add(LN(null,[{}]))),a||(a=uz(e,n)),{key:r,pulse:a,parent:s}};function uz(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:oN(t.getData(e.data).output)}function cz(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}cz.fromEntries=function(e,t){var n=t.length,i=1,r=t[0],o=t[n-1],a=t[n-2],s=null;for(r&&"load"===r.type&&(r=t[1]),e.add(t[0]);i<n;++i)t[i].params.pulse=oN(t[i-1]),e.add(t[i]),"aggregate"===t[i].type&&(s=t[i]);return new cz(e,r,a,o,s)};var lz=cz.prototype;function fz(e){return Object(h["H"])(e)?e:null}function dz(e,t,n){var i,r=hN(n.op,n.field);if(t.ops){for(var o=0,a=t.as.length;o<a;++o)if(t.as[o]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function hz(e,t,n,i,r,o,a){var s,u,c=t[n]||(t[n]={}),l=dN(o),f=fz(r);if(null!=f&&(e=t.scope,f+=l?"|"+l:"",s=c[f]),!s){var d=o?{field:sN,pulse:t.countsRef(e,r,o)}:{field:e.fieldRef(r),pulse:oN(t.output)};l&&(d.sort=e.sortRef(o)),u=e.add(iN(i,void 0,d)),a&&(t.index[r]=u),s=oN(u),null!=f&&(c[f]=s)}return s}lz.countsRef=function(e,t,n){var i,r,o,a=this,s=a.counts||(a.counts={}),u=fz(t);return null!=u&&(e=a.scope,i=s[u]),i?n&&n.field&&dz(e,i.agg.params,n):(o={groupby:e.fieldRef(t,"key"),pulse:oN(a.output)},n&&n.field&&dz(e,o,n),r=e.add(RN(o)),i=e.add(LN({pulse:oN(r)})),i={agg:r,ref:oN(i)},null!=u&&(s[u]=i)),i.ref},lz.tuplesRef=function(){return oN(this.values)},lz.extentRef=function(e,t){return hz(e,this,"extent","extent",t,!1)},lz.domainRef=function(e,t){return hz(e,this,"domain","values",t,!1)},lz.valuesRef=function(e,t,n){return hz(e,this,"vals","values",t,n||!0)},lz.lookupRef=function(e,t){return hz(e,this,"lookup","tupleindex",t,!1)},lz.indataRef=function(e,t){return hz(e,this,"indata","tupleindex",t,!0,!0)};var pz=function(e,t,n){var i,r,o,a,s=e.from.facet,u=s.name,c=uz(s,t);s.name||Object(h["n"])("Facet must have a name: "+Object(h["Z"])(s)),s.data||Object(h["n"])("Facet must reference a data set: "+Object(h["Z"])(s)),s.field?a=t.add(eT({field:t.fieldRef(s.field),pulse:c})):s.groupby?a=t.add(WN({key:t.keyRef(s.groupby),group:oN(t.proxy(n.parent)),pulse:c})):Object(h["n"])("Facet must specify groupby or field: "+Object(h["Z"])(s)),i=t.fork(),r=i.add(LN()),o=i.add(aT({pulse:oN(r)})),i.addData(u,new cz(i,r,r,o)),i.addSignal("parent",null),a.params.subflow={$subflow:i.parse(e).toRuntime()}},gz=function(e,t,n){var i=t.add(eT({pulse:n.pulse})),r=t.fork();r.add(aT()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}},mz=function(e,t,n){var i,r,o=e.remove,a=e.insert,s=e.toggle,u=e.modify,c=e.values,l=t.add(rN());i="if("+e.trigger+',modify("'+n+'",'+[a,o,s,u,c].map((function(e){return null==e?"null":e})).join(",")+"),0)",r=nM(i,t),l.update=r.$expr,l.params=r.$params},vz=function(e,t){var n,i,r,o,a,s,u,c,l,f,d,p,g,m,v=HR(e),b=e.type===fR,y=e.from&&e.from.facet,x=e.layout||v===y$||v===b$,O=v===v$||x||y,_=e.overlap;r=sz(e.from,b,t),i=t.add(IN({key:r.key||(e.key?aN(e.key):void 0),pulse:r.pulse,clean:!b})),f=oN(i),i=o=t.add(LN({pulse:f})),i=t.add(ZN({markdef:GR(e),interactive:VR(e.interactive,t),clip:qR(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:oN(i)})),d=oN(i),i=a=t.add(UN(Y$(e.encode,e.type,v,e.style,t,{mod:!1,pulse:d}))),i.params.parent=t.encode(),e.transform&&e.transform.forEach((function(e){const n=YR(e,t),r=n.metadata;(r.generates||r.changes)&&Object(h["n"])("Mark transforms should not generate new data."),r.nomod||(a.params.mod=!0),n.params.pulse=oN(i),t.add(i=n)})),e.sort&&(i=t.add(sT({sort:t.compareRef(e.sort),pulse:oN(i)}))),p=oN(i),(y||x)&&(x=t.add(uT({layout:t.objectProperty(e.layout),legends:t.legends,mark:d,pulse:p})),g=oN(x)),s=t.add(PN({mark:d,pulse:g||p})),m=oN(s),b&&(O&&(n=t.operators,n.pop(),x&&n.pop()),t.pushState(p,g||m,f),y?pz(e,t,r):O?gz(e,t,r):t.parse(e),t.popState(),O&&(x&&n.push(x),n.push(s))),_&&(m=bz(_,m,t)),u=t.add(rT({pulse:m})),c=t.add(aT({pulse:oN(u)},void 0,t.parent())),null!=e.name&&(l=e.name,t.addData(l,new cz(t,o,u,c)),e.on&&e.on.forEach((function(e){(e.insert||e.remove||e.toggle)&&Object(h["n"])("Marks only support modify triggers."),mz(e,t,l)})))};function bz(e,t,n){var i,r=e.method,o=e.bound,a=e.separation,s={separation:mN(a)?n.signalRef(a.signal):a,method:mN(r)?n.signalRef(r.signal):r,pulse:t};return e.order&&(s.sort=n.compareRef({field:e.order})),o&&(i=o.tolerance,s.boundTolerance=mN(i)?n.signalRef(i.signal):+i,s.boundScale=n.scaleRef(o.scale),s.boundOrient=o.orient),oN(n.add(QN(s)))}var yz=function(e,t){var n,i,r,o,a,s,u,c,l=t.config.legend,f=e.encode||{},d=f.legend||{},p=d.name||void 0,g=d.interactive,m=d.style,v=vR(e,l),b={},y=0;return sR.forEach(t=>e[t]?(b[t]=e[t],y=y||e[t]):0),y||Object(h["n"])("Missing valid scale for legend."),a=xz(e,t.scaleType(y)),s={title:null!=e.title,scales:b,type:a,vgrad:"symbol"!==a&&v.isVertical()},u=oN(t.add(LN(null,[s]))),d=g$(_z(v,e,l),d,uR),n={enter:{x:{value:0},y:{value:0}}},c=oN(t.add(VN(r={type:a,scale:t.scaleRef(y),count:t.objectProperty(v("tickCount")),limit:t.property(v("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),a===QT?(o=[kR(e,y,l,f.gradient),SR(e,l,f.labels,c)],r.count=r.count||t.signalRef(`max(2,2*floor((${xN(v.gradientLength())})/100))`)):a===KT?o=[ER(e,y,l,f.gradient,c),SR(e,l,f.labels,c)]:(i=FR(e,l),o=[CR(e,l,f,c,xN(i.columns))],r.size=wz(e,t,o[0].marks)),o=[mR({role:D$,from:u,encode:n,marks:o,layout:i,interactive:g})],s.title&&o.push(UR(e,l,f.title,u)),vz(mR({role:E$,from:u,encode:d,marks:o,aria:v("aria"),description:v("description"),zindex:v("zindex"),name:p,interactive:g,style:m}),t)};function xz(e,t){var n=e.type||JT;return e.type||1!==Oz(e)||!e.fill&&!e.stroke||(n=tm(t)?QT:im(t)?KT:JT),n!==QT?n:im(t)?KT:QT}function Oz(e){return sR.reduce((function(t,n){return t+(e[n]?1:0)}),0)}function _z(e,t,n){var i={enter:{},update:{}};return p$(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function wz(e,t,n){var i=xN(jz("size",e,n)),r=xN(jz("strokeWidth",e,n)),o=xN(kz(n[1].encode,t,VT));return nM(`max(ceil(sqrt(${i})+${r}),${o})`,t)}function jz(e,t,n){return t[e]?`scale("${t[e]}",datum)`:bR(e,n[0].encode)}function kz(e,t,n){return bR("fontSize",e)||yR("fontSize",t,n)}const Ez=`item.orient==="${$T}"?-90:item.orient==="${NT}"?90:0`;var Az=function(e,t){e=Object(h["H"])(e)?{text:e}:e;var n,i,r=vR(e,t.config.title),o=e.encode||{},a=o.group||{},s=a.name||void 0,u=a.interactive,c=a.style,l=[];return n={},i=oN(t.add(LN(null,[n]))),l.push(Cz(e,r,Dz(e),i)),e.subtitle&&l.push(Fz(e,r,o.subtitle,i)),vz(mR({role:$$,from:i,encode:Sz(r,a),marks:l,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:s,interactive:u,style:c}),t)};function Dz(e){const t=e.encode;return t&&t.title||Object(h["o"])({name:e.name,interactive:e.interactive,style:e.style},t)}function Sz(e,t){var n={enter:{},update:{}};return p$(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:OR},angle:{signal:Ez},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),g$(n,t,uR)}function Cz(e,t,n,i){var r={value:0},o=e.text,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return p$(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),jR({type:gR,role:N$,style:ZT,from:i,encode:a},n)}function Fz(e,t,n,i){var r={value:0},o=e.subtitle,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return p$(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),jR({type:gR,role:T$,style:XT,from:i,encode:a},n)}function Mz(e,t){var n=[];e.transform&&e.transform.forEach((function(e){n.push(YR(e,t))})),e.on&&e.on.forEach((function(n){mz(n,t,e.name)})),t.addDataPipeline(e.name,$z(e,t,n))}function $z(e,t,n){var i,r,o,a,s,u=[],c=null,l=!1,f=!1;for(e.values?bN(e.values)||bN(e.format)?(u.push(Tz(t,e)),u.push(c=Nz())):u.push(c=Nz({$ingest:e.values,$format:e.format})):e.url?bN(e.url)||bN(e.format)?(u.push(Tz(t,e)),u.push(c=Nz())):u.push(c=Nz({$request:e.url,$format:e.format})):e.source&&(c=i=Object(h["i"])(e.source).map((function(e){return oN(t.getData(e).output)})),u.push(null)),r=0,o=n.length;r<o;++r)a=n[r],s=a.metadata,c||s.source||u.push(c=Nz()),u.push(a),s.generates&&(f=!0),s.modifies&&!f&&(l=!0),s.source?c=a:s.changes&&(c=null);return i&&(o=i.length-1,u[0]=iT({derive:l,pulse:o?i:i[0]}),(l||o)&&u.splice(1,0,Nz())),c||u.push(Nz()),u.push(aT({})),u}function Nz(e){var t=LN({},e);return t.metadata={source:!0},t}function Tz(e,t){return YN({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const Rz=e=>e===TT||e===MT,zz=(e,t,n)=>mN(e)?Wz(e.signal,t,n):e===$T||e===MT?t:n,Pz=(e,t,n)=>mN(e)?Uz(e.signal,t,n):Rz(e)?t:n,Lz=(e,t,n)=>mN(e)?qz(e.signal,t,n):Rz(e)?n:t,Bz=(e,t,n)=>mN(e)?Hz(e.signal,t,n):e===MT?{value:t}:{value:n},Iz=(e,t,n)=>mN(e)?Gz(e.signal,t,n):e===NT?{value:t}:{value:n},Uz=(e,t,n)=>Vz(`${e} === '${MT}' || ${e} === '${TT}'`,t,n),qz=(e,t,n)=>Vz(`${e} !== '${MT}' && ${e} !== '${TT}'`,t,n),Wz=(e,t,n)=>Zz(`${e} === '${$T}' || ${e} === '${MT}'`,t,n),Hz=(e,t,n)=>Zz(`${e} === '${MT}'`,t,n),Gz=(e,t,n)=>Zz(`${e} === '${NT}'`,t,n),Vz=(e,t,n)=>(t=null!=t?d$(t):t,n=null!=n?d$(n):n,Yz(t)&&Yz(n)?(t=t?t.signal||Object(h["Z"])(t.value):null,n=n?n.signal||Object(h["Z"])(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Object(h["o"])({test:e},t)].concat(n||[])),Yz=e=>null==e||1===Object.keys(e).length,Zz=(e,t,n)=>({signal:`${e} ? (${Jz(t)}) : (${Jz(n)})`}),Xz=(e,t,n,i,r)=>({signal:(null!=i?`${e} === '${$T}' ? (${Jz(i)}) : `:"")+(null!=n?`${e} === '${TT}' ? (${Jz(n)}) : `:"")+(null!=r?`${e} === '${NT}' ? (${Jz(r)}) : `:"")+(null!=t?`${e} === '${MT}' ? (${Jz(t)}) : `:"")+"(null)"}),Jz=e=>mN(e)?e.signal:null==e?null:Object(h["Z"])(e),Qz=(e,t)=>0===t?0:mN(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Kz=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function eP(e,t,n,i){let r;if(t&&Object(h["v"])(t,e))return t[e];if(Object(h["v"])(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[YT][r]}if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[VT][r]}return null}function tP(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t)}var nP=function(e,t){var n,i,r,o=t.config,a=o.style,s=o.axis,u="band"===t.scaleType(e.scale)&&o.axisBand,c=e.orient;if(mN(c)){const e=tP([o.axisX,o.axisY]),t=tP([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(r of(n={},e))n[r]=Pz(c,eP(r,o.axisX,s,a),eP(r,o.axisY,s,a));for(r of(i={},t))i[r]=Xz(c.signal,eP(r,o.axisTop,s,a),eP(r,o.axisBottom,s,a),eP(r,o.axisLeft,s,a),eP(r,o.axisRight,s,a))}else n=c===MT||c===TT?o.axisX:o.axisY,i=o["axis"+c[0].toUpperCase()+c.slice(1)];var l=n||i||u?Object(h["o"])({},s,n,i,u):s;return l},iP=function(e,t,n,i){var r,o,a,s=vR(e,t),u=e.orient;r={enter:o={opacity:cR},update:a={opacity:lR},exit:{opacity:cR}},p$(r,{stroke:s("domainColor"),strokeCap:s("domainCap"),strokeDash:s("domainDash"),strokeDashOffset:s("domainDashOffset"),strokeWidth:s("domainWidth"),strokeOpacity:s("domainOpacity")});const c=rP(e,0),l=rP(e,1);return o.x=a.x=Pz(u,c,cR),o.x2=a.x2=Pz(u,l),o.y=a.y=Lz(u,c,cR),o.y2=a.y2=Lz(u,l),jR({type:hR,role:O$,from:i,encode:r},n)};function rP(e,t){return{scale:e.scale,range:t}}var oP=function(e,t,n,i,r){var o,a,s,u,c,l,f,d,p=vR(e,t),g=e.orient,m=e.gridScale,v=zz(g,1,-1),b=aP(e.offset,v);return o={enter:a={opacity:cR},update:u={opacity:lR},exit:s={opacity:cR}},p$(o,{stroke:p("gridColor"),strokeCap:p("gridCap"),strokeDash:p("gridDash"),strokeDashOffset:p("gridDashOffset"),strokeOpacity:p("gridOpacity"),strokeWidth:p("gridWidth")}),c={scale:e.scale,field:GT,band:r.band,extra:r.extra,offset:r.offset,round:p("tickRound")},d=Pz(g,{signal:"height"},{signal:"width"}),l=m?{scale:m,range:0,mult:v,offset:b}:{value:0,offset:b},f=m?{scale:m,range:1,mult:v,offset:b}:Object(h["o"])(d,{mult:v,offset:b}),a.x=u.x=Pz(g,c,l),a.y=u.y=Lz(g,c,l),a.x2=u.x2=Lz(g,f),a.y2=u.y2=Pz(g,f),s.x=Pz(g,c),s.y=Lz(g,c),jR({type:hR,role:_$,key:GT,from:i,encode:o},n)};function aP(e,t){if(1===t);else if(Object(h["F"])(e)){let n=e=Object(h["o"])({},e);while(null!=n.mult){if(!Object(h["F"])(n.mult))return n.mult=mN(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=Object(h["o"])({},n.mult)}n.mult=t}else e=mN(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}var sP=function(e,t,n,i,r,o){var a,s,u,c,l,f,d=vR(e,t),h=e.orient,p=zz(h,-1,1);return a={enter:s={opacity:cR},update:c={opacity:lR},exit:u={opacity:cR}},p$(a,{stroke:d("tickColor"),strokeCap:d("tickCap"),strokeDash:d("tickDash"),strokeDashOffset:d("tickDashOffset"),strokeOpacity:d("tickOpacity"),strokeWidth:d("tickWidth")}),l=d$(r),l.mult=p,f={scale:e.scale,field:GT,band:o.band,extra:o.extra,offset:o.offset,round:d("tickRound")},c.y=s.y=Pz(h,cR,f),c.y2=s.y2=Pz(h,l),u.x=Pz(h,f),c.x=s.x=Lz(h,cR,f),c.x2=s.x2=Lz(h,l),u.y=Lz(h,f),jR({type:hR,role:j$,key:GT,from:i,encode:a},n)};function uP(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}var cP=function(e,t,n,i,r,o){var a,s,u,c,l,f,d,h,p,g,m=vR(e,t),v=e.orient,b=e.scale,y=zz(v,-1,1),x=xN(m("labelFlush")),O=xN(m("labelFlushOffset")),_=0===x||!!x,w=m("labelAlign"),j=m("labelBaseline");return c=d$(r),c.mult=y,c.offset=d$(m("labelPadding")||0),c.offset.mult=y,l={scale:b,field:GT,band:.5,offset:wR(o.offset,m("labelOffset"))},f=Pz(v,_?uP(b,x,'"left"','"right"','"center"'):{value:"center"},Iz(v,"left","right")),d=Pz(v,Bz(v,"bottom","top"),_?uP(b,x,'"top"','"bottom"','"middle"'):{value:"middle"}),g=uP(b,x,`-(${O})`,O,0),_=_&&O,s={opacity:cR,x:Pz(v,l,c),y:Lz(v,l,c)},a={enter:s,update:u={opacity:lR,text:{field:UT},x:s.x,y:s.y,align:f,baseline:d},exit:{opacity:cR,x:s.x,y:s.y}},p$(a,{dx:!w&&_?Pz(v,g):null,dy:!j&&_?Lz(v,g):null}),p$(a,{angle:m("labelAngle"),fill:m("labelColor"),fillOpacity:m("labelOpacity"),font:m("labelFont"),fontSize:m("labelFontSize"),fontWeight:m("labelFontWeight"),fontStyle:m("labelFontStyle"),limit:m("labelLimit"),lineHeight:m("labelLineHeight")},{align:w,baseline:j}),h=m("labelBound"),p=m("labelOverlap"),p=p||h?{separation:m("labelSeparation"),method:p,order:"datum.index",bound:h?{scale:b,orient:v,tolerance:h}:null}:void 0,u.align!==f&&(u.align=Kz(u.align,f)),u.baseline!==d&&(u.baseline=Kz(u.baseline,d)),jR({type:gR,role:w$,style:VT,key:GT,from:i,encode:a,overlap:p},n)},lP=function(e,t,n,i){var r,o,a,s,u=vR(e,t),c=e.orient,l=zz(c,-1,1);return r={enter:o={opacity:cR,anchor:d$(u("titleAnchor",null)),align:{signal:OR}},update:a=Object(h["o"])({},o,{opacity:lR,text:d$(e.title)}),exit:{opacity:cR}},s={signal:`lerp(range("${e.scale}"), ${xR(0,1,.5)})`},a.x=Pz(c,s),a.y=Lz(c,s),o.angle=Pz(c,cR,Qz(l,90)),o.baseline=Pz(c,Bz(c,TT,MT),{value:TT}),a.angle=o.angle,a.baseline=o.baseline,p$(r,{fill:u("titleColor"),fillOpacity:u("titleOpacity"),font:u("titleFont"),fontSize:u("titleFontSize"),fontStyle:u("titleFontStyle"),fontWeight:u("titleFontWeight"),limit:u("titleLimit"),lineHeight:u("titleLineHeight")},{align:u("titleAlign"),angle:u("titleAngle"),baseline:u("titleBaseline")}),fP(u,c,r,n),r.update.align=Kz(r.update.align,o.align),r.update.angle=Kz(r.update.angle,o.angle),r.update.baseline=Kz(r.update.baseline,o.baseline),jR({type:gR,role:k$,style:YT,from:i,encode:r},n)};function fP(e,t,n,i){const r=(e,t)=>null!=e?(n.update[t]=Kz(d$(e),n.update[t]),!1):!m$(t,i),o=r(e("titleX"),"x"),a=r(e("titleY"),"y");n.enter.auto=a===o?d$(a):Pz(t,d$(a),d$(o))}var dP=function(e,t){var n,i,r,o,a,s=nP(e,t),u=e.encode||{},c=u.axis||{},l=c.name||void 0,f=c.interactive,d=c.style,h=vR(e,s),p=_R(h);return n={scale:e.scale,ticks:!!h("ticks"),labels:!!h("labels"),grid:!!h("grid"),domain:!!h("domain"),title:null!=e.title},i=oN(t.add(LN({},[n]))),c=g$(hP(h,e),c,uR),r=oN(t.add(zN({scale:t.scaleRef(e.scale),extra:t.property(p.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),a=[],n.grid&&a.push(oP(e,s,u.grid,r,p)),n.ticks&&(o=h("tickSize"),a.push(sP(e,s,u.ticks,r,o,p))),n.labels&&(o=n.ticks?o:0,a.push(cP(e,s,u.labels,r,o,p))),n.domain&&a.push(iP(e,s,u.domain,i)),n.title&&a.push(lP(e,s,u.title,i)),vz(mR({role:x$,from:i,encode:c,marks:a,aria:h("aria"),description:h("description"),zindex:h("zindex"),name:l,interactive:f,style:d}),t)};function hP(e,t){var n={enter:{},update:{}};return p$(n,{orient:e("orient"),offset:e("offset")||0,position:yN(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}var pP=function(e,t,n){var i=Object(h["i"])(e.signals),r=Object(h["i"])(e.scales);return n||i.forEach(e=>tN(e,t)),Object(h["i"])(e.projections).forEach(e=>CT(e,t)),r.forEach(e=>dT(e,t)),Object(h["i"])(e.data).forEach(e=>Mz(e,t)),r.forEach(e=>hT(e,t)),(n||i).forEach(e=>NN(e,t)),Object(h["i"])(e.axes).forEach(e=>dP(e,t)),Object(h["i"])(e.marks).forEach(e=>vz(e,t)),Object(h["i"])(e.legends).forEach(e=>yz(e,t)),e.title&&Az(e.title,t),t.parseLambdas(),t};const gP=e=>g$({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function mP(e,t){const n=t.config,i=oN(t.root=t.add(rN())),r=bP(e,n);r.forEach(e=>tN(e,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(LN()),a=t.add(UN(Y$(gP(e.encode),fR,b$,e.style,t,{pulse:oN(o)}))),s=t.add(uT({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:oN(a)}));t.operators.pop(),t.pushState(oN(a),oN(s),null),pP(e,t,r),t.operators.push(s);let u=t.add(PN({mark:i,pulse:oN(s)}));return u=t.add(rT({pulse:oN(u)})),u=t.add(aT({pulse:oN(u)})),t.addData("root",new cz(t,o,o,u)),t}function vP(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function bP(e,t){const n=n=>yN(e[n],t[n]),i=[vP("background",n("background")),vP("autosize",u$(n("autosize"))),vP("padding",f$(n("padding"))),vP("width",n("width")||0),vP("height",n("height")||0)],r=i.reduce((e,t)=>(e[t.name]=t,e),{}),o={};return Object(h["i"])(e.signals).forEach(e=>{Object(h["v"])(r,e.name)?e=Object(h["o"])(r[e.name],e):i.push(e),o[e.name]=e}),Object(h["i"])(t.signals).forEach(e=>{Object(h["v"])(o,e.name)||Object(h["v"])(r,e.name)||i.push(e)}),i}function yP(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function xP(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}var OP=yP.prototype=xP.prototype;function _P(e){return(Object(h["A"])(e)?wP:jP)(e)}function wP(e){for(var t,n="[",i=0,r=e.length;i<r;++i)t=e[i],n+=(i>0?",":"")+(Object(h["F"])(t)?t.signal||_P(t):Object(h["Z"])(t));return n+"]"}function jP(e){var t,n,i="{",r=0;for(t in e)n=e[t],i+=(++r>1?",":"")+Object(h["Z"])(t)+":"+(Object(h["F"])(n)?n.signal||_P(n):Object(h["Z"])(n));return i+"}"}OP.parse=function(e){return pP(e,this)},OP.fork=function(){return new xP(this)},OP.isSubscope=function(){return this._subid>0},OP.toRuntime=function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},OP.id=function(){return(this._subid?this._subid+":":0)+this._id++},OP.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((function(t){t.$ref=e.id})),e.refs=null),e},OP.proxy=function(e){var t=e instanceof nN?oN(e):e;return this.add(nT({value:t}))},OP.addStream=function(e){return this.streams.push(e),e.id=this.id(),e},OP.addUpdate=function(e){return this.updates.push(e),e},OP.finish=function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var i,r;e&&(i=e.data||(e.data={}),r=i[t]||(i[t]=[]),r.push(n))}for(e in this.data)for(var i in t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[i],e,"index:"+i);return this},OP.pushState=function(e,t,n){this._encode.push(oN(this.add(aT({pulse:e})))),this._parent.push(t),this._lookup.push(n?oN(this.proxy(n)):null),this._markpath.push(-1)},OP.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},OP.parent=function(){return Object(h["U"])(this._parent)},OP.encode=function(){return Object(h["U"])(this._encode)},OP.lookup=function(){return Object(h["U"])(this._lookup)},OP.markpath=function(){var e=this._markpath;return++e[e.length-1]},OP.fieldRef=function(e,t){if(Object(h["H"])(e))return aN(e,t);e.signal||Object(h["n"])("Unsupported field reference: "+Object(h["Z"])(e));var n,i=e.signal,r=this.field[i];return r||(n={name:this.signalRef(i)},t&&(n.as=t),this.field[i]=r=oN(this.add(HN(n)))),r},OP.compareRef=function(e){function t(e){return mN(e)?(i=!0,n.signalRef(e.signal)):vN(e)?(i=!0,n.exprRef(e.expr)):e}var n=this,i=!1,r=Object(h["i"])(e.field).map(t),o=Object(h["i"])(e.order).map(t);return i?oN(this.add(BN({fields:r,orders:o}))):uN(r,o)},OP.keyRef=function(e,t){function n(e){return mN(e)?(r=!0,oN(i[e.signal])):e}var i=this.signals,r=!1;return e=Object(h["i"])(e).map(n),r?oN(this.add(GN({fields:e,flat:t}))):cN(e,t)},OP.sortRef=function(e){if(!e)return e;var t=hN(e.op,e.field),n=e.order||lN;return n.signal?oN(this.add(BN({fields:t,orders:this.signalRef(n.signal)}))):uN(t,n)},OP.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},OP.hasOwnSignal=function(e){return Object(h["v"])(this.signals,e)},OP.addSignal=function(e,t){this.hasOwnSignal(e)&&Object(h["n"])("Duplicate signal name: "+Object(h["Z"])(e));var n=t instanceof nN?t:this.add(rN(t));return this.signals[e]=n},OP.getSignal=function(e){return this.signals[e]||Object(h["n"])("Unrecognized signal name: "+Object(h["Z"])(e)),this.signals[e]},OP.signalRef=function(e){return this.signals[e]?oN(this.signals[e]):(Object(h["v"])(this.lambdas,e)||(this.lambdas[e]=this.add(rN(null))),oN(this.lambdas[e]))},OP.parseLambdas=function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var i=e[t],r=nM(i,this),o=this.lambdas[i];o.params=r.$params,o.update=r.$expr}},OP.property=function(e){return e&&e.signal?this.signalRef(e.signal):e},OP.objectProperty=function(e){return e&&Object(h["F"])(e)?this.signalRef(e.signal||_P(e)):e},OP.exprRef=function(e,t){var n={expr:nM(e,this)};return t&&(n.expr.$name=t),oN(this.add(qN(n)))},OP.addBinding=function(e,t){this.bindings||Object(h["n"])("Nested signals do not support binding: "+Object(h["Z"])(e)),this.bindings.push(Object(h["o"])({signal:e},t))},OP.addScaleProj=function(e,t){Object(h["v"])(this.scales,e)&&Object(h["n"])("Duplicate scale or projection name: "+Object(h["Z"])(e)),this.scales[e]=this.add(t)},OP.addScale=function(e,t){this.addScaleProj(e,oT(t))},OP.addProjection=function(e,t){this.addScaleProj(e,tT(t))},OP.getScale=function(e){return this.scales[e]||Object(h["n"])("Unrecognized scale name: "+Object(h["Z"])(e)),this.scales[e]},OP.projectionRef=OP.scaleRef=function(e){return oN(this.getScale(e))},OP.projectionType=OP.scaleType=function(e){return this.getScale(e).params.type},OP.addData=function(e,t){return Object(h["v"])(this.data,e)&&Object(h["n"])("Duplicate data set name: "+Object(h["Z"])(e)),this.data[e]=t},OP.getData=function(e){return this.data[e]||Object(h["n"])("Undefined data set name: "+Object(h["Z"])(e)),this.data[e]},OP.addDataPipeline=function(e,t){return Object(h["v"])(this.data,e)&&Object(h["n"])("Duplicate data set name: "+Object(h["Z"])(e)),this.addData(e,cz.fromEntries(this,t))};var kP=function(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",o="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}},EP=function(e,t,n){return Object(h["F"])(e)||Object(h["n"])("Input Vega specification must be an object."),t=Object(h["N"])(kP(),t,e.config),mP(e,new yP(t,n)).toRuntime()};Object(h["o"])(Xi,i,r,o,a,s,u,c,l,f,d)},"0803":function(e,t,n){"use strict";var i=n("0986"),r=.8908130915292852,o=Math.sin(i["j"]/10)/Math.sin(7*i["j"]/10),a=Math.sin(i["m"]/10)*o,s=-Math.cos(i["m"]/10)*o;t["a"]={draw:function(e,t){var n=Math.sqrt(t*r),o=a*n,u=s*n;e.moveTo(0,-n),e.lineTo(o,u);for(var c=1;c<5;++c){var l=i["m"]*c/5,f=Math.cos(l),d=Math.sin(l);e.lineTo(d*n,-f*n),e.lineTo(f*o-d*u,d*o+f*u)}e.closePath()}}},"0830":function(e,t,n){"use strict";var i=n("14f3"),r=n("ec83");t["a"]=function(e,t,n,o,a){(1&e.depth?r["a"]:i["a"])(e,t,n,o,a)}},"092b":function(e,t,n){"use strict";function i(){return 0}n.d(t,"a",(function(){return i})),t["b"]=function(e){return function(){return e}}},"0982":function(e,t,n){const i=n("3fce"),r=(e,t)=>{try{return new i(e,t).range||"*"}catch(n){return null}};e.exports=r},"0986":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"h",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return d})),n.d(t,"m",(function(){return h})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g}));var i=Math.abs,r=Math.atan2,o=Math.cos,a=Math.max,s=Math.min,u=Math.sin,c=Math.sqrt,l=1e-12,f=Math.PI,d=f/2,h=2*f;function p(e){return e>1?0:e<-1?f:Math.acos(e)}function g(e){return e>=1?d:e<=-1?-d:Math.asin(e)}},"0a67":function(e,t,n){const i=n("bbfd"),r=n("a236"),{re:o,t:a}=n("8cb5"),s=(e,t)=>{if(e instanceof i)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;t=t||{};let n=null;if(t.rtl){let t;while((t=o[a.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length))n&&t.index+t[0].length===n.index+n[0].length||(n=t),o[a.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[a.COERCERTL].lastIndex=-1}else n=e.match(o[a.COERCE]);return null===n?null:r(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};e.exports=s},"0dd4":function(e,t,n){"use strict";t["a"]=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}},"13af":function(e,t,n){const i=n("bbfd"),r=n("3fce"),o=(e,t,n)=>{let o=null,a=null,s=null;try{s=new r(t,n)}catch(u){return null}return e.forEach(e=>{s.test(e)&&(o&&-1!==a.compare(e)||(o=e,a=new i(o,n)))}),o};e.exports=o},"14f3":function(e,t,n){"use strict";t["a"]=function(e,t,n,i,r){var o,a=e.children,s=-1,u=a.length,c=e.value&&(i-t)/e.value;while(++s<u)o=a[s],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*c}},"1af0":function(e,t,n){"use strict";var i=n("0986");t["a"]={draw:function(e,t){var n=Math.sqrt(t/i["j"]);e.moveTo(n,0),e.arc(0,0,n,0,i["m"])}}},"1cc6":function(e,t,n){const i=n("bbfd"),r=(e,t,n)=>{const r=new i(e,n),o=new i(t,n);return r.compare(o)||r.compareBuild(o)};e.exports=r},"1fb5":function(e,t,n){"use strict";t.byteLength=l,t.toByteArray=d,t.fromByteArray=g;for(var i=[],r=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)i[s]=a[s],r[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var i=n===t?0:4-n%4;return[n,i]}function l(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i}function f(e,t,n){return 3*(t+n)/4-n}function d(e){var t,n,i=c(e),a=i[0],s=i[1],u=new o(f(e,a,s)),l=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[l++]=255&t),1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u}function h(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function p(e,t,n){for(var i,r=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(h(i));return r.join("")}function g(e){for(var t,n=e.length,r=n%3,o=[],a=16383,s=0,u=n-r;s<u;s+=a)o.push(p(e,s,s+a>u?u:s+a));return 1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},"21e5":function(e,t,n){"use strict";function i(e){return null==e?null:r(e)}function r(e){if("function"!==typeof e)throw new Error;return e}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}))},2373:function(e,t,n){"use strict";var i=n("5be2"),r=n("21e5"),o=n("092b");function a(e){return Math.sqrt(e.value)}function s(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function u(e,t){return function(n){if(r=n.children){var r,o,a,s=r.length,u=e(n)*t||0;if(u)for(o=0;o<s;++o)r[o].r+=u;if(a=Object(i["a"])(r),u)for(o=0;o<s;++o)r[o].r-=u;n.r=a+u}}}function c(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}t["a"]=function(){var e=null,t=1,n=1,i=o["a"];function l(r){return r.x=t/2,r.y=n/2,e?r.eachBefore(s(e)).eachAfter(u(i,.5)).eachBefore(c(1)):r.eachBefore(s(a)).eachAfter(u(o["a"],1)).eachAfter(u(i,r.r/Math.min(t,n))).eachBefore(c(Math.min(t,n)/(2*r.r))),r}return l.radius=function(t){return arguments.length?(e=Object(r["a"])(t),l):e},l.size=function(e){return arguments.length?(t=+e[0],n=+e[1],l):[t,n]},l.padding=function(e){return arguments.length?(i="function"===typeof e?e:Object(o["b"])(+e),l):i},l}},2388:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var i=n("14f3"),r=n("ec83"),o=(1+Math.sqrt(5))/2;function a(e,t,n,o,a,s){var u,c,l,f,d,h,p,g,m,v,b,y=[],x=t.children,O=0,_=0,w=x.length,j=t.value;while(O<w){l=a-n,f=s-o;do{d=x[_++].value}while(!d&&_<w);for(h=p=d,v=Math.max(f/l,l/f)/(j*e),b=d*d*v,m=Math.max(p/b,b/h);_<w;++_){if(d+=c=x[_].value,c<h&&(h=c),c>p&&(p=c),b=d*d*v,g=Math.max(p/b,b/h),g>m){d-=c;break}m=g}y.push(u={value:d,dice:l<f,children:x.slice(O,_)}),u.dice?Object(i["a"])(u,n,o,a,j?o+=f*d/j:s):Object(r["a"])(u,n,o,j?n+=l*d/j:a,s),j-=d,O=_}return y}t["a"]=function e(t){function n(e,n,i,r,o){a(t,e,n,i,r,o)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(o)},"276f":function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"w",(function(){return h})),n.d(t,"x",(function(){return p})),n.d(t,"kb",(function(){return g})),n.d(t,"O",(function(){return m})),n.d(t,"gb",(function(){return v})),n.d(t,"r",(function(){return b})),n.d(t,"K",(function(){return k})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return _})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return j})),n.d(t,"N",(function(){return S})),n.d(t,"jb",(function(){return C})),n.d(t,"Q",(function(){return B})),n.d(t,"R",(function(){return I})),n.d(t,"S",(function(){return U})),n.d(t,"T",(function(){return q})),n.d(t,"lb",(function(){return H})),n.d(t,"mb",(function(){return G})),n.d(t,"nb",(function(){return V})),n.d(t,"ob",(function(){return Y})),n.d(t,"V",(function(){return Z})),n.d(t,"hb",(function(){return X})),n.d(t,"i",(function(){return J})),n.d(t,"j",(function(){return Q})),n.d(t,"k",(function(){return te})),n.d(t,"l",(function(){return ae})),n.d(t,"m",(function(){return se})),n.d(t,"n",(function(){return c})),n.d(t,"o",(function(){return ue})),n.d(t,"p",(function(){return ce})),n.d(t,"q",(function(){return le})),n.d(t,"s",(function(){return pe})),n.d(t,"t",(function(){return f})),n.d(t,"u",(function(){return ge})),n.d(t,"v",(function(){return de})),n.d(t,"y",(function(){return me})),n.d(t,"z",(function(){return ve})),n.d(t,"A",(function(){return E})),n.d(t,"B",(function(){return be})),n.d(t,"C",(function(){return ye})),n.d(t,"D",(function(){return K})),n.d(t,"E",(function(){return xe})),n.d(t,"F",(function(){return A})),n.d(t,"G",(function(){return Oe})),n.d(t,"H",(function(){return _e})),n.d(t,"I",(function(){return we})),n.d(t,"J",(function(){return je})),n.d(t,"L",(function(){return Ee})),n.d(t,"M",(function(){return Ae})),n.d(t,"P",(function(){return Se})),n.d(t,"U",(function(){return M})),n.d(t,"W",(function(){return De})),n.d(t,"X",(function(){return Ce})),n.d(t,"Y",(function(){return l})),n.d(t,"Z",(function(){return Fe})),n.d(t,"ab",(function(){return Me})),n.d(t,"bb",(function(){return Ne})),n.d(t,"cb",(function(){return $})),n.d(t,"eb",(function(){return Te})),n.d(t,"db",(function(){return Re})),n.d(t,"fb",(function(){return ze})),n.d(t,"ib",(function(){return Pe}));var i=function(e,t,n){return e.fields=t||[],e.fname=n,e};function r(e){return null==e?null:e.fname}function o(e){return null==e?null:e.fields}var a=function(e){return 1===e.length?s(e[0]):u(e)};const s=e=>function(t){return t[e]},u=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};var c=function(e){throw Error(e)},l=function(e){var t,n,i,r=[],o=null,a=0,s=e.length,u="";function l(){r.push(u+e.substring(t,n)),u="",t=n+1}for(e+="",t=n=0;n<s;++n)if(i=e[n],"\\"===i)u+=e.substring(t,n),u+=e.substring(++n,++n),t=n;else if(i===o)l(),o=null,a=-1;else{if(o)continue;t===a&&'"'===i||t===a&&"'"===i?(t=n+1,o=i):"."!==i||a?"["===i?(n>t&&l(),a=t=n+1):"]"===i&&(a||c("Access path missing open bracket: "+e),a>0&&l(),a=0,t=n+1):n>t?l():t=n+1}return a&&c("Access path missing closing bracket: "+e),o&&c("Access path missing closing quote: "+e),n>t&&(n++,l()),r},f=function(e,t,n){const r=l(e);return e=1===r.length?r[0]:e,i((n&&n.get||a)(r),[e],t||e)},d=[],h=f("id"),p=i((function(e){return e}),d,"identity"),g=i((function(){return 0}),d,"zero"),m=i((function(){return 1}),d,"one"),v=i((function(){return!0}),d,"true"),b=i((function(){return!1}),d,"false");function y(e,t,n){var i=[t].concat([].slice.call(n));console[e].apply(console,i)}var x=0,O=1,_=2,w=3,j=4,k=function(e,t){var n=e||x;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=O&&y(t||"error","ERROR",arguments),this},warn:function(){return n>=_&&y(t||"warn","WARN",arguments),this},info:function(){return n>=w&&y(t||"log","INFO",arguments),this},debug:function(){return n>=j&&y(t||"log","DEBUG",arguments),this}}},E=Array.isArray,A=function(e){return e===Object(e)};const D=e=>"__proto__"!==e;function S(...e){return e.reduce((e,t)=>{for(var n in t)if("signals"===n)e.signals=F(e.signals,t.signals);else{var i="legend"===n?{layout:1}:"style"===n||null;C(e,n,t[n],i)}return e},{})}function C(e,t,n,i){var r,o;if(D(t))if(A(n)&&!E(n))for(r in o=A(e[t])?e[t]:e[t]={},n)i&&(!0===i||i[r])?C(o,r,n[r]):D(r)&&(o[r]=n[r]);else e[t]=n}function F(e,t){if(null==e)return t;const n={},i=[];function r(e){n[e.name]||(n[e.name]=1,i.push(e))}return t.forEach(r),e.forEach(r),i}var M=function(e){return e[e.length-1]},$=function(e){return null==e||""===e?null:+e};function N(e){return function(t){return e*Math.exp(t)}}function T(e){return function(t){return Math.log(e*t)}}function R(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function z(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function P(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function L(e,t,n,i){var r=n(e[0]),o=n(M(e)),a=(o-r)*t;return[i(r-a),i(o-a)]}function B(e,t){return L(e,t,$,p)}function I(e,t){var n=Math.sign(e[0]);return L(e,t,T(n),N(n))}function U(e,t,n){return L(e,t,P(n),P(1/n))}function q(e,t,n){return L(e,t,R(n),z(n))}function W(e,t,n,i,r){var o=i(e[0]),a=i(M(e)),s=null!=t?i(t):(o+a)/2;return[r(s+(o-s)*n),r(s+(a-s)*n)]}function H(e,t,n){return W(e,t,n,$,p)}function G(e,t,n){var i=Math.sign(e[0]);return W(e,t,n,T(i),N(i))}function V(e,t,n,i){return W(e,t,n,P(i),P(1/i))}function Y(e,t,n,i){return W(e,t,n,R(i),z(i))}function Z(e){return 1+~~(new Date(e).getMonth()/3)}function X(e){return 1+~~(new Date(e).getUTCMonth()/3)}var J=function(e){return null!=e?E(e)?e:[e]:[]},Q=function(e,t,n){var i,r=e[0],o=e[1];return o<r&&(i=o,o=r,r=i),i=o-r,i>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-i),r+i]},K=function(e){return"function"===typeof e};const ee="descending";var te=function(e,t,n){n=n||{},t=J(t)||[];const r=[],a=[],s={},u=n.comparator||ie;return J(e).forEach((e,i)=>{null!=e&&(r.push(t[i]===ee?-1:1),a.push(e=K(e)?e:f(e,null,n)),(o(e)||[]).forEach(e=>s[e]=1))}),0===a.length?null:i(u(a,r),Object.keys(s))};const ne=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),ie=(e,t)=>1===e.length?re(e[0],t[0]):oe(e,t,e.length),re=(e,t)=>function(n,i){return ne(e(n),e(i))*t},oe=(e,t,n)=>(t.push(0),function(i,r){let o,a=0,s=-1;while(0===a&&++s<n)o=e[s],a=ne(o(i),o(r));return a*t[s]});var ae=function(e){return K(e)?e:function(){return e}},se=function(e,t){var n,i;function r(){t(i),n=i=null}return function(t){i=t,n&&clearTimeout(n),n=setTimeout(r,e)}},ue=function(e){for(var t,n,i=1,r=arguments.length;i<r;++i)for(n in t=arguments[i],t)e[n]=t[n];return e},ce=function(e,t){var n,i,r,o,a=0;if(e&&(n=e.length))if(null==t){for(i=e[a];a<n&&(null==i||i!==i);i=e[++a]);for(r=o=i;a<n;++a)i=e[a],null!=i&&(i<r&&(r=i),i>o&&(o=i))}else{for(i=t(e[a]);a<n&&(null==i||i!==i);i=t(e[++a]));for(r=o=i;a<n;++a)i=t(e[a]),null!=i&&(i<r&&(r=i),i>o&&(o=i))}return[r,o]},le=function(e,t){var n,i,r,o,a,s=-1,u=e.length;if(null==t){while(++s<u)if(i=e[s],null!=i&&i>=i){n=r=i;break}if(s===u)return[-1,-1];o=a=s;while(++s<u)i=e[s],null!=i&&(n>i&&(n=i,o=s),r<i&&(r=i,a=s))}else{while(++s<u)if(i=t(e[s],s,e),null!=i&&i>=i){n=r=i;break}if(s===u)return[-1,-1];o=a=s;while(++s<u)i=t(e[s],s,e),null!=i&&(n>i&&(n=i,o=s),r<i&&(r=i,a=s))}return[o,a]};const fe=Object.prototype.hasOwnProperty;var de=function(e,t){return fe.call(e,t)},he={},pe=function(e){var t,n,i={};function r(e){return de(i,e)&&i[e]!==he}return t={size:0,empty:0,object:i,has:r,get(e){return r(e)?i[e]:void 0},set(e,n){return r(e)||(++t.size,i[e]===he&&--t.empty),i[e]=n,this},delete(e){return r(e)&&(--t.size,++t.empty,i[e]=he),this},clear(){t.size=t.empty=0,t.object=i={}},test(e){return arguments.length?(n=e,t):n},clean(){var e,r,o={},a=0;for(e in i)r=i[e],r===he||n&&n(r)||(o[e]=r,++a);t.size=a,t.empty=0,t.object=i=o}},e&&Object.keys(e).forEach((function(n){t.set(n,e[n])})),t},ge=function(e,t,n,i,r,o){if(!n&&0!==n)return o;var a,s,u=e[0],c=M(e),l=+n;return c<u&&(a=u,u=c,c=a),a=Math.abs(t-u),s=Math.abs(c-t),a<s&&a<=l?i:s<=l?r:o},me=function(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n},ve=function(e,t,n,i){var r,o=t[0],a=t[t.length-1];return o>a&&(r=o,o=a,a=r),n=void 0===n||n,i=void 0===i||i,(n?o<=e:o<e)&&(i?e<=a:e<a)},be=function(e){return"boolean"===typeof e},ye=function(e){return"[object Date]"===Object.prototype.toString.call(e)},xe=function(e){return"number"===typeof e},Oe=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},_e=function(e){return"string"===typeof e},we=function(e,t,n){e&&(e=t?J(e).map(e=>e.replace(/\\(.)/g,"$1")):J(e));const r=e&&e.length,o=n&&n.get||a,s=e=>o(t?[e]:l(e));let u;if(r)if(1===r){const t=s(e[0]);u=function(e){return""+t(e)}}else{const t=e.map(s);u=function(e){let n=""+t[0](e),i=0;while(++i<r)n+="|"+t[i](e);return n}}else u=function(){return""};return i(u,e,"key")},je=function(e,t){const n=e[0],i=M(e),r=+t;return r?1===r?i:n+r*(i-n):n};const ke=1e4;var Ee=function(e){let t,n,i;e=+e||ke;const r=()=>{t={},n={},i=0},o=(r,o)=>(++i>e&&(n=t,t={},i=1),t[r]=o);return r(),{clear:r,has:e=>de(t,e)||de(n,e),get:e=>de(t,e)?t[e]:de(n,e)?o(e,n[e]):void 0,set:(e,n)=>de(t,e)?t[e]=n:o(e,n)}},Ae=function(e,t,n,i){var r=t.length,o=n.length;if(!o)return t;if(!r)return n;for(var a=i||new t.constructor(r+o),s=0,u=0,c=0;s<r&&u<o;++c)a[c]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<r;++s,++c)a[c]=t[s];for(;u<o;++u,++c)a[c]=n[u];return a},De=function(e,t){var n="";while(--t>=0)n+=e;return n},Se=function(e,t,n,i){var r=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===i?De(r,a)+o:"center"===i?De(r,~~(a/2))+o+De(r,Math.ceil(a/2)):o+De(r,a)},Ce=function(e){return e&&M(e)-e[0]||0};function Fe(e){return E(e)?"["+e.map(Fe)+"]":A(e)||_e(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var Me=function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e};function $e(e){return xe(e)||ye(e)?e:Date.parse(e)}var Ne=function(e,t){return t=t||$e,null==e||""===e?null:t(e)},Te=function(e){return null==e||""===e?null:e+""},Re=function(e){for(var t={},n=0,i=e.length;n<i;++n)t[e[n]]=!0;return t},ze=function(e,t,n,i){var r=null!=i?i:"",o=e+"",a=o.length,s=Math.max(0,t-r.length);return a<=t?o:"left"===n?r+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+r+o.slice(a-~~(s/2)):o.slice(0,s)+r},Pe=function(e,t,n){if(e)if(t)for(var i,r=0,o=e.length;r<o;++r)(i=t(e[r]))&&n(i,r,e);else e.forEach(n)}},"29c8":function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var i=n("0986"),r=n("7792");function o(e,t,n){var r=e._x1,o=e._y1,a=e._x2,s=e._y2;if(e._l01_a>i["f"]){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,o=(o*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>i["f"]){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/f,s=(s*l+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(r,o,a,s,e._x2,e._y2)}function a(e,t){this._context=e,this._alpha=t}a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:o(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["a"]=function e(t){function n(e){return t?new a(e,t):new r["a"](e,0)}return n.alpha=function(t){return e(+t)},n}(.5)},"2a2e":function(e,t,n){const i=n("1cc6"),r=(e,t)=>e.sort((e,n)=>i(e,n,t));e.exports=r},"2a83":function(e,t,n){"use strict";n.r(t),n.d(t,"compile",(function(){return Tb})),n.d(t,"extractTransforms",(function(){return Bb})),n.d(t,"normalize",(function(){return ll})),n.d(t,"version",(function(){return Ib}));var i={};n.r(i),n.d(i,"invalidSpec",(function(){return ai})),n.d(i,"FIT_NON_SINGLE",(function(){return si})),n.d(i,"containerSizeNonSingle",(function(){return ui})),n.d(i,"containerSizeNotCompatibleWithAutosize",(function(){return ci})),n.d(i,"droppingFit",(function(){return li})),n.d(i,"cannotProjectOnChannelWithoutField",(function(){return fi})),n.d(i,"cannotProjectAggregate",(function(){return di})),n.d(i,"nearestNotSupportForContinuous",(function(){return hi})),n.d(i,"selectionNotSupported",(function(){return pi})),n.d(i,"selectionNotFound",(function(){return gi})),n.d(i,"SCALE_BINDINGS_CONTINUOUS",(function(){return mi})),n.d(i,"LEGEND_BINDINGS_PROJECT_LENGTH",(function(){return vi})),n.d(i,"noSameUnitLookup",(function(){return bi})),n.d(i,"noSuchRepeatedValue",(function(){return yi})),n.d(i,"columnsNotSupportByRowCol",(function(){return xi})),n.d(i,"CONCAT_CANNOT_SHARE_AXIS",(function(){return Oi})),n.d(i,"unrecognizedParse",(function(){return _i})),n.d(i,"differentParse",(function(){return wi})),n.d(i,"invalidTransformIgnored",(function(){return ji})),n.d(i,"NO_FIELDS_NEEDS_AS",(function(){return ki})),n.d(i,"customFormatTypeNotAllowed",(function(){return Ei})),n.d(i,"encodingOverridden",(function(){return Ai})),n.d(i,"projectionOverridden",(function(){return Di})),n.d(i,"REPLACE_ANGLE_WITH_THETA",(function(){return Si})),n.d(i,"primitiveChannelDef",(function(){return Ci})),n.d(i,"invalidFieldType",(function(){return Fi})),n.d(i,"invalidFieldTypeForCountAggregate",(function(){return Mi})),n.d(i,"invalidAggregate",(function(){return $i})),n.d(i,"missingFieldType",(function(){return Ni})),n.d(i,"droppingColor",(function(){return Ti})),n.d(i,"emptyFieldDef",(function(){return Ri})),n.d(i,"latLongDeprecated",(function(){return zi})),n.d(i,"LINE_WITH_VARYING_SIZE",(function(){return Pi})),n.d(i,"incompatibleChannel",(function(){return Li})),n.d(i,"invalidEncodingChannel",(function(){return Bi})),n.d(i,"facetChannelShouldBeDiscrete",(function(){return Ii})),n.d(i,"facetChannelDropped",(function(){return Ui})),n.d(i,"discreteChannelCannotEncode",(function(){return qi})),n.d(i,"lineWithRange",(function(){return Wi})),n.d(i,"orientOverridden",(function(){return Hi})),n.d(i,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return Gi})),n.d(i,"RANGE_STEP_DEPRECATED",(function(){return Vi})),n.d(i,"cannotUseScalePropertyWithNonColor",(function(){return Yi})),n.d(i,"unaggregateDomainHasNoEffectForRawField",(function(){return Zi})),n.d(i,"unaggregateDomainWithNonSharedDomainOp",(function(){return Xi})),n.d(i,"unaggregatedDomainWithLogScale",(function(){return Ji})),n.d(i,"cannotApplySizeToNonOrientedMark",(function(){return Qi})),n.d(i,"scaleTypeNotWorkWithChannel",(function(){return Ki})),n.d(i,"scaleTypeNotWorkWithFieldDef",(function(){return er})),n.d(i,"scalePropertyNotWorkWithScaleType",(function(){return tr})),n.d(i,"scaleTypeNotWorkWithMark",(function(){return nr})),n.d(i,"stepDropped",(function(){return ir})),n.d(i,"mergeConflictingProperty",(function(){return rr})),n.d(i,"mergeConflictingDomainProperty",(function(){return or})),n.d(i,"independentScaleMeansIndependentGuide",(function(){return ar})),n.d(i,"domainSortDropped",(function(){return sr})),n.d(i,"MORE_THAN_ONE_SORT",(function(){return ur})),n.d(i,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return cr})),n.d(i,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return lr})),n.d(i,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return fr})),n.d(i,"INVALID_CHANNEL_FOR_AXIS",(function(){return dr})),n.d(i,"cannotStackRangedMark",(function(){return hr})),n.d(i,"cannotStackNonLinearScale",(function(){return pr})),n.d(i,"stackNonSummativeAggregate",(function(){return gr})),n.d(i,"invalidTimeUnit",(function(){return mr})),n.d(i,"droppedDay",(function(){return vr})),n.d(i,"errorBarCenterAndExtentAreNotNeeded",(function(){return br})),n.d(i,"errorBarCenterIsUsedWithWrongExtent",(function(){return yr})),n.d(i,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return xr})),n.d(i,"errorBarCenterIsNotNeeded",(function(){return Or})),n.d(i,"errorBand1DNotSupport",(function(){return _r})),n.d(i,"channelRequiredForBinned",(function(){return wr})),n.d(i,"domainRequiredForThresholdScale",(function(){return jr}));var r=n("a87b"),o=n("276f");function a(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var s=n("6715"),u=n.n(s),c=n("694b"),l=n.n(c),f=n("f71e"),d=n.n(f);function h(e){return!!e.or}function p(e){return!!e.and}function g(e){return!!e.not}function m(e,t){if(g(e))m(e.not,t);else if(p(e))for(const n of e.and)m(n,t);else if(h(e))for(const n of e.or)m(n,t);else t(e)}function v(e,t){return g(e)?{not:v(e.not,t)}:p(e)?{and:e.and.map(e=>v(e,t))}:h(e)?{or:e.or.map(e=>v(e,t))}:t(e)}const b=l.a,y=u.a;function x(e,t){const n={};for(const i of t)Object(o["v"])(e,i)&&(n[i]=e[i]);return n}function O(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype["toJSON"]=function(){return`Set(${[...this].map(e=>d()(e)).join(",")})`};const _=d.a;function w(e){if(Object(o["E"])(e))return e;const t=Object(o["H"])(e)?e:d()(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const e=t.charCodeAt(i);n=(n<<5)-n+e,n&=n}return n}function j(e){return!1===e||null===e}function k(e,t){return e.indexOf(t)>-1}function E(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function A(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function D(e,...t){for(const n of t)S(e,null!==n&&void 0!==n?n:{});return e}function S(e,t){for(const n of R(t))Object(o["jb"])(e,n,t[n],!0)}function C(e,t){const n=[],i={};let r;for(const o of e)r=t(o),r in i||(i[r]=1,n.push(o));return n}function F(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function M(e,t){for(const n of e)if(t.has(n))return!0;return!1}function $(e){const t=new Set;for(const n of e){const e=Object(o["Y"])(n),i=e.map((e,t)=>0===t?e:`[${e}]`),r=i.map((e,t)=>i.slice(0,t+1).join(""));for(const n of r)t.add(n)}return t}function N(e,t){return void 0===e||void 0===t||M($(e),$(t))}function T(e){return 0===R(e).length}const R=Object.keys,z=Object.values;function P(e){const t=[];for(const n in e)Object(o["v"])(e,n)&&t.push({key:n,value:e[n]});return t}function L(e){return!0===e||!1===e}function B(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function I(e,t){return g(e)?"!("+I(e.not,t)+")":p(e)?"("+e.and.map(e=>I(e,t)).join(") && (")+")":h(e)?"("+e.or.map(e=>I(e,t)).join(") || (")+")":t(e)}function U(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&U(e[n],t)&&delete e[n],T(e)}function q(e){return e.charAt(0).toUpperCase()+e.substr(1)}function W(e,t="datum"){const n=Object(o["Y"])(e),i=[];for(let r=1;r<=n.length;r++){const e=`[${n.slice(0,r).map(o["Z"]).join("][")}]`;i.push(`${t}${e}`)}return i.join(" && ")}function H(e,t="datum"){return`${t}[${Object(o["Z"])(Object(o["Y"])(e).join("."))}]`}function G(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function V(e){return""+Object(o["Y"])(e).map(G).join("\\.")}function Y(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function Z(e){return""+Object(o["Y"])(e).join(".")}function X(e){return e?Object(o["Y"])(e).length:0}function J(...e){for(const t of e)if(void 0!==t)return t}let Q=42;function K(e){const t=++Q;return e?String(e)+t:t}function ee(e){return te(e)?e:"__"+e}function te(e){return 0===e.indexOf("__")}function ne(e){if(void 0!==e)return(e%360+360)%360}function ie(e){return!!Object(o["E"])(e)||!isNaN(e)&&!isNaN(parseFloat(e))}const re={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function oe(e){return e&&e["condition"]}const ae=["domain","grid","labels","ticks","title"],se={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},ue={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},ce=Object.assign(Object.assign({},ue),{style:1,labelExpr:1,encoding:1});function le(e){return!!ce[e]}R(ce);const fe={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},de=fe.arc,he=fe.area,pe=fe.bar,ge=fe.image,me=fe.line,ve=fe.point,be=fe.rect,ye=fe.rule,xe=fe.text,Oe=fe.tick,_e=fe.trail,we=fe.circle,je=fe.square,ke=fe.geoshape;function Ee(e){return k(["line","area","trail"],e)}function Ae(e){return k(["rect","bar","image","arc"],e)}const De=R(fe);function Se(e){return e["type"]}Object(o["db"])(De);const Ce=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Fe=["fill","fillOpacity"],Me=[...Ce,...Fe],$e={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},Ne=R($e),Te={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Re={color:"#4c78a8",invalid:"filter",timeUnitBand:1},ze={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Pe=5,Le={binSpacing:1,continuousBandSize:Pe,timeUnitBandPosition:.5},Be={binSpacing:0,continuousBandSize:Pe,timeUnitBandPosition:.5},Ie={thickness:1};function Ue(e){return Se(e)?e.type:e}function qe(e){return"mark"in e}class We{constructor(e,t){this.name=e,this.run=t}hasMatchingType(e){return!!qe(e)&&Ue(e.mark)===this.name}}const He={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Ge={count:1,min:1,max:1};function Ve(e){return!!e&&!!e["argmin"]}function Ye(e){return!!e&&!!e["argmax"]}R(He);function Ze(e){return Object(o["H"])(e)&&!!He[e]}const Xe=["count","valid","missing","distinct"];function Je(e){return Object(o["H"])(e)&&k(Xe,e)}function Qe(e){return Object(o["H"])(e)&&k(["min","max"],e)}const Ke=["count","sum","distinct","valid","missing"],et=["mean","average","median","q1","q3","min","max"],tt=Object(o["db"])(et),nt="row",it="column",rt="facet",ot="x",at="y",st="x2",ut="y2",ct="radius",lt="radius2",ft="theta",dt="theta2",ht="latitude",pt="longitude",gt="latitude2",mt="longitude2",vt="color",bt="fill",yt="stroke",xt="shape",Ot="size",_t="angle",wt="opacity",jt="fillOpacity",kt="strokeOpacity",Et="strokeWidth",At="strokeDash",Dt="text",St="order",Ct="detail",Ft="key",Mt="tooltip",$t="href",Nt="url",Tt="description",Rt={x:1,y:1,x2:1,y2:1},zt={theta:1,theta2:1,radius:1,radius2:1};function Pt(e){return e in zt}const Lt={longitude:1,longitude2:1,latitude:1,latitude2:1};function Bt(e){switch(e){case ht:return"y";case gt:return"y2";case pt:return"x";case mt:return"x2"}}function It(e){return e in Lt}const Ut=R(Lt),qt=Object.assign(Object.assign(Object.assign(Object.assign({},Rt),zt),Lt),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Wt(e){return e===vt||e===bt||e===yt}const Ht={row:1,column:1,facet:1},Gt=R(Ht),Vt=Object.assign(Object.assign({},qt),Ht),Yt=R(Vt),{order:Zt,detail:Xt,tooltip:Jt}=Vt,Qt=a(Vt,["order","detail","tooltip"]),{row:Kt,column:en,facet:tn}=Qt,nn=a(Qt,["row","column","facet"]);R(Qt),R(nn);function rn(e){return!!nn[e]}function on(e){return!!Vt[e]}const an=[st,ut,gt,mt,dt,lt];function sn(e){const t=un(e);return t!==e}function un(e){switch(e){case st:return ot;case ut:return at;case gt:return ht;case mt:return pt;case dt:return ft;case lt:return ct}return e}function cn(e){if(Pt(e))switch(e){case ft:return"startAngle";case dt:return"endAngle";case ct:return"outerRadius";case lt:return"innerRadius"}return e}function ln(e){switch(e){case ot:return st;case at:return ut;case ht:return gt;case pt:return mt;case ft:return dt;case ct:return lt}}function fn(e){switch(e){case ot:case st:return"width";case at:case ut:return"height"}}function dn(e){switch(e){case ot:return"xOffset";case at:return"yOffset";case st:return"x2Offset";case ut:return"y2Offset";case ft:return"thetaOffset";case ct:return"radiusOffset";case dt:return"theta2Offset";case lt:return"radius2Offset"}}R(qt);const{x:hn,y:pn,x2:gn,y2:mn,latitude:vn,longitude:bn,latitude2:yn,longitude2:xn,theta:On,theta2:_n,radius:wn,radius2:jn}=qt,kn=a(qt,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),En=R(kn),An={x:1,y:1},Dn=R(An);function Sn(e){return e in An}const Cn={theta:1,radius:1},Fn=R(Cn);function Mn(e){return"width"===e?ot:at}const{text:$n,tooltip:Nn,href:Tn,url:Rn,description:zn,detail:Pn,key:Ln,order:Bn}=kn,In=a(kn,["text","tooltip","href","url","description","detail","key","order"]),Un=R(In);function qn(e){return!!kn[e]}function Wn(e){switch(e){case vt:case bt:case yt:case Ot:case xt:case wt:case Et:case At:return!0;case jt:case kt:case _t:return!1}}const Hn=Object.assign(Object.assign(Object.assign({},An),Cn),In),Gn=R(Hn);function Vn(e){return!!Hn[e]}function Yn(e,t){return Qn(e)[t]}const Zn={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:Xn}=Zn,Jn=a(Zn,["geoshape"]);function Qn(e){switch(e){case vt:case bt:case yt:case Tt:case Ct:case Ft:case Mt:case $t:case St:case wt:case jt:case kt:case Et:case rt:case nt:case it:return Zn;case ot:case at:case ht:case pt:return Jn;case st:case ut:case gt:case mt:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Ot:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case At:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case xt:return{point:"always",geoshape:"always"};case Dt:return{text:"always"};case _t:return{point:"always",square:"always",text:"always"};case Nt:return{image:"always"};case ft:return{text:"always",arc:"always"};case ct:return{text:"always",arc:"always"};case dt:case lt:return{arc:"always"}}}function Kn(e){switch(e){case ot:case at:case ft:case ct:case Ot:case _t:case Et:case wt:case jt:case kt:case st:case ut:case dt:case lt:return;case rt:case nt:case it:case xt:case At:case Dt:case Mt:case $t:case Nt:case Tt:return"discrete";case vt:case bt:case yt:return"flexible";case ht:case pt:case gt:case mt:case Ct:case Ft:case St:return}}function ei(e){return Object(o["B"])(e)&&(e=Is(e,void 0)),"bin"+R(e).map(t=>ri(e[t])?B(`_${t}_${Object.entries(e[t])}`):B(`_${t}_${e[t]}`)).join("")}function ti(e){return!0===e||ii(e)&&!e.binned}function ni(e){return"binned"===e||ii(e)&&!0===e.binned}function ii(e){return Object(o["F"])(e)}function ri(e){return null===e||void 0===e?void 0:e["selection"]}function oi(e){switch(e){case nt:case it:case Ot:case vt:case bt:case yt:case Et:case wt:case jt:case kt:case xt:return 6;case At:return 4;default:return 10}}function ai(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const si='Autosize "fit" only works for single views and layered views.';function ui(e){const t="width"==e?"Width":"Height";return t+' "container" only works for single views and layered views.'}function ci(e){const t="width"==e?"Width":"Height",n="width"==e?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function li(e){return e?`Dropping "fit-${e}" because spec has discrete ${fn(e)}.`:'Dropping "fit" because spec has discrete size.'}function fi(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function di(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function hi(e){return`The "nearest" transform is not supported for ${e} marks.`}function pi(e){return`Selection not supported for ${e} yet.`}function gi(e){return`Cannot find a selection named "${e}".`}const mi="Scale bindings are currently only supported for scales with unbinned, continuous domains.",vi="Legend bindings are only supported for selections over an individual field or encoding channel.";function bi(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function yi(e){return`Unknown repeated value "${e}".`}function xi(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Oi="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function _i(e){return`Unrecognized parse "${e}".`}function wi(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function ji(e){return`Ignoring an invalid transform: ${_(e)}.`}const ki='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function Ei(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Ai(e){return`Layer's shared ${e.join(",")} channel ${1===e.length?"is":"are"} overriden.`}function Di(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${_(t)} is overridden by a child projection ${_(n)}.`}const Si="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Ci(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${_(n)}}.`}function Fi(e){return`Invalid field type "${e}".`}function Mi(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function $i(e){return`Invalid aggregation operator "${e}".`}function Ni(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function Ti(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function Ri(e,t){return`Dropping ${_(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function zi(e,t,n){return`${e}-encoding with type ${t} is deprecated. Replacing with ${n}-encoding.`}const Pi="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Li(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?" when "+n:""}.`}function Bi(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Ii(e){return e+" encoding should be discrete (ordinal / nominal / binned)."}function Ui(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function qi(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function Wi(e,t){const n=e&&t?"x2 and y2":e?"x2":"y2";return`Line mark is for continuous lines and thus cannot be used with ${n}. We will use the rule mark (line segments) instead.`}function Hi(e,t){return`Specified orient "${e}" overridden with "${t}".`}const Gi="Custom domain scale cannot be unioned with default field-based domain.",Vi='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function Yi(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Zi(e){return`Using unaggregated domain with raw field has no effect (${_(e)}).`}function Xi(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Ji(e){return`Unaggregated domain is currently unsupported for log scale (${_(e)}).`}function Qi(e){return`Cannot apply size to non-oriented mark "${e}".`}function Ki(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function er(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function tr(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function nr(e,t){return`Scale type "${t}" does not work with mark "${e}".`}function ir(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}function rr(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${_(n)} and ${_(i)}). Using ${_(n)}.`}function or(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${_(n)} and ${_(i)}). Using the union of the two domains.`}function ar(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function sr(e){return`Dropping sort property ${_(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const ur="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",cr="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",lr="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",fr="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",dr="Invalid channel for axis.";function hr(e){return`Cannot stack "${e}" if there is already "${e}2".`}function pr(e){return`Cannot stack non-linear scale (${e}).`}function gr(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function mr(e,t){return`Invalid ${e}: ${_(t)}.`}function vr(e){return`Dropping day from datetime ${_(e)} as day cannot be combined with other units.`}function br(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function yr(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function xr(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function Or(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function _r(e){return`1D error band does not support ${e}.`}function wr(e){return`Channel ${e} is required for "binned" bin.`}function jr(e){return`Domain for ${e} is required for threshold scale.`}const kr=Object(o["K"])(o["e"]);let Er=kr;function Ar(e){return Er=e,Er}function Dr(){return Er=kr,Er}function Sr(...e){Er.warn(...e)}function Cr(...e){Er.debug(...e)}function Fr(e){if(e&&Object(o["F"])(e))for(const t of Wr)if(t in e)return!0;return!1}const Mr=["january","february","march","april","may","june","july","august","september","october","november","december"],$r=Mr.map(e=>e.substr(0,3)),Nr=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Tr=Nr.map(e=>e.substr(0,3));function Rr(e){if(ie(e)&&(e=+e),Object(o["E"])(e))return e>4&&Sr(i.invalidTimeUnit("quarter",e)),e-1;throw new Error(i.invalidTimeUnit("quarter",e))}function zr(e){if(ie(e)&&(e=+e),Object(o["E"])(e))return e-1;{const t=e.toLowerCase(),n=Mr.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),o=$r.indexOf(r);if(-1!==o)return o;throw new Error(i.invalidTimeUnit("month",e))}}function Pr(e){if(ie(e)&&(e=+e),Object(o["E"])(e))return e%7;{const t=e.toLowerCase(),n=Nr.indexOf(t);if(-1!==n)return n;const r=t.substr(0,3),o=Tr.indexOf(r);if(-1!==o)return o;throw new Error(i.invalidTimeUnit("day",e))}}function Lr(e,t){const n=[];if(t&&void 0!==e.day&&R(e).length>1&&(Sr(i.droppedDay(e)),e=y(e),delete e.day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){const i=t?zr(e.month):e.month;n.push(i)}else if(void 0!==e.quarter){const i=t?Rr(e.quarter):e.quarter;n.push(Object(o["E"])(i)?3*i:i+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const i=t?Pr(e.day):e.day;n.push(Object(o["E"])(i)?i+1:i+"+1")}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const t=e[i];n.push("undefined"===typeof t?0:t)}return n}function Br(e){const t=Lr(e,!0),n=t.join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Ir(e){const t=Lr(e,!1),n=t.join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Ur(e){const t=Lr(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const qr={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Wr=R(qr);function Hr(e){return!!qr[e]}function Gr(e){return e.startsWith("utc")}function Vr(e){return e.substr(3)}const Yr={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Zr(e){const t=[];for(const n of Wr)Xr(e,n)&&t.push(n);return t}function Xr(e,t){const n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function Jr(e,t,{end:n}={end:!1}){const i=W(t),r=Gr(e)?"utc":"";function o(e){return"quarter"===e?`(${r}quarter(${i})-1)`:`${r}${e}(${i})`}let a;const s={};for(const u of Wr)Xr(e,u)&&(s[u]=o(u),a=u);return n&&(s[a]+="+1"),Ir(s)}function Qr(e){if(!e)return;const t=Zr(e);return`timeUnitSpecifier(${d()(t)}, ${d()(Yr)})`}function Kr(e,t,n){if(!e)return;const i=Qr(e),r=n||Gr(e);return`${r?"utc":"time"}Format(${t}, ${i})`}function eo(e){if(!e)return;let t;return Object(o["H"])(e)?t={unit:e}:Object(o["F"])(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),Gr(t.unit)&&(t.utc=!0,t.unit=Vr(t.unit)),t}function to(e){const t=eo(e),{utc:n}=t,i=a(t,["utc"]);return i.unit?(n?"utc":"")+R(i).map(e=>B(`${"unit"===e?"":`_${e}_`}${i[e]}`)).join(""):(n?"utc":"")+"timeunit"+R(i).map(e=>B(`_${e}_${i[e]}`)).join("")}function no(e){return e&&!!e["signal"]}function io(e){return!!e["step"]}function ro(e){return!Object(o["A"])(e)&&("fields"in e&&!("data"in e))}function oo(e){return!Object(o["A"])(e)&&("fields"in e&&"data"in e)}function ao(e){return!Object(o["A"])(e)&&("field"in e&&"data"in e)}const so={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},uo=R(so),co={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},lo=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function fo(e){return null===e||void 0===e?void 0:e["selection"]}function ho(e){return e&&!!e.field&&void 0!==e.equal}function po(e){return e&&!!e.field&&void 0!==e.lt}function go(e){return e&&!!e.field&&void 0!==e.lte}function mo(e){return e&&!!e.field&&void 0!==e.gt}function vo(e){return e&&!!e.field&&void 0!==e.gte}function bo(e){if(e&&e.field){if(Object(o["A"])(e.range)&&2===e.range.length)return!0;if(no(e.range))return!0}return!1}function yo(e){return e&&!!e.field&&(Object(o["A"])(e.oneOf)||Object(o["A"])(e.in))}function xo(e){return e&&!!e.field&&void 0!==e.valid}function Oo(e){return yo(e)||ho(e)||bo(e)||po(e)||mo(e)||go(e)||vo(e)}function _o(e,t){return Gs(e,{timeUnit:t,wrapTime:!0})}function wo(e,t){return e.map(e=>_o(e,t))}function jo(e,t=!0){var n;const{field:i}=e,r=null===(n=eo(e.timeUnit))||void 0===n?void 0:n.unit,o=r?"time("+Jr(r,i)+")":xs(e,{expr:"datum"});if(ho(e))return o+"==="+_o(e.equal,r);if(po(e)){const t=e.lt;return`${o}<${_o(t,r)}`}if(mo(e)){const t=e.gt;return`${o}>${_o(t,r)}`}if(go(e)){const t=e.lte;return`${o}<=${_o(t,r)}`}if(vo(e)){const t=e.gte;return`${o}>=${_o(t,r)}`}if(yo(e))return`indexof([${wo(e.oneOf,r).join(",")}], ${o}) !== -1`;if(xo(e))return ko(o,e.valid);if(bo(e)){const{range:n}=e,i=no(n)?{signal:n.signal+"[0]"}:n[0],a=no(n)?{signal:n.signal+"[1]"}:n[1];if(null!==i&&null!==a&&t)return"inrange("+o+", ["+_o(i,r)+", "+_o(a,r)+"])";const s=[];return null!==i&&s.push(`${o} >= ${_o(i,r)}`),null!==a&&s.push(`${o} <= ${_o(a,r)}`),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}function ko(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Eo(e){var t;return Oo(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=eo(e.timeUnit))||void 0===t?void 0:t.unit}):e}const Ao={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};const Do=Ao.quantitative,So=Ao.ordinal,Co=Ao.temporal,Fo=Ao.nominal,Mo=Ao.geojson,$o=R(Ao);function No(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Do:return"quantitative";case"t":case Co:return"temporal";case"o":case So:return"ordinal";case"n":case Fo:return"nominal";case Mo:return"geojson"}}const To={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},Ro={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},zo=R(Ro);function Po(e,t){const n=Ro[e],i=Ro[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n}const Lo={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Bo(e){return Lo[e]}const Io=["linear","log","pow","sqrt","symlog","time","utc"],Uo=Object(o["db"])(Io),qo=["linear","log","pow","sqrt","symlog"],Wo=Object(o["db"])(qo);function Ho(e){return e in Wo}const Go=["quantile","quantize","threshold"],Vo=Object(o["db"])(Go),Yo=Io.concat(["quantile","quantize","threshold","sequential","identity"]),Zo=Object(o["db"])(Yo),Xo=["ordinal","bin-ordinal","point","band"],Jo=Object(o["db"])(Xo);function Qo(e){return e in Jo}function Ko(e){return e in Zo}function ea(e){return e in Uo}function ta(e){return e in Vo}const na={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function ia(e){return!Object(o["H"])(e)&&!!e["name"]}function ra(e){return null===e||void 0===e?void 0:e["selection"]}function oa(e){return e&&e["unionWith"]}const aa={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:sa,domain:ua,range:ca,scheme:la}=(R(aa),aa),fa=a(aa,["type","domain","range","scheme"]),da=R(fa);va();function ha(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!k(["point","band","identity"],e);case"bins":return!k(["point","band","identity","ordinal"],e);case"round":return ea(e)||"band"===e||"point"===e;case"padding":return ea(e)||k(["point","band"],e);case"paddingOuter":case"align":return k(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return ea(e);case"nice":return ea(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return Ko(e)&&!k(["log","time","utc","threshold","quantile"],e)}}function pa(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Wt(e)?void 0:i.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function ga(e,t){return k([So,Fo],t)?void 0===e||Qo(e):t===Co?k([To.TIME,To.UTC,void 0],e):t!==Do||k([To.LOG,To.POW,To.SQRT,To.SYMLOG,To.QUANTILE,To.QUANTIZE,To.THRESHOLD,To.LINEAR,void 0],e)}function ma(e,t){if(!Vn(e))return!1;switch(e){case ot:case at:case ft:case ct:return ea(t)||k(["band","point"],t);case Ot:case Et:case wt:case jt:case kt:case _t:return ea(t)||ta(t)||k(["band","point","ordinal"],t);case vt:case bt:case yt:return"band"!==t;case At:return"ordinal"===t||ta(t);case xt:return"ordinal"===t}}function va(){var e;const t={};for(const n of Yt)for(const i of $o)for(const r of zo){const o=ba(n,i);ma(n,r)&&ga(r,i)&&(t[o]=null!==(e=t[o])&&void 0!==e?e:[],t[o].push(r))}return t}function ba(e,t){return e+"_"+t}function ya(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:o}=e,a=Ea(e);return ss(n)&&!Je(n.aggregate)&&r&&ea(r.get("type"))&&!1===r.get("zero")?xa({fieldDef:n,channel:t,markDef:i,ref:a,config:o}):a}function xa({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){if(Ee(n.type))return i;const o=nu("invalid",n,r);return null===o?i:[Oa(e,t),i]}function Oa(e,t){const n=_a(e,!0),i=un(t),r="y"===i?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function _a(e,t=!0){return ko(Object(o["H"])(e)?e:xs(e,{expr:"datum"}),!t)}function wa(e){const{datum:t}=e;return Fr(t)?Br(t):""+JSON.stringify(t)}function ja(e,t,n,i){const r={};if(t&&(r.scale=t),cs(e)){const{datum:t}=e;Fr(t)?r.signal=Br(t):no(t)?r.signal=t.signal:r.value=t}else r.field=xs(e,n);if(i){const{offset:e,band:t}=i;e&&(r.offset=e),t&&(r.band=t)}return r}function ka({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,band:o=.5}){const a=0<o&&o<1?"datum":void 0,s=xs(t,{expr:a,suffix:r}),u=void 0!==n?xs(n,{expr:a}):xs(t,{suffix:"end",expr:a}),c={};if(0===o||1===o){c.scale=e;const t=0===o?s:u;c.field=t}else{const t=`${o} * ${s} + ${1-o} * ${u}`;c.signal=`scale("${e}", ${t})`}return i&&(c.offset=i),c}function Ea({channel:e,channelDef:t,channel2Def:n,markDef:r,config:a,scaleName:s,scale:u,stack:c,offset:l,defaultRef:f,band:d}){var h;if(t){if(ds(t)){if(hs(t)){d=null!==d&&void 0!==d?d:ts({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:c,config:a,isMidPoint:!0});const{bin:o,timeUnit:u,type:f}=t;if(ti(o)||d&&u&&f===Co)return c&&c.impute?ja(t,s,{binSuffix:"mid"},{offset:l}):d?ka({scaleName:s,fieldOrDatumDef:t,band:d,offset:l}):ja(t,s,Ys(t,e)?{binSuffix:"range"}:{},{offset:l});if(ni(o)){if(ss(n))return ka({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:d,offset:l});{const t=e===ot?st:ut;Sr(i.channelRequiredForBinned(t))}}}const o=null===u||void 0===u?void 0:u.get("type");return ja(t,s,Qo(o)?{binSuffix:"range"}:{},{offset:l,band:"band"===o?null!==(h=null!==d&&void 0!==d?d:t.band)&&void 0!==h?h:.5:void 0})}if(ps(t)){const n=t.value,i=l?{offset:l}:{};return Object.assign(Object.assign({},Aa(e,n)),i)}}return Object(o["D"])(f)&&(f=f()),f?Object.assign(Object.assign({},f),l?{offset:l}:{}):f}function Aa(e,t){return k(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:k(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:Js(t)}function Da(e){return e&&"number"!==e&&"time"!==e}function Sa(e,t,n){return`${e}(${t}${n?", "+JSON.stringify(n):""})`}const Ca="  ";function Fa({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o}){var a,s;if(Da(n))return $a({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:o});const u=Ma(e,i,r);if(Ws(e)){const n=Ia(u,ss(e)?null===(a=eo(e.timeUnit))||void 0===a?void 0:a.unit:void 0,t,o.timeFormat,gs(e)&&(null===(s=e.scale)||void 0===s?void 0:s.type)===To.UTC);return n?{signal:n}:void 0}if(t=Ra(us(e),t,o),ss(e)&&ti(e.bin)){const r=xs(e,{expr:i,binSuffix:"end"});return{signal:Ba(u,r,t,n,o)}}return t||"quantitative"===us(e)?{signal:""+Pa(u,t)}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function Ma(e,t,n){return ss(e)?n?`${xs(e,{expr:t,suffix:"end"})}-${xs(e,{expr:t,suffix:"start"})}`:xs(e,{expr:t}):wa(e)}function $a({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:a}){if(a=null!==a&&void 0!==a?a:Ma(e,i,r),ss(e)&&ti(e.bin)){const r=xs(e,{expr:i,binSuffix:"end"});return{signal:Ba(a,r,t,n,o)}}return{signal:Sa(n,a,t)}}function Na(e,t,n,i,r,o){var a;if(!Da(i)){if(Ws(e)){const t=ss(e)?null===(a=eo(e.timeUnit))||void 0===a?void 0:a.unit:void 0;return za(n,t,r,o)}return Ra(t,n,r)}}function Ta(e,t,n){return e&&(no(e)||"number"===e||"time"===e)?e:Ws(t)&&"time"!==n&&"utc"!==n?"time":void 0}function Ra(e,t,n){return Object(o["H"])(t)?t:e===Do?n.numberFormat:void 0}function za(e,t,n,i){return e||(t?{signal:Qr(t)}:i?void 0:n.timeFormat)}function Pa(e,t){return`format(${e}, "${t||""}")`}function La(e,t,n,i){var r;return Da(n)?Sa(n,e,t):Pa(e,null!==(r=Object(o["H"])(t)?t:void 0)&&void 0!==r?r:i.numberFormat)}function Ba(e,t,n,i,r){const o=La(e,n,i,r),a=La(t,n,i,r);return`${ko(e,!1)} ? "null" : ${o} + "${Ca}" + ${a}`}function Ia(e,t,n,i,r){return!t||n?(n=Object(o["H"])(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):Kr(t,e,r)}const Ua="min",qa={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Wa(e){return e in qa}function Ha(e){return!!e&&!!e["encoding"]}function Ga(e){return!!e&&("count"===e["op"]||!!e["field"])}function Va(e){return!!e&&Object(o["A"])(e)}function Ya(e){return"row"in e||"column"in e}function Za(e){return!!e&&"header"in e}function Xa(e){return"facet"in e}function Ja(e){return e["selection"]}function Qa(e){return e&&!Object(o["H"])(e)&&"repeat"in e}function Ka(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function es(e){return hs(e)&&"sort"in e}function ts({channel:e,fieldDef:t,fieldDef2:n,markDef:i,stack:r,config:o,isMidPoint:a}){if(ds(t)&&void 0!==t.band)return t.band;if(ss(t)){const{timeUnit:e,bin:r}=t;if(e&&!n)return a?iu("timeUnitBandPosition",i,o):Ae(i.type)?iu("timeUnitBand",i,o):0;if(ti(r))return Ae(i.type)&&!a?1:.5}return(null===r||void 0===r?void 0:r.fieldChannel)===e&&a?.5:void 0}function ns(e,t,n,i,r,o){return!!(ti(t.bin)||t.timeUnit&&hs(t)&&"temporal"===t.type)&&!!ts({channel:e,fieldDef:t,fieldDef2:n,stack:i,markDef:r,config:o})}function is(e){return!!e&&"condition"in e}function rs(e){const t=e&&e["condition"];return!!t&&!Object(o["A"])(t)&&ss(t)}function os(e){const t=e&&e["condition"];return!!t&&!Object(o["A"])(t)&&ds(t)}function as(e){const t=e&&e["condition"];return!!t&&(Object(o["A"])(t)||ps(t))}function ss(e){return!!e&&(!!e["field"]||"count"===e["aggregate"])}function us(e){return e&&e["type"]}function cs(e){return!!e&&"datum"in e}function ls(e){return hs(e)&&_s(e)||fs(e)}function fs(e){return cs(e)&&Object(o["E"])(e.datum)}function ds(e){return ss(e)||cs(e)}function hs(e){return!!e&&("field"in e&&"type"in e||"count"===e["aggregate"])}function ps(e){return e&&"value"in e&&"value"in e}function gs(e){return!!e&&("scale"in e||"sort"in e)}function ms(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function vs(e){return!!e&&"legend"in e}function bs(e){return!!e&&("format"in e||"formatType"in e)}function ys(e){return"op"in e}function xs(e,t={}){var n,i,r;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if(ws(e))o=ee("count");else{let a;if(!t.nofn)if(ys(e))a=e.op;else{const{bin:c,aggregate:l,timeUnit:f}=e;ti(c)?(a=ei(c),s=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(i=t.suffix)&&void 0!==i?i:"")):l?Ye(l)?(u=`["${o}"]`,o="argmax_"+l.argmax):Ve(l)?(u=`["${o}"]`,o="argmin_"+l.argmin):a=String(l):f&&(a=to(f),s=(!k(["range","mid"],t.binSuffix)&&t.binSuffix||"")+(null!==(r=t.suffix)&&void 0!==r?r:""))}a&&(o=o?`${a}_${o}`:a)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?Z(o):t.expr?H(o,t.expr)+u:V(o)+u}function Os(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ss(e)&&!!e.bin;case"temporal":return!1}throw new Error(i.invalidFieldType(e.type))}function _s(e){return!Os(e)}function ws(e){return"count"===e.aggregate}function js(e,t){var n;const{field:i,bin:r,timeUnit:o,aggregate:a}=e;if("count"===a)return t.countTitle;if(ti(r))return i+" (binned)";if(o){const e=null===(n=eo(o))||void 0===n?void 0:n.unit;if(e)return`${i} (${Zr(e).join("-")})`}else if(a)return Ye(a)?`${i} for max ${a.argmax}`:Ve(a)?`${i} for min ${a.argmin}`:`${q(a)} of ${i}`;return i}function ks(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Ye(t))return`${r} for argmax(${t.argmax})`;if(Ve(t))return`${r} for argmin(${t.argmin})`;const o=eo(i),a=t||(null===o||void 0===o?void 0:o.unit)||(null===o||void 0===o?void 0:o.maxbins)&&"timeunit"||ti(n)&&"bin";return a?a.toUpperCase()+"("+r+")":r}const Es=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return ks(e);default:return js(e,t)}};let As=Es;function Ds(e){As=e}function Ss(){Ds(Es)}function Cs(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,o;const a=null!==(r=Fs(e))&&void 0!==r?r:{},s=a.title;if(!ss(e))return s;const u=e,c=i?Ms(u,t):void 0;return n?J(s,u.title,c):null!==(o=null!==s&&void 0!==s?s:u.title)&&void 0!==o?o:c}function Fs(e){return ms(e)&&e.axis?e.axis:vs(e)&&e.legend?e.legend:Za(e)&&e.header?e.header:void 0}function Ms(e,t){return As(e,t)}function $s(e){var t;if(bs(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}{const n=null!==(t=Fs(e))&&void 0!==t?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function Ns(e,t){if(e.timeUnit)return"temporal";if(ti(e.bin))return"quantitative";switch(Kn(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Ts(e){return ss(e)?e:rs(e)?e.condition:void 0}function Rs(e){return ds(e)?e:os(e)?e.condition:void 0}function zs(e,t,n){if(Object(o["H"])(e)||Object(o["E"])(e)||Object(o["B"])(e)){const n=Object(o["H"])(e)?"string":Object(o["E"])(e)?"number":"boolean";return Sr(i.primitiveChannelDef(t,n,e)),{value:e}}return ds(e)?Ps(e,t,n):os(e)?Object.assign(Object.assign({},e),{condition:Ps(e.condition,t,n)}):e}function Ps(e,t,n){if(bs(e)){const{format:r,formatType:o}=e,s=a(e,["format","formatType"]);if(Da(o)&&!n.customFormatTypes)return Sr(i.customFormatTypeNotAllowed(t)),Ps(s,t,n)}else{const r=ms(e)?"axis":vs(e)?"legend":Za(e)?"header":null;if(r&&e[r]){const o=e[r],{format:s,formatType:u}=o,c=a(o,["format","formatType"]);if(Da(u)&&!n.customFormatTypes)return Sr(i.customFormatTypeNotAllowed(t)),Ps(Object.assign(Object.assign({},e),{[r]:c}),t,n)}}return ss(e)?Bs(e,t):Ls(e)}function Ls(e){let t=e["type"];if(t)return e;const{datum:n}=e;return t=Object(o["E"])(n)?"quantitative":Object(o["H"])(n)?"nominal":Fr(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function Bs(e,t){const{aggregate:n,timeUnit:r,bin:s,field:u}=e,c=Object.assign({},e);if(!n||Ze(n)||Ye(n)||Ve(n)||(Sr(i.invalidAggregate(n)),delete c.aggregate),r&&(c.timeUnit=eo(r)),u&&(c.field=""+u),ti(s)&&(c.bin=Is(s,t)),ni(s)&&!Sn(t)&&Sr(`Channel ${t} should not be used with "binned" bin.`),hs(c)){const{type:e}=c,t=No(e);e!==t&&(c.type=t),"quantitative"!==e&&Je(n)&&(Sr(i.invalidFieldTypeForCountAggregate(e,n)),c.type="quantitative")}else if(!sn(t)){const e=Ns(c,t);Sr(i.missingFieldType(t,e)),c["type"]=e}if(hs(c)){const{compatible:e,warning:n}=qs(c,t);e||Sr(n)}if(es(c)&&Object(o["H"])(c.sort)){const{sort:e}=c;if(Wa(e))return Object.assign(Object.assign({},c),{sort:{encoding:e}});const t=e.substr(1);if("-"===e.charAt(0)&&Wa(t))return Object.assign(Object.assign({},c),{sort:{encoding:t,order:"descending"}})}if(Za(c)){const{header:e}=c,{orient:t}=e,n=a(e,["orient"]);if(t)return Object.assign(Object.assign({},c),{header:Object.assign(Object.assign({},n),{labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t})})}return c}function Is(e,t){return Object(o["B"])(e)?{maxbins:oi(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:oi(t)})}const Us={compatible:!0};function qs(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case nt:case it:case rt:return _s(e)?{compatible:!1,warning:i.facetChannelShouldBeDiscrete(t)}:Us;case ot:case at:case vt:case bt:case yt:case Dt:case Ct:case Ft:case Mt:case $t:case Nt:case _t:case ft:case ct:case Tt:return Us;case pt:case mt:case ht:case gt:return n!==Do?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Us;case wt:case jt:case kt:case Et:case Ot:case dt:case lt:case st:case ut:return"nominal"!==n||e["sort"]?Us:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case At:return k(["ordinal","nominal"],e.type)?Us:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case xt:return k(["ordinal","nominal","geojson"],e.type)?Us:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case St:return"nominal"!==e.type||"sort"in e?Us:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}function Ws(e){const{formatType:t}=$s(e);return"time"===t||!t&&Hs(e)}function Hs(e){return e&&("temporal"===e["type"]||ss(e)&&!!e.timeUnit)}function Gs(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var a;const s=t&&(null===(a=eo(t))||void 0===a?void 0:a.unit);let u,c=s||"temporal"===n;return no(e)?u=e.signal:Fr(e)?(c=!0,u=Br(e)):(Object(o["H"])(e)||Object(o["E"])(e))&&c&&(u=`datetime(${JSON.stringify(e)})`,Hr(s)&&(Object(o["E"])(e)&&e<1e4||Object(o["H"])(e)&&isNaN(Date.parse(e)))&&(u=Br({[s]:e}))),u?i&&c?`time(${u})`:u:r?void 0:JSON.stringify(e)}function Vs(e,t){const{type:n}=e;return t.map(t=>{const i=Gs(t,{timeUnit:ss(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==i?{signal:i}:t})}function Ys(e,t){return ti(e.bin)?Vn(t)&&k(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Zs(e){const{anchor:t,frame:n,offset:i,orient:r,color:o,subtitleColor:s,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:l,subtitleFontWeight:f,subtitleLineHeight:d,subtitlePadding:h}=e,p=a(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),g=Object.assign(Object.assign({},p),o?{fill:o}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{subtitleColor:s}:{}),u?{subtitleFont:u}:{}),c?{subtitleFontSize:c}:{}),l?{subtitleFontStyle:l}:{}),f?{subtitleFontWeight:f}:{}),d?{subtitleLineHeight:d}:{}),h?{subtitlePadding:h}:{}),b=x(g,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:g,subtitleMarkConfig:b,nonMark:m,subtitle:v}}function Xs(e){return Object(o["H"])(e)||Object(o["A"])(e)&&Object(o["H"])(e[0])}function Js(e){return no(e)?e:void 0!==e?{value:e}:void 0}function Qs(e){return no(e)?e.signal:Object(o["Z"])(e.value)}function Ks(e){return no(e)?e.signal:null==e?null:Object(o["Z"])(e)}function eu(e,t,n){for(const i of n){const n=iu(i,t.markDef,t.config);void 0!==n&&(e[i]=Js(n))}return e}function tu(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function nu(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!o||r&&r!==e?iu(e,t,n,i):void 0}function iu(e,t,n,{vgChannel:i}={}){return J(i?ru(e,t,n.style):void 0,ru(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function ru(e,t,n){return ou(e,tu(t),n)}function ou(e,t,n){let i;t=Object(o["i"])(t);for(const r of t){const t=n[r];t&&void 0!==t[e]&&(i=t[e])}return i}function au(e,t){return Object(o["i"])(e).reduce((e,n)=>{var i;return e.field.push(xs(n,t)),e.order.push(null!==(i=n.sort)&&void 0!==i?i:"ascending"),e},{field:[],order:[]})}function su(e,t){const n=[...e];return t.forEach(e=>{for(const t of n)if(b(t,e))return;n.push(e)}),n}function uu(e,t){return b(e,t)||!t?e:e?[...Object(o["i"])(e),...Object(o["i"])(t)].join(", "):t}function cu(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if((Xs(n)||no(n))&&(Xs(i)||no(i)))return{explicit:e.explicit,value:uu(n,i)};if(Xs(n)||no(n))return{explicit:e.explicit,value:n};if(Xs(i)||no(i))return{explicit:e.explicit,value:i};if(!Xs(n)&&!no(n)&&!Xs(i)&&!no(i))return{explicit:e.explicit,value:su(n,i)};throw new Error("It should never reach here")}function lu(e,t){const n=e&&e[t];return!!n&&(Object(o["A"])(n)?E(n,e=>!!e.field):ss(n)||rs(n))}function fu(e){return E(Yt,t=>{if(lu(e,t)){const n=e[t];if(Object(o["A"])(n))return E(n,e=>!!e.aggregate);{const e=Ts(n);return e&&!!e.aggregate}}return!1})}function du(e,t){const n=[],i=[],r=[],o=[],s={};return mu(e,(u,c)=>{if(ss(u)){const{field:l,aggregate:f,bin:d,timeUnit:h}=u,p=a(u,["field","aggregate","bin","timeUnit"]);if(f||h||d){const e=Fs(u),a=e&&e.title;let g=xs(u,{forAs:!0});const m=Object.assign(Object.assign(Object.assign({},a?[]:{title:Cs(u,t,{allowDisabling:!0})}),p),{field:g});if(f){let e;if(Ye(f)?(e="argmax",g=xs({op:"argmax",field:f.argmax},{forAs:!0}),m.field=`${g}.${l}`):Ve(f)?(e="argmin",g=xs({op:"argmin",field:f.argmin},{forAs:!0}),m.field=`${g}.${l}`):"boxplot"!==f&&"errorbar"!==f&&"errorband"!==f&&(e=f),e){const t={op:e,as:g};l&&(t.field=l),o.push(t)}}else if(n.push(g),hs(u)&&ti(d)){if(i.push({bin:d,field:l,as:g}),n.push(xs(u,{binSuffix:"end"})),Ys(u,c)&&n.push(xs(u,{binSuffix:"range"})),Sn(c)){const e={field:g+"_end"};s[c+"2"]=e}m.bin="binned",sn(c)||(m["type"]=Do)}else if(h){r.push({timeUnit:h,field:l,as:g});const e=hs(u)&&u.type!==Co&&"time";e&&(c===Dt||c===Mt?m["formatType"]=e:qn(c)?m["legend"]=Object.assign({formatType:e},m["legend"]):Sn(c)&&(m["axis"]=Object.assign({formatType:e},m["axis"])))}s[c]=m}else n.push(l),s[c]=e[c]}else s[c]=e[c]}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:s}}function hu(e,t,n){const i=Yn(t,n);if(!i)return!1;if("binned"===i){const n=e[t===st?ot:at];return!!(ss(n)&&ss(e[t])&&ni(n.bin))}return!0}function pu(e,t,n){const r=t.type;return R(e).reduce((a,s)=>{if(!on(s))return Sr(i.invalidEncodingChannel(s)),a;const u=e[s];if("angle"!==s||"arc"!==r||e.theta||(Sr(i.REPLACE_ANGLE_WITH_THETA),s=ft),!hu(e,s,r))return Sr(i.incompatibleChannel(s,r)),a;if(s===Ot&&"line"===r){const t=Ts(e[s]);if(null===t||void 0===t?void 0:t.aggregate)return Sr(i.LINE_WITH_VARYING_SIZE),a}if(s===vt&&(t.filled?"fill"in e:"stroke"in e))return Sr(i.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),a;if(s===Ct||s===St&&!Object(o["A"])(u)&&!ps(u)||s===Mt&&Object(o["A"])(u))u&&(a[s]=Object(o["i"])(u).reduce((e,t)=>(ss(t)?e.push(Bs(t,s)):Sr(i.emptyFieldDef(t,s)),e),[]));else{if(s===Mt&&null===u)a[s]=null;else if(!ss(u)&&!cs(u)&&!ps(u)&&!is(u)&&!no(u))return Sr(i.emptyFieldDef(u,s)),a;a[s]=zs(u,s,n)}return a},{})}function gu(e){const t=[];for(const n of R(e))if(lu(e,n)){const i=e[n],r=Object(o["i"])(i);for(const e of r)ss(e)?t.push(e):rs(e)&&t.push(e.condition)}return t}function mu(e,t,n){if(e)for(const i of R(e)){const r=e[i];if(Object(o["A"])(r))for(const e of r)t.call(n,e,i);else t.call(n,r,i)}}function vu(e,t,n,i){return e?R(e).reduce((n,r)=>{const a=e[r];return Object(o["A"])(a)?a.reduce((e,n)=>t.call(i,e,n,r),n):t.call(i,n,a,r)},n):n}function bu(e,t){return R(t).reduce((n,i)=>{switch(i){case ot:case at:case $t:case Tt:case Nt:case st:case ut:case ft:case dt:case ct:case lt:case ht:case pt:case gt:case mt:case Dt:case xt:case _t:case Mt:return n;case St:if("line"===e||"trail"===e)return n;case Ct:case Ft:{const e=t[i];if(Object(o["A"])(e)||ss(e))for(const t of Object(o["i"])(e))t.aggregate||n.push(xs(t,{}));return n}case Ot:if("trail"===e)return n;case vt:case bt:case yt:case wt:case jt:case kt:case At:case Et:{const e=Ts(t[i]);return e&&!e.aggregate&&n.push(xs(e,{})),n}}},[])}function yu(e){const{tooltip:t}=e,n=a(e,["tooltip"]);if(!t)return{filteredEncoding:e};let i,r;if(Object(o["A"])(t)){for(const e of t)e.aggregate?(i||(i=[]),i.push(e)):(r||(r=[]),r.push(e));i&&(n.tooltip=i)}else t["aggregate"]?n.tooltip=t:r=t;return Object(o["A"])(r)&&1===r.length&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function xu(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:e,titlePrefix:n})=>{const r=i?" of "+t.field:"";return{field:e+t.field,type:t.type,title:no(n)?{signal:n+`"${escape(r)}"`}:n+r}});return{tooltip:[...r,...gu(n)]}}function Ou(e){const{axis:t,title:n,field:i}=e;return t&&void 0!==t.title?void 0:J(n,i)}function _u(e,t,n,i,r){const{scale:a,axis:s}=n;return({partName:u,mark:c,positionPrefix:l,endPositionPrefix:f,aria:d,extraEncoding:h={}})=>{const p=Ou(n);return wu(e,u,r,d,{mark:c,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==p?{title:p}:{}),void 0!==a?{scale:a}:{}),void 0!==s?{axis:s}:{})},Object(o["H"])(f)?{[t+"2"]:{field:f+"_"+n.field}}:{}),i),h)})}}function wu(e,t,n,i,r){const{clip:a,color:s,opacity:u}=e,c=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),a?{clip:a}:{}),s?{color:s}:{}),u?{opacity:u}:{}),Se(r.mark)?r.mark:{type:r.mark}),{style:`${c}-${t}`}),Object(o["B"])(e[t])?{}:e[t]),!1===i?{aria:i}:{})})]:[]}function ju(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[r],a=i[r+"2"],s=i[r+"Error"],u=i[r+"Error2"];return{continuousAxisChannelDef:ku(o,n),continuousAxisChannelDef2:ku(a,n),continuousAxisChannelDefError:ku(s,n),continuousAxisChannelDefError2:ku(u,n),continuousAxis:r}}function ku(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=a(e,["aggregate"]);return n!==t&&Sr(i.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function Eu(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(ls(r)){if(ls(o)){const e=ss(r)&&r.aggregate,i=ss(o)&&o.aggregate;if(e||i!==t){if(i||e!==t){if(e===t&&i===t)throw new Error("Both x and y cannot have aggregate");return Se(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(ls(o))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}const Au="boxplot",Du=["box","median","outliers","rule","ticks"],Su=new We(Au,Fu);function Cu(e){return Object(o["E"])(e)?"tukey":e}function Fu(e,{config:t}){var n,r;const{mark:s,encoding:u,selection:c,projection:l}=e,f=a(e,["mark","encoding","selection","projection"]),d=Se(s)?s:{type:s};c&&Sr(i.selectionNotSupported("boxplot"));const h=null!==(n=d.extent)&&void 0!==n?n:t.boxplot.extent,p=nu("size",d,t),g=Cu(h),{transform:m,continuousAxisChannelDef:v,continuousAxis:b,groupby:y,aggregate:x,encodingWithoutContinuousAxis:O,ticksOrient:_,boxOrient:w,customTooltipWithoutAggregatedField:j}=$u(e,h,t),{color:k,size:E}=O,A=a(O,["color","size"]),D=e=>_u(d,b,v,e,t.boxplot),S=D(A),C=D(O),F=D(Object.assign(Object.assign({},A),E?{size:E}:{})),M=xu([{fieldPrefix:"min-max"===g?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===g?"lower_whisker_":"min_",titlePrefix:"Min"}],v,O),$={type:"tick",color:"black",opacity:1,orient:_,invalid:null},N="min-max"===g?M:xu([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,O),T=[...S({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:N}),...S({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:N}),...S({partName:"ticks",mark:$,positionPrefix:"lower_whisker",aria:!1,extraEncoding:N}),...S({partName:"ticks",mark:$,positionPrefix:"upper_whisker",aria:!1,extraEncoding:N})],R=[..."tukey"!==g?T:[],...C({partName:"box",mark:Object.assign(Object.assign({type:"bar"},p?{size:p}:{}),{orient:w,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:M}),...F({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Object(o["F"])(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),p?{size:p}:{}),{orient:_,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:M})];let z;if("min-max"!==g){const e=`datum["lower_box_${v.field}"]`,n=`datum["upper_box_${v.field}"]`,i=`(${n} - ${e})`,r=`${e} - ${h} * ${i}`,o=`${n} + ${h} * ${i}`,s=`datum["${v.field}"]`,u={joinaggregate:Mu(v.field),groupby:y};let c=void 0;"tukey"===g&&(c={transform:[{filter:`(${r} <= ${s}) && (${s} <= ${o})`},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_"+v.field},{op:"max",field:v.field,as:"upper_whisker_"+v.field},{op:"min",field:"lower_box_"+v.field,as:"lower_box_"+v.field},{op:"max",field:"upper_box_"+v.field,as:"upper_box_"+v.field},...x],groupby:y}],layer:T});const{tooltip:l}=A,f=a(A,["tooltip"]),{scale:p,axis:m}=v,O=Ou(v),_=wu(d,"outliers",t.boxplot,!0,{transform:[{filter:`(${s} < ${r}) || (${s} > ${o})`}],mark:"point",encoding:Object.assign(Object.assign({[b]:Object.assign(Object.assign(Object.assign({field:v.field,type:v.type},void 0!==O?{title:O}:{}),void 0!==p?{scale:p}:{}),void 0!==m?{axis:m}:{})},f),j?{tooltip:j}:{})})[0];_&&c?z={transform:[u],layer:[_,c]}:_?(z=_,z.transform.unshift(u)):c&&(z=c,z.transform.unshift(u))}return z?Object.assign(Object.assign({},f),{layer:[z,{transform:m,layer:R}]}):Object.assign(Object.assign({},f),{transform:(null!==(r=f.transform)&&void 0!==r?r:[]).concat(m),layer:R})}function Mu(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function $u(e,t,n){const i=Eu(e,Au),{continuousAxisChannelDef:r,continuousAxis:o}=ju(e,i,Au),s=r.field,u=Cu(t),c=[...Mu(s),{op:"median",field:s,as:"mid_box_"+s},{op:"min",field:s,as:("min-max"===u?"lower_whisker_":"min_")+s},{op:"max",field:s,as:("min-max"===u?"upper_whisker_":"max_")+s}],l="min-max"===u||"tukey"===u?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:"iqr_"+s},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:"upper_whisker_"+s},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:"lower_whisker_"+s}],f=e.encoding,d=o,h=(f[d],a(f,["symbol"===typeof d?d:d+""])),{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=yu(h),{bins:m,timeUnits:v,aggregate:b,groupby:y,encoding:x}=du(g,n),O="vertical"===i?"horizontal":"vertical",_=i,w=[...m,...v,{aggregate:[...b,...c],groupby:y},...l];return{transform:w,groupby:y,aggregate:b,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:O,boxOrient:_,customTooltipWithoutAggregatedField:p}}const Nu="errorbar",Tu=["ticks","rule"],Ru=new We(Nu,zu);function zu(e,{config:t}){const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:c}=Uu(e,Nu,t),l=_u(s,r,i,o,t.errorbar),f={type:"tick",orient:a},d=[...l({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:c}),...l({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:c}),...l({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function Pu(e,t){const{encoding:n}=e;if(Lu(n))return{orient:Eu(e,t),inputType:"raw"};const i=Bu(n),r=Iu(n),o=n.x,a=n.y;if(i){if(r)throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error");const e=n.x2,i=n.y2;if(ds(e)&&ds(i))throw new Error(t+" cannot have both x2 and y2");if(ds(e)){if(ls(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+t)}if(ds(i)){if(ls(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+t)}throw new Error("No ranged axis")}{const e=n.xError,i=n.xError2,r=n.yError,s=n.yError2;if(ds(i)&&!ds(e))throw new Error(t+" cannot have xError2 without xError");if(ds(s)&&!ds(r))throw new Error(t+" cannot have yError2 without yError");if(ds(e)&&ds(r))throw new Error(t+" cannot have both xError and yError with both are quantiative");if(ds(e)){if(ls(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(ds(r)){if(ls(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Lu(e){return(ds(e.x)||ds(e.y))&&!ds(e.x2)&&!ds(e.y2)&&!ds(e.xError)&&!ds(e.xError2)&&!ds(e.yError)&&!ds(e.yError2)}function Bu(e){return ds(e.x2)||ds(e.y2)}function Iu(e){return ds(e.xError)||ds(e.xError2)||ds(e.yError)||ds(e.yError2)}function Uu(e,t,n){var r;const{mark:o,encoding:s,selection:u,projection:c}=e,l=a(e,["mark","encoding","selection","projection"]),f=Se(o)?o:{type:o};u&&Sr(i.selectionNotSupported(t));const{orient:d,inputType:h}=Pu(e,t),{continuousAxisChannelDef:p,continuousAxisChannelDef2:g,continuousAxisChannelDefError:m,continuousAxisChannelDefError2:v,continuousAxis:b}=ju(e,d,t),{errorBarSpecificAggregate:y,postAggregateCalculates:x,tooltipSummary:O,tooltipTitleWithFieldName:_}=qu(f,p,g,m,v,h,t,n),w=s,j=b,k=(w[j],"x"===b?"x2":"y2"),E=(w[k],"x"===b?"xError":"yError"),A=(w[E],"x"===b?"xError2":"yError2"),D=(w[A],a(w,["symbol"===typeof j?j:j+"","symbol"===typeof k?k:k+"","symbol"===typeof E?E:E+"","symbol"===typeof A?A:A+""])),{bins:S,timeUnits:C,aggregate:F,groupby:M,encoding:$}=du(D,n),N=[...F,...y],T="raw"!==h?[]:M,R=xu(O,p,$,_);return{transform:[...null!==(r=l.transform)&&void 0!==r?r:[],...S,...C,...0===N.length?[]:[{aggregate:N,groupby:T}],...x],groupby:T,continuousAxisChannelDef:p,continuousAxis:b,encodingWithoutContinuousAxis:$,ticksOrient:"vertical"===d?"horizontal":"vertical",markDef:f,outerSpec:l,tooltipEncoding:R}}function qu(e,t,n,r,o,a,s,u){let c=[],l=[];const f=t.field;let d,h=!1;if("raw"===a){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":u.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!==("iqr"===n)&&Sr(i.errorBarCenterIsUsedWithWrongExtent(t,n,s)),"stderr"===n||"stdev"===n)c=[{op:n,field:f,as:"extent_"+f},{op:t,field:f,as:"center_"+f}],l=[{calculate:`datum["center_${f}"] + datum["extent_${f}"]`,as:"upper_"+f},{calculate:`datum["center_${f}"] - datum["extent_${f}"]`,as:"lower_"+f}],d=[{fieldPrefix:"center_",titlePrefix:q(t)},{fieldPrefix:"upper_",titlePrefix:Wu(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:Wu(t,n,"-")}],h=!0;else{let t,r,o;e.center&&e.extent&&Sr(i.errorBarCenterIsNotNeeded(e.extent,s)),"ci"===n?(t="mean",r="ci0",o="ci1"):(t="median",r="q1",o="q3"),c=[{op:r,field:f,as:"lower_"+f},{op:o,field:f,as:"upper_"+f},{op:t,field:f,as:"center_"+f}],d=[{fieldPrefix:"upper_",titlePrefix:Cs({field:f,aggregate:o,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Cs({field:f,aggregate:r,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Cs({field:f,aggregate:t,type:"quantitative"},u,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Sr(i.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===a?(d=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+f},{calculate:`datum["${f}"]`,as:"lower_"+f}]):"aggregated-error"===a&&(d=[{fieldPrefix:"",titlePrefix:f}],l=[{calculate:`datum["${f}"] + datum["${r.field}"]`,as:"upper_"+f}],o?l.push({calculate:`datum["${f}"] + datum["${o.field}"]`,as:"lower_"+f}):l.push({calculate:`datum["${f}"] - datum["${r.field}"]`,as:"lower_"+f}));for(const e of l)d.push({fieldPrefix:e.as.substring(0,6),titlePrefix:Y(Y(e.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:c,tooltipSummary:d,tooltipTitleWithFieldName:h}}function Wu(e,t,n){return q(e)+" "+n+" "+t}const Hu="errorband",Gu=["band","borders"],Vu=new We(Hu,Yu);function Yu(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:a,markDef:s,outerSpec:u,tooltipEncoding:c}=Uu(e,Hu,t),l=s,f=_u(l,o,r,a,t.errorband),d=void 0!==e.encoding.x&&void 0!==e.encoding.y;let h={type:d?"area":"rect"},p={type:d?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return d?(h=Object.assign(Object.assign(Object.assign({},h),g),{ariaRoleDescription:"errorband"}),p=Object.assign(Object.assign({},p),g)):l.interpolate?Sr(i.errorBand1DNotSupport("interpolate")):l.tension&&Sr(i.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},u),{transform:n,layer:[...f({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}),...f({partName:"borders",mark:p,positionPrefix:"lower",aria:!1,extraEncoding:c}),...f({partName:"borders",mark:p,positionPrefix:"upper",aria:!1,extraEncoding:c})]})}const Zu={};function Xu(e,t,n){const i=new We(e,t);Zu[e]={normalizer:i,parts:n}}function Ju(){return R(Zu)}Xu(Au,Fu,Du),Xu(Nu,zu,Tu),Xu(Hu,Yu,Gu);const Qu=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Ku=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],ec={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},tc={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},nc={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},ic=(R(nc),"_vgsid_"),rc={single:{on:"click",fields:[ic],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[ic],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function oc(e){return!!e&&("legend"===e||!!e.legend)}function ac(e){return oc(e)&&Object(o["F"])(e)}function sc(e){return cc(e)||lc(e)||uc(e)}function uc(e){return"concat"in e}function cc(e){return"vconcat"in e}function lc(e){return"hconcat"in e}function fc(e){return Object(o["F"])(e)&&void 0!==e["step"]}function dc(e){return e["view"]||e["width"]||e["height"]}const hc=20,pc={align:1,bounds:1,center:1,columns:1,spacing:1},gc=R(pc);function mc(e,t,n){var i,r;const a=n[t],s={},{spacing:u,columns:c}=a;void 0!==u&&(s.spacing=u),void 0!==c&&(Xa(e)&&!Ya(e.facet)||uc(e))&&(s.columns=c),cc(e)&&(s.columns=1);for(const l of gc)if(void 0!==e[l])if("spacing"===l){const t=e[l];s[l]=Object(o["E"])(t)?t:{row:null!==(i=t.row)&&void 0!==i?i:u,column:null!==(r=t.column)&&void 0!==r?r:u}}else s[l]=e[l];return s}function vc(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function bc(e,t){const n=yc(e,t);return fc(n)?n.step:xc}function yc(e,t){var n;const i=null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"];return J(i,{step:e.step})}const xc=20,Oc={continuousWidth:200,continuousHeight:200,step:xc};const _c={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Oc,mark:Re,arc:{},area:{},bar:Le,circle:{},geoshape:{},image:{},line:{},point:{},rect:Be,rule:{color:"black"},square:{},text:{color:"black"},tick:Ie,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:na,projection:{},legend:tc,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:rc,style:{},title:{},facet:{spacing:hc},concat:{spacing:hc}},wc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],jc={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},kc={blue:wc[0],orange:wc[1],red:wc[2],teal:wc[3],green:wc[4],yellow:wc[5],purple:wc[6],pink:wc[7],brown:wc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Ec(e={}){return{signals:[{name:"color",value:Object(o["F"])(e)?Object.assign(Object.assign({},kc),e):kc}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Ac(e){return{signals:[{name:"fontSize",value:Object(o["F"])(e)?Object.assign(Object.assign({},jc),e):jc}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Dc(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Sc(e={}){const{color:t,font:n,fontSize:i}=e,r=a(e,["color","font","fontSize"]);return Object(o["N"])({},_c,n?Dc(n):{},t?Ec(t):{},i?Ac(i):{},r||{})}const Cc=["view",...De],Fc=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Mc=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Te);function $c(e){e=y(e);for(const t of Fc)delete e[t];if(e.axis)for(const t in e.axis)oe(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Qu)delete e.legend[t];if(e.mark){for(const t of Ne)delete e.mark[t];e.mark.tooltip&&Object(o["F"])(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of Cc){for(const i of Ne)delete e[t][i];const n=Mc[t];if(n)for(const i of n)delete e[t][i];Tc(e,t)}for(const t of Ju())delete e[t];Nc(e);for(const t in e)Object(o["F"])(e[t])&&T(e[t])&&delete e[t];return T(e)?void 0:e}function Nc(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=Zs(e.title);T(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),T(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),T(i)?delete e.title:e.title=i}function Tc(e,t,n,i){const r=i?e[t][i]:e[t];"view"===t&&(n="cell");const o=Object.assign(Object.assign({},r),e.style[null!==n&&void 0!==n?n:t]);T(o)||(e.style[null!==n&&void 0!==n?n:t]=o),i||delete e[t]}function Rc(e){return"layer"in e}function zc(e){return"repeat"in e}function Pc(e){return!Object(o["A"])(e.repeat)&&e.repeat["layer"]}class Lc{map(e,t){return Xa(e)?this.mapFacet(e,t):zc(e)?this.mapRepeat(e,t):lc(e)?this.mapHConcat(e,t):cc(e)?this.mapVConcat(e,t):uc(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(Rc(e))return this.mapLayer(e,t);if(qe(e))return this.mapUnit(e,t);throw new Error(i.invalidSpec(e))}mapLayer(e,t){return Object.assign(Object.assign({},e),{layer:e.layer.map(e=>this.mapLayerOrUnit(e,t))})}mapHConcat(e,t){return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map(e=>this.map(e,t))})}mapVConcat(e,t){return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map(e=>this.map(e,t))})}mapConcat(e,t){const{concat:n}=e,i=a(e,["concat"]);return Object.assign(Object.assign({},i),{concat:n.map(e=>this.map(e,t))})}mapFacet(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}mapRepeat(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}const Bc={zero:1,center:1,normalize:1};function Ic(e){return e in Bc}const Uc=new Set([de,pe,he,ye,ve,we,je,me,xe,Oe]),qc=new Set([pe,he,de]);function Wc(e,t){var n,i;const r="x"===t?"y":"radius",o=e[t],a=e[r];if(ss(o)&&ss(a))if("quantitative"===us(o)&&"quantitative"===us(a)){if(o.stack)return t;if(a.stack)return r;const e=ss(o)&&!!o.aggregate,s=ss(a)&&!!a.aggregate;if(e!==s)return e?t:r;{const e=null===(n=o.scale)||void 0===n?void 0:n.type,s=null===(i=a.scale)||void 0===i?void 0:i.type;if(e&&"linear"!==e)return r;if(s&&"linear"!==s)return t}}else{if("quantitative"===us(o))return t;if("quantitative"===us(a))return r}else{if("quantitative"===us(o))return t;if("quantitative"===us(a))return r}}function Hc(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Gc(e,t,n={}){const r=Se(e)?e.type:e;if(!Uc.has(r))return null;const a=Wc(t,"x")||Wc(t,"theta");if(!a)return null;const s=t[a],u=ss(s)?xs(s,{}):void 0;let c=Hc(a),l=t[c],f=ss(l)?xs(l,{}):void 0;f===u&&(f=void 0,l=void 0,c=void 0);const d=En.reduce((e,n)=>{if("tooltip"!==n&&lu(t,n)){const i=t[n];for(const t of Object(o["i"])(i)){const i=Ts(t);if(i.aggregate)continue;const r=xs(i,{});r&&r===f||e.push({channel:n,fieldDef:i})}}return e},[]);let h;if(void 0!==s.stack?h=Object(o["B"])(s.stack)?s.stack?"zero":null:s.stack:d.length>0&&qc.has(r)&&(h="zero"),!h||!Ic(h))return null;if(fu(t)&&0===d.length)return null;if(s.scale&&s.scale.type&&s.scale.type!==To.LINEAR){if(n.disallowNonLinearStack)return null;Sr(i.cannotStackNonLinearScale(s.scale.type))}return ds(t[ln(a)])?(void 0!==s.stack&&Sr(i.cannotStackRangedMark(a)),null):(ss(s)&&s.aggregate&&!k(Ke,s.aggregate)&&Sr(i.stackNonSummativeAggregate(s.aggregate)),{groupbyChannel:l?c:void 0,groupbyField:f,fieldChannel:a,impute:null!==s.impute&&Ee(r),stackBy:d,offset:h})}function Vc(e){const{point:t,line:n}=e,i=a(e,["point","line"]);return R(i).length>1?i:i.type}function Yc(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:O(e[t],["point","line"])}));return e}function Zc(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?Object(o["F"])(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?Object(o["F"])(t.point)?t.point:{}:void 0}function Xc(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class Jc{constructor(){this.name="path-overlay"}hasMatchingType(e,t){if(qe(e)){const{mark:n,encoding:i}=e,r=Se(n)?n:{type:n};switch(r.type){case"line":case"rule":case"trail":return!!Zc(r,t[r.type],i);case"area":return!!Zc(r,t[r.type],i)||!!Xc(r,t[r.type])}}return!1}run(e,t,n){const{config:i}=t,{selection:r,projection:o,encoding:s,mark:u}=e,c=a(e,["selection","projection","encoding","mark"]),l=Se(u)?u:{type:u},f=Zc(l,i[l.type],s),d="area"===l.type&&Xc(l,i[l.type]),h=[Object.assign(Object.assign({},r?{selection:r}:{}),{mark:Vc(Object.assign(Object.assign({},"area"===l.type&&void 0===l.opacity&&void 0===l.fillOpacity?{opacity:.7}:{}),l)),encoding:O(s,["shape"])})],p=Gc(l,s);let g=s;if(p){const{fieldChannel:e,offset:t}=p;g=Object.assign(Object.assign({},s),{[e]:Object.assign(Object.assign({},s[e]),t?{stack:t}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},x(l,["clip","interpolate","tension","tooltip"])),d),encoding:g})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},x(l,["clip","tooltip"])),f),encoding:g})),n(Object.assign(Object.assign({},c),{layer:h}),Object.assign(Object.assign({},t),{config:Yc(i)}))}}class Qc{constructor(){this.name="RangeStep"}hasMatchingType(e){var t;if(qe(e)&&e.encoding)for(const n of Dn){const i=e.encoding[n];if(i&&ds(i)&&(null===(t=null===i||void 0===i?void 0:i.scale)||void 0===t?void 0:t["rangeStep"]))return!0}return!1}run(e){var t;const n={};let r=Object.assign({},e.encoding);for(const o of Dn){const e=fn(o),s=r[o];if(s&&ds(s)&&(null===(t=null===s||void 0===s?void 0:s.scale)||void 0===t?void 0:t["rangeStep"])){const{scale:t}=s,u=a(s,["scale"]),c=t,{rangeStep:l}=c,f=a(c,["rangeStep"]);n[e]={step:t["rangeStep"]},Sr(i.RANGE_STEP_DEPRECATED),r=Object.assign(Object.assign({},r),{[o]:Object.assign(Object.assign({},u),T(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},n),e),{encoding:r})}}function Kc(e,t){return t?Ya(e)?ol(e,t):nl(e,t):e}function el(e,t){return t?ol(e,t):e}function tl(e,t,n){const r=t[e];return Qa(r)?r.repeat in n?Object.assign(Object.assign({},t),{[e]:n[r.repeat]}):void Sr(i.noSuchRepeatedValue(r.repeat)):t}function nl(e,t){if(e=tl("field",e,t),void 0!==e){if(null===e)return null;if(es(e)&&Ga(e.sort)){const n=tl("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function il(e,t){if(ss(e))return nl(e,t);{const n=tl("datum",e,t);return n===e||n.type||(n.type="nominal"),n}}function rl(e,t){if(!ds(e)){if(os(e)){const n=il(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});{const{condition:t}=e,n=a(e,["condition"]);return n}}return e}{const n=il(e,t);if(n)return n;if(is(e))return{condition:e.condition}}}function ol(e,t){const n={};for(const i in e)if(Object(o["v"])(e,i)){const r=e[i];if(Object(o["A"])(r))n[i]=r.map(e=>rl(e,t)).filter(e=>e);else{const e=rl(r,t);void 0!==e&&(n[i]=e)}}return n}class al{constructor(){this.name="RuleForRangedLine"}hasMatchingType(e){if(qe(e)){const{encoding:t,mark:n}=e;if("line"===n)for(const e of an){const n=un(e),i=t[n];if(t[e]&&(ss(i)&&!ni(i.bin)||cs(i)))return!0}}return!1}run(e,t,n){const{encoding:r}=e;return Sr(i.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}class sl extends Lc{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Su,Ru,Vu,new Jc,new al,new Qc]}map(e,t){if(qe(e)){const n=lu(e.encoding,nt),i=lu(e.encoding,it),r=lu(e.encoding,rt);if(n||i||r)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:n,parentProjection:i}=t,r=Object.assign(Object.assign({},e),{encoding:el(e.encoding,t.repeater)});if(n||i)return this.mapUnitWithParentEncodingOrProjection(r,t);const o=this.mapLayerOrUnit.bind(this);for(const a of this.nonFacetUnitNormalizers)if(a.hasMatchingType(r,t.config))return a.run(r,t,o);return r}mapRepeat(e,t){return Pc(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,t){const{repeat:n,spec:i}=e,r=a(e,["repeat","spec"]),{row:o,column:s,layer:u}=n,{repeater:c={},repeaterPrefix:l=""}=t;return o||s?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),t):Object.assign(Object.assign({},r),{layer:u.map(e=>{const n=Object.assign(Object.assign({},c),{layer:e}),r=(i.name||"")+l+"child__layer_"+B(e),o=this.mapLayerOrUnit(i,Object.assign(Object.assign({},t),{repeater:n,repeaterPrefix:r}));return o.name=r,o})})}mapNonLayerRepeat(e,t){var n;const{repeat:r,spec:s,data:u}=e,c=a(e,["repeat","spec","data"]);!Object(o["A"])(r)&&e.columns&&(e=O(e,["columns"]),Sr(i.columnsNotSupportByRowCol("repeat")));const l=[],{repeater:f={},repeaterPrefix:d=""}=t,h=!Object(o["A"])(r)&&r.row||[f?f.row:null],p=!Object(o["A"])(r)&&r.column||[f?f.column:null],g=Object(o["A"])(r)&&r||[f?f.repeat:null];for(const i of g)for(const e of h)for(const n of p){const a={repeat:i,row:e,column:n,layer:f.layer},u=(s.name||"")+d+"child__"+(Object(o["A"])(r)?""+B(i):(r.row?"row_"+B(e):"")+(r.column?"column_"+B(n):"")),c=this.map(s,Object.assign(Object.assign({},t),{repeater:a,repeaterPrefix:u}));c.name=u,l.push(O(c,["data"]))}const m=Object(o["A"])(r)?e.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=s.data)&&void 0!==n?n:u,align:"all"},c),{columns:m,concat:l})}mapFacet(e,t){const{facet:n}=e;return Ya(n)&&e.columns&&(e=O(e,["columns"]),Sr(i.columnsNotSupportByRowCol("facet"))),super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:i}=e,{parentEncoding:r,parentProjection:o,config:a}=t,s=cl({parentProjection:o,projection:i}),u=ul({parentEncoding:r,encoding:el(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),s?{projection:s}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(e,t){const n=e.encoding,{row:i,column:r,facet:o}=n,s=a(n,["row","column","facet"]),{mark:u,width:c,projection:l,height:f,view:d,selection:h,encoding:p}=e,g=a(e,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:r,facet:o},t),b=el(s,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c?{width:c}:{}),f?{height:f}:{}),d?{view:d}:{}),l?{projection:l}:{}),{mark:u,encoding:b}),h?{selection:h}:{})}),t)}getFacetMappingAndLayout(e,t){var n;const{row:r,column:o,facet:s}=e;if(r||o){s&&Sr(i.facetChannelDropped([...r?[nt]:[],...o?[it]:[]]));const t={},u={};for(const i of[nt,it]){const r=e[i];if(r){const{align:e,center:o,spacing:s,columns:c}=r,l=a(r,["align","center","spacing","columns"]);t[i]=l;for(const t of["align","center","spacing"])void 0!==r[t]&&(u[t]=null!==(n=u[t])&&void 0!==n?n:{},u[t][i]=r[t])}}return{facetMapping:t,layout:u}}{const{align:e,center:n,spacing:i,columns:r}=s,o=a(s,["align","center","spacing","columns"]);return{facetMapping:Kc(o,t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},e?{align:e}:{}),n?{center:n}:{}),i?{spacing:i}:{}),r?{columns:r}:{})}}}mapLayer(e,t){var{parentEncoding:n,parentProjection:i}=t,r=a(t,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=e,u=a(e,["encoding","projection"]),c=Object.assign(Object.assign({},r),{parentEncoding:ul({parentEncoding:n,encoding:o}),parentProjection:cl({parentProjection:i,projection:s})});return super.mapLayer(u,c)}}function ul(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const e=R(t).reduce((e,t)=>(n[t]&&e.push(t),e),[]);e.length>0&&Sr(i.encodingOverridden(e))}const r=Object.assign(Object.assign({},null!==t&&void 0!==t?t:{}),null!==n&&void 0!==n?n:{});return T(r)?void 0:r}function cl(e){const{parentProjection:t,projection:n}=e;return t&&n&&Sr(i.projectionOverridden({parentProjection:t,projection:n})),null!==n&&void 0!==n?n:t}function ll(e,t){void 0===t&&(t=Sc(e.config));const n=dl(e,t),{width:i,height:r}=e,o=pl(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const fl=new sl;function dl(e,t={}){return fl.map(e,{config:t})}function hl(e){return Object(o["H"])(e)?{type:e}:null!==e&&void 0!==e?e:{}}function pl(e,t,n){let{width:r,height:o}=t;const a=qe(e)||Rc(e),s={};a?"container"==r&&"container"==o?(s.type="fit",s.contains="padding"):"container"==r?(s.type="fit-x",s.contains="padding"):"container"==o&&(s.type="fit-y",s.contains="padding"):("container"==r&&(Sr(i.containerSizeNonSingle("width")),r=void 0),"container"==o&&(Sr(i.containerSizeNonSingle("height")),o=void 0));const u=Object.assign(Object.assign(Object.assign({type:"pad"},s),n?hl(n.autosize):{}),hl(e.autosize));if("fit"!==u.type||a||(Sr(i.FIT_NON_SINGLE),u.type="pad"),"container"==r&&"fit"!=u.type&&"fit-x"!=u.type&&Sr(i.containerSizeNotCompatibleWithAutosize("width")),"container"==o&&"fit"!=u.type&&"fit-y"!=u.type&&Sr(i.containerSizeNotCompatibleWithAutosize("height")),!b(u,{type:"pad"}))return u}function gl(e){return"fit"===e||"fit-x"===e||"fit-y"===e}function ml(e){return e?"fit-"+Mn(e):"fit"}const vl=["background","padding"];function bl(e){return vl.reduce((t,n)=>(e&&void 0!==e[n]&&(t[n]=e[n]),t),{})}class yl{constructor(e={},t={}){this.explicit=e,this.implicit=t}clone(){return new yl(y(this.explicit),y(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(e){return J(this.explicit[e],this.implicit[e])}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}setWithExplicit(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}copyKeyFromSplit(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}copyAll(e){for(const t of R(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n)}}}function xl(e){return{explicit:!0,value:e}}function Ol(e){return{explicit:!1,value:e}}function _l(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:wl(t,n,i,r)}}function wl(e,t,n,r){return e.explicit&&t.explicit&&Sr(i.mergeConflictingProperty(n,r,e.value,t.value)),e}function jl(e,t,n,i,r=wl){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:b(e.value,t.value)?e:r(e,t,n,i)}class kl extends yl{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e}}function El(e){return"url"in e}function Al(e){return"values"in e}function Dl(e){return"name"in e&&!El(e)&&!Al(e)&&!Sl(e)}function Sl(e){return e&&(Cl(e)||Fl(e)||Ml(e))}function Cl(e){return"sequence"in e}function Fl(e){return"sphere"in e}function Ml(e){return"graticule"in e}const $l="main",Nl="raw";function Tl(e){return"filter"in e}function Rl(e){return void 0!==(null===e||void 0===e?void 0:e["stop"])}function zl(e){return"lookup"in e}function Pl(e){return"data"in e}function Ll(e){return"selection"in e}function Bl(e){return"pivot"in e}function Il(e){return"density"in e}function Ul(e){return"quantile"in e}function ql(e){return"regression"in e}function Wl(e){return"loess"in e}function Hl(e){return"sample"in e}function Gl(e){return"window"in e}function Vl(e){return"joinaggregate"in e}function Yl(e){return"flatten"in e}function Zl(e){return"calculate"in e}function Xl(e){return"bin"in e}function Jl(e){return"impute"in e}function Ql(e){return"timeUnit"in e}function Kl(e){return"aggregate"in e}function ef(e){return"stack"in e}function tf(e){return"fold"in e}function nf(e){return e.map(e=>Tl(e)?{filter:v(e.filter,Eo)}:e)}var rf=n("f127");function of(e,t,n,i){const r=is(t)&&t.condition,a=i(t);if(r){const t=Object(o["i"])(r),s=t.map(t=>{const n=i(t),r=Ja(t)?oh(e,t.selection):uh(e,t.test);return Object.assign({test:r},n)});return{[n]:[...s,...void 0!==a?[a]:[]]}}return void 0!==a?{[n]:a}:{}}function af(e,t="text"){const n=e.encoding[t];return of(e,n,t,t=>sf(t,e.config))}function sf(e,t,n="datum"){if(e){if(ps(e))return Js(e.value);if(ds(e)){const{format:i,formatType:r}=$s(e);return Fa({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function uf(e,t={}){const{encoding:n,markDef:i,config:r,stack:a}=e,s=n.tooltip;if(Object(o["A"])(s))return{tooltip:lf({tooltip:s},a,r,t)};{const u=t.reactiveGeom?"datum.datum":"datum";return of(e,s,"tooltip",e=>{const s=sf(e,r,u);if(s)return s;if(null===e)return;let c=nu("tooltip",i,r);return!0===c&&(c={content:"encoding"}),Object(o["H"])(c)?{value:c}:Object(o["F"])(c)?"encoding"===c.content?lf(n,a,r,t):{signal:u}:void 0})}}function cf(e,t,n,{reactiveGeom:i}={}){const r={},a=i?"datum.datum":"datum",s=[];function u(i,u){const c=un(u),l=hs(i)?i:Object.assign(Object.assign({},i),{type:e[c].type}),f=Object(o["i"])(Cs(l,n,{allowDisabling:!1})).join(", ");let d;if(Sn(u)){const i="x"===u?"x2":"y2",o=Ts(e[i]);if(ni(l.bin)&&o){const e=xs(l,{expr:a}),t=xs(o,{expr:a}),{format:s,formatType:u}=$s(l);d=Ba(e,t,s,u,n),r[i]=!0}else if(t&&t.fieldChannel===u&&"normalize"===t.offset){const{format:e,formatType:t}=$s(l);d=Fa({fieldOrDatumDef:l,format:e,formatType:t,expr:a,config:n,normalizeStack:!0}).signal}}d=null!==d&&void 0!==d?d:sf(l,n,a).signal,s.push({channel:u,key:f,value:d})}mu(e,(e,t)=>{ss(e)?u(e,t):rs(e)&&u(e.condition,t)});const c={};for(const{channel:l,key:f,value:d}of s)r[l]||c[f]||(c[Object(o["Z"])(f)]=d);return c}function lf(e,t,n,{reactiveGeom:i}={}){const r=cf(e,t,n,{reactiveGeom:i}),o=P(r).map(({key:e,value:t})=>`${e}: ${t}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function ff(e){const{markDef:t,config:n}=e,i=nu("aria",t,n);return!1===i?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),df(e)),hf(e))}function df(e){const{mark:t,markDef:n,config:i}=e;if(!1===i.aria)return{};const r=nu("ariaRoleDescription",n,i);return null!=r?{ariaRoleDescription:{value:r}}:t in co?{}:{ariaRoleDescription:{value:t}}}function hf(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return of(e,o,"description",t=>sf(t,e.config));const a=nu("description",n,i);if(null!=a)return{description:Js(a)};if(!1===i.aria)return{};const s=cf(t,r,i);return T(s)?void 0:{description:{signal:P(s).map(({key:e,value:t})=>`${e} + ": " + (${t})`).join(' + "; " + ')}}}function pf(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;void 0===s&&(u=null!==u&&void 0!==u?u:nu(e,i,o,{vgChannel:a,ignoreVgConfig:!0}),void 0!==u&&(s=Js(u)));const c=r[e];return of(t,c,null!==a&&void 0!==a?a:e,n=>Ea({channel:e,channelDef:n,markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function gf(e,t={filled:void 0}){var n,r,o,a;const{markDef:s,encoding:u,config:c}=e,{type:l}=s,f=null!==(n=t.filled)&&void 0!==n?n:nu("filled",s,c),d=k(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,h=null!==(o=null!==(r=nu(!0===f?"color":void 0,s,c,{vgChannel:"fill"}))&&void 0!==r?r:c.mark[!0===f&&"color"])&&void 0!==o?o:d,p=null!==(a=nu(!1===f?"color":void 0,s,c,{vgChannel:"stroke"}))&&void 0!==a?a:c.mark[!1===f&&"color"],g=f?"fill":"stroke",m=Object.assign(Object.assign({},h?{fill:Js(h)}:{}),p?{stroke:Js(p)}:{});return s.color&&(f?s.fill:s.stroke)&&Sr(i.droppingColor("property",{fill:"fill"in s,stroke:"stroke"in s})),Object.assign(Object.assign(Object.assign(Object.assign({},m),pf("color",e,{vgChannel:g,defaultValue:f?h:p})),pf("fill",e,{defaultValue:u.fill?h:void 0})),pf("stroke",e,{defaultValue:u.stroke?p:void 0}))}function mf(e,t){const n=dn(e),i=t[n];if(i)return i}function vf(e,t,{defaultPos:n,vgChannel:i,isMidPoint:r}){const{encoding:o,markDef:a,config:s,stack:u}=t,c=o[e],l=o[ln(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=mf(e,a),p=yf({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),g=!c&&Sn(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:bf({channel:e,channelDef:c,channel2Def:l,markDef:a,config:s,isMidPoint:r,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return g?{[i||e]:g}:void 0}function bf(e){const{channel:t,channelDef:n,isMidPoint:i,scaleName:r,stack:o,offset:a,markDef:s,config:u}=e;if(ds(n)&&o&&t===o.fieldChannel){if(ss(n)){const e=ts({channel:t,fieldDef:n,isMidPoint:i,markDef:s,stack:o,config:u});if(void 0!==e)return ka({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",band:e,offset:a})}return ja(n,r,{suffix:"end"},{offset:a})}return ya(e)}function yf({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:a}=e;return()=>{const s=un(n),u=cn(n),c=nu(n,o,a,{vgChannel:u});if(void 0!==c)return Aa(n,c);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const e=r.get("type");if(k([To.LOG,To.TIME,To.UTC],e));else if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===t)return"y"===s?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const t=e[fn(n)];return Object.assign(Object.assign({},t),{mult:.5})}}}}const xf={left:"x",center:"xc",right:"x2"},Of={top:"y",middle:"yc",bottom:"y2"};function _f(e,t,n,i="middle"){if("radius"===e||"theta"===e)return cn(e);const r="x"===e?"align":"baseline",o=nu(r,t,n);return"x"===e?xf[o||("top"===i?"left":"center")]:Of[o||i]}function wf(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?jf(e,t,{defaultPos:n,defaultPos2:i}):vf(e,t,{defaultPos:n})}function jf(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,a=ln(e),s=fn(e),u=kf(t,i,a),c=u[s]?_f(e,r,o):cn(e);return Object.assign(Object.assign({},vf(e,t,{defaultPos:n,vgChannel:c})),u)}function kf(e,t,n){const{encoding:i,mark:r,markDef:o,stack:a,config:s}=e,u=un(n),c=fn(n),l=cn(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=mf(n in i||n in o?n:u,e.markDef);if(!f&&("x2"===n||"y2"===n)&&(i.latitude||i.longitude))return{[l]:{field:e.getName(n)}};const g=Ef({channel:n,channelDef:f,channel2Def:i[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:p,defaultRef:void 0});return void 0!==g?{[l]:g}:Af(n,o)||Af(n,{[n]:ru(n,o,s.style),[c]:ru(c,o,s.style)})||Af(n,s[r])||Af(n,s.mark)||{[l]:yf({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Ef({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:c}){return ds(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?ja(t,o,{suffix:"start"},{offset:u}):ya({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:i,config:r,offset:u,defaultRef:c})}function Af(e,t){const n=fn(e),i=cn(e);return void 0!==t[i]?{[i]:Aa(e,t[i])}:void 0!==t[e]?{[i]:Aa(e,t[e])}:t[n]?{[n]:Aa(e,t[n])}:void 0}function Df(e,t,n){var i,r,o,a;const{config:s,encoding:u,markDef:c,stack:l}=e,f=ln(t),d=fn(t),h=u[t],p=u[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),b=c.orient,y=null!==(r=null!==(i=u[d])&&void 0!==i?i:u.size)&&void 0!==r?r:nu("size",c,s,{vgChannel:d}),x="bar"===n&&("x"===t?"vertical"===b:"horizontal"===b);if(ss(h)&&(ti(h.bin)||ni(h.bin)||h.timeUnit&&!p)&&!y&&!Qo(m)){const n=ts({channel:t,fieldDef:h,stack:l,markDef:c,config:s}),i=null===(o=e.component.axes[t])||void 0===o?void 0:o[0],r=null!==(a=null===i||void 0===i?void 0:i.get("translate"))&&void 0!==a?a:.5;return Mf({fieldDef:h,fieldDef2:p,channel:t,markDef:c,scaleName:v,band:n,axisTranslate:r,spacing:Sn(t)?nu("binSpacing",c,s):void 0,reverse:g.get("reverse"),config:s})}return(ds(h)&&Qo(m)||x)&&!p?Cf(n,h,t,e):jf(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Sf(e,t,n,i,r,a){if(i){const t=i.get("type");if("point"===t||"band"===t){if(void 0!==r[e].discreteBandSize)return{value:r[e].discreteBandSize};if(t===To.POINT){const e=i.get("range");return io(e)&&Object(o["E"])(e.step)?{value:e.step-2}:{value:xc-2}}return{scale:n,band:a}}return{value:r[e].continuousBandSize}}const s=bc(r.view,t),u=J(r[e].discreteBandSize,s-2);return void 0!==u?{value:u}:void 0}function Cf(e,t,n,r){var a;const{markDef:s,encoding:u,config:c,stack:l}=r,f=s.orient,d=r.scaleName(n),h=r.getScaleComponent(n),p=fn(n),g=ln(n),m="horizontal"===f&&"y"===n||"vertical"===f&&"x"===n,v=nu(m?"size":p,s,c,{vgChannel:p});let b;(u.size||void 0!==v)&&(m?b=pf("size",r,{vgChannel:p,defaultValue:v}):Sr(i.cannotApplySizeToNonOrientedMark(s.type)));const y=null!==(a=ds(t)?ts({channel:n,fieldDef:t,markDef:s,stack:l,config:c}):void 0)&&void 0!==a?a:1;b=b||{[p]:Sf(e,p,d,h,c,y)};const x="band"!==(null===h||void 0===h?void 0:h.get("type"))||!("band"in b[p]),O=_f(n,s,c,x?"middle":"top"),_=mf(n,s),w=ya({channel:n,channelDef:t,markDef:s,config:c,scaleName:d,scale:h,stack:l,offset:_,defaultRef:yf({model:r,defaultPos:"mid",channel:n,scaleName:d,scale:h}),band:x?.5:(1-y)/2});if(p)return Object.assign({[O]:w},b);{const e=cn(g),t=b[p],n=_?Object.assign(Object.assign({},t),{offset:_}):t;return{[O]:w,[e]:Object(o["A"])(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:n})]:Object.assign(Object.assign({},w),{offset:n})}}}function Ff(e,t,n,i,r){if(Pt(e))return 0;const o="x"===e||"y2"===e?-t/2:t/2;if(no(n)){const e=Ks(r);return{signal:`${n.signal} ? ${i-o}${e?"-"+e:""} : ${i+o}${e?"+"+e:""}`}}if(no(r)){const e=i+(n?-o:o);return{signal:`${e||""}${n?" - ":e?" + ":""}${r.signal}`}}return r=r||0,i+(n?-r-o:+r+o)}function Mf({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:o,markDef:a,spacing:s=0,axisTranslate:u,reverse:c,config:l}){const f=ln(n),d=cn(n),h=cn(f),p=mf(n,a);if(ti(e.bin)||e.timeUnit)return{[h]:$f({channel:n,fieldDef:e,scaleName:o,markDef:a,band:(1-r)/2,offset:Ff(f,s,c,u,p),config:l}),[d]:$f({channel:n,fieldDef:e,scaleName:o,markDef:a,band:1-(1-r)/2,offset:Ff(n,s,c,u,p),config:l})};if(ni(e.bin)){const i=ja(e,o,{},{offset:Ff(f,s,c,u,p)});if(ss(t))return{[h]:i,[d]:ja(t,o,{},{offset:Ff(n,s,c,u,p)})};if(ii(e.bin)&&e.bin.step)return{[h]:i,[d]:{signal:`scale("${o}", ${xs(e,{expr:"datum"})} + ${e.bin.step})`,offset:Ff(n,s,c,u,p)}}}Sr(i.channelRequiredForBinned(f))}function $f({channel:e,fieldDef:t,scaleName:n,markDef:i,band:r,offset:o,config:a}){const s=ka({scaleName:n,fieldOrDatumDef:t,band:r,offset:o});return xa({fieldDef:t,channel:e,markDef:i,ref:s,config:a})}const Nf=new Set(["aria"]);function Tf(e,t){const{fill:n,stroke:i}="include"===t.color?gf(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},zf(e.markDef,t)),Rf(e,"fill",n)),Rf(e,"stroke",i)),pf("opacity",e)),pf("fillOpacity",e)),pf("strokeOpacity",e)),pf("strokeWidth",e)),pf("strokeDash",e)),uf(e)),af(e,"href")),ff(e))}function Rf(e,t,n){const{config:i,mark:r,markDef:a}=e,s=nu("invalid",a,i);if("hide"===s&&n&&!Ee(r)){const i=Pf(e,{invalid:!0,channels:Gn});if(i)return{[t]:[{test:i,value:null},...Object(o["i"])(n)]}}return n?{[t]:n}:{}}function zf(e,t){return uo.reduce((n,i)=>(Nf.has(i)||void 0===e[i]||"ignore"===t[i]||(n[i]=Js(e[i])),n),{})}function Pf(e,{invalid:t=!1,channels:n}){const i=n.reduce((t,n)=>{const i=e.getScaleComponent(n);if(i){const r=i.get("type"),o=e.vgField(n,{expr:"datum"});o&&Ko(r)&&(t[o]=!0)}return t},{}),r=R(i);if(r.length>0){const e=t?"||":"&&";return r.map(e=>_a(e,t)).join(` ${e} `)}}function Lf(e){const{config:t,markDef:n}=e,i=nu("invalid",n,t);if(i){const t=Bf(e,{channels:Dn});if(t)return{defined:{signal:t}}}return{}}function Bf(e,{invalid:t=!1,channels:n}){const i=n.reduce((t,n)=>{const i=e.getScaleComponent(n);if(i){const r=i.get("type"),o=e.vgField(n,{expr:"datum"});o&&Ko(r)&&(t[o]=!0)}return t},{}),r=R(i);if(r.length>0){const e=t?"||":"&&";return r.map(e=>_a(e,t)).join(` ${e} `)}}function If(e,t){if(void 0!==t)return{[e]:Js(t)}}const Uf="voronoi",qf={has:e=>"interval"!==e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Uf)},marks:(e,t,n)=>{const{x:r,y:o}=t.project.hasChannel,a=e.mark;if(Ee(a))return Sr(i.nearestNotSupportForContinuous(a)),n;const s={name:e.getName(Uf),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},uf(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!o?"datum.datum.x || 0":"0"},y:{expr:o||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let u=0,c=!1;return n.forEach((t,n)=>{var i;const r=null!==(i=t.name)&&void 0!==i?i:"";r===e.component.mark[0].name?u=n:r.indexOf(Uf)>=0&&(c=!0)}),c||n.splice(u+1,0,s),n}};var Wf=qf;class Hf{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e,e&&e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++)}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}swapWithParent(){const e=this._parent,t=e.parent;for(const n of this._children)n.parent=e;this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}}class Gf extends Hf{constructor(e,t,n,i){super(e,t),this.type=n,this.refCounts=i,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output "+K()),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}class Vf extends Hf{constructor(e,t){super(e),this.formula=t}clone(){return new Vf(null,y(this.formula))}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{const{field:r,timeUnit:o}=n,a=Xm(t)?t.encoding[ln(i)]:void 0,s=Xm(t)&&ns(i,n,a,t.stack,t.markDef,t.config);if(o){const t=xs(n,{forAs:!0});e[w({as:t,field:r,timeUnit:o})]=Object.assign({as:t,field:r,timeUnit:o},s?{band:!0}:{})}return e},{});return T(n)?null:new Vf(e,n)}static makeFromTransform(e,t){const n=Object.assign({},t),{timeUnit:i}=n,r=a(n,["timeUnit"]),o=eo(i),s=Object.assign(Object.assign({},r),{timeUnit:o});return new Vf(e,{[w(s)]:s})}merge(e){this.formula=Object.assign({},this.formula);for(const t in e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove()}producedFields(){return new Set(z(this.formula).map(e=>e.as))}dependentFields(){return new Set(z(this.formula).map(e=>e.field))}hash(){return"TimeUnit "+w(this.formula)}assemble(){const e=[];for(const t of z(this.formula)){const{field:n,as:i,timeUnit:r}=t,o=eo(r),{unit:s,utc:u}=o,c=a(o,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:V(n),type:"timeunit"},s?{units:Zr(s)}:{}),u?{timezone:"utc"}:{}),c),{as:[i,i+"_end"]}))}return e}}const Yf="_tuple_fields";class Zf{constructor(...e){this.items=e,this.hasChannel={},this.hasField={}}}const Xf={has:()=>!0,parse:(e,t,n)=>{var r,a,s;const u=t.name,c=null!==(r=t.project)&&void 0!==r?r:t.project=new Zf,l={},f={},d=new Set,h=(e,t)=>{const n="visual"===t?e.channel:e.field;let i=B(`${u}_${n}`);for(let r=1;d.has(i);r++)i=B(`${u}_${n}_${r}`);return d.add(i),{[t]:i}};if(!n.fields&&!n.encodings){const t=e.config.selection[n.type];if(n.init)for(const e of Object(o["i"])(n.init))for(const i of R(e))rn(i)?(n.encodings||(n.encodings=[])).push(i):"interval"===n.type?(Sr('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=t.encodings):(n.fields||(n.fields=[])).push(i);else n.encodings=t.encodings,n.fields=t.fields}for(const i of null!==(a=n.fields)&&void 0!==a?a:[]){const e={type:"E",field:i};e.signals=Object.assign({},h(e,"data")),c.items.push(e),c.hasField[i]=e}for(const o of null!==(s=n.encodings)&&void 0!==s?s:[]){const n=e.fieldDef(o);if(n){let r=n.field;if(n.aggregate){Sr(i.cannotProjectAggregate(o,n.aggregate));continue}if(!r){Sr(i.cannotProjectOnChannelWithoutField(o));continue}if(n.timeUnit){r=e.vgField(o);const t={timeUnit:n.timeUnit,as:r,field:n.field};f[w(t)]=t}if(!l[r]){let i="E";if("interval"===t.type){const t=e.getScaleComponent(o).get("type");Ko(t)&&(i="R")}else n.bin&&(i="R-RE");const a={field:r,channel:o,type:i};a.signals=Object.assign(Object.assign({},h(a,"data")),h(a,"visual")),c.items.push(l[r]=a),c.hasField[r]=c.hasChannel[o]=l[r]}}else Sr(i.cannotProjectOnChannelWithoutField(o))}if(n.init){const e=e=>c.items.map(t=>void 0!==e[t.channel]?e[t.channel]:e[t.field]);if("interval"===n.type)t.init=e(n.init);else{const i=Object(o["i"])(n.init);t.init=i.map(e)}}T(f)||(c.timeUnit=new Vf(null,f))},signals:(e,t,n)=>{const i=t.name+Yf,r=n.filter(e=>e.name===i);return r.length>0?n:n.concat({name:i,value:t.project.items.map(e=>{const{signals:t,hasLegend:n}=e,i=a(e,["signals","hasLegend"]);return i.field=V(i.field),i})})}};var Jf=Xf;const Qf={has:e=>"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!oc(e.bind),parse:(e,t,n,i)=>{i.on||delete t.events,i.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,a=t.bind,s=t.init&&t.init[0],u=Wf.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((e,r)=>{var c,l;const f=B(`${i}_${e.field}`),d=n.filter(e=>e.name===f);d.length||n.unshift(Object.assign(Object.assign({name:f},s?{init:jd(s[r])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${u}[${Object(o["Z"])(e.field)}] : null`}]:[],bind:null!==(l=null!==(c=a[e.field])&&void 0!==c?c:a[e.channel])&&void 0!==l?l:a}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.filter(e=>e.name===i+Hd)[0],a=i+Yf,s=r.items.map(e=>B(`${i}_${e.field}`)),u=s.map(e=>e+" !== null").join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}};var Kf=Qf;const ed="_toggle",td={has:e=>"multi"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+ed,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Hd,i=t.name+ed;return`${i} ? null : ${n}, `+("global"===t.resolve?i+" ? null : true, ":`${i} ? null : {unit: ${Jd(e)}}, `)+`${i} ? ${n} : null`}};var nd=td;const id={has:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t,n)=>{n.clear&&(t.clear=Object(o["H"])(n.clear)?Object(rf["a"])(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(Kf.has(t))for(const i of t.project.items){const e=n.findIndex(e=>e.name===B(`${t.name}_${i.field}`));-1!==e&&n[e].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(e,i){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:i})}if("interval"===t.type)for(const r of t.project.items){const e=n.findIndex(e=>e.name===r.signals.visual);if(i(e,"[0, 0]"),-1===e){const e=n.findIndex(e=>e.name===r.signals.data);i(e,"null")}}else{let e=n.findIndex(e=>e.name===t.name+Hd);i(e,"null"),nd.has(t)&&(e=n.findIndex(e=>e.name===t.name+ed),i(e,"false"))}return n}};var rd=id;const od={has:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const o=r.channel;if(!Vn(o))continue;const a=e.getScaleComponent(o),s=a?a.get("type"):void 0;if(!a||!Ko(s)){Sr(i.SCALE_BINDINGS_CONTINUOUS);continue}const u={selection:t.name,field:r.field};a.set("selectionExtent",u,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(e=>0===n.filter(t=>t.name===e.signals.data).length);if(!e.parent||ud(e)||0===i.length)return n;const r=n.filter(e=>e.name===t.name)[0];let a=r.update;if(a.indexOf(Vd)>=0)r.update=`{${i.map(e=>`${Object(o["Z"])(e.field)}: ${e.signals.data}`).join(", ")}}`;else{for(const e of i){const t=`${Object(o["Z"])(e.field)}: ${e.signals.data}`;a.indexOf(t)<0&&(a=`${a.substring(0,a.length-1)}, ${t}}`)}r.update=a}return n.concat(i.map(e=>({name:e.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!ud(e))for(const i of t.scales){const e=n.filter(e=>e.name===i.signals.data)[0];e.push="outer",delete e.value,delete e.update}return n}};var ad=od;function sd(e,t){const n=Object(o["Z"])(e.scaleName(t));return`domain(${n})`}function ud(e){var t;return e.parent&&Km(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:ud(e.parent.parent))}const cd={has:e=>{const t="global"===e.resolve&&e.bind&&oc(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==ic;return t&&!n&&Sr(i.LEGEND_BINDINGS_PROJECT_LENGTH),t&&n},parse:(e,t,n,i)=>{var r;if(i.on||delete t.events,i.clear||delete t.clear,i.on||i.clear){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=Object(o["i"])(null!==(r=n.filter)&&void 0!==r?r:[]),n.filter.indexOf(e)<0&&n.filter.push(e)}const a=ac(t.bind)?t.bind.legend:"click",s=Object(o["H"])(a)?Object(rf["a"])(a,"view"):Object(o["i"])(a);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=ac(t.bind)&&t.bind.legend,o=e=>t=>{const n=y(t);return n.markname=e,n};for(const a of t.project.items){if(!a.hasLegend)continue;const e=B(a.field)+"_legend",s=`${i}_${e}`,u=n.filter(e=>e.name===s);if(0===u.length){const i=r.merge.map(o(e+"_symbols")).concat(r.merge.map(o(e+"_labels"))).concat(r.merge.map(o(e+"_entries")));n.unshift(Object.assign(Object.assign({name:s},t.init?{}:{value:null}),{on:[{events:i,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:"!event.item || !datum ? null : "+s,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(e=>e.name===i+Hd),a=i+Yf,s=r.items.filter(e=>e.hasLegend).map(e=>B(`${i}_${B(e.field)}_legend`)),u=s.map(e=>e+" !== null").join(" && "),c=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(e=>({signal:e})),update:c}):s.length>0&&(o.update=c,delete o.value,delete o.on);const l=n.find(e=>e.name===i+ed),f=ac(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:f})):l.on[0].events=f),n}};var ld=cd;function fd(e,t,n){var i;const r=null===(i=e.fieldDef(t))||void 0===i?void 0:i.field;Zd(e,e=>{var i,o;const a=null!==(i=e.project.hasField[r])&&void 0!==i?i:e.project.hasChannel[t];if(a&&cd.has(e)){const t=null!==(o=n.get("selections"))&&void 0!==o?o:[];t.push(e.name),n.set("selections",t,!1),a.hasLegend=!0}})}const dd="_translate_anchor",hd="_translate_delta",pd={has:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name,r=ad.has(t),o=i+dd,{x:a,y:s}=t.project.hasChannel;let u=Object(rf["a"])(t.translate,"scope");return r||(u=u.map(e=>(e.between[0].markname=i+$d,e))),n.push({name:o,value:{},on:[{events:u.map(e=>e.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==a?", extent_x: "+(r?sd(e,ot):`slice(${a.signals.visual})`):"")+(void 0!==s?", extent_y: "+(r?sd(e,at):`slice(${s.signals.visual})`):"")+"}"}]},{name:i+hd,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&md(e,t,a,"width",n),void 0!==s&&md(e,t,s,"height",n),n}};var gd=pd;function md(e,t,n,i,r){var o;const a=t.name,s=a+dd,u=a+hd,c=n.channel,l=ad.has(t),f=r.filter(e=>e.name===n.signals[l?"data":"visual"])[0],d=e.getSizeSignalRef(i).signal,h=e.getScaleComponent(c),p=h.get("type"),g=l&&c===ot?"-":"",m=`${s}.extent_${c}`,v=`${g}${u}.${c} / `+(l?""+d:`span(${m})`),b=l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear",y=`${b}(${m}, ${v}`+(l&&"pow"===p?", "+(null!==(o=h.get("exponent"))&&void 0!==o?o:1):"")+")";f.on.push({events:{signal:u},update:l?y:`clampRange(${y}, 0, ${d})`})}const vd="_zoom_anchor",bd="_zoom_delta",yd={has:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=ad.has(t),a=i+bd,{x:s,y:u}=t.project.hasChannel,c=Object(o["Z"])(e.scaleName(ot)),l=Object(o["Z"])(e.scaleName(at));let f=Object(rf["a"])(t.zoom,"scope");return r||(f=f.map(e=>(e.markname=i+$d,e))),n.push({name:i+vd,on:[{events:f,update:r?"{"+[c?`x: invert(${c}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(e=>!!e).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==s&&Od(e,t,s,"width",n),void 0!==u&&Od(e,t,u,"height",n),n}};var xd=yd;function Od(e,t,n,i,r){var o;const a=t.name,s=n.channel,u=ad.has(t),c=r.filter(e=>e.name===n.signals[u?"data":"visual"])[0],l=e.getSizeSignalRef(i).signal,f=e.getScaleComponent(s),d=f.get("type"),h=u?sd(e,s):c.name,p=a+bd,g=`${a}${vd}.${s}`,m=u?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear",v=`${m}(${h}, ${g}, ${p}`+(u&&"pow"===d?", "+(null!==(o=f.get("exponent"))&&void 0!==o?o:1):"")+")";c.on.push({events:{signal:p},update:u?v:`clampRange(${v}, 0, ${l})`})}const _d=[Jf,nd,ad,ld,gd,xd,Kf,Wf,rd];function wd(e,t){for(const n of _d)n.has(e)&&t(n)}function jd(e,t=!0,n=o["x"]){if(Object(o["A"])(e)){const i=e.map(e=>jd(e,t,n));return t?`[${i.join(", ")}]`:i}return Fr(e)?n(t?Br(e):Ur(e)):t?n(JSON.stringify(e)):e}function kd(e,t){return Zd(e,(n,i)=>{const r=n.name;let a=i.modifyExpr(e,n);t.push(...i.signals(e,n)),wd(n,i=>{i.signals&&(t=i.signals(e,n,t)),i.modifyExpr&&(a=i.modifyExpr(e,n,a))}),t.push({name:r+Gd,on:[{events:{signal:n.name+Hd},update:`modify(${Object(o["Z"])(n.name+Wd)}, ${a})`}]})}),Md(t)}function Ed(e,t){if(e.component.selection&&R(e.component.selection).length){const n=Object(o["Z"])(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Object(rf["a"])("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Md(t)}function Ad(e,t){let n=!1;if(Zd(e,(i,r)=>{const a=i.name,s=Object(o["Z"])(a+Wd),u=t.filter(e=>e.name===a);if(0===u.length){const e="global"===i.resolve?"union":i.resolve,n="multi"===i.type?", true)":")";t.push({name:i.name,update:`${Vd}(${s}, ${Object(o["Z"])(e)}${n}`})}n=!0,r.topLevelSignals&&(t=r.topLevelSignals(e,i,t)),wd(i,n=>{n.topLevelSignals&&(t=n.topLevelSignals(e,i,t))})}),n){const e=t.filter(e=>"unit"===e.name);0===e.length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return Md(t)}function Dd(e,t){const n=[...t];return Zd(e,t=>{const i={name:t.name+Wd};if(t.init){const n=t.project.items.map(e=>{const{signals:t}=e,n=a(e,["signals"]);return n}),r=t.init.map(e=>jd(e,!1));i.values="interval"===t.type?[{unit:Jd(e,{escape:!1}),fields:n,values:r}]:r.map(t=>({unit:Jd(e,{escape:!1}),fields:n,values:t}))}const r=n.filter(e=>e.name===t.name+Wd);r.length||n.push(i)}),n}function Sd(e,t){return Zd(e,(n,i)=>{t=i.marks?i.marks(e,n,t):t,wd(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function Cd(e,t){for(const n of e.children)Xm(n)&&(t=Sd(n,t));return t}function Fd(e,t){const n=t.selection,i=e.getSelectionComponent(n,B(n));return{signal:ah(i,t)}}function Md(e){return e.map(e=>(e.on&&!e.on.length&&delete e.on,e))}const $d="_brush",Nd="_scale_trigger",Td={signals:(e,t)=>{const n=t.name,i=n+Yf,r=ad.has(t),a=[],s=[],u=[];if(t.translate&&!r){const e="!event.item || event.item.mark.name !== "+Object(o["Z"])(n+$d);Pd(t,(t,n)=>{var i;const r=Object(o["i"])(null!==(i=n.between[0].filter)&&void 0!==i?i:n.between[0].filter=[]);return r.indexOf(e)<0&&r.push(e),t})}t.project.items.forEach((n,i)=>{const r=n.channel;if(r!==ot&&r!==at)return void Sr("Interval selections only support x and y encoding channels.");const c=t.init?t.init[i]:null,l=zd(e,t,n,c),f=n.signals.data,d=n.signals.visual,h=Object(o["Z"])(e.scaleName(r)),p=e.getScaleComponent(r).get("type"),g=Ko(p)?"+":"";a.push(...l),s.push(f),u.push({scaleName:e.scaleName(r),expr:`(!isArray(${f}) || (${g}invert(${h}, ${d})[0] === ${g}${f}[0] && ${g}invert(${h}, ${d})[1] === ${g}${f}[1]))`})}),r||a.push({name:n+Nd,value:{},on:[{events:u.map(e=>({scale:e.scaleName})),update:u.map(e=>e.expr).join(" && ")+` ? ${n+Nd} : {}`}]});const c=t.init,l=`unit: ${Jd(e)}, fields: ${i}, values`;return a.concat(Object.assign(Object.assign({name:n+Hd},c?{init:`{${l}: ${jd(c)}}`}:{}),{on:[{events:[{signal:s.join(" || ")}],update:s.join(" && ")+` ? {${l}: [${s}]} : null`}]}))},modifyExpr:(e,t)=>{const n=t.name+Hd;return n+", "+("global"===t.resolve?"true":`{unit: ${Jd(e)}}`)},marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,u=r&&r.signals.visual,c=s&&s.signals.visual,l=`data(${Object(o["Z"])(t.name+Wd)})`;if(ad.has(t))return n;const f={x:void 0!==r?{signal:u+"[0]"}:{value:0},y:void 0!==s?{signal:c+"[0]"}:{value:0},x2:void 0!==r?{signal:u+"[1]"}:{field:{group:"width"}},y2:void 0!==s?{signal:c+"[1]"}:{field:{group:"height"}}};if("global"===t.resolve)for(const o of R(f))f[o]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${Jd(e)}`},f[o]),{value:0}];const d=t.mark,{fill:h,fillOpacity:p,cursor:g}=d,m=a(d,["fill","fillOpacity","cursor"]),v=R(m).reduce((e,t)=>(e[t]=[{test:[void 0!==r&&`${u}[0] !== ${u}[1]`,void 0!==s&&`${c}[0] !== ${c}[1]`].filter(e=>e).join(" && "),value:m[t]},{value:null}],e),{});return[{name:i+$d+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:h},fillOpacity:{value:p}},update:f}},...n,{name:i+$d,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},g?{cursor:{value:g}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},f),v)}}]}};var Rd=Td;function zd(e,t,n,i){const r=n.channel,a=n.signals.visual,s=n.signals.data,u=ad.has(t),c=Object(o["Z"])(e.scaleName(r)),l=e.getScaleComponent(r),f=l?l.get("type"):void 0,d=e=>`scale(${c}, ${e})`,h=e.getSizeSignalRef(r===ot?"width":"height").signal,p=r+"(unit)",g=Pd(t,(e,t)=>[...e,{events:t.between[0],update:`[${p}, ${p}]`},{events:t,update:`[${a}[0], clamp(${p}, 0, ${h})]`}]);return g.push({events:{signal:t.name+Nd},update:Ko(f)?`[${d(s+"[0]")}, ${d(s+"[1]")}]`:"[0, 0]"}),u?[{name:s,on:[]}]:[Object.assign(Object.assign({name:a},i?{init:jd(i,!0,d)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:s},i?{init:jd(i)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${c}, ${a})`}]})]}function Pd(e,t){return e.events.reduce((e,n)=>n.between?t(e,n):(Sr(n+" is not an ordered event stream for interval selections."),e),[])}function Ld(e,t){const n=t.name,i=n+Yf,r=t.project,a="(item().isVoronoi ? datum.datum : datum)",s=r.items.map(t=>{const n=e.fieldDef(t.channel);return n&&n.bin?`[${a}[${Object(o["Z"])(e.vgField(t.channel,{}))}], ${a}[${Object(o["Z"])(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${a}[${Object(o["Z"])(t.field)}]`}).join(", "),u=`unit: ${Jd(e)}, fields: ${i}, values`,c=t.events;return[{name:n+Hd,on:c?[{events:c,update:`datum && item().mark.marktype !== 'group' ? {${u}: [${s}]} : null`,force:!0}]:[]}]}const Bd={signals:Ld,modifyExpr:(e,t)=>{const n=t.name+Hd;return n+", "+("global"===t.resolve?"null":`{unit: ${Jd(e)}}`)}};var Id=Bd;const Ud={signals:Ld,modifyExpr:(e,t)=>{const n=t.name+Hd;return n+", "+("global"===t.resolve?"true":`{unit: ${Jd(e)}}`)}};var qd=Ud;const Wd="_store",Hd="_tuple",Gd="_modify",Vd="vlSelectionResolve",Yd={single:qd,multi:Id,interval:Rd};function Zd(e,t){const n=e.component.selection;if(n)for(const i of z(n)){const e=t(i,Yd[i.type]);if(!0===e)break}}function Xd(e){let t=e.parent;while(t){if(Jm(t))break;t=t.parent}return t}function Jd(e,{escape:t}={escape:!0}){let n=t?Object(o["Z"])(e.name):e.name;const i=Xd(e);if(i){const{facet:e}=i;for(const t of Gt)e[t]&&(n+=` + '__facet_${t}_' + (facet[${Object(o["Z"])(i.vgField(t))}])`)}return n}function Qd(e){let t=!1;return Zd(e,e=>{t=t||e.project.items.some(e=>e.field===ic)}),t}var Kd=n("8e31");function eh(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...eh(e.object)),t.push(...eh(e.property))),t)}function th(e){return"MemberExpression"===e.object.type?th(e.object):"datum"===e.object.name}function nh(e){const t=Object(Kd["f"])(e),n=new Set;return t.visit(e=>{"MemberExpression"===e.type&&th(e)&&n.add(eh(e).slice(1).join("."))}),n}class ih extends Hf{constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=uh(this.model,this.filter,this),this._dependentFields=nh(this.expr)}clone(){return new ih(null,this.model,y(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter "+this.expr}}function rh(e,t){var n;const i={},r=e.config.selection;for(const s of R(null!==t&&void 0!==t?t:{})){const u=y(t[s]),c=r[u.type],{fields:l,encodings:f}=c,d=a(c,["fields","encodings"]);for(const e in d)"encodings"===e&&u.fields||"fields"===e&&u.encodings||("mark"===e&&(u[e]=Object.assign(Object.assign({},d[e]),u[e])),void 0!==u[e]&&!0!==u[e]||(u[e]=null!==(n=d[e])&&void 0!==n?n:u[e]));const h=B(s),p=i[h]=Object.assign(Object.assign({},u),{name:h,events:Object(o["H"])(u.on)?Object(rf["a"])(u.on,"scope"):y(u.on)});wd(p,n=>{n.has(p)&&n.parse&&n.parse(e,p,u,t[s])})}return i}function oh(e,t,n,i="datum"){const r=[];function a(t){const a=B(t),s=e.getSelectionComponent(a,t),u=Object(o["Z"])(a+Wd);if(s.project.timeUnit){const t=null!==n&&void 0!==n?n:e.component.data.raw,i=s.project.timeUnit.clone();t.parent?i.insertAsParentOf(t):t.parent=i}return"none"!==s.empty&&r.push(u),`vlSelectionTest(${u}, ${i}`+("global"===s.resolve?")":`, ${Object(o["Z"])(s.resolve)})`)}const s=I(t,a);return(r.length?"!("+r.map(e=>`length(data(${e}))`).join(" || ")+") || ":"")+`(${s})`}function ah(e,t){const n=t["encoding"];let i=t["field"];if(n||i){if(n&&!i){const r=e.project.items.filter(e=>e.channel===n);!r.length||r.length>1?(i=e.project.items[0].field,Sr((r.length?"Multiple ":"No ")+`matching ${Object(o["Z"])(n)} encoding found for selection ${Object(o["Z"])(t.selection)}. `+`Using "field": ${Object(o["Z"])(i)}.`)):i=r[0].field}}else i=e.project.items[0].field,e.project.items.length>1&&Sr(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Object(o["Z"])(i)}.`);return`${e.name}[${Object(o["Z"])(i)}]`}function sh(e,t){Zd(e,n=>{const i=n.name,r=e.getName("lookup_"+i);e.component.data.outputNodes[r]=n.materialized=new Gf(new ih(t,e,{selection:i}),r,"lookup",e.component.data.outputNodeRefCounts)})}function uh(e,t,n){return I(t,t=>Object(o["H"])(t)?t:fo(t)?oh(e,t.selection,n):jo(t))}function ch(e,t){if(e)return Object(o["A"])(e)&&!Xs(e)?e.map(e=>Ms(e,t)).join(", "):e}function lh(e,t,n,i){var r,o,a;e.encode=null!==(r=e.encode)&&void 0!==r?r:{},e.encode[t]=null!==(o=e.encode[t])&&void 0!==o?o:{},e.encode[t].update=null!==(a=e.encode[t].update)&&void 0!==a?a:{},e.encode[t].update[n]=i}function fh(e,t,n,i={header:!1}){var r,s;const u=e.combine(),{disable:c,orient:l,scale:f,labelExpr:d,title:h,zindex:p}=u,g=a(u,["disable","orient","scale","labelExpr","title","zindex"]);if(!c){for(const e in g){const n=se[e],i=g[e];if(n&&n!==t&&"both"!==n)delete g[e];else if(oe(i)){const{condition:t}=i,n=a(i,["condition"]),r=Object(o["i"])(t),s=re[e];if(s){const{vgProp:t,part:i}=s,o=[...r.map(e=>{const{test:t}=e,n=a(e,["test"]);return Object.assign({test:uh(null,t)},n)}),n];lh(g,i,t,o),delete g[e]}else if(null===s){const t={signal:r.map(e=>{const{test:t}=e,n=a(e,["test"]);return`${uh(null,t)} ? ${Qs(n)} : `}).join("")+Qs(n)};g[e]=t}}else if(no(i)){const t=re[e];if(t){const{vgProp:n,part:r}=t;lh(g,r,n,i),delete g[e]}}}if("grid"===t){if(!g.grid)return;if(g.encode){const{grid:e}=g.encode;g.encode=Object.assign({},e?{grid:e}:{}),T(g.encode)&&delete g.encode}return Object.assign(Object.assign({scale:f,orient:l},g),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:J(p,0)})}{if(!i.header&&e.mainExtracted)return;if(void 0!==d){let e=d;(null===(s=null===(r=g.encode)||void 0===r?void 0:r.labels)||void 0===s?void 0:s.update)&&no(g.encode.labels.update.text)&&(e=Y(d,"datum.label",g.encode.labels.update.text.signal)),lh(g,"labels","text",{signal:e})}if(null===g.labelAlign&&delete g.labelAlign,g.encode){for(const t of ae)e.hasAxisPart(t)||delete g.encode[t];T(g.encode)&&delete g.encode}const t=ch(h,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:f,orient:l,grid:!1},t?{title:t}:{}),g),!1===n.aria?{aria:!1}:{}),{zindex:J(p,0)})}}}function dh(e){const{axes:t}=e.component,n=[];for(const i of Dn)if(t[i])for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const t="x"===i?"height":"width",r=e.getSizeSignalRef(t).signal;t!==r&&n.push({name:t,update:r})}return n}function hh(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(e=>fh(e,"grid",t)),...i.map(e=>fh(e,"grid",t)),...n.map(e=>fh(e,"main",t)),...i.map(e=>fh(e,"main",t))].filter(e=>e)}const ph={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},gh={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},mh=R(ph),vh=R(gh);function bh(e,t,n,i){return Object.assign.apply(null,[{},...e.map(e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",r=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},a=new Set([...R(r),...R(o)]),s={};for(const t of a.values())s[t]={signal:`${i["signal"]} === "${e}" ? ${Ks(r[t])} : ${Ks(o[t])}`};return s}return t[e]})])}function yh(e,t,n,i){const r="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:Ho(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],o="x"===e?"axisX":"axisY",a=no(n)?"axisOrient":"axis"+q(n),s=[...r,...r.map(e=>o+e.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:bh(s,i,e,n),vgAxisConfig:bh(u,i,e,n),axisConfigStyle:xh([...u,...s],i)}}function xh(e,t){var n;const i=[{}];for(const r of e){let e=null===(n=t[r])||void 0===n?void 0:n.style;if(e){e=Object(o["i"])(e);for(const n of e)i.push(t.style[n])}}return Object.assign.apply(null,i)}function Oh(e,t,n,i={}){var r;const o=ou(e,n,t.style);if(void 0!==o)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(r=i[a])||void 0===r?void 0:r[e]))return{configFrom:a,configValue:i[a][e]};return{}}const _h={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return Na(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Ta(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(!ss(e)||!ni(e.bin))&&(null!==(i=t.grid)&&void 0!==i?i:wh(n,e))},gridScale:({model:e,channel:t})=>jh(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||Dh(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||Ah(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return null!==(i=e.labelFlush)&&void 0!==i?i:Sh(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:Ch(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var o;const a="x"===e?"width":"y"===e?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return null!==(o=n.tickCount)&&void 0!==o?o:Mh({fieldOrDatumDef:i,scaleType:r,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const i=$h(t,n);if(void 0!==i)return i;const r=t.typedFieldDef(n),o="x"===n?"x2":"y2",a=t.fieldDef(o);return su(r?[Ka(r)]:[],ss(a)?[Ka(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Nh(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return null!==(i=e.zindex)&&void 0!==i?i:Th(n,t)}};function wh(e,t){return!Qo(e)&&ss(t)&&!ti(null===t||void 0===t?void 0:t.bin)}function jh(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function kh(e,t,n,i,r){const o=null===t||void 0===t?void 0:t.labelAngle;if(void 0!==o)return no(o)?o:ne(o);{const{configValue:o}=Oh("labelAngle",e.config,null===t||void 0===t?void 0:t.style,r);return void 0!==o?ne(o):n===ot&&k([Fo,So],i.type)?270:void 0}}function Eh(e){return`(((${e.signal} % 360) + 360) % 360)`}function Ah(e,t,n,i){if(void 0!==e){if("x"===n){if(no(e)){const n=Eh(e),i=no(t)?`(${t.signal} === "top")`:"top"===t;return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${i} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(no(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)===("top"===t)?"bottom":"top"}if(no(e)){const n=Eh(e),r=no(t)?`(${t.signal} === "left")`:"left"===t,o=i?'"middle"':"null";return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${o} : (45 <= ${n} && ${n} <= 135) === ${r} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(no(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)===("left"===t)?"top":"bottom"}}function Dh(e,t,n){if(void 0===e)return;const i="x"===n,r=i?0:90,o=i?"bottom":"left";if(no(e)){const n=Eh(e),a=no(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${r?"("+n+" + 90)":n} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${n} && ${n} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(no(t)){const n=r<e&&e<180+r?"===":"!==",i=`${t.signal} ${n} "${o}"`;return{signal:i+' ? "left" : "right"'}}return(r<e&&e<180+r)===(t===o)?"left":"right"}function Sh(e,t){if("x"===t&&k(["quantitative","temporal"],e))return!0}function Ch(e,t){if("nominal"!==e)return"log"!==t||"greedy"}function Fh(e){return"x"===e?"bottom":"left"}function Mh({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!Qo(t)&&"log"!==t){if(ss(e)){if(ti(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&k(["month","hours","day","quarter"],null===(r=eo(e.timeUnit))||void 0===r?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function $h(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,a=r?r.title:void 0;return o&&a?uu(o,a):o||(a||(void 0!==o?o:void 0!==a?a:void 0))}function Nh(e,t){const n=e.values;return Object(o["A"])(n)?Vs(t,n):no(n)?n:void 0}function Th(e,t){return"rect"===e&&Os(t)?1:0}class Rh extends Hf{constructor(e,t){super(e),this.transform=t,this._dependentFields=nh(this.transform.calculate)}clone(){return new Rh(null,y(this.transform))}static parseAllForSortIndex(e,t){return t.forEachFieldDef((t,n)=>{if(gs(t)&&Va(t.sort)){const{field:i,timeUnit:r}=t,o=t.sort,a=o.map((e,t)=>`${jo({field:i,timeUnit:r,equal:e})} ? ${t} : `).join("")+o.length;e=new Rh(e,{calculate:a,as:zh(t,n,{forAs:!0})})}}),e}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate "+w(this.transform)}}function zh(e,t,n){return xs(e,Object.assign({prefix:t,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function Ph(e,t){return k(["top","bottom"],t)?"column":k(["left","right"],t)||"row"===e?"row":"column"}function Lh(e,t,n,i){const r="row"===i?n.headerRow:"column"===i?n.headerColumn:n.headerFacet;return J(((null===t||void 0===t?void 0:t.header)||{})[e],r[e],n.header[e])}function Bh(e,t,n,i){const r={};for(const o of e){const e=Lh(o,t,n,i);void 0!==e&&(r[o]=e)}return r}const Ih=["row","column"],Uh=["header","footer"];function qh(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=Bh(["titleAnchor","titleAngle","titleOrient"],r,i,t),u=Ph(t,s),c=ne(a);return{name:t+"-title",type:"group",role:u+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),Hh(c,u)),Wh(u,c,o)),Kh(i,r,t,mh,ph))}}function Wh(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=Dh(t,"row"===e?"left":"top","row"===e?"y":"x");return i?{align:i}:{}}function Hh(e,t){const n=Ah(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function Gh(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of Uh)if(n[r])for(const o of n[r]){const a=Zh(e,t,r,n,o);null!=a&&i.push(a)}return i}function Vh(e,t){var n;const{sort:i}=e;return Ga(i)?{field:xs(i,{expr:"datum"}),order:null!==(n=i.order)&&void 0!==n?n:"ascending"}:Object(o["A"])(i)?{field:zh(e,t,{expr:"datum"}),order:"ascending"}:{field:xs(e,{expr:"datum"}),order:null!==i&&void 0!==i?i:"ascending"}}function Yh(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=Bh(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),c=Fa({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,l=Ph(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Y(Y(u,"datum.label",c),"datum.value",xs(e,{expr:"parent"})):c}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Hh(o,l)),Wh(l,o,a)),Kh(n,e,t,vh,gh))}function Zh(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:a}=i,s=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:e}=Bh(["labelOrient"],a,s,t);("row"===t&&!k(["top","bottom"],e)||"column"===t&&!k(["left","right"],e))&&(o=Yh(a,t,s))}const u=Jm(e)&&!Ya(e.facet),c=r.axes,l=(null===c||void 0===c?void 0:c.length)>0;if(o||l){const s="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:Vh(a,t)}:{}),l&&u?{from:{data:e.getName("facet_domain_"+t)}}:{}),o?{title:o}:{}),r.sizeSignal?{encode:{update:{[s]:r.sizeSignal}}}:{}),l?{axes:c}:{})}}return null}const Xh={column:{start:0,end:1},row:{start:1,end:0}};function Jh(e,t){return Xh[t][e]}function Qh(e,t){const n={};for(const i of Gt){const r=e[i];if(null===r||void 0===r?void 0:r.facetFieldDef){const{titleAnchor:e,titleOrient:o}=Bh(["titleAnchor","titleOrient"],r.facetFieldDef,t,i),a=Ph(i,o),s=Jh(e,a);void 0!==s&&(n[a]=s)}}return T(n)?void 0:n}function Kh(e,t,n,i,r){const o={};for(const a of i){if(!r[a])continue;const i=Lh(a,t,e,n);void 0!==i&&(o[r[a]]=i)}return o}function ep(e){return[...tp(e,"width"),...tp(e,"height"),...tp(e,"childWidth"),...tp(e,"childHeight")]}function tp(e,t){const n="width"===t?"x":"y",i=e.component.layoutSize.get(t);if(!i||"merged"===i)return[];const r=e.getSizeSignalRef(t).signal;if("step"===i){const t=e.getScaleComponent(n);if(t){const i=t.get("type"),o=t.get("range");if(Qo(i)&&io(o)){const i=e.scaleName(n);if(Jm(e.parent)){const t=e.parent.component.resolve;if("independent"===t.scale[n])return[np(i,o)]}return[np(i,o),{name:r,update:ip(i,t,`domain('${i}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==i){const t=r.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",i=vc(e.config.view,t?"width":"height"),o=`isFinite(${n}) ? ${n} : ${i}`;return[{name:r,init:o,on:[{update:o,events:"window:resize"}]}]}return[{name:r,value:i}]}function np(e,t){return{name:e+"_step",value:t.step}}function ip(e,t,n){const i=t.get("type"),r=t.get("padding"),o=J(t.get("paddingOuter"),r);let a=t.get("paddingInner");return a="band"===i?void 0!==a?a:r:1,`bandspace(${n}, ${a}, ${o}) * ${e}_step`}function rp(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function op(e,t){return R(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),of(t,r,i,e=>no(e)?e:{value:e.value}))},{})}function ap(e,t){if(Km(t)||Jm(t))return"shared";if(Qm(t))return Sn(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function sp(e,t){const n=e.scale[t],r=Sn(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&Sr(i.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}const up=Object.assign(Object.assign({},nc),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),cp=R(up);class lp extends yl{}const fp={symbols:dp,gradient:hp,labels:pp,entries:gp};function dp(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:a}){var s,u,c,l,f;if("symbol"!==a)return;const{markDef:d,encoding:h,config:p,mark:g}=n,m=d.filled&&"trail"!==g;let v=Object.assign(Object.assign({},eu({},n,Me)),gf(n,{filled:m}));const b=null!==(s=mp(h.opacity))&&void 0!==s?s:d.opacity;if(v.fill)if("fill"===i||m&&i===vt)delete v.fill;else if(v.fill["field"])r.get("symbolFillColor")?delete v.fill:(v.fill=Js(null!==(u=p.legend.symbolBaseFillColor)&&void 0!==u?u:"black"),v.fillOpacity=Js(null!==b&&void 0!==b?b:1));else if(Object(o["A"])(v.fill)){const e=null!==(f=null!==(l=vp(null!==(c=h.fill)&&void 0!==c?c:h.color))&&void 0!==l?l:d.fill)&&void 0!==f?f:m&&d.color;e&&(v.fill=Js(e))}if(v.stroke)if("stroke"===i||!m&&i===vt)delete v.stroke;else if(v.stroke["field"])delete v.stroke;else if(Object(o["A"])(v.stroke)){const e=J(vp(h.stroke||h.color),d.stroke,m?d.color:void 0);e&&(v.stroke={value:e})}if(i!==wt){const e=ss(t)&&yp(n,r,t);e?v.opacity=[Object.assign({test:e},Js(null!==b&&void 0!==b?b:1)),Js(p.legend.unselectedOpacity)]:b&&(v.opacity=Js(b))}return v=Object.assign(Object.assign({},v),e),T(v)?void 0:v}function hp(e,{model:t,legendType:n}){if("gradient"!==n)return;let i={};const r=mp(t.encoding.opacity)||t.markDef.opacity;return r&&(i.opacity=Js(r)),i=Object.assign(Object.assign({},i),e),T(i)?void 0:i}function pp(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},a=n.config,s=ss(t)?yp(n,r,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:c,formatType:l}=o,f=Da(l)?$a({fieldOrDatumDef:t,field:"datum.value",format:c,formatType:l,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return T(d)?void 0:d}function gp(e,{legendCmpt:t}){const n=t.get("selections");return(null===n||void 0===n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function mp(e){return bp(e,(e,t)=>Math.max(e,t.value))}function vp(e){return bp(e,(e,t)=>J(e,t.value))}function bp(e,t){return as(e)?Object(o["i"])(e.condition).reduce(t,e.value):ps(e)?e.value:void 0}function yp(e,t,n){const i=t.get("selections");if(!(null===i||void 0===i?void 0:i.length))return;const r=Object(o["Z"])(n.field);return i.map(e=>{const t=Object(o["Z"])(B(e)+Wd);return`(!length(data(${t})) || (${e}[${r}] && indexof(${e}[${r}], datum.value) >= 0))`}).join(" || ")}const xp={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return Na(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Ta(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return null!==(n=null!==(t=i.gradientLength)&&void 0!==t?t:r.gradientLength)&&void 0!==n?n:Ap(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return null!==(r=null!==(i=e.labelOverlap)&&void 0!==i?i:t.labelOverlap)&&void 0!==r?r:Sp(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return null!==(r=e.symbolType)&&void 0!==r?r:_p(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Cs(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Wt(n)&&ea(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>Op(t,e)};function Op(e,t){const n=e.values;return Object(o["A"])(n)?Vs(t,n):no(n)?n:void 0}function _p(e,t,n,i){var r;if("shape"!==t){const e=null!==(r=vp(n))&&void 0!==r?r:i;if(e)return e}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function wp(e){const{legend:t}=e;return J(t.type,jp(e))}function jp({channel:e,timeUnit:t,scaleType:n}){if(Wt(e)){if(k(["quarter","month","day"],t))return"symbol";if(ea(n))return"gradient"}return"symbol"}function kp({legendConfig:e,legendType:t,orient:n,legend:i}){var r,o;return null!==(o=null!==(r=i.direction)&&void 0!==r?r:e[t?"gradientDirection":"symbolDirection"])&&void 0!==o?o:Ep(n,t)}function Ep(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}function Ap({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(ea(r))return"horizontal"===n?"top"===i||"bottom"===i?Dp(t,"width",a,o):a:Dp(t,"height",u,s)}function Dp(e,t,n,i){const r=e.getSizeSignalRef(t).signal;return{signal:`clamp(${r}, ${n}, ${i})`}}function Sp(e){if(k(["quantile","threshold","log"],e))return"greedy"}function Cp(e){const t=Xm(e)?Fp(e):Tp(e);return e.component.legends=t,t}function Fp(e){const{encoding:t}=e,n={};for(const i of[vt,...Ku]){const r=Rs(t[i]);r&&e.getScaleComponent(i)&&(i===xt&&ss(r)&&r.type===Mo||(n[i]=Np(e,i)))}return n}function Mp(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function $p(e,t,n,i){switch(t){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===t&&e===(null===i||void 0===i?void 0:i.title))return!0}return e===(n||{})[t]}function Np(e,t){var n,i,r;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,c=u.legend,l=new lp({},Mp(e,t));fd(e,t,l);const f=void 0!==o?!o:c.disable;if(l.set("disable",f,void 0!==o),f)return l;o=o||{};const d=e.getScaleComponent(t).get("type"),h=Rs(s[t]),p=ss(h)?null===(n=eo(h.timeUnit))||void 0===n?void 0:n.unit:void 0,g=o.orient||u.legend.orient||"right",m=wp({legend:o,channel:t,timeUnit:p,scaleType:d}),v=kp({legend:o,legendType:m,orient:g,legendConfig:c}),b={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:c,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const w of cp){const n=w in xp?xp[w](b):o[w];if(void 0!==n){const i=$p(n,w,o,e.fieldDef(t));(i||void 0===u.legend[w])&&l.set(w,n,i)}}const y=null!==(i=null===o||void 0===o?void 0:o.encoding)&&void 0!==i?i:{},x=l.get("selections"),O={},_={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:l,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const t=op(null!==(r=y[w])&&void 0!==r?r:{},e),n=w in fp?fp[w](t,_):t;void 0===n||T(n)||(O[w]=Object.assign(Object.assign(Object.assign({},(null===x||void 0===x?void 0:x.length)&&ss(h)?{name:`${B(h.field)}_legend_${w}`}:{}),(null===x||void 0===x?void 0:x.length)?{interactive:!!x}:{}),{update:n}))}return T(O)||l.set("encode",O,!!(null===o||void 0===o?void 0:o.encoding)),l}function Tp(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){Cp(i);for(const r of R(i.component.legends))n.legend[r]=sp(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=Rp(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of R(t))for(const t of e.children)t.component.legends[i]&&"shared"===n.legend[i]&&delete t.component.legends[i];return t}function Rp(e,t){var n,i,r,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const c of cp){const n=jl(e.getWithExplicit(c),t.getWithExplicit(c),c,"legend",(e,t)=>{switch(c){case"symbolType":return zp(e,t);case"title":return cu(e,t);case"type":return u=!0,Ol("symbol")}return wl(e,t,c,"legend")});e.setWithExplicit(c,n)}return u&&((null===(i=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===i?void 0:i.gradient)&&U(e.implicit,["encode","gradient"]),(null===(o=null===(r=e.explicit)||void 0===r?void 0:r.encode)||void 0===o?void 0:o.gradient)&&U(e.explicit,["encode","gradient"])),e}function zp(e,t){return"circle"===t.value?t:e}function Pp(e,t,n,i){var r,o,a;e.encode=null!==(r=e.encode)&&void 0!==r?r:{},e.encode[t]=null!==(o=e.encode[t])&&void 0!==o?o:{},e.encode[t].update=null!==(a=e.encode[t].update)&&void 0!==a?a:{},e.encode[t].update[n]=i}function Lp(e){const t=e.component.legends,n={};for(const r of R(t)){const i=e.getScaleComponent(r),o=_(i.get("domains"));if(n[o])for(const e of n[o]){const i=Rp(e,t[r]);i||n[o].push(t[r])}else n[o]=[t[r].clone()]}const i=z(n).flat().map(t=>Bp(t,e.config)).filter(e=>void 0!==e);return i}function Bp(e,t){var n,i,r;const o=e.combine(),{disable:s,labelExpr:u,selections:c}=o,l=a(o,["disable","labelExpr","selections"]);if(!s){if(!1===t.aria&&void 0==l.aria&&(l.aria=!1),null===(n=l.encode)||void 0===n?void 0:n.symbols){const e=l.encode.symbols.update;!e.fill||"transparent"===e.fill["value"]||e.stroke||l.stroke||(e.stroke={value:"transparent"});for(const t of Ku)l[t]&&delete e[t]}if(l.title||delete l.title,void 0!==u){let e=u;(null===(r=null===(i=l.encode)||void 0===i?void 0:i.labels)||void 0===r?void 0:r.update)&&no(l.encode.labels.update.text)&&(e=Y(u,"datum.label",l.encode.labels.update.text.signal)),Pp(l,"labels","text",{signal:e})}for(const e in l){const t=l[e];if(no(t)){const n=ec[e];if(n){const{vgProp:i,part:r}=n;Pp(l,r,i,t),delete l[e]}}}return l}}function Ip(e){return Km(e)||Qm(e)?Up(e):qp(e)}function Up(e){return e.children.reduce((e,t)=>e.concat(t.assembleProjections()),qp(e))}function qp(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(e=>e.signal).join(", ")}]`},o=t.data.reduce((t,n)=>{const i=no(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return k(t,i)||t.push(i),t},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Wp=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Hp extends yl{constructor(e,t,n,i){super(Object.assign({},t),{name:e}),this.specifiedProjection=t,this.size=n,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function Gp(e){e.component.projection=Xm(e)?Vp(e):Xp(e)}function Vp(e){var t;if(e.hasProjection){const n=e.specifiedProjection,i=!(n&&(null!=n.scale||null!=n.translate)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=i?Yp(e):void 0;return new Hp(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!==n&&void 0!==n?n:{}),r,o)}}function Yp(e){const t=[],{encoding:n}=e;for(const i of[[pt,ht],[mt,gt]])(Rs(n[i[0]])||Rs(n[i[1]]))&&t.push({signal:e.getName("geojson_"+t.length)});return e.channelHasField(xt)&&e.typedFieldDef(xt).type===Mo&&t.push({signal:e.getName("geojson_"+t.length)}),0===t.length&&t.push(e.requestDataName($l)),t}function Zp(e,t){const n=A(Wp,n=>!Object(o["v"])(e.explicit,n)&&!Object(o["v"])(t.explicit,n)||!(!Object(o["v"])(e.explicit,n)||!Object(o["v"])(t.explicit,n)||_(e.get(n))!==_(t.get(n)))),i=_(e.size)===_(t.size);if(i){if(n)return e;if(_(e.explicit)===_({}))return t;if(_(t.explicit)===_({}))return e}return null}function Xp(e){if(0===e.children.length)return;let t;for(const i of e.children)Gp(i);const n=A(e.children,e=>{const n=e.component.projection;if(n){if(t){const e=Zp(t,n);return e&&(t=e),!!e}return t=n,!0}return!0});if(t&&n){const n=e.projectionName(!0),i=new Hp(n,t.specifiedProjection,t.size,y(t.data));for(const t of e.children){const e=t.component.projection;e&&(e.isFit&&i.data.push(...t.component.projection.data),t.renameProjection(e.get("name"),n),e.merged=!0)}return i}}function Jp(e,t,n,i){var r,o;if(Ys(t,n)){const a=Xm(e)&&null!==(o=null!==(r=e.axis(n))&&void 0!==r?r:e.legend(n))&&void 0!==o?o:{},s=xs(t,{expr:"datum"}),u=xs(t,{expr:"datum",binSuffix:"end"});return{formulaAs:xs(t,{binSuffix:"range",forAs:!0}),formula:Ba(s,u,a.format,a.formatType,i)}}return{}}function Qp(e,t){return`${ei(e)}_${t}`}function Kp(e,t){return{signal:e.getName(t+"_bins"),extentSignal:e.getName(t+"_extent")}}function eg(e,t,n){var i;const r=null!==(i=Is(n,void 0))&&void 0!==i?i:{},o=Qp(r,t);return e.getName(o+"_bins")}function tg(e){return"as"in e}function ng(e,t,n){let i,r;i=tg(e)?Object(o["H"])(e.as)?[e.as,e.as+"_end"]:[e.as[0],e.as[1]]:[xs(e,{forAs:!0}),xs(e,{binSuffix:"end",forAs:!0})];const a=Object.assign({},Is(t,void 0)),s=Qp(a,e.field),{signal:u,extentSignal:c}=Kp(n,s);if(ri(a.extent)){const e=a.extent,t=e.selection;r=ah(n.getSelectionComponent(B(t),t),e),delete a.extent}const l=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[i]},u?{signal:u}:{}),c?{extentSignal:c}:{}),r?{span:r}:{});return{key:s,binComponent:l}}class ig extends Hf{constructor(e,t){super(e),this.bins=t}clone(){return new ig(null,y(this.bins))}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{if(hs(n)&&ti(n.bin)){const{key:r,binComponent:o}=ng(n,n.bin,t);e[r]=Object.assign(Object.assign(Object.assign({},o),e[r]),Jp(t,n,i,t.config))}return e},{});return T(n)?null:new ig(e,n)}static makeFromTransform(e,t,n){const{key:i,binComponent:r}=ng(t,t.bin,n);return new ig(e,{[i]:r})}merge(e,t){for(const n of R(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=C([...this.bins[n].as,...e.bins[n].as],w)):this.bins[n]=e.bins[n];for(const n of e.children)e.removeChild(n),n.parent=this;e.remove()}producedFields(){return new Set(z(this.bins).map(e=>e.as).flat(2))}dependentFields(){return new Set(z(this.bins).map(e=>e.field))}hash(){return"Bin "+w(this.bins)}assemble(){return z(this.bins).flatMap(e=>{const t=[],[n,...i]=e.as,r=e.bin,{extent:o}=r,s=a(r,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:V(e.field),as:n,signal:e.signal},ri(o)?{extent:null}:{extent:o}),e.span?{span:{signal:`span(${e.span})`}}:{}),s);!o&&e.extentSignal&&(t.push({type:"extent",field:V(e.field),signal:e.extentSignal}),u.extent={signal:e.extentSignal}),t.push(u);for(const a of i)for(let e=0;e<2;e++)t.push({type:"formula",expr:xs({field:n[e]},{expr:"datum"}),as:a[e]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t})}}class rg extends Hf{constructor(e){let t;if(super(null),e=null!==e&&void 0!==e?e:{name:"source"},Sl(e)||(t=e.format?Object.assign({},O(e.format,["parse"])):{}),Al(e))this._data={values:e.values};else if(El(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];k(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n}}else Fl(e)?this._data={values:[{type:"Sphere"}]}:(Dl(e)||Sl(e))&&(this._data={});this._generator=Sl(e),e.name&&(this._name=e.name),t&&!T(t)&&(this._data.format=t)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function og(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return console.error("Dataflow graph is inconsistent.",t,e),!1;if(!og(t.children))return!1}return!0}class ag extends Hf{constructor(e,t){super(e),this.params=t}clone(){return new ag(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule "+w(this.params)}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class sg extends Hf{constructor(e,t){super(e),this.params=t}clone(){return new sg(null,this.params)}dependentFields(){return new Set}producedFields(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}hash(){return"Hash "+w(this.params)}assemble(){return Object.assign({type:"sequence"},this.params)}}function ug(e){return e instanceof rg||e instanceof ag||e instanceof sg}class cg{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class lg extends cg{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:e,mutatedFlag:t}){e&&this.setContinue(),t&&this.setMutated()}reset(){}optimizeNextFromLeaves(e){if(ug(e))return!1;const t=e.parent,{continueFlag:n}=this.run(e);return n&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}class fg extends cg{}function dg(e,t,n,i){const r=Xm(i)?i.encoding[ln(t)]:void 0;if(hs(n)&&Xm(i)&&ns(t,n,r,i.stack,i.markDef,i.config))e.add(xs(n,{})),e.add(xs(n,{suffix:"end"})),n.bin&&Ys(n,t)&&e.add(xs(n,{binSuffix:"range"}));else if(It(t)){const n=Bt(t);e.add(i.getName(n))}else e.add(xs(n));return e}function hg(e,t){var n;for(const i of R(t)){const r=t[i];for(const t of R(r))i in e?e[i][t]=new Set([...null!==(n=e[i][t])&&void 0!==n?n:[],...r[t]]):e[i]={[t]:r[t]}}}class pg extends Hf{constructor(e,t,n){super(e),this.dimensions=t,this.measures=n}clone(){return new pg(null,new Set(this.dimensions),y(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef(e=>{e.aggregate&&(n=!0)});const i={},r=new Set;return n?(t.forEachFieldDef((e,n)=>{var o,a,s,u;const{aggregate:c,field:l}=e;if(c)if("count"===c)i["*"]=null!==(o=i["*"])&&void 0!==o?o:{},i["*"]["count"]=new Set([xs(e,{forAs:!0})]);else{if(Ve(c)||Ye(c)){const e=Ve(c)?"argmin":"argmax",t=c[e];i[t]=null!==(a=i[t])&&void 0!==a?a:{},i[t][e]=new Set([xs({op:e,field:t},{forAs:!0})])}else i[l]=null!==(s=i[l])&&void 0!==s?s:{},i[l][c]=new Set([xs(e,{forAs:!0})]);Vn(n)&&"unaggregated"===t.scaleDomain(n)&&(i[l]=null!==(u=i[l])&&void 0!==u?u:{},i[l]["min"]=new Set([xs({field:l,aggregate:"min"},{forAs:!0})]),i[l]["max"]=new Set([xs({field:l,aggregate:"max"},{forAs:!0})]))}else dg(r,n,e,t)}),r.size+R(i).length===0?null:new pg(e,r,i)):null}static makeFromTransform(e,t){var n,i,r;const o=new Set,a={};for(const s of t.aggregate){const{op:e,field:t,as:r}=s;e&&("count"===e?(a["*"]=null!==(n=a["*"])&&void 0!==n?n:{},a["*"]["count"]=new Set([r||xs(s,{forAs:!0})])):(a[t]=null!==(i=a[t])&&void 0!==i?i:{},a[t][e]=new Set([r||xs(s,{forAs:!0})])))}for(const s of null!==(r=t.groupby)&&void 0!==r?r:[])o.add(s);return o.size+R(a).length===0?null:new pg(e,o,a)}merge(e){return F(this.dimensions,e.dimensions)?(hg(this.measures,e.measures),!0):(Cr("different dimensions, cannot merge"),!1)}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...R(this.measures)])}producedFields(){const e=new Set;for(const t of R(this.measures))for(const n of R(this.measures[t])){const i=this.measures[t][n];0===i.size?e.add(`${n}_${t}`):i.forEach(e.add,e)}return e}hash(){return"Aggregate "+w({dimensions:this.dimensions,measures:this.measures})}assemble(){const e=[],t=[],n=[];for(const r of R(this.measures))for(const i of R(this.measures[r]))for(const o of this.measures[r][i])n.push(o),e.push(i),t.push("*"===r?null:V(r));const i={type:"aggregate",groupby:[...this.dimensions].map(V),ops:e,fields:t,as:n};return i}}class gg extends Hf{constructor(e,t,n,i){super(e),this.model=t,this.name=n,this.data=i;for(const r of Gt){const e=t.facet[r];if(e){const{bin:n,sort:i}=e;this[r]=Object.assign({name:t.getName(r+"_domain"),fields:[xs(e),...ti(n)?[xs(e,{binSuffix:"end"})]:[]]},Ga(i)?{sortField:i}:Object(o["A"])(i)?{sortIndexField:zh(e,r)}:{})}}this.childModel=t.child}hash(){let e="Facet";for(const t of Gt)this[t]&&(e+=` ${t.charAt(0)}:${w(this[t])}`);return e}get fields(){var e;const t=[];for(const n of Gt)(null===(e=this[n])||void 0===e?void 0:e.fields)&&t.push(...this[n].fields);return t}dependentFields(){const e=new Set(this.fields);for(const t of Gt)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of Dn){const n=this.childModel.component.scales[t];if(n&&!n.merged){const i=n.get("type"),r=n.get("range");if(Qo(i)&&io(r)){const n=fm(this.childModel,t),i=lm(n);i?e[t]=i:Sr(`Unknown field for ${t}. Cannot calculate view size.`)}}}return e}assembleRowColumnHeaderData(e,t,n){const i={row:"y",column:"x"}[e],r=[],o=[],a=[];n&&n[i]&&(t?(r.push("distinct_"+n[i]),o.push("max")):(r.push(n[i]),o.push("distinct")),a.push("distinct_"+n[i]));const{sortField:s,sortIndexField:u}=this[e];if(s){const{op:e=Ua,field:t}=s;r.push(t),o.push(e),a.push(xs(s,{forAs:!0}))}else u&&(r.push(u),o.push("max"),a.push(u));return{name:this[e].name,source:null!==t&&void 0!==t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},r.length?{fields:r,ops:o,as:a}:{})]}}assembleFacetHeaderData(e){var t,n;const{columns:i}=this.model.layout,{layoutHeaders:r}=this.model.component,o=[],a={};for(const c of Ih){for(const e of Uh){const i=null!==(t=r[c]&&r[c][e])&&void 0!==t?t:[];for(const e of i)if((null===(n=e.axes)||void 0===n?void 0:n.length)>0){a[c]=!0;break}}if(a[c]){const e=`length(data("${this.facet.name}"))`,t="row"===c?i?{signal:`ceil(${e} / ${i})`}:1:i?{signal:`min(${e}, ${i})`}:{signal:e};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:t}]})}}const{row:s,column:u}=a;return(s||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}assemble(){var e,t;const n=[];let i=null;const r=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:s}=this;if(o&&a&&(r.x||r.y)){i=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(null!==(e=r.x)&&void 0!==e?e:[],null!==(t=r.y)&&void 0!==t?t:[]),a=o.map(()=>"distinct");n.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:a}]})}for(const u of[it,nt])this[u]&&n.push(this.assembleRowColumnHeaderData(u,i,r));if(s){const e=this.assembleFacetHeaderData(r);e&&n.push(...e)}return n}}function mg(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function vg(e,t){const n=W(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(0===t.indexOf("date:")){const e=mg(t.slice(5,t.length));return`timeParse(${n},'${e}')`}if(0===t.indexOf("utc:")){const e=mg(t.slice(4,t.length));return`utcParse(${n},'${e}')`}return Sr(i.unrecognizedParse(t)),null}function bg(e){const t={};return m(e.filter,e=>{var n;if(Oo(e)){let i=null;ho(e)?i=e.equal:bo(e)?i=e.range[0]:yo(e)&&(i=(null!==(n=e.oneOf)&&void 0!==n?n:e["in"])[0]),i&&(Fr(i)?t[e.field]="date":Object(o["E"])(i)?t[e.field]="number":Object(o["H"])(i)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}}),t}function yg(e){const t={};function n(e){Ws(e)?t[e.field]="date":"quantitative"===e.type&&Qe(e.aggregate)?t[e.field]="number":X(e.field)>1?e.field in t||(t[e.field]="flatten"):gs(e)&&Ga(e.sort)&&X(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((Xm(e)||Jm(e))&&e.forEachFieldDef((t,i)=>{if(hs(t))n(t);else{const r=un(i),o=e.fieldDef(r);n(Object.assign(Object.assign({},t),{type:o.type}))}}),Xm(e)){const{mark:n,markDef:i,encoding:r}=e;if(Ee(n)&&!e.encoding.order){const e="horizontal"===i.orient?"y":"x",n=r[e];ss(n)&&"quantitative"===n.type&&!(n.field in t)&&(t[n.field]="number")}}return t}function xg(e){const t={};if(Xm(e)&&e.component.selection)for(const n of R(e.component.selection)){const i=e.component.selection[n];for(const e of i.project.items)!e.channel&&X(e.field)>1&&(t[e.field]="flatten")}return t}class Og extends Hf{constructor(e,t){super(e),this._parse=t}clone(){return new Og(null,y(this._parse))}hash(){return"Parse "+w(this._parse)}static makeExplicit(e,t,n){let i={};const r=t.data;return!Sl(r)&&r&&r.format&&r.format.parse&&(i=r.format.parse),this.makeWithAncestors(e,i,{},n)}static makeWithAncestors(e,t,n,r){for(const s of R(n)){const e=r.getWithExplicit(s);void 0!==e.value&&(e.explicit||e.value===n[s]||"derived"===e.value||"flatten"===n[s]?delete n[s]:Sr(i.differentParse(s,n[s],e.value)))}for(const s of R(t)){const e=r.get(s);void 0!==e&&(e===t[s]?delete t[s]:Sr(i.differentParse(s,t[s],e)))}const o=new yl(t,n);r.copyAll(o);const a={};for(const i of R(o.combine())){const e=o.get(i);null!==e&&(a[i]=e)}return 0===R(a).length||r.parseNothing?null:new Og(e,a)}get parse(){return this._parse}merge(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}assembleFormatParse(){const e={};for(const t of R(this._parse)){const n=this._parse[t];1===X(t)&&(e[t]=n)}return e}producedFields(){return new Set(R(this._parse))}dependentFields(){return new Set(R(this._parse))}assembleTransforms(e=!1){return R(this._parse).filter(t=>!e||X(t)>1).map(e=>{const t=vg(e,this._parse[e]);if(!t)return null;const n={type:"formula",expr:t,as:Z(e)};return n}).filter(e=>null!==e)}}class _g extends Hf{clone(){return new _g(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([ic])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:ic}}}class wg extends Hf{constructor(e,t){super(e),this.transform=t}clone(){return new wg(null,y(this.transform))}addDimensions(e){this.transform.groupby=C(this.transform.groupby.concat(e),e=>e)}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map(e=>e.field).filter(e=>void 0!==e).forEach(e.add,e),e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){var t;return null!==(t=e.as)&&void 0!==t?t:xs(e)}hash(){return"JoinAggregateTransform "+w(this.transform)}assemble(){const e=[],t=[],n=[];for(const r of this.transform.joinaggregate)t.push(r.op),n.push(this.getDefaultName(r)),e.push(void 0===r.field?null:r.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==i?{groupby:i}:{})}}function jg(e){return e.stack.stackBy.reduce((e,t)=>{const n=t.fieldDef,i=xs(n);return i&&e.push(i),e},[])}function kg(e){return Object(o["A"])(e)&&e.every(e=>Object(o["H"])(e))&&e.length>1}class Eg extends Hf{constructor(e,t){super(e),this._stack=t}clone(){return new Eg(null,y(this._stack))}static makeFromTransform(e,t){const{stack:n,groupby:i,as:r,offset:a="zero"}=t,s=[],u=[];if(void 0!==t.sort)for(const o of t.sort)s.push(o.field),u.push(J(o.order,"ascending"));const c={field:s,order:u};let l;return l=kg(r)?r:Object(o["H"])(r)?[r,r+"_end"]:[t.stack+"_start",t.stack+"_end"],new Eg(e,{stackField:n,groupby:i,offset:a,sort:c,facetby:[],as:l})}static makeFromEncoding(e,t){const n=t.stack,{encoding:i}=t;if(!n)return null;const{groupbyChannel:r,fieldChannel:a,offset:s,impute:u}=n;let c;if(r){const e=i[r];c=Ts(e)}const l=jg(t),f=t.encoding.order;let d;return d=Object(o["A"])(f)||ss(f)?au(f):l.reduce((e,t)=>(e.field.push(t),e.order.push("y"===a?"descending":"ascending"),e),{field:[],order:[]}),new Eg(e,{dimensionFieldDef:c,stackField:t.vgField(a),facetby:[],stackby:l,sort:d,offset:s,impute:u,as:[t.vgField(a,{suffix:"start",forAs:!0}),t.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}producedFields(){return new Set(this._stack.as)}hash(){return"Stack "+w(this._stack)}getGroupbyFields(){const{dimensionFieldDef:e,impute:t,groupby:n}=this._stack;return e?e.bin?t?[xs(e,{binSuffix:"mid"})]:[xs(e,{}),xs(e,{binSuffix:"end"})]:[xs(e)]:null!==n&&void 0!==n?n:[]}assemble(){const e=[],{facetby:t,dimensionFieldDef:n,stackField:i,stackby:r,sort:o,offset:a,impute:s,as:u}=this._stack;if(s&&n){const{band:o=.5,bin:a}=n;a&&e.push({type:"formula",expr:o+"*"+xs(n,{expr:"datum"})+`+${1-o}*`+xs(n,{expr:"datum",binSuffix:"end"}),as:xs(n,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:i,groupby:[...r,...t],key:xs(n,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:i,sort:o,as:u,offset:a}),e}}class Ag extends Hf{constructor(e,t){super(e),this.transform=t}clone(){return new Ag(null,y(this.transform))}addDimensions(e){this.transform.groupby=C(this.transform.groupby.concat(e),e=>e)}dependentFields(){var e,t;const n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach(e=>n.add(e.field)),this.transform.window.map(e=>e.field).filter(e=>void 0!==e).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){var t;return null!==(t=e.as)&&void 0!==t?t:xs(e)}hash(){return"WindowTransform "+w(this.transform)}assemble(){var e;const t=[],n=[],i=[],r=[];for(const f of this.transform.window)n.push(f.op),i.push(this.getDefaultName(f)),r.push(void 0===f.param?null:f.param),t.push(void 0===f.field?null:f.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&n.every(e=>Ze(e)))return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},void 0!==a?{groupby:a}:{});const s=[],u=[];if(void 0!==this.transform.sort)for(const f of this.transform.sort)s.push(f.field),u.push(null!==(e=f.order)&&void 0!==e?e:"ascending");const c={field:s,order:u},l=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:r,as:i,ops:n,fields:t,sort:c},void 0!==l?{ignorePeers:l}:{}),void 0!==a?{groupby:a}:{}),void 0!==o?{frame:o}:{})}}class Dg extends lg{run(e){const t=e.parent;if(e instanceof Og){if(ug(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof Og)this.setMutated(),t.merge(e);else{if(N(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}class Sg extends fg{mergeNodes(e,t){const n=t.shift();for(const i of t)e.removeChild(i),i.parent=n,i.remove()}run(e){const t=e.children.map(e=>e.hash()),n={};for(let i=0;i<t.length;i++)void 0===n[t[i]]?n[t[i]]=[e.children[i]]:n[t[i]].push(e.children[i]);for(const i of R(n))n[i].length>1&&(this.setMutated(),this.mergeNodes(e,n[i]));for(const i of e.children)this.run(i);return this.mutatedFlag}}class Cg extends lg{run(e){return e instanceof Gf||e.numChildren()>0||e instanceof gg||(this.setMutated(),e.remove()),this.flags}}class Fg extends lg{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(e){if(this.setContinue(),e instanceof Vf){const t=e.producedFields();M(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...t]),this.prev=e}return this.flags}reset(){this.fields.clear()}}class Mg extends lg{run(e){this.setContinue();const t=e.parent,n=t.children.filter(e=>e instanceof Vf),i=n.pop();for(const r of n)this.setMutated(),i.merge(r);return this.flags}}function $g(e){function t(n){if(!(n instanceof gg)){const i=n.clone();if(i instanceof Gf){const t=Ug+i.getSource();i.setSource(t),e.model.component.data.outputNodes[t]=i}else(i instanceof pg||i instanceof Eg||i instanceof Ag||i instanceof wg)&&i.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=i;return[i]}return n.children.flatMap(t)}return t}function Ng(e){if(e instanceof gg)if(1!==e.numChildren()||e.children[0]instanceof Gf){const t=e.model.component.data.main;Tg(t);const n=$g(e),i=e.children.map(n).flat();for(const e of i)e.parent=t}else{const t=e.children[0];(t instanceof pg||t instanceof Eg||t instanceof Ag||t instanceof wg)&&t.addDimensions(e.fields),t.swapWithParent(),Ng(e)}else e.children.map(Ng)}function Tg(e){if(e instanceof Gf&&e.type===$l&&1===e.numChildren()){const t=e.children[0];t instanceof gg||(t.swapWithParent(),Tg(e))}}class Rg extends fg{constructor(){super()}run(e){e instanceof Gf&&!e.isRequired()&&(this.setMutated(),e.remove());for(const t of e.children)this.run(t);return this.mutatedFlag}}class zg extends fg{constructor(e){super(),this.requiresSelectionId=e&&Qd(e)}run(e){e instanceof _g&&(this.requiresSelectionId&&(ug(e.parent)||e.parent instanceof pg||e.parent instanceof Og)||(this.setMutated(),e.remove()));for(const t of e.children)this.run(t);return this.mutatedFlag}}class Pg extends lg{run(e){const t=e.parent,n=[...t.children],i=t.children.filter(e=>e instanceof Og);if(t.numChildren()>1&&i.length>=1){const e={},r=new Set;for(const t of i){const n=t.parse;for(const t of R(n))t in e?e[t]!==n[t]&&r.add(t):e[t]=n[t]}for(const t of r)delete e[t];if(!T(e)){this.setMutated();const i=new Og(t,e);for(const r of n){if(r instanceof Og)for(const t of R(e))delete r.parse[t];t.removeChild(r),r.parent=i,r instanceof Og&&0===R(r.parse).length&&r.remove()}}}return this.setContinue(),this.flags}}class Lg extends lg{run(e){const t=e.parent,n=t.children.filter(e=>e instanceof pg),i={};for(const r of n){const e=w(r.groupBy);e in i||(i[e]=[]),i[e].push(r)}for(const r of R(i)){const e=i[r];if(e.length>1){const n=e.pop();for(const i of e)n.merge(i)&&(t.removeChild(i),i.parent=n,i.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class Bg extends lg{constructor(e){super(),this.model=e}run(e){const t=e.parent,n=!(ug(t)||t instanceof ih||t instanceof Og||t instanceof _g),i=[],r=[];for(const o of t.children)o instanceof ig&&(n&&!N(t.producedFields(),o.dependentFields())?i.push(o):r.push(o));if(i.length>0){const e=i.pop();for(const t of i)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated(),t instanceof ig?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(r.length>1){const e=r.pop();for(const t of r)e.merge(t,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class Ig extends lg{run(e){const t=e.parent,n=[...t.children],i=E(n,e=>e instanceof Gf);if(!i||t.numChildren()<=1)return this.setContinue(),this.flags;const r=[];let o;for(const a of n)if(a instanceof Gf){let e=a;while(1===e.numChildren()){const t=e.children[0];if(!(t instanceof Gf))break;e=t}r.push(...e.children),o?(t.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=e,this.setMutated()):o=e}else r.push(a);if(r.length){this.setMutated();for(const e of r)e.parent.removeChild(e),e.parent=o}return this.setContinue(),this.flags}}const Ug="scale_",qg=5;function Wg(e){const t=[];function n(e){if(0===e.numChildren())t.push(e);else for(const t of e.children)n(t)}for(const i of e)n(i);return t}function Hg(e){return e}function Gg(e,t){const n=t.map(t=>{if(e instanceof lg){const n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)});return n.some(Hg)}function Vg(e,t){let n=e.sources;const i=new Set;return i.add(Gg(new Rg,n)),i.add(Gg(new zg(t),n)),n=n.filter(e=>e.numChildren()>0),i.add(Gg(new Cg,Wg(n))),n=n.filter(e=>e.numChildren()>0),i.add(Gg(new Dg,Wg(n))),i.add(Gg(new Bg(t),Wg(n))),i.add(Gg(new Fg,Wg(n))),i.add(Gg(new Pg,Wg(n))),i.add(Gg(new Lg,Wg(n))),i.add(Gg(new Mg,Wg(n))),i.add(Gg(new Sg,n)),i.add(Gg(new Ig,Wg(n))),e.sources=n,i.has(!0)}function Yg(e,t){og(e.sources);let n=0,i=0;for(let r=0;r<qg;r++){if(!Vg(e,t))break;n++}e.sources.map(Ng);for(let r=0;r<qg;r++){if(!Vg(e,t))break;i++}og(e.sources),Math.max(n,i)===qg&&Sr(`Maximum optimization runs(${qg}) reached.`)}class Zg{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e})}static fromName(e,t){return new Zg(()=>e(t))}}function Xg(e){Xm(e)?Jg(e):Qg(e)}function Jg(e){const t=e.component.scales;for(const n of R(t)){const i=em(e,n),r=t[n];if(r.setWithExplicit("domains",i),om(e,n),e.component.data.isFaceted){let t=e;while(!Jm(t)&&t.parent)t=t.parent;const r=t.component.resolve.scale[n];if("shared"===r)for(const e of i.value)ao(e)&&(e.data=Ug+e.data.replace(Ug,""))}}}function Qg(e){for(const n of e.children)Xg(n);const t=e.component.scales;for(const n of R(t)){let i,r=null;for(const t of e.children){const e=t.component.scales[n];if(e){i=void 0===i?e.getWithExplicit("domains"):jl(i,e.getWithExplicit("domains"),"domains","scale",um);const t=e.get("selectionExtent");r&&t&&r.selection!==t.selection&&Sr("The same selection must be used to override scale domains in a layered view."),r=t}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function Kg(e,t,n,i){if("unaggregated"===e){const{valid:e,reason:i}=sm(t,n);if(!e)return void Sr(i)}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:e}=sm(t,n);if(e)return"unaggregated"}return e}function em(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=Kg(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),"x"===t&&Rs(i.x2)?Rs(i.x)?jl(im(n,r,e,"x"),im(n,r,e,"x2"),"domain","scale",um):im(n,r,e,"x2"):"y"===t&&Rs(i.y2)?Rs(i.y)?jl(im(n,r,e,"y"),im(n,r,e,"y2"),"domain","scale",um):im(n,r,e,"y2"):im(n,r,e,t)}function tm(e,t,n){return e.map(e=>{const i=Gs(e,{timeUnit:n,type:t});return{signal:`{data: ${i}}`}})}function nm(e,t,n){var i;const r=null===(i=eo(n))||void 0===i?void 0:i.unit;return"temporal"===t||r?tm(e,t,r):[e]}function im(e,t,n,i){const{encoding:r}=n,a=Rs(r[i]),{type:s}=a,u=a["timeUnit"];if(oa(t)){const r=im(e,void 0,n,i),o=nm(t.unionWith,s,u);return xl([...r.value,...o])}if(no(t))return xl([t]);if(t&&"unaggregated"!==t&&!ra(t))return xl(nm(t,s,u));const c=n.stack;if(c&&i===c.fieldChannel){if("normalize"===c.offset)return Ol([[0,1]]);const e=n.requestDataName($l);return Ol([{data:e,field:n.vgField(i,{suffix:"start"})},{data:e,field:n.vgField(i,{suffix:"end"})}])}const l=Vn(i)&&ss(a)?am(n,i,e):void 0;if(cs(a)){const e=nm([a.datum],s,u);return Ol(e)}const f=a;if("unaggregated"===t){const e=n.requestDataName($l),{field:t}=a;return Ol([{data:e,field:xs({field:t,aggregate:"min"})},{data:e,field:xs({field:t,aggregate:"max"})}])}if(ti(f.bin)){if(Qo(e))return Ol("bin-ordinal"===e?[]:[{data:L(l)?n.requestDataName($l):n.requestDataName(Nl),field:n.vgField(i,Ys(f,i)?{binSuffix:"range"}:{}),sort:!0!==l&&Object(o["F"])(l)?l:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:e}=f;if(ti(e)){const t=eg(n,f.field,e);return Ol([new Zg(()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`})])}return Ol([{data:n.requestDataName($l),field:n.vgField(i,{})}])}}if(f.timeUnit&&k(["time","utc"],e)&&ns(i,f,Xm(n)?n.encoding[ln(i)]:void 0,n.stack,n.markDef,n.config)){const e=n.requestDataName($l);return Ol([{data:e,field:n.vgField(i)},{data:e,field:n.vgField(i,{suffix:"end"})}])}return Ol(l?[{data:L(l)?n.requestDataName($l):n.requestDataName(Nl),field:n.vgField(i),sort:l}]:[{data:n.requestDataName($l),field:n.vgField(i)}])}function rm(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:t?"sum":Ua},i?{field:V(i)}:{}),r?{order:r}:{})}function om(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,o=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,a=ra(r)&&r,s=ii(o)&&ri(o.extent)&&o.extent;(a||s)&&i.set("selectionExtent",null!==a&&void 0!==a?a:s,!0)}function am(e,t,n){if(!Qo(n))return;const i=e.fieldDef(t),r=i.sort;if(Va(r))return{op:"min",field:zh(i,t),order:"ascending"};const{stack:o}=e,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(e=>e.fieldDef.field)]:void 0;if(Ga(r)){const e=o&&!k(a,r.field);return rm(r,e)}if(Ha(r)){const{encoding:t,order:n}=r,i=e.fieldDef(t),{aggregate:s,field:u}=i,c=o&&!k(a,u);if(Ve(s)||Ye(s))return rm({field:xs(i),order:n},c);if(Ze(s)||!s)return rm({op:s,field:u,order:n},c)}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(k(["ascending",void 0],r))return!0}}function sm(e,t){const{aggregate:n,type:r}=e;return n?Object(o["H"])(n)&&!tt[n]?{valid:!1,reason:i.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:i.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:i.unaggregateDomainHasNoEffectForRawField(e)}}function um(e,t,n,r){return e.explicit&&t.explicit&&Sr(i.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function cm(e){const t=C(e.map(e=>{if(ao(e)){const{sort:t}=e,n=a(e,["sort"]);return n}return e}),w),n=C(e.map(e=>{if(ao(e)){const t=e.sort;return void 0===t||L(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(e=>void 0!==e),w);if(0===t.length)return;if(1===t.length){const t=e[0];if(ao(t)&&n.length>0){let e=n[0];if(n.length>1)Sr(i.MORE_THAN_ONE_SORT),e=!0;else if(Object(o["F"])(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order})}return Object.assign(Object.assign({},t),{sort:e})}return t}const r=C(n.map(e=>L(e)||!("op"in e)||e.op in Ge?e:(Sr(i.domainSortDropped(e)),!0)),w);let s;1===r.length?s=r[0]:r.length>1&&(Sr(i.MORE_THAN_ONE_SORT),s=!0);const u=C(e.map(e=>ao(e)?e.data:null),e=>e);if(1===u.length&&null!==u[0]){const e=Object.assign({data:u[0],fields:t.map(e=>e.field)},s?{sort:s}:{});return e}return Object.assign({fields:t},s?{sort:s}:{})}function lm(e){if(ao(e)&&Object(o["H"])(e.field))return e.field;if(ro(e)){let t;for(const n of e.fields)if(ao(n)&&Object(o["H"])(n.field))if(t){if(t!==n.field)return Sr(i.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}else t=n.field;return Sr(i.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}if(oo(e)){Sr(i.FACETED_INDEPENDENT_SAME_SOURCE);const t=e.fields[0];return Object(o["H"])(t)?t:void 0}}function fm(e,t){const n=e.component.scales[t],i=n.get("domains").map(t=>(ao(t)&&(t.data=e.lookupDataSource(t.data)),t));return cm(i)}function dm(e){return Km(e)||Qm(e)?e.children.reduce((e,t)=>e.concat(dm(t)),hm(e)):hm(e)}function hm(e){return R(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:o,type:s,selectionExtent:u,domains:c,range:l,reverse:f}=r,d=a(r,["name","type","selectionExtent","domains","range","reverse"]),h=pm(r.range,o,n);let p;u&&(p=Fd(e,u));const g=fm(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:s},g?{domain:g}:{}),p?{domainRaw:p}:{}),{range:h}),void 0!==f?{reverse:f}:{}),d)),t},[])}function pm(e,t,n){return Sn(n)&&io(e)?{step:{signal:t+"_step"}}:e}class gm extends yl{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||E(this.get("domains"),e=>Object(o["A"])(e)&&2===e.length&&e[0]<=0&&e[1]>=0)}}const mm=["range","scheme"];function vm(e){return"x"===e?"width":"y"===e?"height":void 0}function bm(e){const t=e.component.scales;for(const n of Gn){const i=t[n];if(!i)continue;const r=xm(n,e);i.setWithExplicit("range",r)}}function ym(e,t){const n=e.fieldDef(t);if(n&&n.bin&&ti(n.bin)){const i=eg(e,n.field,n.bin),r=vm(t),o=e.getName(r);return new Zg(()=>{const t=e.getSignalName(i),n=`(${t}.stop - ${t}.start) / ${t}.step`;return`${e.getSignalName(o)} / (${n})`})}}function xm(e,t){const n=t.specifiedScales[e],{size:r}=t,a=t.getScaleComponent(e),s=a.get("type");for(const u of mm)if(void 0!==n[u]){const r=ha(s,u),a=pa(e,u);if(r)if(a)Sr(a);else switch(u){case"range":return Object(o["A"])(n.range)&&Sn(e)?xl(n.range.map(e=>{if("width"===e||"height"===e){const n=t.getName(e),i=t.getSignalName.bind(t);return Zg.fromName(i,n)}return e})):xl(n.range);case"scheme":return xl(Om(n[u]))}else Sr(i.scalePropertyNotWorkWithScaleType(s,u,e))}if(e===ot||e===at){const t=e===ot?"width":"height",n=r[t];if(fc(n)){if(Qo(s))return xl({step:n.step});Sr(i.stepDropped(t))}}return Ol(_m(e,t))}function Om(e){return ia(e)?Object.assign({scheme:e.name},O(e,["name"])):{scheme:e}}function _m(e,t){const{size:n,config:i,mark:r,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=Rs(o[e]),u=t.getScaleComponent(e),c=u.get("type"),{domain:l,domainMid:f}=t.specifiedScales[e];switch(e){case ot:case at:{if(k(["point","band"],c))if(e!==ot||n.width){if(e===at&&!n.height){const e=yc(i.view,"height");if(fc(e))return e}}else{const e=yc(i.view,"width");if(fc(e))return e}const r=vm(e),o=t.getName(r);return e===at&&Ko(c)?[Zg.fromName(a,o),0]:[0,Zg.fromName(a,o)]}case Ot:{const o=t.component.scales[e].get("zero"),a=km(r,o,i),s=Am(r,n,t,i);return ta(c)?jm(a,s,wm(c,i,l,e)):[a,s]}case ft:return[0,2*Math.PI];case _t:return[0,360];case ct:return[0,new Zg(()=>{const e=t.getSignalName("width"),n=t.getSignalName("height");return`min(${e},${n})/2`})];case Et:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case At:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case xt:return"symbol";case vt:case bt:case yt:return"ordinal"===c?"nominal"===s?"category":"ordinal":void 0!==f?"diverging":"rect"===r||"geoshape"===r?"heatmap":"ramp";case wt:case jt:case kt:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}function wm(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&Object(o["A"])(n)?n.length+1:(Sr(i.domainRequiredForThresholdScale(r)),3)}}function jm(e,t,n){const i=()=>{const i=Ks(t),r=Ks(e),o=`(${i} - ${r}) / (${n} - 1)`;return`sequence(${r}, ${i} + ${o}, ${o})`};return no(t)?new Zg(i):{signal:i()}}function km(e,t,n){if(t)return no(t)?{signal:`${t.signal} ? 0 : ${km(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(i.incompatibleChannel("size",e))}const Em=.95;function Am(e,t,n,r){const a={x:ym(n,"x"),y:ym(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=Dm(t,a,r.view);return Object(o["E"])(e)?e-1:new Zg(()=>e.signal+" - 1")}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=Dm(t,a,r.view);return Object(o["E"])(e)?Math.pow(Em*e,2):new Zg(()=>`pow(${Em} * ${e.signal}, 2)`)}}throw new Error(i.incompatibleChannel("size",e))}function Dm(e,t,n){const i=fc(e.width)?e.width.step:bc(n,"width"),r=fc(e.height)?e.height.step:bc(n,"height");return t.x||t.y?new Zg(()=>{const e=[t.x?t.x.signal:i,t.y?t.y.signal:r];return`min(${e.join(", ")})`}):Math.min(i,r)}function Sm(e,t){Xm(e)?Cm(e,t):$m(e,t)}function Cm(e,t){const n=e.component.scales,{config:r,encoding:o,markDef:a,specifiedScales:s}=e;for(const u of R(n)){const c=s[u],l=n[u],f=e.getScaleComponent(u),d=Rs(o[u]),h=c[t],p=f.get("type"),g=f.get("padding"),m=f.get("paddingInner"),v=ha(p,t),b=pa(u,t);if(void 0!==h&&(v?b&&Sr(b):Sr(i.scalePropertyNotWorkWithScaleType(p,t,u))),v&&void 0===b)if(void 0!==h)l.copyKeyFromObject(t,c);else{const n=t in Fm?Fm[t]({model:e,channel:u,fieldOrDatumDef:d,scaleType:p,scalePadding:g,scalePaddingInner:m,domain:c.domain,markDef:a,config:r}):r.scale[t];void 0!==n&&l.set(t,n,!1)}}}const Fm={bins:({model:e,fieldOrDatumDef:t})=>ss(t)?Nm(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Tm(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>Rm(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>zm(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:i})=>Pm(e,t,n.type,i.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:i,scalePaddingInner:r,config:o})=>Lm(e,t,n,i.type,r,o.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=ss(e)?e.sort:void 0;return Bm(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>Im(e,t,n,i,r)};function Mm(e){Xm(e)?bm(e):$m(e,"range")}function $m(e,t){const n=e.component.scales;for(const i of e.children)"range"===t?Mm(i):Sm(i,t);for(const i of R(n)){let r;for(const n of e.children){const e=n.component.scales[i];if(e){const n=e.getWithExplicit(t);r=jl(r,n,t,"scale",_l((e,n)=>{switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function Nm(e,t){const n=t.bin;if(ti(n)){const i=eg(e,t.field,n);return new Zg(()=>e.getSignalName(i))}if(ni(n)&&ii(n)&&void 0!==n.step)return{step:n.step}}function Tm(e,t){if(k([vt,bt,yt],e)&&"nominal"!==t)return"hcl"}function Rm(e,t,n){var i;if(!(null===(i=Ts(n))||void 0===i?void 0:i.bin)&&!k([To.TIME,To.UTC],e))return t in An||void 0}function zm(e,t,n,i,r,o){if(e in An){if(ea(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:a}=r;if("bar"===t&&(!ss(i)||!i.bin&&!i.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize}if(t===To.POINT)return n.pointPadding}}function Pm(e,t,n,i){if(void 0===e&&t in An){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:r}=i;return J(e,"bar"===n?t:r)}}function Lm(e,t,n,i,r,o){if(void 0===e&&t in An&&n===To.BAND){const{bandPaddingOuter:e}=o;return J(e,no(r)?{signal:r.signal+"/2"}:r/2)}}function Bm(e,t,n,i){return"x"===n&&void 0!==i.xReverse?Ko(e)&&"descending"===t?no(i.xReverse)?{signal:"!"+i.xReverse.signal}:!i.xReverse:i.xReverse:!(!Ko(e)||"descending"!==t)||void 0}function Im(e,t,n,i,r){const a=!!n&&"unaggregated"!==n;if(a&&Ko(r)){if(Object(o["A"])(n)){const e=n[0],t=n[n.length-1];if(e<=0&&t>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!ta(r))return!0;if((!ss(t)||!t.bin)&&k([...Dn,...Fn],e)){const{orient:t,type:n}=i;return!k(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e)}return!1}function Um(e,t,n,r){const o=qm(t,n,r),{type:a}=e;return Vn(t)?void 0!==a?ma(t,a)?ss(n)&&!ga(a,n.type)?(Sr(i.scaleTypeNotWorkWithFieldDef(a,o)),o):a:(Sr(i.scaleTypeNotWorkWithChannel(t,a,o)),o):o:null}function qm(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(Wt(e)||"discrete"===Kn(e))return"shape"===e&&"ordinal"===t.type&&Sr(i.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(e in An){if(k(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in Cn)return"band";return void 0!==t.band||ms(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return Wt(e)?"time":"discrete"===Kn(e)?(Sr(i.discreteChannelCannotEncode(e,"temporal")),"ordinal"):ss(t)&&t.timeUnit&&eo(t.timeUnit).utc?"utc":"time";case"quantitative":return Wt(e)?ss(t)&&ti(t.bin)?"bin-ordinal":"linear":"discrete"===Kn(e)?(Sr(i.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(i.invalidFieldType(t.type))}function Wm(e,{ignoreRange:t}={}){Hm(e),Xg(e);for(const n of da)Sm(e,n);t||Mm(e)}function Hm(e){Xm(e)?e.component.scales=Gm(e):e.component.scales=Ym(e)}function Gm(e){const{encoding:t,mark:n}=e;return Gn.reduce((i,r)=>{const o=Rs(t[r]);if(o&&n===ke&&r===xt&&o.type===Mo)return i;let a=o&&o["scale"];if(o&&null!==a&&!1!==a){a=null!==a&&void 0!==a?a:{};const t=Um(a,r,o,n);i[r]=new gm(e.scaleName(r+"",!0),{value:t,explicit:a.type===t})}return i},{})}const Vm=_l((e,t)=>Bo(e)-Bo(t));function Ym(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const o of e.children){Hm(o);for(const n of R(o.component.scales))if(r.scale[n]=null!==(t=r.scale[n])&&void 0!==t?t:ap(n,e),"shared"===r.scale[n]){const e=i[n],t=o.component.scales[n].getWithExplicit("type");e?Po(e.value,t.value)?i[n]=jl(e,t,"type","scale",Vm):(r.scale[n]="independent",delete i[n]):i[n]=t}}for(const o of R(i)){const t=e.scaleName(o,!0),r=i[o];n[o]=new gm(t,r);for(const n of e.children){const e=n.component.scales[o];e&&(n.renameScale(e.get("name"),t),e.merged=!0)}}return n}class Zm{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return void 0!==this.nameMap[e]}get(e){while(this.nameMap[e]&&e!==this.nameMap[e])e=this.nameMap[e];return e}}function Xm(e){return"unit"===(null===e||void 0===e?void 0:e.type)}function Jm(e){return"facet"===(null===e||void 0===e?void 0:e.type)}function Qm(e){return"concat"===(null===e||void 0===e?void 0:e.type)}function Km(e){return"layer"===(null===e||void 0===e?void 0:e.type)}class ev{constructor(e,t,n,i,r,o,a){var s,u;this.type=t,this.parent=n,this.config=r,this.view=a,this.children=[],this.correctDataNames=e=>(e.from&&e.from.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=n,this.config=r,this.name=null!==(s=e.name)&&void 0!==s?s:i,this.title=Xs(e.title)?{text:e.title}:e.title,this.scaleNameMap=n?n.scaleNameMap:new Zm,this.projectionNameMap=n?n.projectionNameMap:new Zm,this.signalNameMap=n?n.signalNameMap:new Zm,this.data=e.data,this.description=e.description,this.transforms=nf(null!==(u=e.transform)&&void 0!==u?u:[]),this.layout="layer"===t||"unit"===t?{}:mc(e,t,r),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:Xa(e)||n&&n.component.data.isFaceted&&void 0===e.data},layoutSize:new yl,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?y(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Wm(this)}parseProjection(){Gp(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Cp(this)}assembleGroupStyle(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}assembleEncodeFromView(e){const{style:t}=e,n=a(e,["style"]),i={};for(const r of R(n)){const e=n[r];void 0!==e&&(i[r]=Js(e))}return i}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t["description"]=Js(this.description)),"unit"!==this.type&&"layer"!==this.type)?T(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==t&&void 0!==t?t:{})}assembleLayout(){if(!this.layout)return;const e=this.layout,{spacing:t}=e,n=a(e,["spacing"]),{component:i,config:r}=this,o=Qh(i.layoutHeaders,r);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of Gt)e[n].title&&t.push(qh(this,n));for(const n of Ih)t=t.concat(Gh(this,n));return t}assembleAxes(){return hh(this.component.axes,this.config)}assembleLegends(){return Lp(this)}assembleProjections(){return Ip(this)}assembleTitle(){var e,t,n;const i=null!==(e=this.title)&&void 0!==e?e:{},{encoding:r}=i,o=a(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},Zs(this.config.title).nonMark),o),r?{encode:{update:r}}:{});if(s.text)return k(["unit","layer"],this.type)?k(["middle",void 0],s.anchor)&&(s.frame=null!==(t=s.frame)&&void 0!==t?t:"group"):s.anchor=null!==(n=s.anchor)&&void 0!==n?n:"start",T(s)?void 0:s}assembleGroup(e=[]){const t={};e=e.concat(this.assembleSignals()),e.length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Jm(this.parent)?dm(this):[];i.length>0&&(t.scales=i);const r=this.assembleAxes();r.length>0&&(t.axes=r);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t}getName(e){return B((this.name?this.name+"_":"")+e)}requestDataName(e){var t;const n=this.getName(e),i=this.component.data.outputNodeRefCounts;return i[n]=(null!==(t=i[n])&&void 0!==t?t:0)+1,n}getSizeSignalRef(e){if(Jm(this.parent)){const t=rp(e),n=Mn(t),i=this.component.scales[n];if(i&&!i.merged){const e=i.get("type"),t=i.get("range");if(Qo(e)&&io(t)){const e=i.get("name"),t=fm(this,n),r=lm(t);if(r){const t=xs({aggregate:"distinct",field:r},{expr:"datum"});return{signal:ip(e,i,t)}}return Sr(`Unknown field for ${n}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){return t?this.getName(e):on(e)&&Vn(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(i.selectionNotFound(t));return n}hasAxisOrientSignalRef(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some(e=>e.hasOrientSignalRef()))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some(e=>e.hasOrientSignalRef()))}}class tv extends ev{vgField(e,t={}){const n=this.fieldDef(e);if(n)return xs(n,t)}reduceFieldDef(e,t){return vu(this.getMapping(),(t,n,i)=>{const r=Ts(n);return r?e(t,r,i):t},t)}forEachFieldDef(e,t){mu(this.getMapping(),(t,n)=>{const i=Ts(t);i&&e(i,n)},t)}}class nv extends Hf{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=y(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:"value",null!==(r=o[1])&&void 0!==r?r:"density"]}clone(){return new nv(null,y(this.transform))}dependentFields(){var e;return new Set([this.transform.density,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform "+w(this.transform)}assemble(){const e=this.transform,{density:t}=e,n=a(e,["density"]),i=Object.assign({type:"kde",field:t},n);return i}}class iv extends Hf{constructor(e,t){super(e),this.filter=t}clone(){return new iv(null,Object.assign({},this.filter))}static make(e,t){const{config:n,mark:i,markDef:r}=t,o=nu("invalid",r,n);if("filter"!==o)return null;const a=t.reduceFieldDef((e,n,r)=>{const o=Vn(r)&&t.getScaleComponent(r);if(o){const t=o.get("type");Ko(t)&&"count"!==n.aggregate&&!Ee(i)&&(e[n.field]=n)}return e},{});return R(a).length?new iv(e,a):null}dependentFields(){return new Set(R(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid "+w(this.filter)}assemble(){const e=R(this.filter).reduce((e,t)=>{const n=this.filter[t],i=xs(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${i}) || (isValid(${i}) && isFinite(+${i})))`):"quantitative"===n.type&&(e.push(`isValid(${i})`),e.push(`isFinite(+${i})`))),e},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}class rv extends Hf{constructor(e,t){super(e),this.transform=t,this.transform=y(t);const{flatten:n,as:i=[]}=this.transform;this.transform.as=n.map((e,t)=>{var n;return null!==(n=i[t])&&void 0!==n?n:e})}clone(){return new rv(this.parent,y(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform "+w(this.transform)}assemble(){const{flatten:e,as:t}=this.transform,n={type:"flatten",fields:e,as:t};return n}}class ov extends Hf{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=y(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:"key",null!==(r=o[1])&&void 0!==r?r:"value"]}clone(){return new ov(null,y(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform "+w(this.transform)}assemble(){const{fold:e,as:t}=this.transform,n={type:"fold",fields:e,as:t};return n}}class av extends Hf{constructor(e,t,n,i){super(e),this.fields=t,this.geojson=n,this.signal=i}clone(){return new av(null,y(this.fields),this.geojson,this.signal)}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const i of[[pt,ht],[mt,gt]]){const r=i.map(e=>{const n=Rs(t.encoding[e]);return ss(n)?n.field:cs(n)?{expr:""+n.datum}:ps(n)?{expr:""+n["value"]}:void 0});(r[0]||r[1])&&(e=new av(e,r,null,t.getName("geojson_"+n++)))}if(t.channelHasField(xt)){const i=t.typedFieldDef(xt);i.type===Mo&&(e=new av(e,null,i.field,t.getName("geojson_"+n++)))}return e}dependentFields(){var e;const t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(o["H"]);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${w(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class sv extends Hf{constructor(e,t,n,i){super(e),this.projection=t,this.fields=n,this.as=i}clone(){return new sv(null,this.projection,y(this.fields),y(this.as))}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[pt,ht],[mt,gt]]){const i=n.map(e=>{const n=Rs(t.encoding[e]);return ss(n)?n.field:cs(n)?{expr:""+n.datum}:ps(n)?{expr:""+n["value"]}:void 0}),r=n[0]===mt?"2":"";(i[0]||i[1])&&(e=new sv(e,t.projectionName(),i,[t.getName("x"+r),t.getName("y"+r)]))}return e}dependentFields(){return new Set(this.fields.filter(o["H"]))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${w(this.fields)} ${w(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class uv extends Hf{constructor(e,t){super(e),this.transform=t}clone(){return new uv(null,y(this.transform))}dependentFields(){var e;return new Set([this.transform.impute,this.transform.key,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:n,step:i}=e,r=[t,n,...i?[i]:[]].join(",");return{signal:`sequence(${r})`}}static makeFromTransform(e,t){return new uv(e,t)}static makeFromEncoding(e,t){const n=t.encoding,i=n.x,r=n.y;if(ss(i)&&ss(r)){const o=i.impute?i:r.impute?r:void 0;if(void 0===o)return;const a=i.impute?r:r.impute?i:void 0,{method:s,value:u,frame:c,keyvals:l}=o.impute,f=bu(t.mark,n);return new uv(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},s?{method:s}:{}),void 0!==u?{value:u}:{}),c?{frame:c}:{}),void 0!==l?{keyvals:l}:{}),f.length?{groupby:f}:{}))}return null}hash(){return"Impute "+w(this.transform)}assemble(){const{impute:e,key:t,keyvals:n,method:i,groupby:r,value:o,frame:a=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:e,key:t},n?{keyvals:Rl(n)?this.processSequence(n):n}:{}),{method:"value"}),r?{groupby:r}:{}),{value:i&&"value"!==i?null:o});if(i&&"value"!==i){const t=Object.assign({type:"window",as:[`imputed_${e}_value`],ops:[i],fields:[e],frame:a,ignorePeers:!1},r?{groupby:r}:{}),n={type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e};return[s,t,n]}return[s]}}class cv extends Hf{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=y(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:t.on,null!==(r=o[1])&&void 0!==r?r:t.loess]}clone(){return new cv(null,y(this.transform))}dependentFields(){var e;return new Set([this.transform.loess,this.transform.on,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform "+w(this.transform)}assemble(){const e=this.transform,{loess:t,on:n}=e,i=a(e,["loess","on"]),r=Object.assign({type:"loess",x:n,y:t},i);return r}}class lv extends Hf{constructor(e,t,n){super(e),this.transform=t,this.secondary=n}clone(){return new lv(null,y(this.transform),this.secondary)}static make(e,t,n,r){const o=t.component.data.sources,{from:a}=n;let s=null;if(Pl(a)){let e=Mv(a.data,o);e||(e=new rg(a.data),o.push(e));const n=t.getName("lookup_"+r);s=new Gf(e,n,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=s}else if(Ll(a)){const e=a.selection;if(n=Object.assign({as:e},n),s=t.getSelectionComponent(B(e),e).materialized,!s)throw new Error(i.noSameUnitLookup(e))}return new lv(e,n,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Object(o["i"])(this.transform.as):this.transform.from.fields)}hash(){return"Lookup "+w({transform:this.transform,secondary:this.secondary})}assemble(){let e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Object(o["i"])(this.transform.as)}:{});else{let t=this.transform.as;Object(o["H"])(t)||(Sr(i.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}class fv extends Hf{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=y(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:"prob",null!==(r=o[1])&&void 0!==r?r:"value"]}clone(){return new fv(null,y(this.transform))}dependentFields(){var e;return new Set([this.transform.quantile,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform "+w(this.transform)}assemble(){const e=this.transform,{quantile:t}=e,n=a(e,["quantile"]),i=Object.assign({type:"quantile",field:t},n);return i}}class dv extends Hf{constructor(e,t){var n,i,r;super(e),this.transform=t,this.transform=y(t);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(i=o[0])&&void 0!==i?i:t.on,null!==(r=o[1])&&void 0!==r?r:t.regression]}clone(){return new dv(null,y(this.transform))}dependentFields(){var e;return new Set([this.transform.regression,this.transform.on,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform "+w(this.transform)}assemble(){const e=this.transform,{regression:t,on:n}=e,i=a(e,["regression","on"]),r=Object.assign({type:"regression",x:n,y:t},i);return r}}class hv extends Hf{constructor(e,t){super(e),this.transform=t}clone(){return new hv(null,y(this.transform))}addDimensions(e){var t;this.transform.groupby=C((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),e=>e)}producedFields(){}dependentFields(){var e;return new Set([this.transform.pivot,this.transform.value,...null!==(e=this.transform.groupby)&&void 0!==e?e:[]])}hash(){return"PivotTransform "+w(this.transform)}assemble(){const{pivot:e,value:t,groupby:n,limit:i,op:r}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:e,value:t},void 0!==i?{limit:i}:{}),void 0!==r?{op:r}:{}),void 0!==n?{groupby:n}:{})}}class pv extends Hf{constructor(e,t){super(e),this.transform=t}clone(){return new pv(null,y(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform "+w(this.transform)}assemble(){return{type:"sample",size:this.transform.sample}}}function gv(e){let t=0;function n(i,r){var o;if(i instanceof rg&&!i.isGenerator&&!El(i.data)){e.push(r);const t={name:null,source:r.name,transform:[]};r=t}if(i instanceof Og&&(i.parent instanceof rg&&!r.source?(r.format=Object.assign(Object.assign({},null!==(o=r.format)&&void 0!==o?o:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof gg){r.name||(r.name="data_"+t++),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source;for(const t of i.assemble())e.push(t)}else{if((i instanceof ag||i instanceof sg||i instanceof iv||i instanceof ih||i instanceof Rh||i instanceof sv||i instanceof av||i instanceof pg||i instanceof lv||i instanceof Ag||i instanceof wg||i instanceof ov||i instanceof rv||i instanceof nv||i instanceof cv||i instanceof fv||i instanceof dv||i instanceof _g||i instanceof pv||i instanceof hv)&&r.transform.push(i.assemble()),(i instanceof ig||i instanceof Vf||i instanceof uv||i instanceof Eg)&&r.transform.push(...i.assemble()),i instanceof Gf)if(r.source&&0===r.transform.length)i.setSource(r.source);else if(i.parent instanceof Gf)i.setSource(r.name);else if(r.name||(r.name="data_"+t++),i.setSource(r.name),1===i.numChildren()){e.push(r);const t={name:null,source:r.name,transform:[]};r=t}switch(i.numChildren()){case 0:i instanceof Gf&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name="data_"+t++);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const e of i.children){const t={name:null,source:o,transform:[]};n(e,t)}break}}}}return n}function mv(e){const t=[],n=gv(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function vv(e,t){var n,i;const r=[],o=gv(r);let a=0;for(const u of e.sources){u.hasName()||(u.dataName="source_"+a++);const e=u.assemble();o(u,e)}for(const u of r)0===u.transform.length&&delete u.transform;let s=0;for(const[u,c]of r.entries())0!==(null!==(n=c.transform)&&void 0!==n?n:[]).length||c.source||r.splice(s++,0,r.splice(u,1)[0]);for(const u of r)for(const t of null!==(i=u.transform)&&void 0!==i?i:[])"lookup"===t.type&&(t.from=e.outputNodes[t.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function bv(e){return"top"===e||"left"===e||no(e)?"header":"footer"}function yv(e){for(const t of Gt)xv(e,t);_v(e,"x"),_v(e,"y")}function xv(e,t){var n;const{facet:i,config:r,child:a,component:s}=e;if(e.channelHasField(t)){const u=i[t],c=Lh("title",null,r,t);let l=Cs(u,r,{allowDisabling:!0,includeDefault:void 0===c||!!c});a.component.layoutHeaders[t].title&&(l=Object(o["A"])(l)?l.join(", "):l,l+=" / "+a.component.layoutHeaders[t].title,a.component.layoutHeaders[t].title=null);const f=Lh("labelOrient",u,r,t),d=null!==(n=u.header)&&void 0!==n?n:{},h=J(d.labels,r.header.labels,!0),p=k(["bottom","right"],f)?"footer":"header";s.layoutHeaders[t]={title:l,facetFieldDef:u,[p]:"facet"===t?[]:[Ov(e,t,h)]}}}function Ov(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function _v(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:o}=e.component;if(o.axis[t]=sp(o,t),"shared"===o.axis[t]){const o="x"===t?"column":"row",a=r[o];for(const r of i.component.axes[t]){const t=bv(r.get("orient"));a[t]=null!==(n=a[t])&&void 0!==n?n:[Ov(e,o,!1)];const i=fh(r,"main",e.config,{header:!0});i&&a[t][0].axes.push(i),r.mainExtracted=!0}}}}function wv(e){kv(e),Ev(e,"width"),Ev(e,"height")}function jv(e){kv(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";Ev(e,t),Ev(e,n)}function kv(e){for(const t of e.children)t.parseLayoutSize()}function Ev(e,t){const n=rp(t),i=Mn(n),r=e.component.resolve,o=e.component.layoutSize;let a;for(const s of e.children){const e=s.component.layoutSize.getWithExplicit(n),t=r.scale[i];if("independent"===t&&"step"===e.value){a=void 0;break}if(a){if("independent"===t&&a.value!==e.value){a=void 0;break}a=jl(a,e,n,"")}else a=e}if(a){for(const i of e.children)e.renameSignal(i.getName(n),e.getName(t)),i.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function Av(e){const{size:t,component:n}=e;for(const i of Dn){const r=fn(i);if(t[r]){const e=t[r];n.layoutSize.set(r,fc(e)?"step":e,!0)}else{const t=Dv(e,r);n.layoutSize.set(r,t,!1)}}}function Dv(e,t){const n="width"===t?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const e=r.get("type"),n=r.get("range");if(Qo(e)){const e=yc(i.view,t);return io(n)||fc(e)?"step":e}return vc(i.view,t)}if(e.hasProjection||"arc"===e.mark)return vc(i.view,t);{const e=yc(i.view,t);return fc(e)?e.step:e}}function Sv(e,t,n){return xs(t,Object.assign({suffix:"by_"+xs(e)},null!==n&&void 0!==n?n:{}))}class Cv extends tv{constructor(e,t,n,i){super(e,"facet",t,n,i,e.resolve),this.child=Nb(e.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(e.facet,i)}initFacet(e,t){return Ya(e)?vu(e,(e,n,r)=>k([nt,it],r)?void 0===n.field?(Sr(i.emptyFieldDef(n,r)),e):(e[r]=zs(n,r,t),e):(Sr(i.incompatibleChannel(r,"facet")),e),{}):{facet:zs(e,"facet",t)}}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=Tv(this),this.child.parseData()}parseLayoutSize(){kv(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),yv(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){var e,t,n;const i={};for(const r of Gt)for(const o of Uh){const a=this.component.layoutHeaders[r],s=a[o],{facetFieldDef:u}=a;if(u){const t=Lh("titleOrient",u,this.config,r);if(k(["right","bottom"],t)){const n=Ph(r,t);i.titleAnchor=null!==(e=i.titleAnchor)&&void 0!==e?e:{},i.titleAnchor[n]="end"}}if(null===s||void 0===s?void 0:s[0]){const e="row"===r?"height":"width",s="header"===o?"headerBand":"footerBand";"facet"===r||this.child.component.layoutSize.get(e)||(i[s]=null!==(t=i[s])&&void 0!==t?t:{},i[s][r]=.5),a.title&&(i.offset=null!==(n=i.offset)&&void 0!==n?n:{},i.offset["row"===r?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let i="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Cv)){const e=this.getName("column_domain");return{signal:`length(data('${e}'))`}}}assembleGroup(e){return this.parent&&this.parent instanceof Cv?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:xs(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(e)):super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof Cv){if(this.child.channelHasField("column")){const i=xs(this.child.facet.column);e.push(i),t.push("distinct"),n.push("distinct_"+i)}}else for(const i of Dn){const r=this.child.component.scales[i];if(r&&!r.merged){const o=r.get("type"),a=r.get("range");if(Qo(o)&&io(a)){const r=fm(this.child,i),o=lm(r);o?(e.push(o),t.push("distinct"),n.push("distinct_"+o)):Sr(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:e,ops:t,as:n}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:i}=this.facet,{fields:r,ops:a,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const l of Gt){const e=this.facet[l];if(e){u.push(xs(e));const{bin:t,sort:c}=e;if(ti(t)&&u.push(xs(e,{binSuffix:"end"})),Ga(c)){const{field:t,op:o=Ua}=c,u=Sv(e,c);n&&i?(r.push(u),a.push("max"),s.push(u)):(r.push(t),a.push(o),s.push(u))}else if(Object(o["A"])(c)){const t=zh(e,l);r.push(t),a.push("max"),s.push(t)}}}const c=!!n&&!!i;return Object.assign({name:e,data:t,groupby:u},c||r.length>0?{aggregate:Object.assign(Object.assign({},c?{cross:c}:{}),r.length?{fields:r,ops:a,as:s}:{})}:{})}facetSortFields(e){const{facet:t}=this,n=t[e];return n?Ga(n.sort)?[Sv(n,n.sort,{expr:"datum"})]:Object(o["A"])(n.sort)?[zh(n,e,{expr:"datum"})]:[xs(n,{expr:"datum"})]:[]}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n,t=(Ga(e)?e.order:!Object(o["A"])(e)&&e)||"ascending";return[t]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return Yh(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const i of Ih)if(e[i]){const r=Lh("labelOrient",e[i],t,i);if(k(n[i],r))return Yh(e[i],i,t)}}assembleMarks(){const{child:e}=this,t=this.component.data.facetRoot,n=mv(t),i=e.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||e.assembleTitle(),o=e.assembleGroupStyle(),a=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Gt.map(e=>this.facetSortFields(e)).flat(),order:Gt.map(e=>this.facetSortOrder(e)).flat()}}),n.length>0?{data:n}:{}),i?{encode:{update:i}}:{}),e.assembleGroup(Ed(this,[])));return[a]}getMapping(){return this.facet}}function Fv(e,t){const{row:n,column:i}=t;if(n&&i){let t=null;for(const r of[n,i])if(Ga(r.sort)){const{field:n,op:i=Ua}=r.sort;e=t=new wg(e,{joinaggregate:[{op:i,field:n,as:Sv(r,r.sort,{forAs:!0})}],groupby:[xs(r)]})}return t}return null}function Mv(e,t){var n,i,r,o,a,s,u,c,l,f;for(const d of t){const t=d.data;if((!e.name||!d.hasName()||e.name===d.dataName)&&((!(null===(n=e["format"])||void 0===n?void 0:n.mesh)||!(null===(i=t.format)||void 0===i?void 0:i.feature))&&(!(null===(r=e["format"])||void 0===r?void 0:r.feature)&&!(null===(o=t.format)||void 0===o?void 0:o.feature)||(null===(a=e["format"])||void 0===a?void 0:a.feature)===(null===(s=t.format)||void 0===s?void 0:s.feature))&&(!(null===(u=e["format"])||void 0===u?void 0:u.mesh)&&!(null===(c=t.format)||void 0===c?void 0:c.mesh)||(null===(l=e["format"])||void 0===l?void 0:l.mesh)===(null===(f=t.format)||void 0===f?void 0:f.mesh))))if(Al(e)&&Al(t)){if(b(e.values,t.values))return d}else if(El(e)&&El(t)){if(e.url===t.url)return d}else if(Dl(e)&&e.name===d.dataName)return d}return null}function $v(e,t){if(e.data||!e.parent){if(null===e.data){const e=new rg({values:[]});return t.push(e),e}const n=Mv(e.data,t);if(n)return Sl(e.data)||(n.data.format=D({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new rg(e.data);return t.push(n),n}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Nv(e,t,n){var r,o;let a=0;for(const s of t.transforms){let u,c=void 0;if(Zl(s))u=e=new Rh(e,s),c="derived";else if(Tl(s)){const i=bg(s);u=e=null!==(r=Og.makeWithAncestors(e,{},i,n))&&void 0!==r?r:e,e=new ih(e,t,s.filter)}else if(Xl(s))u=e=ig.makeFromTransform(e,s,t),c="number";else if(Ql(s)){c="date";const t=n.getWithExplicit(s.field);void 0===t.value&&(e=new Og(e,{[s.field]:c}),n.set(s.field,c,!1)),u=e=Vf.makeFromTransform(e,s)}else if(Kl(s))u=e=pg.makeFromTransform(e,s),c="number",Qd(t)&&(e=new _g(e));else if(zl(s))u=e=lv.make(e,t,s,a++),c="derived";else if(Gl(s))u=e=new Ag(e,s),c="number";else if(Vl(s))u=e=new wg(e,s),c="number";else if(ef(s))u=e=Eg.makeFromTransform(e,s),c="derived";else if(tf(s))u=e=new ov(e,s),c="derived";else if(Yl(s))u=e=new rv(e,s),c="derived";else if(Bl(s))u=e=new hv(e,s),c="derived";else if(Hl(s))e=new pv(e,s);else if(Jl(s))u=e=uv.makeFromTransform(e,s),c="derived";else if(Il(s))u=e=new nv(e,s),c="derived";else if(Ul(s))u=e=new fv(e,s),c="derived";else if(ql(s))u=e=new dv(e,s),c="derived";else{if(!Wl(s)){Sr(i.invalidTransformIgnored(s));continue}u=e=new cv(e,s),c="derived"}if(u&&void 0!==c)for(const e of null!==(o=u.producedFields())&&void 0!==o?o:[])n.set(e,c,!1)}return e}function Tv(e){var t,n,i,r,o,a,s,u,c,l;let f=$v(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new kl,g=e.data;Sl(g)?(Cl(g)?f=new sg(f,g.sequence):Ml(g)&&(f=new ag(f,g.graticule)),p.parseNothing=!0):null===(null===(t=null===g||void 0===g?void 0:g.format)||void 0===t?void 0:t.parse)&&(p.parseNothing=!0),f=null!==(n=Og.makeExplicit(f,e,p))&&void 0!==n?n:f,f=new _g(f);const m=e.parent&&Km(e.parent);(Xm(e)||Jm(e))&&m&&(f=null!==(i=ig.makeFromEncoding(f,e))&&void 0!==i?i:f),e.transforms.length>0&&(f=Nv(f,e,p));const v=xg(e),b=yg(e);f=null!==(r=Og.makeWithAncestors(f,{},Object.assign(Object.assign({},v),b),p))&&void 0!==r?r:f,Xm(e)&&(f=av.parseAll(f,e),f=sv.parseAll(f,e)),(Xm(e)||Jm(e))&&(m||(f=null!==(o=ig.makeFromEncoding(f,e))&&void 0!==o?o:f),f=null!==(a=Vf.makeFromEncoding(f,e))&&void 0!==a?a:f,f=Rh.parseAllForSortIndex(f,e));const y=e.getName(Nl),x=new Gf(f,y,Nl,h);if(d[y]=x,f=x,Xm(e)){const t=pg.makeFromEncoding(f,e);t&&(f=t,Qd(e)&&(f=new _g(f))),f=null!==(s=uv.makeFromEncoding(f,e))&&void 0!==s?s:f,f=null!==(u=Eg.makeFromEncoding(f,e))&&void 0!==u?u:f}Xm(e)&&(f=null!==(c=iv.make(f,e))&&void 0!==c?c:f);const O=e.getName($l),_=new Gf(f,O,$l,h);d[O]=_,f=_,Xm(e)&&sh(e,_);let w=null;if(Jm(e)){const t=e.getName("facet");f=null!==(l=Fv(f,e.facet))&&void 0!==l?l:f,w=new gg(f,e,t,_.getSource()),d[t]=w}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:_,facetRoot:w,ancestorParse:p})}class Rv extends ev{constructor(e,t,n,r){var o,a,s,u;super(e,"concat",t,n,r,e.resolve),"shared"!==(null===(a=null===(o=e.resolve)||void 0===o?void 0:o.axis)||void 0===a?void 0:a.x)&&"shared"!==(null===(u=null===(s=e.resolve)||void 0===s?void 0:s.axis)||void 0===u?void 0:u.y)||Sr(i.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(e).map((e,t)=>Nb(e,this,this.getName("concat_"+t),void 0,r))}parseData(){this.component.data=Tv(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of R(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){return cc(e)?e.vconcat:lc(e)?e.hconcat:e.concat}parseLayoutSize(){jv(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.forEach(e=>e.assembleSignals()),[]}assembleLayoutSignals(){const e=ep(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleMarks(){return this.children.map(e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),i=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),i?{encode:{update:i}}:{}),e.assembleGroup())})}assembleDefaultLayout(){const e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}function zv(e){return!1===e||null===e}const Pv=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},ue),{labelExpr:1,encode:1}),Lv=R(Pv);class Bv extends yl{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n}clone(){return new Bv(y(this.explicit),y(this.implicit),this.mainExtracted)}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!zv(this.get(e)))}hasOrientSignalRef(){return no(this.explicit.orient)}}function Iv(e,t,n){var i;const{encoding:r,config:o}=e,a=null!==(i=Rs(r[t]))&&void 0!==i?i:Rs(r[ln(t)]),s=e.axis(t)||{},{format:u,formatType:c}=s;return Da(c)?Object.assign({text:$a({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:c,config:o})},n):n}function Uv(e){return Dn.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Zv(n,e)]),t),{})}const qv={bottom:"top",top:"bottom",left:"right",right:"left"};function Wv(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const t of R(o.component.axes))i.axis[t]=sp(e.component.resolve,t),"shared"===i.axis[t]&&(n[t]=Hv(n[t],o.component.axes[t]),n[t]||(i.axis[t]="independent",delete n[t]))}for(const o of Dn){for(const a of e.children)if(a.component.axes[o]){if("independent"===i.axis[o]){n[o]=(null!==(t=n[o])&&void 0!==t?t:[]).concat(a.component.axes[o]);for(const e of a.component.axes[o]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!no(t)){if(r[t]>0&&!n){const n=qv[t];r[t]>r[n]&&e.set("orient",n,!1)}r[t]++}}}delete a.component.axes[o]}if("independent"===i.axis[o]&&n[o]&&n[o].length>1)for(const e of n[o])e.get("grid")&&!e.explicit.grid&&(e.implicit.grid=!1)}}function Hv(e,t){if(!e)return t.map(e=>e.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const n=e[i],r=t[i];if(!!n!==!!r)return;if(n&&r){const t=n.getWithExplicit("orient"),o=r.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[i]=Gv(n,r)}}}return e}function Gv(e,t){for(const n of Lv){const i=jl(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(e,t)=>{switch(n){case"title":return cu(e,t);case"gridScale":return{explicit:e.explicit,value:J(e.value,t.value)}}return wl(e,t,n,"axis")});e.setWithExplicit(n,i)}return e}function Vv(e,t,n,i,r){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(no(n.labelAngle)?n.labelAngle:ne(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===$h(i,r))return!0}return e===n[t]}const Yv=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Zv(e,t){var n,i,r;let o=t.axis(e);const a=new Bv,s=Rs(t.encoding[e]),{mark:u,config:c}=t,l=(null===o||void 0===o?void 0:o.orient)||(null===(n=c["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(i=c.axis)||void 0===i?void 0:i.orient)||Fh(e),f=t.getScaleComponent(e).get("type"),d=yh(e,f,l,t.config),h=void 0!==o?!o:Oh("disable",c,null===o||void 0===o?void 0:o.style,d).configValue;if(a.set("disable",h,void 0!==o),h)return a;o=o||{};const p=kh(t,o,e,s,d),g={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:f,orient:l,labelAngle:p,mark:u,config:c};for(const b of Lv){const n=b in _h?_h[b](g):le(b)?o[b]:void 0,i=void 0!==n,r=Vv(n,b,o,t,e);if(i&&r)a.set(b,n,r);else{const{configValue:e,configFrom:s}=le(b)&&"values"!==b?Oh(b,t.config,o.style,d):{},u=void 0!==e;i&&!u?a.set(b,n,r):("vgAxisConfig"!==s||Yv.has(b)&&u||oe(e)||no(e))&&a.set(b,e,!1)}}const m=null!==(r=o.encoding)&&void 0!==r?r:{},v=ae.reduce((n,i)=>{var r;if(!a.hasAxisPart(i))return n;const o=op(null!==(r=m[i])&&void 0!==r?r:{},t),s="labels"===i?Iv(t,e,o):o;return void 0===s||T(s)||(n[i]={update:s}),n},{});return T(v)||a.set("encode",v,!!o.encoding||void 0!==o.labelAngle),a}function Xv({encoding:e,size:t}){for(const n of Dn){const r=fn(n);fc(t[r])&&ls(e[n])&&(delete t[r],Sr(i.stepDropped(r)))}return t}function Jv(e,t,n,{graticule:r}){const o=Se(e)?Object.assign({},e):{type:e},a=nu("orient",o,n);if(o.orient=tb(o.type,t,a),void 0!==a&&a!==o.orient&&Sr(i.orientOverridden(o.orient,a)),"bar"===o.type&&o.orient){const e=nu("cornerRadiusEnd",o,n);if(void 0!==e){const n="horizontal"===o.orient&&t.x2||"vertical"===o.orient&&t.y2?["cornerRadius"]:ze[o.orient];for(const t of n)o[t]=e;void 0!==o.cornerRadiusEnd&&delete o.cornerRadiusEnd}}const s=nu("opacity",o,n);void 0===s&&(o.opacity=Kv(o.type,t));const u=o.filled;void 0===u&&(o.filled=!r&&eb(o,n));const c=nu("cursor",o,n);return void 0===c&&(o.cursor=Qv(o,t,n)),o}function Qv(e,t,n){return t.href||e.href||nu("href",e,n)?"pointer":e.cursor}function Kv(e,t){if(k([ve,Oe,we,je],e)&&!fu(t))return.7}function eb(e,t){const n=iu("filled",e,t),i=e.type;return J(n,i!==ve&&i!==me&&i!==ye)}function tb(e,t,n){switch(e){case ve:case we:case je:case xe:case be:case ge:return}const{x:i,y:r,x2:o,y2:a}=t;switch(e){case pe:if(ss(i)&&(ni(i.bin)||ss(r)&&r.aggregate&&!i.aggregate))return"vertical";if(ss(r)&&(ni(r.bin)||ss(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(ss(i)&&i.type===Do&&!ti(i.bin)||fs(i)))return"horizontal";if(!a&&(ss(r)&&r.type===Do&&!ti(r.bin)||fs(r)))return"vertical"}case ye:if(o&&(!ss(i)||!ni(i.bin))&&a&&(!ss(r)||!ni(r.bin)))return;case he:if(a)return ss(r)&&ni(r.bin)?"horizontal":"vertical";if(o)return ss(i)&&ni(i.bin)?"vertical":"horizontal";if(e===ye){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case me:case Oe:{const t=ls(i),o=ls(r);if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o){const t=i,o=r,a=t.type===Co,s=o.type===Co;return a&&!s?"tick"!==e?"vertical":"horizontal":!a&&s?"tick"!==e?"horizontal":"vertical":!t.aggregate&&o.aggregate?"tick"!==e?"vertical":"horizontal":t.aggregate&&!o.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}const nb={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),vf("x",e,{defaultPos:"mid"})),vf("y",e,{defaultPos:"mid"})),Df(e,"radius","arc")),Df(e,"theta","arc"))},ib={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),wf("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),wf("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),Lf(e))},rb={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Df(e,"x","bar")),Df(e,"y","bar"))},ob={vgMark:"shape",encodeEntry:e=>Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape,i=Object.assign({type:"geoshape",projection:e.projectionName()},n&&ss(n)&&n.type===Mo?{field:xs(n,{expr:"datum"})}:{});return[i]}},ab={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Df(e,"x","image")),Df(e,"y","image")),af(e,"url"))},sb={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),vf("x",e,{defaultPos:"mid"})),vf("y",e,{defaultPos:"mid"})),pf("size",e,{vgChannel:"strokeWidth"})),Lf(e))},ub={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),vf("x",e,{defaultPos:"mid"})),vf("y",e,{defaultPos:"mid"})),pf("size",e)),Lf(e))};function cb(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),vf("x",e,{defaultPos:"mid"})),vf("y",e,{defaultPos:"mid"})),pf("size",e)),pf("angle",e)),lb(e,n,t))}function lb(e,t,n){return n?{shape:{value:n}}:pf("shape",e)}const fb={vgMark:"symbol",encodeEntry:e=>cb(e)},db={vgMark:"symbol",encodeEntry:e=>cb(e,"circle")},hb={vgMark:"symbol",encodeEntry:e=>cb(e,"square")},pb={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Df(e,"x","rect")),Df(e,"y","rect"))},gb={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),wf("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),wf("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),pf("size",e,{vgChannel:"strokeWidth"})):{}}},mb={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),vf("x",e,{defaultPos:"mid"})),vf("y",e,{defaultPos:"mid"})),af(e)),pf("size",e,{vgChannel:"fontSize"})),pf("angle",e)),If("align",vb(e.markDef,n,t))),If("baseline",bb(e.markDef,n,t))),vf("radius",e,{defaultPos:null,isMidPoint:!0})),vf("theta",e,{defaultPos:null,isMidPoint:!0}))}};function vb(e,t,n){const i=nu("align",e,n);if(void 0===i)return"center"}function bb(e,t,n){const i=nu("baseline",e,n);if(void 0===i)return"middle"}const yb={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",o="horizontal"===i?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tf(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),vf("x",e,{defaultPos:"mid",vgChannel:"xc"})),vf("y",e,{defaultPos:"mid",vgChannel:"yc"})),pf("size",e,{defaultValue:xb(e),vgChannel:r})),{[o]:Js(nu("thickness",n,t))})}};function xb(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,a="horizontal"===r?"width":"height",s=e.getScaleComponent("horizontal"===r?"x":"y"),u=null!==(t=nu("size",i,n,{vgChannel:a}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==u)return u;{const e=s?s.get("range"):void 0;if(e&&io(e)&&Object(o["E"])(e.step))return 3*e.step/4;const t=bc(n.view,a);return 3*t/4}}const Ob={arc:nb,area:ib,bar:rb,circle:db,geoshape:ob,image:ab,line:sb,point:fb,rect:pb,rule:gb,square:hb,text:mb,tick:yb,trail:ub};function _b(e){return k([me,he,_e],e.mark)?jb(e):k([pe],e.mark)?Eb(e):Db(e)}const wb="faceted_path_";function jb(e){const t=bu(e.mark,e.encoding),n=Db(e,{fromPrefix:t.length>0?wb:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:wb+e.requestDataName($l),data:e.requestDataName($l),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const kb="stack_group_";function Eb(e){const t=lo.some(t=>nu(t,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[t]=Db(e,{fromPrefix:kb}),n=e.scaleName(e.stack.fieldChannel),i=(t={})=>e.vgField(e.stack.fieldChannel,t),r=(e,t)=>{const r=[i({prefix:"min",suffix:"start",expr:t}),i({prefix:"max",suffix:"start",expr:t}),i({prefix:"min",suffix:"end",expr:t}),i({prefix:"max",suffix:"end",expr:t})];return`${e}(${r.map(e=>`scale('${n}',${e})`).join(",")})`};let o,a;"x"===e.stack.fieldChannel?(o=Object.assign(Object.assign({},x(t.encode.update,["y","yc","y2","height",...lo])),{x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update=Object.assign(Object.assign({},O(t.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},x(t.encode.update,["x","xc","x2","width"])),{y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update=Object.assign(Object.assign({},O(t.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of lo){const n=iu(l,e.markDef,e.config);t.encode.update[l]?(o[l]=t.encode.update[l],delete t.encode.update[l]):n&&(o[l]=Js(n)),n&&(t.encode.update[l]={value:0})}const s=e.fieldDef(e.stack.groupbyChannel),u=xs(s)?[xs(s)]:[];((null===s||void 0===s?void 0:s.bin)||(null===s||void 0===s?void 0:s.timeUnit))&&u.push(xs(s,{binSuffix:"end"}));const c=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"];return o=c.reduce((n,i)=>{if(t.encode.update[i])return Object.assign(Object.assign({},n),{[i]:t.encode.update[i]});{const t=iu(i,e.markDef,e.config);return void 0!==t?Object.assign(Object.assign({},n),{[i]:Js(t)}):n}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName($l),name:kb+e.requestDataName($l),groupby:u,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}]}return Db(e)}function Ab(e){const{encoding:t,stack:n,mark:i,markDef:r,config:a}=e,s=t.order;if(!(!Object(o["A"])(s)&&ps(s)&&j(s.value)||!s&&j(nu("order",r,a)))){if((Object(o["A"])(s)||ss(s))&&!n)return au(s,{expr:"datum"});if(Ee(i)){const n="horizontal"===r.orient?"y":"x",i=t[n];if(ss(i)){const t=i.sort;if(Object(o["A"])(t))return{field:xs(i,{prefix:n,suffix:"sort_index",expr:"datum"})};if(Ga(t))return{field:xs({aggregate:fu(e.encoding)?t.op:void 0,field:t.field},{expr:"datum"})};if(Ha(t)){const n=e.fieldDef(t.encoding);return{field:xs(n,{expr:"datum"}),order:t.order}}return null===t?void 0:{field:xs(i,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}function Db(e,t={fromPrefix:""}){const{mark:n,markDef:i,config:r}=e,o=J(i.clip,Sb(e),Cb(e)),a=tu(i),s=e.encoding.key,u=Ab(e),c=Fb(e),l=nu("aria",i,r),f=Ob[n].postEncodingTransform?Ob[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Ob[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),c||{}),!1===l?{aria:l}:{}),{from:{data:t.fromPrefix+e.requestDataName($l)},encode:{update:Ob[n].encodeEntry(e)}}),f?{transform:f}:{})]}function Sb(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}function Cb(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}function Fb(e){if(!e.component.selection)return null;const t=R(e.component.selection).length;let n=t,i=e.parent;while(i&&0===n)n=R(i.component.selection).length,i=i.parent;return n?{interactive:t>0}:null}class Mb extends tv{constructor(e,t,n,i={},r){var o,a;super(e,"unit",t,n,r,void 0,dc(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=Se(e.mark)?e.mark.type:e.mark;this.markDef=Jv(e.mark,null!==(o=e.encoding)&&void 0!==o?o:{},r,{graticule:e.data&&Ml(e.data)});const u=this.encoding=pu(null!==(a=e.encoding)&&void 0!==a?a:{},this.markDef,r);this.size=Xv({encoding:u,size:dc(e)?Object.assign(Object.assign(Object.assign({},i),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):i}),this.stack=Gc(s,u),this.specifiedScales=this.initScales(s,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=e.projection,this.selection=e.selection}get hasProjection(){const{encoding:e}=this,t=this.mark===ke,n=e&&Ut.some(t=>ds(e[t]));return t||n}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,t){return Gn.reduce((e,n)=>{var i;const r=Rs(t[n]);return r&&(e[n]=null!==(i=r.scale)&&void 0!==i?i:{}),e},{})}initAxes(e){return Dn.reduce((t,n)=>{const i=e[n];if(ds(i)||n===ot&&ds(e.x2)||n===at&&ds(e.y2)){const e=ds(i)?i.axis:void 0;t[n]=e?Object.assign({},e):e}return t},{})}initLegend(e){return Un.reduce((t,n)=>{const i=Rs(e[n]);if(i&&Wn(n)){const e=i.legend;t[n]=e?Object.assign({},e):e}return t},{})}parseData(){this.component.data=Tv(this)}parseLayoutSize(){Av(this)}parseSelections(){this.component.selection=rh(this,this.selection)}parseMarkGroup(){this.component.mark=_b(this)}parseAxesAndHeaders(){this.component.axes=Uv(this)}assembleSelectionTopLevelSignals(e){return Ad(this,e)}assembleSignals(){return[...dh(this),...kd(this,[])]}assembleSelectionData(e){return Dd(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return ep(this)}assembleMarks(){var e;let t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&Km(this.parent)||(t=Sd(this,t)),t.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return lu(this.encoding,e)}fieldDef(e){const t=this.encoding[e];return Ts(t)}typedFieldDef(e){const t=this.fieldDef(e);return hs(t)?t:null}}class $b extends ev{constructor(e,t,n,r,o){super(e,"layer",t,n,o,e.resolve,e.view);const a=Object.assign(Object.assign(Object.assign({},r),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});this.children=e.layer.map((e,t)=>{if(Rc(e))return new $b(e,this,this.getName("layer_"+t),a,o);if(qe(e))return new Mb(e,this,this.getName("layer_"+t),a,o);throw new Error(i.invalidSpec(e))})}parseData(){this.component.data=Tv(this);for(const e of this.children)e.parseData()}parseLayoutSize(){wv(this)}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of R(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){Wv(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleSignals()),dh(this))}assembleLayoutSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleLayoutSignals()),ep(this))}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e}assembleLayout(){return null}assembleMarks(){return Cd(this,this.children.flatMap(e=>e.assembleMarks()))}assembleLegends(){return this.children.reduce((e,t)=>e.concat(t.assembleLegends()),Lp(this))}}function Nb(e,t,n,r,o){if(Xa(e))return new Cv(e,t,n,o);if(Rc(e))return new $b(e,t,n,r,o);if(qe(e))return new Mb(e,t,n,r,o);if(sc(e))return new Rv(e,t,n,o);throw new Error(i.invalidSpec(e))}function Tb(e,t={}){t.logger&&Ar(t.logger),t.fieldTitle&&Ds(t.fieldTitle);try{const n=Sc(Object(o["N"])(t.config,e.config)),i=ll(e,n),r=Nb(i,null,"",void 0,n);r.parse(),Yg(r.component.data,r);const a=zb(r,Rb(e,i.autosize,n,r),e.datasets,e.usermeta);return{spec:a,normalized:i}}finally{t.logger&&Dr(),t.fieldTitle&&Ss()}}function Rb(e,t,n,r){const a=r.component.layoutSize.get("width"),s=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Object(o["H"])(t)&&(t={type:t}),a&&s&&gl(t.type))if("step"===a&&"step"===s)Sr(i.droppingFit()),t.type="pad";else if("step"===a||"step"===s){const e="step"===a?"width":"height";Sr(i.droppingFit(Mn(e)));const n="width"===e?"height":"width";t.type=ml(n)}return Object.assign(Object.assign(Object.assign({},1===R(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),bl(n)),bl(e))}function zb(e,t,n={},i){const r=e.config?$c(e.config):void 0,o=[].concat(e.assembleSelectionData([]),vv(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let l=e.assembleLayoutSignals();return l=l.filter(e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),c?{encode:{update:c}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...l,...e.assembleSelectionTopLevelSignals([])])),r?{config:r}:{}),i?{usermeta:i}:{})}class Pb extends Lc{mapUnit(e,{config:t}){if(e.encoding){const{encoding:n,transform:i}=e,{bins:r,timeUnits:o,aggregate:a,groupby:s,encoding:u}=du(n,t),c=[...i||[],...r,...o,...0===a.length?[]:[{aggregate:a,groupby:s}]];return Object.assign(Object.assign(Object.assign({},e),c.length>0?{transform:c}:{}),{encoding:u})}return e}}const Lb=new Pb;function Bb(e,t){return Lb.map(e,{config:t})}const Ib=r.version},"2a86":function(e,t,n){const i=n("3fce"),r=(e,t,n)=>{try{t=new i(t,n)}catch(r){return!1}return t.test(e)};e.exports=r},"2cdf":function(e,t){const n=/^[0-9]+$/,i=(e,t)=>{const i=n.test(e),r=n.test(t);return i&&r&&(e=+e,t=+t),e===t?0:i&&!r?-1:r&&!i?1:e<t?-1:1},r=(e,t)=>i(t,e);e.exports={compareIdentifiers:i,rcompareIdentifiers:r}},3034:function(e,t,n){const i=n("bbfd"),r=(e,t,n)=>new i(e,n).compare(new i(t,n));e.exports=r},"354e":function(e,t,n){"use strict";var i=n("21e5"),r=n("6bcb"),o="$",a={depth:-1},s={};function u(e){return e.id}function c(e){return e.parentId}t["a"]=function(){var e=u,t=c;function n(n){var i,u,c,l,f,d,h,p=n.length,g=new Array(p),m={};for(u=0;u<p;++u)i=n[u],f=g[u]=new r["a"](i),null!=(d=e(i,u,n))&&(d+="")&&(h=o+(f.id=d),m[h]=h in m?s:f);for(u=0;u<p;++u)if(f=g[u],d=t(n[u],u,n),null!=d&&(d+="")){if(l=m[o+d],!l)throw new Error("missing: "+d);if(l===s)throw new Error("ambiguous: "+d);l.children?l.children.push(f):l.children=[f],f.parent=l}else{if(c)throw new Error("multiple roots");c=f}if(!c)throw new Error("no root");if(c.parent=a,c.eachBefore((function(e){e.depth=e.parent.depth+1,--p})).eachBefore(r["b"]),c.parent=null,p>0)throw new Error("cycle");return c}return n.id=function(t){return arguments.length?(e=Object(i["b"])(t),n):e},n.parentId=function(e){return arguments.length?(t=Object(i["b"])(e),n):t},n}},"38cb":function(e,t,n){const i=n("bbfd"),r=n("6d43"),{ANY:o}=r,a=n("3fce"),s=n("2a86"),u=n("bac4"),c=n("38fa"),l=n("68d3"),f=n("a2a3"),d=(e,t,n,d)=>{let h,p,g,m,v;switch(e=new i(e,d),t=new a(t,d),n){case">":h=u,p=l,g=c,m=">",v=">=";break;case"<":h=c,p=f,g=u,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,d))return!1;for(let i=0;i<t.set.length;++i){const n=t.set[i];let a=null,s=null;if(n.forEach(e=>{e.semver===o&&(e=new r(">=0.0.0")),a=a||e,s=s||e,h(e.semver,a.semver,d)?a=e:g(e.semver,s.semver,d)&&(s=e)}),a.operator===m||a.operator===v)return!1;if((!s.operator||s.operator===m)&&p(e,s.semver))return!1;if(s.operator===v&&g(e,s.semver))return!1}return!0};e.exports=d},"38fa":function(e,t,n){const i=n("3034"),r=(e,t,n)=>i(e,t,n)<0;e.exports=r},"3b4d":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("d0ae"),r=n("7792");function o(e,t){this._context=e,this._k=(1-t)/6}o.prototype={areaStart:i["a"],areaEnd:i["a"],lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Object(r["c"])(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["b"]=function e(t){function n(e){return new o(e,t)}return n.tension=function(t){return e(+t)},n}(0)},"3fce":function(e,t,n){class i{constructor(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof i)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new i(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=this.options.loose;e=e.trim();const n=t?s[u.HYPHENRANGELOOSE]:s[u.HYPHENRANGE];e=e.replace(n,w(this.options.includePrerelease)),o("hyphen replace",e),e=e.replace(s[u.COMPARATORTRIM],c),o("comparator trim",e,s[u.COMPARATORTRIM]),e=e.replace(s[u.TILDETRIM],l),e=e.replace(s[u.CARETTRIM],f),e=e.split(/\s+/).join(" ");const i=t?s[u.COMPARATORLOOSE]:s[u.COMPARATOR];return e.split(" ").map(e=>h(e,this.options)).join(" ").split(/\s+/).map(e=>_(e,this.options)).filter(this.options.loose?e=>!!e.match(i):()=>!0).map(e=>new r(e,this.options))}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Range is required");return this.set.some(n=>d(n,t)&&e.set.some(e=>d(e,t)&&n.every(n=>e.every(e=>n.intersects(e,t)))))}test(e){if(!e)return!1;if("string"===typeof e)try{e=new a(e,this.options)}catch(t){return!1}for(let n=0;n<this.set.length;n++)if(j(this.set[n],e,this.options))return!0;return!1}}e.exports=i;const r=n("6d43"),o=n("b802"),a=n("bbfd"),{re:s,t:u,comparatorTrimReplace:c,tildeTrimReplace:l,caretTrimReplace:f}=n("8cb5"),d=(e,t)=>{let n=!0;const i=e.slice();let r=i.pop();while(n&&i.length)n=i.every(e=>r.intersects(e,t)),r=i.pop();return n},h=(e,t)=>(o("comp",e,t),e=v(e,t),o("caret",e),e=g(e,t),o("tildes",e),e=y(e,t),o("xrange",e),e=O(e,t),o("stars",e),e),p=e=>!e||"x"===e.toLowerCase()||"*"===e,g=(e,t)=>e.trim().split(/\s+/).map(e=>m(e,t)).join(" "),m=(e,t)=>{const n=t.loose?s[u.TILDELOOSE]:s[u.TILDE];return e.replace(n,(t,n,i,r,a)=>{let s;return o("tilde",e,t,n,i,r,a),p(n)?s="":p(i)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:p(r)?s=`>=${n}.${i}.0 <${n}.${+i+1}.0-0`:a?(o("replaceTilde pr",a),s=`>=${n}.${i}.${r}-${a} <${n}.${+i+1}.0-0`):s=`>=${n}.${i}.${r} <${n}.${+i+1}.0-0`,o("tilde return",s),s})},v=(e,t)=>e.trim().split(/\s+/).map(e=>b(e,t)).join(" "),b=(e,t)=>{o("caret",e,t);const n=t.loose?s[u.CARETLOOSE]:s[u.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(t,n,r,a,s)=>{let u;return o("caret",e,t,n,r,a,s),p(n)?u="":p(r)?u=`>=${n}.0.0${i} <${+n+1}.0.0-0`:p(a)?u="0"===n?`>=${n}.${r}.0${i} <${n}.${+r+1}.0-0`:`>=${n}.${r}.0${i} <${+n+1}.0.0-0`:s?(o("replaceCaret pr",s),u="0"===n?"0"===r?`>=${n}.${r}.${a}-${s} <${n}.${r}.${+a+1}-0`:`>=${n}.${r}.${a}-${s} <${n}.${+r+1}.0-0`:`>=${n}.${r}.${a}-${s} <${+n+1}.0.0-0`):(o("no pr"),u="0"===n?"0"===r?`>=${n}.${r}.${a}${i} <${n}.${r}.${+a+1}-0`:`>=${n}.${r}.${a}${i} <${n}.${+r+1}.0-0`:`>=${n}.${r}.${a} <${+n+1}.0.0-0`),o("caret return",u),u})},y=(e,t)=>(o("replaceXRanges",e,t),e.split(/\s+/).map(e=>x(e,t)).join(" ")),x=(e,t)=>{e=e.trim();const n=t.loose?s[u.XRANGELOOSE]:s[u.XRANGE];return e.replace(n,(n,i,r,a,s,u)=>{o("xRange",e,n,i,r,a,s,u);const c=p(r),l=c||p(a),f=l||p(s),d=f;return"="===i&&d&&(i=""),u=t.includePrerelease?"-0":"",c?n=">"===i||"<"===i?"<0.0.0-0":"*":i&&d?(l&&(a=0),s=0,">"===i?(i=">=",l?(r=+r+1,a=0,s=0):(a=+a+1,s=0)):"<="===i&&(i="<",l?r=+r+1:a=+a+1),"<"===i&&(u="-0"),n=`${i+r}.${a}.${s}${u}`):l?n=`>=${r}.0.0${u} <${+r+1}.0.0-0`:f&&(n=`>=${r}.${a}.0${u} <${r}.${+a+1}.0-0`),o("xRange return",n),n})},O=(e,t)=>(o("replaceStars",e,t),e.trim().replace(s[u.STAR],"")),_=(e,t)=>(o("replaceGTE0",e,t),e.trim().replace(s[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),w=e=>(t,n,i,r,o,a,s,u,c,l,f,d,h)=>(n=p(i)?"":p(r)?`>=${i}.0.0${e?"-0":""}`:p(o)?`>=${i}.${r}.0${e?"-0":""}`:a?">="+n:`>=${n}${e?"-0":""}`,u=p(c)?"":p(l)?`<${+c+1}.0.0-0`:p(f)?`<${c}.${+l+1}.0-0`:d?`<=${c}.${l}.${f}-${d}`:e?`<${c}.${l}.${+f+1}-0`:"<="+u,`${n} ${u}`.trim()),j=(e,t,n)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(o(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const i=e[n].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},"438d":function(e,t,n){"use strict";var i=n("b0ad"),r=n("29c8");function o(e,t){this._context=e,this._alpha=t}o.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Object(r["b"])(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["a"]=function e(t){function n(e){return t?new o(e,t):new i["a"](e,0)}return n.alpha=function(t){return e(+t)},n}(.5)},4392:function(e,t,n){const i=n("3034"),r=(e,t,n)=>0===i(e,t,n);e.exports=r},4830:function(e,t,n){"use strict";function i(e){this._context=e}i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}},t["a"]=function(e){return new i(e)}},"4c60":function(e,t,n){"use strict";n.r(t),n.d(t,"dark",(function(){return s})),n.d(t,"excel",(function(){return l})),n.d(t,"fivethirtyeight",(function(){return b})),n.d(t,"ggplot2",(function(){return O})),n.d(t,"latimes",(function(){return $})),n.d(t,"quartz",(function(){return z})),n.d(t,"vox",(function(){return B})),n.d(t,"urbaninstitute",(function(){return J})),n.d(t,"googlecharts",(function(){return ne})),n.d(t,"version",(function(){return ie}));var i=n("ab0f");const r="#fff",o="#888",a={background:"#333",title:{color:r},style:{"guide-label":{fill:r},"guide-title":{fill:r}},axis:{domainColor:r,gridColor:o,tickColor:r}};var s=a;const u="#4572a7",c={background:"#fff",arc:{fill:u},area:{fill:u},line:{stroke:u,strokeWidth:2},path:{stroke:u},rect:{fill:u},shape:{stroke:u},symbol:{fill:u,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}};var l=c;const f="#30a2da",d="#cbcbcb",h="#999",p="#333",g="#f0f0f0",m="#333",v={arc:{fill:f},area:{fill:f},axis:{domainColor:d,grid:!0,gridColor:d,gridWidth:1,labelColor:h,labelFontSize:10,titleColor:p,tickColor:d,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:g,group:{fill:g},legend:{labelColor:m,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:m,titleFontSize:14,titlePadding:10},line:{stroke:f,strokeWidth:2},path:{stroke:f,strokeWidth:.5},rect:{fill:f},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:f},bar:{binSpacing:2,fill:f,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}};var b=v;const y="#000",x={group:{fill:"#e5e5e5"},arc:{fill:y},area:{fill:y},line:{stroke:y},path:{stroke:y},rect:{fill:y},shape:{stroke:y},symbol:{fill:y,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};var O=x;const _=22,w="normal",j="Benton Gothic, sans-serif",k=11.5,E="normal",A="#82c6df",D="Benton Gothic Bold, sans-serif",S="normal",C=13,F={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},M={background:"#ffffff",title:{anchor:"start",color:"#000000",font:D,fontSize:_,fontWeight:w},arc:{fill:A},area:{fill:A},line:{stroke:A,strokeWidth:2},path:{stroke:A},rect:{fill:A},shape:{stroke:A},symbol:{fill:A,size:30},axis:{labelFont:j,labelFontSize:k,labelFontWeight:E,titleFont:D,titleFontSize:C,titleFontWeight:S},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:j,labelFontSize:k,symbolType:"square",titleFont:D,titleFontSize:C,titleFontWeight:S},range:{category:F["category-6"],diverging:F["fireandice-6"],heatmap:F["fire-7"],ordinal:F["fire-7"],ramp:F["fire-7"]}};var $=M;const N="#ab5787",T="#979797",R={background:"#f9f9f9",arc:{fill:N},area:{fill:N},line:{stroke:N},path:{stroke:N},rect:{fill:N},shape:{stroke:N},symbol:{fill:N,size:30},axis:{domainColor:T,domainWidth:.5,gridWidth:.2,labelColor:T,tickColor:T,tickWidth:.2,titleColor:T},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}};var z=R;const P="#3e5c69",L={background:"#fff",arc:{fill:P},area:{fill:P},line:{stroke:P},path:{stroke:P},rect:{fill:P},shape:{stroke:P},symbol:{fill:P},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};var B=L;const I="#1696d2",U="#000000",q="#FFFFFF",W="Lato",H="Lato",G="Lato",V="#DEDDDD",Y=18,Z={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},X={background:q,title:{anchor:"start",fontSize:Y,font:W},axisX:{domain:!0,domainColor:U,domainWidth:1,grid:!1,labelFontSize:12,labelFont:H,labelAngle:0,tickColor:U,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:W},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:V,gridWidth:1,labelFontSize:12,labelFont:H,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:W,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:H,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:W,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Z["six-groups-cat-1"],diverging:Z["diverging-colors"],heatmap:Z["diverging-colors"],ordinal:Z["six-groups-seq"],ramp:Z["shades-blue"]},area:{fill:I},rect:{fill:I},line:{color:I,stroke:I,strokeWidth:5},trail:{color:I,stroke:I,strokeWidth:0,size:1},path:{stroke:I,strokeWidth:.5},point:{filled:!0},text:{font:G,color:I,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:I,stroke:null}},arc:{fill:I},shape:{stroke:I},symbol:{fill:I,size:30}};var J=X;const Q="#3366CC",K="#ccc",ee="Arial, sans-serif",te={arc:{fill:Q},area:{fill:Q},path:{stroke:Q},rect:{fill:Q},shape:{stroke:Q},symbol:{stroke:Q},circle:{fill:Q},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:ee,fontSize:12},"guide-title":{font:ee,fontSize:12},"group-title":{font:ee,fontSize:12}},title:{font:ee,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:K,tickColor:K,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}};var ne=te;const ie=i.version},"4ca4":function(e,t,n){const i=n("bbfd"),r=(e,t)=>new i(e,t).patch;e.exports=r},"4d89":function(e,t,n){const i=n("8cb5");e.exports={re:i.re,src:i.src,tokens:i.t,SEMVER_SPEC_VERSION:n("b15c").SEMVER_SPEC_VERSION,SemVer:n("bbfd"),compareIdentifiers:n("2cdf").compareIdentifiers,rcompareIdentifiers:n("2cdf").rcompareIdentifiers,parse:n("a236"),valid:n("acef6"),clean:n("d2ef"),inc:n("0159"),diff:n("6b78"),major:n("4e14"),minor:n("c2d5"),patch:n("4ca4"),prerelease:n("8970"),compare:n("3034"),rcompare:n("b805"),compareLoose:n("b00b"),compareBuild:n("1cc6"),sort:n("2a2e"),rsort:n("6fa7"),gt:n("bac4"),lt:n("38fa"),eq:n("4392"),neq:n("f195"),gte:n("a2a3"),lte:n("68d3"),cmp:n("c4be"),coerce:n("0a67"),Comparator:n("6d43"),Range:n("3fce"),satisfies:n("2a86"),toComparators:n("7d63"),maxSatisfying:n("13af"),minSatisfying:n("fd90"),minVersion:n("86d4"),validRange:n("0982"),outside:n("38cb"),gtr:n("8bd6"),ltr:n("9b6c"),intersects:n("5237"),simplifyRange:n("f67c"),subset:n("c628")}},"4e14":function(e,t,n){const i=n("bbfd"),r=(e,t)=>new i(e,t).major;e.exports=r},5237:function(e,t,n){const i=n("3fce"),r=(e,t,n)=>(e=new i(e,n),t=new i(t,n),e.intersects(t));e.exports=r},"530a":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i=Math.PI/180,r=180/Math.PI},5644:function(e,t,n){"use strict";var i=n("3b4d"),r=n("d0ae"),o=n("29c8");function a(e,t){this._context=e,this._alpha=t}a.prototype={areaStart:r["a"],areaEnd:r["a"],lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Object(o["b"])(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["a"]=function e(t){function n(e){return t?new a(e,t):new i["a"](e,0)}return n.alpha=function(t){return e(+t)},n}(.5)},"5be2":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("eccb");function r(e,t,n){var i,r,o,a,s=e.x-t.x,u=e.y-t.y,c=s*s+u*u;c?(r=t.r+n.r,r*=r,a=e.r+n.r,a*=a,r>a?(i=(c+a-r)/(2*c),o=Math.sqrt(Math.max(0,a/c-i*i)),n.x=e.x-i*s-o*u,n.y=e.y-i*u+o*s):(i=(c+r-a)/(2*c),o=Math.sqrt(Math.max(0,r/c-i*i)),n.x=t.x+i*s-o*u,n.y=t.y+i*u+o*s)):(n.x=t.x+n.r,n.y=t.y)}function o(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function a(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,o=(t.y*n.r+n.y*t.r)/i;return r*r+o*o}function s(e){this._=e,this.next=null,this.previous=null}function u(e){if(!(c=e.length))return 0;var t,n,u,c,l,f,d,h,p,g,m;if(t=e[0],t.x=0,t.y=0,!(c>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(c>2))return t.r+n.r;r(n,t,u=e[2]),t=new s(t),n=new s(n),u=new s(u),t.next=u.previous=n,n.next=t.previous=u,u.next=n.previous=t;e:for(d=3;d<c;++d){r(t._,n._,u=e[d]),u=new s(u),h=n.next,p=t.previous,g=n._.r,m=t._.r;do{if(g<=m){if(o(h._,u._)){n=h,t.next=n,n.previous=t,--d;continue e}g+=h._.r,h=h.next}else{if(o(p._,u._)){t=p,t.next=n,n.previous=t,--d;continue e}m+=p._.r,p=p.previous}}while(h!==p.next);u.previous=t,u.next=n,t.next=n.previous=n=u,l=a(t);while((u=u.next)!==n)(f=a(u))<l&&(t=u,l=f);n=t.next}t=[n._],u=n;while((u=u.next)!==n)t.push(u._);for(u=Object(i["a"])(t),d=0;d<c;++d)t=e[d],t.x-=u.x,t.y-=u.y;return u.r}},"62f0":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return _}));var i=n("63ad"),r=n("166a"),o=n("530a"),a=18,s=.96422,u=1,c=.82521,l=4/29,f=6/29,d=3*f*f,h=f*f*f;function p(e){if(e instanceof m)return new m(e.l,e.a,e.b,e.opacity);if(e instanceof w)return j(e);e instanceof r["b"]||(e=Object(r["h"])(e));var t,n,i=x(e.r),o=x(e.g),a=x(e.b),l=v((.2225045*i+.7168786*o+.0606169*a)/u);return i===o&&o===a?t=n=l:(t=v((.4360747*i+.3850649*o+.1430804*a)/s),n=v((.0139322*i+.0971045*o+.7141733*a)/c)),new m(116*l-16,500*(t-l),200*(l-n),e.opacity)}function g(e,t,n,i){return 1===arguments.length?p(e):new m(e,t,n,null==i?1:i)}function m(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function v(e){return e>h?Math.pow(e,1/3):e/d+l}function b(e){return e>f?e*e*e:d*(e-l)}function y(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function x(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function O(e){if(e instanceof w)return new w(e.h,e.c,e.l,e.opacity);if(e instanceof m||(e=p(e)),0===e.a&&0===e.b)return new w(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*o["b"];return new w(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function _(e,t,n,i){return 1===arguments.length?O(e):new w(e,t,n,null==i?1:i)}function w(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function j(e){if(isNaN(e.h))return new m(e.l,0,0,e.opacity);var t=e.h*o["a"];return new m(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Object(i["a"])(m,g,Object(i["b"])(r["a"],{brighter:function(e){return new m(this.l+a*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new m(this.l-a*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=s*b(t),e=u*b(e),n=c*b(n),new r["b"](y(3.1338561*t-1.6168667*e-.4906146*n),y(-.9787684*t+1.9161415*e+.033454*n),y(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Object(i["a"])(w,_,Object(i["b"])(r["a"],{brighter:function(e){return new w(this.h,this.c,this.l+a*(null==e?1:e),this.opacity)},darker:function(e){return new w(this.h,this.c,this.l-a*(null==e?1:e),this.opacity)},rgb:function(){return j(this).rgb()}}))},"650c":function(e,t,n){"use strict";var i=n("eadc"),r=n("d8ad"),o=n("0986");function a(e){return e.innerRadius}function s(e){return e.outerRadius}function u(e){return e.startAngle}function c(e){return e.endAngle}function l(e){return e&&e.padAngle}function f(e,t,n,i,r,a,s,u){var c=n-e,l=i-t,f=s-r,d=u-a,h=d*c-f*l;if(!(h*h<o["f"]))return h=(f*(t-a)-d*(e-r))/h,[e+h*c,t+h*l]}function d(e,t,n,i,r,a,s){var u=e-n,c=t-i,l=(s?a:-a)/Object(o["l"])(u*u+c*c),f=l*c,d=-l*u,h=e+f,p=t+d,g=n+f,m=i+d,v=(h+g)/2,b=(p+m)/2,y=g-h,x=m-p,O=y*y+x*x,_=r-a,w=h*m-g*p,j=(x<0?-1:1)*Object(o["l"])(Object(o["h"])(0,_*_*O-w*w)),k=(w*x-y*j)/O,E=(-w*y-x*j)/O,A=(w*x+y*j)/O,D=(-w*y+x*j)/O,S=k-v,C=E-b,F=A-v,M=D-b;return S*S+C*C>F*F+M*M&&(k=A,E=D),{cx:k,cy:E,x01:-f,y01:-d,x11:k*(r/_-1),y11:E*(r/_-1)}}t["a"]=function(){var e=a,t=s,n=Object(r["a"])(0),h=null,p=u,g=c,m=l,v=null;function b(){var r,a,s=+e.apply(this,arguments),u=+t.apply(this,arguments),c=p.apply(this,arguments)-o["g"],l=g.apply(this,arguments)-o["g"],b=Object(o["a"])(l-c),y=l>c;if(v||(v=r=Object(i["a"])()),u<s&&(a=u,u=s,s=a),u>o["f"])if(b>o["m"]-o["f"])v.moveTo(u*Object(o["e"])(c),u*Object(o["k"])(c)),v.arc(0,0,u,c,l,!y),s>o["f"]&&(v.moveTo(s*Object(o["e"])(l),s*Object(o["k"])(l)),v.arc(0,0,s,l,c,y));else{var x,O,_=c,w=l,j=c,k=l,E=b,A=b,D=m.apply(this,arguments)/2,S=D>o["f"]&&(h?+h.apply(this,arguments):Object(o["l"])(s*s+u*u)),C=Object(o["i"])(Object(o["a"])(u-s)/2,+n.apply(this,arguments)),F=C,M=C;if(S>o["f"]){var $=Object(o["c"])(S/s*Object(o["k"])(D)),N=Object(o["c"])(S/u*Object(o["k"])(D));(E-=2*$)>o["f"]?($*=y?1:-1,j+=$,k-=$):(E=0,j=k=(c+l)/2),(A-=2*N)>o["f"]?(N*=y?1:-1,_+=N,w-=N):(A=0,_=w=(c+l)/2)}var T=u*Object(o["e"])(_),R=u*Object(o["k"])(_),z=s*Object(o["e"])(k),P=s*Object(o["k"])(k);if(C>o["f"]){var L,B=u*Object(o["e"])(w),I=u*Object(o["k"])(w),U=s*Object(o["e"])(j),q=s*Object(o["k"])(j);if(b<o["j"]&&(L=f(T,R,U,q,B,I,z,P))){var W=T-L[0],H=R-L[1],G=B-L[0],V=I-L[1],Y=1/Object(o["k"])(Object(o["b"])((W*G+H*V)/(Object(o["l"])(W*W+H*H)*Object(o["l"])(G*G+V*V)))/2),Z=Object(o["l"])(L[0]*L[0]+L[1]*L[1]);F=Object(o["i"])(C,(s-Z)/(Y-1)),M=Object(o["i"])(C,(u-Z)/(Y+1))}}A>o["f"]?M>o["f"]?(x=d(U,q,T,R,u,M,y),O=d(B,I,z,P,u,M,y),v.moveTo(x.cx+x.x01,x.cy+x.y01),M<C?v.arc(x.cx,x.cy,M,Object(o["d"])(x.y01,x.x01),Object(o["d"])(O.y01,O.x01),!y):(v.arc(x.cx,x.cy,M,Object(o["d"])(x.y01,x.x01),Object(o["d"])(x.y11,x.x11),!y),v.arc(0,0,u,Object(o["d"])(x.cy+x.y11,x.cx+x.x11),Object(o["d"])(O.cy+O.y11,O.cx+O.x11),!y),v.arc(O.cx,O.cy,M,Object(o["d"])(O.y11,O.x11),Object(o["d"])(O.y01,O.x01),!y))):(v.moveTo(T,R),v.arc(0,0,u,_,w,!y)):v.moveTo(T,R),s>o["f"]&&E>o["f"]?F>o["f"]?(x=d(z,P,B,I,s,-F,y),O=d(T,R,U,q,s,-F,y),v.lineTo(x.cx+x.x01,x.cy+x.y01),F<C?v.arc(x.cx,x.cy,F,Object(o["d"])(x.y01,x.x01),Object(o["d"])(O.y01,O.x01),!y):(v.arc(x.cx,x.cy,F,Object(o["d"])(x.y01,x.x01),Object(o["d"])(x.y11,x.x11),!y),v.arc(0,0,s,Object(o["d"])(x.cy+x.y11,x.cx+x.x11),Object(o["d"])(O.cy+O.y11,O.cx+O.x11),y),v.arc(O.cx,O.cy,F,Object(o["d"])(O.y11,O.x11),Object(o["d"])(O.y01,O.x01),!y))):v.arc(0,0,s,k,j,y):v.lineTo(z,P)}else v.moveTo(0,0);if(v.closePath(),r)return v=null,r+""||null}return b.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,i=(+p.apply(this,arguments)+ +g.apply(this,arguments))/2-o["j"]/2;return[Object(o["e"])(i)*n,Object(o["k"])(i)*n]},b.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:Object(r["a"])(+t),b):e},b.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:Object(r["a"])(+e),b):t},b.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:Object(r["a"])(+e),b):n},b.padRadius=function(e){return arguments.length?(h=null==e?null:"function"===typeof e?e:Object(r["a"])(+e),b):h},b.startAngle=function(e){return arguments.length?(p="function"===typeof e?e:Object(r["a"])(+e),b):p},b.endAngle=function(e){return arguments.length?(g="function"===typeof e?e:Object(r["a"])(+e),b):g},b.padAngle=function(e){return arguments.length?(m="function"===typeof e?e:Object(r["a"])(+e),b):m},b.context=function(e){return arguments.length?(v=null==e?null:e,b):v},b}},65827:function(e,t,n){"use strict";var i=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,t){var n,r,o;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),r=""===n?1/0:void 0===t.maxLength?80:t.maxLength,o=t.replacer,function e(t,a,s){var u,c,l,f,d,h,p,g,m,v,b,y;if(t&&"function"===typeof t.toJSON&&(t=t.toJSON()),b=JSON.stringify(t,o),void 0===b)return b;if(p=r-a.length-s,b.length<=p&&(m=b.replace(i,(function(e,t){return t||e+" "})),m.length<=p))return m;if(null!=o&&(t=JSON.parse(b),o=void 0),"object"===typeof t&&null!==t){if(g=a+n,l=[],c=0,Array.isArray(t))for(v="[",u="]",p=t.length;c<p;c++)l.push(e(t[c],g,c===p-1?0:1)||"null");else for(v="{",u="}",h=Object.keys(t),p=h.length;c<p;c++)f=h[c],d=JSON.stringify(f)+": ",y=e(t[f],g,d.length+(c===p-1?0:1)),void 0!==y&&l.push(d+y);if(l.length>0)return[v,n+l.join(",\n"+g),u].join("\n"+a)}return b}(e,"",0)}},6715:function(e,t,n){(function(t){var n=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var n,i,r;try{n=Map}catch(f){n=function(){}}try{i=Set}catch(f){i=function(){}}try{r=Promise}catch(f){r=function(){}}function o(a,s,u,c,f){"object"===typeof s&&(u=s.depth,c=s.prototype,f=s.includeNonEnumerable,s=s.circular);var d=[],h=[],p="undefined"!=typeof t;function g(a,u){if(null===a)return null;if(0===u)return a;var m,v;if("object"!=typeof a)return a;if(e(a,n))m=new n;else if(e(a,i))m=new i;else if(e(a,r))m=new r((function(e,t){a.then((function(t){e(g(t,u-1))}),(function(e){t(g(e,u-1))}))}));else if(o.__isArray(a))m=[];else if(o.__isRegExp(a))m=new RegExp(a.source,l(a)),a.lastIndex&&(m.lastIndex=a.lastIndex);else if(o.__isDate(a))m=new Date(a.getTime());else{if(p&&t.isBuffer(a))return m=t.allocUnsafe?t.allocUnsafe(a.length):new t(a.length),a.copy(m),m;e(a,Error)?m=Object.create(a):"undefined"==typeof c?(v=Object.getPrototypeOf(a),m=Object.create(v)):(m=Object.create(c),v=c)}if(s){var b=d.indexOf(a);if(-1!=b)return h[b];d.push(a),h.push(m)}for(var y in e(a,n)&&a.forEach((function(e,t){var n=g(t,u-1),i=g(e,u-1);m.set(n,i)})),e(a,i)&&a.forEach((function(e){var t=g(e,u-1);m.add(t)})),a){var x;v&&(x=Object.getOwnPropertyDescriptor(v,y)),x&&null==x.set||(m[y]=g(a[y],u-1))}if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(a);for(y=0;y<O.length;y++){var _=O[y],w=Object.getOwnPropertyDescriptor(a,_);(!w||w.enumerable||f)&&(m[_]=g(a[_],u-1),w.enumerable||Object.defineProperty(m,_,{enumerable:!1}))}}if(f){var j=Object.getOwnPropertyNames(a);for(y=0;y<j.length;y++){var k=j[y];w=Object.getOwnPropertyDescriptor(a,k);w&&w.enumerable||(m[k]=g(a[k],u-1),Object.defineProperty(m,k,{enumerable:!1}))}}return m}return"undefined"==typeof s&&(s=!0),"undefined"==typeof u&&(u=1/0),g(a,u)}function a(e){return Object.prototype.toString.call(e)}function s(e){return"object"===typeof e&&"[object Date]"===a(e)}function u(e){return"object"===typeof e&&"[object Array]"===a(e)}function c(e){return"object"===typeof e&&"[object RegExp]"===a(e)}function l(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return o.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},o.__objToStr=a,o.__isDate=s,o.__isArray=u,o.__isRegExp=c,o.__getRegExpFlags=l,o}();e.exports&&(e.exports=n)}).call(this,n("b639").Buffer)},"68d3":function(e,t,n){const i=n("3034"),r=(e,t,n)=>i(e,t,n)<=0;e.exports=r},"694b":function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),i=o.length,i!==Object.keys(n).length)return!1;for(r=i;0!==r--;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;0!==r--;){var a=o[r];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n}},"6b78":function(e,t,n){const i=n("a236"),r=n("4392"),o=(e,t)=>{if(r(e,t))return null;{const n=i(e),r=i(t),o=n.prerelease.length||r.prerelease.length,a=o?"pre":"",s=o?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==r[e])return a+e;return s}};e.exports=o},"6d43":function(e,t,n){const i=Symbol("SemVer ANY");class r{static get ANY(){return i}constructor(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===i?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?o[a.COMPARATORLOOSE]:o[a.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=i}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"===typeof e)try{e=new c(e,this.options)}catch(t){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new l(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new l(this.value,t).test(e.semver);const n=(">="===this.operator||">"===this.operator)&&(">="===e.operator||">"===e.operator),i=("<="===this.operator||"<"===this.operator)&&("<="===e.operator||"<"===e.operator),o=this.semver.version===e.semver.version,a=(">="===this.operator||"<="===this.operator)&&(">="===e.operator||"<="===e.operator),u=s(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=s(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&a||u||c}}e.exports=r;const{re:o,t:a}=n("8cb5"),s=n("c4be"),u=n("b802"),c=n("bbfd"),l=n("3fce")},"6fa7":function(e,t,n){const i=n("1cc6"),r=(e,t)=>e.sort((e,n)=>i(n,e,t));e.exports=r},7247:function(e,t){},7784:function(e,t,n){"use strict";var i=n("8c80");function r(e,t){this._basis=new i["a"](e),this._beta=t}r.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0){var i,r=e[0],o=t[0],a=e[n]-r,s=t[n]-o,u=-1;while(++u<=n)i=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(r+i*a),this._beta*t[u]+(1-this._beta)*(o+i*s))}this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}},t["a"]=function e(t){function n(e){return 1===t?new i["a"](e):new r(e,t)}return n.beta=function(t){return e(+t)},n}(.85)},7792:function(e,t,n){"use strict";function i(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function r(e,t){this._context=e,this._k=(1-t)/6}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:i(this,this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:i(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["b"]=function e(t){function n(e){return new r(e,t)}return n.tension=function(t){return e(+t)},n}(0)},"7ad3":function(e,t,n){"use strict";n.d(t,"default",(function(){return M}));var i,r=n("9ab4"),o=n("d733"),a=n("65827"),s=n.n(a),u=n("4d89"),c=n("037c"),l=n("2a83"),f=n("81ab"),d=n.n(f),h=n("4c60"),p=n("bca0"),g=n("276f"),m=n("fcc4"),v=n("d748"),b=n("c98b");n("7247");const y=c;let x=l;const O="undefined"!==typeof window?window:void 0;void 0===x&&(null===(i=null===O||void 0===O?void 0:O["vl"])||void 0===i?void 0:i.compile)&&(x=O["vl"]);const _={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},w={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},j={vega:"Vega","vega-lite":"Vega-Lite"},k={vega:y.version,"vega-lite":x?x.version:"not available"},E={vega:e=>e,"vega-lite":(e,t)=>x.compile(e,{config:t}).spec},A='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';function D(e){return"function"===typeof e}function S(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(r+e+o),a.document.title=j[i]+" JSON Source"}function C(e,t){var n;if(e.$schema){const i=d()(e.$schema);t&&t!==i.library&&console.warn(`The given visualization spec is written in ${j[i.library]}, but mode argument sets ${null!==(n=j[t])&&void 0!==n?n:t}.`);const r=i.library;return Object(u["satisfies"])(k[r],"^"+i.version.slice(1))||console.warn(`The input spec uses ${j[r]} ${i.version}, but the current version of ${j[r]} is v${k[r]}.`),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!==t&&void 0!==t?t:"vega"}function F(e){return!(!e||!("load"in e))}function M(e,t,n={}){var i,o,a;return Object(r["a"])(this,void 0,void 0,(function*(){const r=F(n.loader)?n.loader:y.loader(n.loader),s=Object(g["H"])(t)?JSON.parse(yield r.load(t)):t,u=yield $(null!==(i=s.usermeta&&s.usermeta["embedOptions"])&&void 0!==i?i:{},r),c=yield $(n,r),l=Object.assign(Object.assign({},Object(b["a"])(c,u)),{config:Object(g["N"])(null!==(o=c.config)&&void 0!==o?o:{},null!==(a=u.config)&&void 0!==a?a:{})});return yield N(e,s,l,r)}))}function $(e,t){var n;return Object(r["a"])(this,void 0,void 0,(function*(){const i=Object(g["H"])(e.config)?JSON.parse(yield t.load(e.config)):null!==(n=e.config)&&void 0!==n?n:{},r=Object(g["H"])(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),r?{patch:r}:{}),i?{config:i}:{})}))}function N(e,t,n={},i){var a,c,l,f,x,O;return Object(r["a"])(this,void 0,void 0,(function*(){const j=n.theme?Object(g["N"])(h[n.theme],null!==(a=n.config)&&void 0!==a?a:{}):n.config,F=Object(g["B"])(n.actions)?n.actions:Object(b["a"])({},_,null!==(c=n.actions)&&void 0!==c?c:{}),M=Object.assign(Object.assign({},w),n.i18n),$=null!==(l=n.renderer)&&void 0!==l?l:"canvas",N=null!==(f=n.logLevel)&&void 0!==f?f:y.Warn,T=null!==(x=n.downloadFileName)&&void 0!==x?x:"visualization";if(!1!==n.defaultStyle){const e="vega-embed-style";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?(null!==v["a"]&&void 0!==v["a"]?v["a"]:"").toString():n.defaultStyle,document.head.appendChild(t)}}const R=C(t,n.mode);let z=E[R](t,j);if("vega-lite"===R&&z.$schema){const e=d()(z.$schema);Object(u["satisfies"])(k.vega,"^"+e.version.slice(1))||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${k.vega}.`)}const P="string"===typeof e?document.querySelector(e):e;if(!P)throw Error(e+" does not exist");P.classList.add("vega-embed"),F&&P.classList.add("has-actions"),P.innerHTML="";const L=n.patch;L&&(z=L instanceof Function?L(z):Object(o["a"])(z,L,!0,!1).newDocument),n.formatLocale&&y.formatLocale(n.formatLocale),n.timeFormatLocale&&y.timeFormatLocale(n.timeFormatLocale);const{ast:B}=n,I=y.parse(z,"vega-lite"===R?{}:j,{ast:B}),U=new y.View(I,Object.assign({loader:i,logLevel:N,renderer:$},B?{expr:y.expressionInterpreter}:{}));if(!1!==n.tooltip){let e;e=D(n.tooltip)?n.tooltip:new p["a"](!0===n.tooltip?{}:n.tooltip).call,U.tooltip(e)}let q,{hover:W}=n;if(void 0===W&&(W="vega"===R),W){const{hoverSet:e,updateSet:t}="boolean"===typeof W?{}:W;U.hover(e,t)}if(n&&(null!=n.width&&U.width(n.width),null!=n.height&&U.height(n.height),null!=n.padding&&U.padding(n.padding)),yield U.initialize(e).runAsync(),!1!==F){let e=P;if(!1!==n.defaultStyle){const t=document.createElement("details");t.title=M.CLICK_TO_VIEW_ACTIONS,P.append(t),e=t;const n=document.createElement("summary");n.innerHTML=A,t.append(n),q=e=>{t.contains(e.target)||t.removeAttribute("open")},document.addEventListener("click",q)}const i=document.createElement("div");if(e.append(i),i.classList.add("vega-actions"),!0===F||!1!==F.export)for(const t of["svg","png"])if(!0===F||!0===F.export||F.export[t]){const e=M[t.toUpperCase()+"_ACTION"],o=document.createElement("a");o.text=e,o.href="#",o.target="_blank",o.download=`${T}.${t}`,o.addEventListener("mousedown",(function(e){return Object(r["a"])(this,void 0,void 0,(function*(){e.preventDefault();const i=yield U.toImageURL(t,n.scaleFactor);this.href=i}))})),i.append(o)}if(!0===F||!1!==F.source){const e=document.createElement("a");e.text=M.SOURCE_ACTION,e.href="#",e.addEventListener("click",(function(e){var i,r;S(s()(t),null!==(i=n.sourceHeader)&&void 0!==i?i:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"",R),e.preventDefault()})),i.append(e)}if("vega-lite"===R&&(!0===F||!1!==F.compiled)){const e=document.createElement("a");e.text=M.COMPILED_ACTION,e.href="#",e.addEventListener("click",(function(e){var t,i;S(s()(z),null!==(t=n.sourceHeader)&&void 0!==t?t:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"","vega"),e.preventDefault()})),i.append(e)}if(!0===F||!1!==F.editor){const e=null!==(O=n.editorUrl)&&void 0!==O?O:"https://vega.github.io/editor/",r=document.createElement("a");r.text=M.EDITOR_ACTION,r.href="#",r.addEventListener("click",(function(n){Object(m["a"])(window,e,{config:j,mode:R,renderer:$,spec:s()(t)}),n.preventDefault()})),i.append(r)}}function H(){q&&document.removeEventListener("click",q),U.finalize()}return{view:U,spec:t,vgSpec:z,finalize:H}}))}},"7bd6":function(e,t,n){"use strict";function i(e,t){this._context=e,this._t=t}function r(e){return new i(e,0)}function o(e){return new i(e,1)}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}this._x=e,this._y=t}},t["a"]=function(e){return new i(e,.5)}},"7d63":function(e,t,n){const i=n("3fce"),r=(e,t)=>new i(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "));e.exports=r},"81ab":function(e,t,n){"use strict";function i(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g,n=t.exec(e).slice(1,3),i=n[0],r=n[1];return{library:i,version:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},"860b":function(e,t,n){"use strict";var i=n("eae9"),r=n.n(i);r.a},"86d4":function(e,t,n){const i=n("bbfd"),r=n("3fce"),o=n("bac4"),a=(e,t)=>{e=new r(e,t);let n=new i("0.0.0");if(e.test(n))return n;if(n=new i("0.0.0-0"),e.test(n))return n;n=null;for(let r=0;r<e.set.length;++r){const t=e.set[r];t.forEach(e=>{const t=new i(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!o(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}return n&&e.test(n)?n:null};e.exports=a},8970:function(e,t,n){const i=n("a236"),r=(e,t)=>{const n=i(e,t);return n&&n.prerelease.length?n.prerelease:null};e.exports=r},"8af3":function(e,t,n){"use strict";t["a"]=function(e,t,n,i,r){var o,a,s=e.children,u=s.length,c=new Array(u+1);for(c[0]=a=o=0;o<u;++o)c[o+1]=a+=s[o].value;function l(e,t,n,i,r,o,a){if(e>=t-1){var u=s[e];return u.x0=i,u.y0=r,u.x1=o,void(u.y1=a)}var f=c[e],d=n/2+f,h=e+1,p=t-1;while(h<p){var g=h+p>>>1;c[g]<d?h=g+1:p=g}d-c[h-1]<c[h]-d&&e+1<h&&--h;var m=c[h]-f,v=n-m;if(o-i>a-r){var b=(i*v+o*m)/n;l(e,h,m,i,r,b,a),l(h,t,v,b,r,o,a)}else{var y=(r*v+a*m)/n;l(e,h,m,i,r,o,y),l(h,t,v,i,y,o,a)}}l(0,u,e.value,t,n,i,r)}},"8bd6":function(e,t,n){const i=n("38cb"),r=(e,t,n)=>i(e,t,">",n);e.exports=r},"8c80":function(e,t,n){"use strict";function i(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function r(e){this._context=e}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:i(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:i(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},t["b"]=function(e){return new r(e)}},"8cb5":function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:i}=n("b15c"),r=n("b802");t=e.exports={};const o=t.re=[],a=t.src=[],s=t.t={};let u=0;const c=(e,t,n)=>{const i=u++;r(i,t),s[e]=i,a[i]=t,o[i]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${a[s.NUMERICIDENTIFIER]}|${a[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${a[s.NUMERICIDENTIFIERLOOSE]}|${a[s.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${a[s.PRERELEASEIDENTIFIER]}(?:\\.${a[s.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${a[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[s.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${a[s.BUILDIDENTIFIER]}(?:\\.${a[s.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${a[s.MAINVERSION]}${a[s.PRERELEASE]}?${a[s.BUILD]}?`),c("FULL",`^${a[s.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${a[s.MAINVERSIONLOOSE]}${a[s.PRERELEASELOOSE]}?${a[s.BUILD]}?`),c("LOOSE",`^${a[s.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",a[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),c("XRANGEIDENTIFIER",a[s.NUMERICIDENTIFIER]+"|x|X|\\*"),c("XRANGEPLAIN",`[v=\\s]*(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:${a[s.PRERELEASE]})?${a[s.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:${a[s.PRERELEASELOOSE]})?${a[s.BUILD]}?)?)?`),c("XRANGE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?(?:$|[^\\d])`),c("COERCERTL",a[s.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${a[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${a[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${a[s.LONECARET]}${a[s.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${a[s.LONECARET]}${a[s.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${a[s.GTLT]}\\s*(${a[s.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]}|${a[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${a[s.XRANGEPLAIN]})\\s+-\\s+(${a[s.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${a[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[s.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},"8e31":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return p})),n.d(t,"f",(function(){return ct})),n.d(t,"c",(function(){return pt})),n.d(t,"e",(function(){return dt})),n.d(t,"d",(function(){return lt}));var i,r,o,a,s,u="RawCode",c="Literal",l="Property",f="Identifier",d="ArrayExpression",h="BinaryExpression",p="CallExpression",g="ConditionalExpression",m="LogicalExpression",v="MemberExpression",b="ObjectExpression",y="UnaryExpression";function x(e){this.type=e}function O(e){switch(e.type){case d:return e.elements;case h:case m:return[e.left,e.right];case p:var t=e.arguments.slice();return t.unshift(e.callee),t;case g:return[e.test,e.consequent,e.alternate];case v:return[e.object,e.property];case b:return e.properties;case l:return[e.key,e.value];case y:return[e.argument];case f:case c:case u:default:return[]}}x.prototype.visit=function(e){var t,n,i,r=this;if(e(r))return 1;for(t=O(r),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};var _=1,w=2,j=3,k=4,E=5,A=6,D=7,S=8,C=9;i={},i[_]="Boolean",i[w]="<end>",i[j]="Identifier",i[k]="Keyword",i[E]="Null",i[A]="Numeric",i[D]="Punctuator",i[S]="String",i[C]="RegularExpression";var F="ArrayExpression",M="BinaryExpression",$="CallExpression",N="ConditionalExpression",T="Identifier",R="Literal",z="LogicalExpression",P="MemberExpression",L="ObjectExpression",B="Property",I="UnaryExpression",U="Unexpected token %0",q="Unexpected number",W="Unexpected string",H="Unexpected identifier",G="Unexpected reserved word",V="Unexpected end of input",Y="Invalid regular expression",Z="Invalid regular expression: missing /",X="Octal literals are not allowed in strict mode.",J="Duplicate data property in object literal not allowed in strict mode",Q="ILLEGAL",K="Disabled.",ee=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),te=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function ne(e,t){if(!e)throw new Error("ASSERT: "+t)}function ie(e){return e>=48&&e<=57}function re(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function oe(e){return"01234567".indexOf(e)>=0}function ae(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function se(e){return 10===e||13===e||8232===e||8233===e}function ue(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&ee.test(String.fromCharCode(e))}function ce(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&te.test(String.fromCharCode(e))}var le={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function fe(){var e;while(o<a){if(e=r.charCodeAt(o),!ae(e)&&!se(e))break;++o}}function de(e){var t,n,i,s=0;for(n="u"===e?4:2,t=0;t<n;++t)o<a&&re(r[o])?(i=r[o++],s=16*s+"0123456789abcdef".indexOf(i.toLowerCase())):Be({},U,Q);return String.fromCharCode(s)}function he(){var e,t,n,i;e=r[o],t=0,"}"===e&&Be({},U,Q);while(o<a){if(e=r[o++],!re(e))break;t=16*t+"0123456789abcdef".indexOf(e.toLowerCase())}return(t>1114111||"}"!==e)&&Be({},U,Q),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),i=56320+(t-65536&1023),String.fromCharCode(n,i))}function pe(){var e,t;e=r.charCodeAt(o++),t=String.fromCharCode(e),92===e&&(117!==r.charCodeAt(o)&&Be({},U,Q),++o,e=de("u"),e&&"\\"!==e&&ue(e.charCodeAt(0))||Be({},U,Q),t=e);while(o<a){if(e=r.charCodeAt(o),!ce(e))break;++o,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==r.charCodeAt(o)&&Be({},U,Q),++o,e=de("u"),e&&"\\"!==e&&ce(e.charCodeAt(0))||Be({},U,Q),t+=e)}return t}function ge(){var e,t;e=o++;while(o<a){if(t=r.charCodeAt(o),92===t)return o=e,pe();if(!ce(t))break;++o}return r.slice(e,o)}function me(){var e,t,n;return e=o,t=92===r.charCodeAt(o)?pe():ge(),n=1===t.length?j:le.hasOwnProperty(t)?k:"null"===t?E:"true"===t||"false"===t?_:j,{type:n,value:t,start:e,end:o}}function ve(){var e,t,n,i,a=o,s=r.charCodeAt(o),u=r[o];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++o,{type:D,value:String.fromCharCode(s),start:a,end:o};default:if(e=r.charCodeAt(o+1),61===e)switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return o+=2,{type:D,value:String.fromCharCode(s)+String.fromCharCode(e),start:a,end:o};case 33:case 61:return o+=2,61===r.charCodeAt(o)&&++o,{type:D,value:r.slice(a,o),start:a,end:o}}}return i=r.substr(o,4),">>>="===i?(o+=4,{type:D,value:i,start:a,end:o}):(n=i.substr(0,3),">>>"===n||"<<="===n||">>="===n?(o+=3,{type:D,value:n,start:a,end:o}):(t=n.substr(0,2),u===t[1]&&"+-<>&|".indexOf(u)>=0||"=>"===t?(o+=2,{type:D,value:t,start:a,end:o}):"<>=!+-*%&|^/".indexOf(u)>=0?(++o,{type:D,value:u,start:a,end:o}):void Be({},U,Q)))}function be(e){var t="";while(o<a){if(!re(r[o]))break;t+=r[o++]}return 0===t.length&&Be({},U,Q),ue(r.charCodeAt(o))&&Be({},U,Q),{type:A,value:parseInt("0x"+t,16),start:e,end:o}}function ye(e){var t="0"+r[o++];while(o<a){if(!oe(r[o]))break;t+=r[o++]}return(ue(r.charCodeAt(o))||ie(r.charCodeAt(o)))&&Be({},U,Q),{type:A,value:parseInt(t,8),octal:!0,start:e,end:o}}function xe(){var e,t,n;if(n=r[o],ne(ie(n.charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=o,e="","."!==n){if(e=r[o++],n=r[o],"0"===e){if("x"===n||"X"===n)return++o,be(t);if(oe(n))return ye(t);n&&ie(n.charCodeAt(0))&&Be({},U,Q)}while(ie(r.charCodeAt(o)))e+=r[o++];n=r[o]}if("."===n){e+=r[o++];while(ie(r.charCodeAt(o)))e+=r[o++];n=r[o]}if("e"===n||"E"===n)if(e+=r[o++],n=r[o],"+"!==n&&"-"!==n||(e+=r[o++]),ie(r.charCodeAt(o)))while(ie(r.charCodeAt(o)))e+=r[o++];else Be({},U,Q);return ue(r.charCodeAt(o))&&Be({},U,Q),{type:A,value:parseFloat(e),start:t,end:o}}function Oe(){var e,t,n,i,s="",u=!1;e=r[o],ne("'"===e||'"'===e,"String literal must starts with a quote"),t=o,++o;while(o<a){if(n=r[o++],n===e){e="";break}if("\\"===n)if(n=r[o++],n&&se(n.charCodeAt(0)))"\r"===n&&"\n"===r[o]&&++o;else switch(n){case"u":case"x":"{"===r[o]?(++o,s+=he()):s+=de(n);break;case"n":s+="\n";break;case"r":s+="\r";break;case"t":s+="\t";break;case"b":s+="\b";break;case"f":s+="\f";break;case"v":s+="\v";break;default:oe(n)?(i="01234567".indexOf(n),0!==i&&(u=!0),o<a&&oe(r[o])&&(u=!0,i=8*i+"01234567".indexOf(r[o++]),"0123".indexOf(n)>=0&&o<a&&oe(r[o])&&(i=8*i+"01234567".indexOf(r[o++]))),s+=String.fromCharCode(i)):s+=n;break}else{if(se(n.charCodeAt(0)))break;s+=n}}return""!==e&&Be({},U,Q),{type:S,value:s,octal:u,start:t,end:o}}function _e(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";Be({},Y)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){Be({},Y)}try{return new RegExp(e,t)}catch(r){return null}}function we(){var e,t,n,i,s;e=r[o],ne("/"===e,"Regular expression literal must start with a slash"),t=r[o++],n=!1,i=!1;while(o<a)if(e=r[o++],t+=e,"\\"===e)e=r[o++],se(e.charCodeAt(0))&&Be({},Z),t+=e;else if(se(e.charCodeAt(0)))Be({},Z);else if(n)"]"===e&&(n=!1);else{if("/"===e){i=!0;break}"["===e&&(n=!0)}return i||Be({},Z),s=t.substr(1,t.length-2),{value:s,literal:t}}function je(){var e,t,n;t="",n="";while(o<a){if(e=r[o],!ce(e.charCodeAt(0)))break;++o,"\\"===e&&o<a?Be({},U,Q):(n+=e,t+=e)}return n.search(/[^gimuy]/g)>=0&&Be({},Y,n),{value:n,literal:t}}function ke(){var e,t,n,i;return s=null,fe(),e=o,t=we(),n=je(),i=_e(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:o}}function Ee(e){return e.type===j||e.type===k||e.type===_||e.type===E}function Ae(){var e;return fe(),o>=a?{type:w,start:o,end:o}:(e=r.charCodeAt(o),ue(e)?me():40===e||41===e||59===e?ve():39===e||34===e?Oe():46===e?ie(r.charCodeAt(o+1))?xe():ve():ie(e)?xe():ve())}function De(){var e;return e=s,o=e.end,s=Ae(),o=e.end,e}function Se(){var e;e=o,s=Ae(),o=e}function Ce(e){var t=new x(F);return t.elements=e,t}function Fe(e,t,n){var i=new x("||"===e||"&&"===e?z:M);return i.operator=e,i.left=t,i.right=n,i}function Me(e,t){var n=new x($);return n.callee=e,n.arguments=t,n}function $e(e,t,n){var i=new x(N);return i.test=e,i.consequent=t,i.alternate=n,i}function Ne(e){var t=new x(T);return t.name=e,t}function Te(e){var t=new x(R);return t.value=e.value,t.raw=r.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Re(e,t,n){var i=new x(P);return i.computed="["===e,i.object=t,i.property=n,i.computed||(n.member=!0),i}function ze(e){var t=new x(L);return t.properties=e,t}function Pe(e,t,n){var i=new x(B);return i.key=t,i.value=n,i.kind=e,i}function Le(e,t){var n=new x(I);return n.operator=e,n.argument=t,n.prefix=!0,n}function Be(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(function(e,t){return ne(t<i.length,"Message reference must be in range"),i[t]}));throw n=new Error(r),n.index=o,n.description=r,n}function Ie(e){e.type===w&&Be(e,V),e.type===A&&Be(e,q),e.type===S&&Be(e,W),e.type===j&&Be(e,H),e.type===k&&Be(e,G),Be(e,U,e.value)}function Ue(e){var t=De();t.type===D&&t.value===e||Ie(t)}function qe(e){return s.type===D&&s.value===e}function We(e){return s.type===k&&s.value===e}function He(){var e=[];o=s.start,Ue("[");while(!qe("]"))qe(",")?(De(),e.push(null)):(e.push(st()),qe("]")||Ue(","));return De(),Ce(e)}function Ge(){var e;return o=s.start,e=De(),e.type===S||e.type===A?(e.octal&&Be(e,X),Te(e)):Ne(e.value)}function Ve(){var e,t,n,i;return o=s.start,e=s,e.type===j?(n=Ge(),Ue(":"),i=st(),Pe("init",n,i)):e.type!==w&&e.type!==D?(t=Ge(),Ue(":"),i=st(),Pe("init",t,i)):void Ie(e)}function Ye(){var e,t,n,i=[],r={},a=String;o=s.start,Ue("{");while(!qe("}"))e=Ve(),t=e.key.type===T?e.key.name:a(e.key.value),n="$"+t,Object.prototype.hasOwnProperty.call(r,n)?Be({},J):r[n]=!0,i.push(e),qe("}")||Ue(",");return Ue("}"),ze(i)}function Ze(){var e;return Ue("("),e=ut(),Ue(")"),e}var Xe={if:1};function Je(){var e,t,n;if(qe("("))return Ze();if(qe("["))return He();if(qe("{"))return Ye();if(e=s.type,o=s.start,e===j||Xe[s.value])n=Ne(De().value);else if(e===S||e===A)s.octal&&Be(s,X),n=Te(De());else{if(e===k)throw new Error(K);e===_?(t=De(),t.value="true"===t.value,n=Te(t)):e===E?(t=De(),t.value=null,n=Te(t)):qe("/")||qe("/=")?(n=Te(ke()),Se()):Ie(De())}return n}function Qe(){var e=[];if(Ue("("),!qe(")"))while(o<a){if(e.push(st()),qe(")"))break;Ue(",")}return Ue(")"),e}function Ke(){var e;return o=s.start,e=De(),Ee(e)||Ie(e),Ne(e.value)}function et(){return Ue("."),Ke()}function tt(){var e;return Ue("["),e=ut(),Ue("]"),e}function nt(){var e,t,n;for(e=Je();;)if(qe("."))n=et(),e=Re(".",e,n);else if(qe("("))t=Qe(),e=Me(e,t);else{if(!qe("["))break;n=tt(),e=Re("[",e,n)}return e}function it(){var e=nt();if(s.type===D&&(qe("++")||qe("--")))throw new Error(K);return e}function rt(){var e,t;if(s.type!==D&&s.type!==k)t=it();else{if(qe("++")||qe("--"))throw new Error(K);if(qe("+")||qe("-")||qe("~")||qe("!"))e=De(),t=rt(),t=Le(e.value,t);else{if(We("delete")||We("void")||We("typeof"))throw new Error(K);t=it()}}return t}function ot(e){var t=0;if(e.type!==D&&e.type!==k)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break;default:break}return t}function at(){var e,t,n,i,r,o,a,u,c,l;if(e=s,c=rt(),i=s,r=ot(i),0===r)return c;i.prec=r,De(),t=[e,s],a=rt(),o=[c,i,a];while((r=ot(s))>0){while(o.length>2&&r<=o[o.length-2].prec)a=o.pop(),u=o.pop().value,c=o.pop(),t.pop(),n=Fe(u,c,a),o.push(n);i=De(),i.prec=r,o.push(i),t.push(s),n=rt(),o.push(n)}l=o.length-1,n=o[l],t.pop();while(l>1)t.pop(),n=Fe(o[l-1].value,o[l-2],n),l-=2;return n}function st(){var e,t,n;return e=at(),qe("?")&&(De(),t=st(),Ue(":"),n=st(),e=$e(e,t,n)),e}function ut(){var e=st();if(qe(","))throw new Error(K);return e}var ct=function(e){r=e,o=0,a=r.length,s=null,Se();var t=ut();if(s.type!==w)throw new Error("Unexpect token after expression.");return t},lt={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},ft=n("276f"),dt=function(e){function t(t,n,i,r){var o=e(n[0]);return i&&(o=i+"("+o+")",0===i.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+t+(r<0?"":0===r?"()":"("+n.slice(1).map(e).join(",")+")")}function n(e,n,i){return function(r){return t(e,r,n,i)}}var i="new Date",r="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&Object(ft["n"])("Missing arguments to clamp function."),t.length>3&&Object(ft["n"])("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),replace:n("replace",r),trim:n("trim",r,0),regexp:o,test:n("test",o),if:function(t){t.length<3&&Object(ft["n"])("Missing arguments to if function."),t.length>3&&Object(ft["n"])("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}};function ht(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}var pt=function(e){e=e||{};var t=e.whitelist?Object(ft["db"])(e.whitelist):{},n=e.blacklist?Object(ft["db"])(e.blacklist):{},i=e.constants||lt,r=(e.functions||dt)(f),o=e.globalvar,a=e.fieldvar,s={},u={},c=0,l=Object(ft["D"])(o)?o:function(e){return o+'["'+e+'"]'};function f(e){if(Object(ft["H"])(e))return e;var t=d[e.type];return null==t&&Object(ft["n"])("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var r=e.name;return c>0?r:Object(ft["v"])(n,r)?Object(ft["n"])("Illegal identifier: "+r):Object(ft["v"])(i,r)?i[r]:Object(ft["v"])(t,r)?r:(s[r]=1,l(r))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(c+=1);var i=f(e.property);return n===a&&(u[ht(i)]=1),t&&(c-=1),n+(t?"."+i:"["+i+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&Object(ft["n"])("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,i=Object(ft["v"])(r,t)&&r[t];return i||Object(ft["n"])("Unrecognized function: "+t),Object(ft["D"])(i)?i(n):i+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){c+=1;var t=f(e.key);return c-=1,t+":"+f(e.value)}};function h(e){var t={code:f(e),globals:Object.keys(s),fields:Object.keys(u)};return s={},u={},t}return h.functions=r,h.constants=i,h}},9150:function(e,t,n){"use strict";var i=n("eadc"),r=n("1af0"),o=n("a0ac"),a=n("9ace"),s=n("0803"),u=n("d5a7"),c=n("ae40"),l=n("c494"),f=n("d8ad");r["a"],o["a"],a["a"],u["a"],s["a"],c["a"],l["a"];t["a"]=function(){var e=Object(f["a"])(r["a"]),t=Object(f["a"])(64),n=null;function o(){var r;if(n||(n=r=Object(i["a"])()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return o.type=function(t){return arguments.length?(e="function"===typeof t?t:Object(f["a"])(t),o):e},o.size=function(e){return arguments.length?(t="function"===typeof e?e:Object(f["a"])(+e),o):t},o.context=function(e){return arguments.length?(n=null==e?null:e,o):n},o}},9152:function(e,t){t.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?r-1:0,d=n?-1:1,h=e[t+f];for(f+=d,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=d,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=i;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,i),o-=c}return(h?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var a,s,u,c=8*o-r-1,l=(1<<c)-1,f=l>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,h=i?0:o-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),t+=a+f>=1?d/u:d*Math.pow(2,1-f),t*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,r),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,r),a=0));r>=8;e[n+h]=255&s,h+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+h]=255&a,h+=p,a/=256,c-=8);e[n+h-p]|=128*g}},"9ace":function(e,t,n){"use strict";var i=Math.sqrt(1/3),r=2*i;t["a"]={draw:function(e,t){var n=Math.sqrt(t/r),o=n*i;e.moveTo(0,-n),e.lineTo(o,0),e.lineTo(0,n),e.lineTo(-o,0),e.closePath()}}},"9ae6":function(e,t,n){"use strict";var i=n("d0ae"),r=n("8c80");function o(e){this._context=e}o.prototype={areaStart:i["a"],areaEnd:i["a"],lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Object(r["c"])(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},t["a"]=function(e){return new o(e)}},"9b0d":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n("276f");function r(t){return!("function"!==typeof e||!Object(i["D"])(e.isBuffer))&&e.isBuffer(t)}function o(e,t){const n=t&&t.property?Object(i["t"])(t.property):i["x"];return Object(i["F"])(e)&&!r(e)?a(n(e)):n(JSON.parse(e))}function a(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}o.responseType="json"}).call(this,n("b639").Buffer)},"9b6c":function(e,t,n){const i=n("38cb"),r=(e,t,n)=>i(e,t,"<",n);e.exports=r},a0ac:function(e,t,n){"use strict";t["a"]={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}}},a236:function(e,t,n){const{MAX_LENGTH:i}=n("b15c"),{re:r,t:o}=n("8cb5"),a=n("bbfd"),s=(e,t)=>{if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof a)return e;if("string"!==typeof e)return null;if(e.length>i)return null;const n=t.loose?r[o.LOOSE]:r[o.FULL];if(!n.test(e))return null;try{return new a(e,t)}catch(s){return null}};e.exports=s},a2a3:function(e,t,n){const i=n("3034"),r=(e,t,n)=>i(e,t,n)>=0;e.exports=r},a43d:function(e,t,n){"use strict";n.r(t),n.d(t,"interpolate",(function(){return i["a"]})),n.d(t,"interpolateArray",(function(){return r["a"]})),n.d(t,"interpolateBasis",(function(){return o["b"]})),n.d(t,"interpolateBasisClosed",(function(){return a["a"]})),n.d(t,"interpolateDate",(function(){return s["a"]})),n.d(t,"interpolateDiscrete",(function(){return u})),n.d(t,"interpolateHue",(function(){return l})),n.d(t,"interpolateNumber",(function(){return f["a"]})),n.d(t,"interpolateNumberArray",(function(){return d["a"]})),n.d(t,"interpolateObject",(function(){return h["a"]})),n.d(t,"interpolateRound",(function(){return p["a"]})),n.d(t,"interpolateString",(function(){return g["a"]})),n.d(t,"interpolateTransformCss",(function(){return m["a"]})),n.d(t,"interpolateTransformSvg",(function(){return m["b"]})),n.d(t,"interpolateZoom",(function(){return v["a"]})),n.d(t,"interpolateRgb",(function(){return b["a"]})),n.d(t,"interpolateRgbBasis",(function(){return b["b"]})),n.d(t,"interpolateRgbBasisClosed",(function(){return b["c"]})),n.d(t,"interpolateHsl",(function(){return O})),n.d(t,"interpolateHslLong",(function(){return _})),n.d(t,"interpolateLab",(function(){return j})),n.d(t,"interpolateHcl",(function(){return E})),n.d(t,"interpolateHclLong",(function(){return A})),n.d(t,"interpolateCubehelix",(function(){return U})),n.d(t,"interpolateCubehelixLong",(function(){return q})),n.d(t,"piecewise",(function(){return W["a"]})),n.d(t,"quantize",(function(){return H}));var i=n("ea1d"),r=n("6730"),o=n("c84a"),a=n("4bcd"),s=n("1b6d"),u=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},c=n("b055"),l=function(e,t){var n=Object(c["c"])(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},f=n("e317"),d=n("51de"),h=n("71bd"),p=n("5857"),g=n("90ef"),m=n("4b79"),v=n("ce75"),b=n("e360"),y=n("166a");function x(e){return function(t,n){var i=e((t=Object(y["f"])(t)).h,(n=Object(y["f"])(n)).h),r=Object(c["a"])(t.s,n.s),o=Object(c["a"])(t.l,n.l),a=Object(c["a"])(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=r(e),t.l=o(e),t.opacity=a(e),t+""}}}var O=x(c["c"]),_=x(c["a"]),w=n("62f0");function j(e,t){var n=Object(c["a"])((e=Object(w["a"])(e)).l,(t=Object(w["a"])(t)).l),i=Object(c["a"])(e.a,t.a),r=Object(c["a"])(e.b,t.b),o=Object(c["a"])(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}}function k(e){return function(t,n){var i=e((t=Object(w["b"])(t)).h,(n=Object(w["b"])(n)).h),r=Object(c["a"])(t.c,n.c),o=Object(c["a"])(t.l,n.l),a=Object(c["a"])(t.opacity,n.opacity);return function(e){return t.h=i(e),t.c=r(e),t.l=o(e),t.opacity=a(e),t+""}}}var E=k(c["c"]),A=k(c["a"]),D=n("63ad"),S=n("530a"),C=-.14861,F=1.78277,M=-.29227,$=-.90649,N=1.97294,T=N*$,R=N*F,z=F*M-$*C;function P(e){if(e instanceof B)return new B(e.h,e.s,e.l,e.opacity);e instanceof y["b"]||(e=Object(y["h"])(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(z*i+T*t-R*n)/(z+T-R),o=i-r,a=(N*(n-r)-M*o)/$,s=Math.sqrt(a*a+o*o)/(N*r*(1-r)),u=s?Math.atan2(a,o)*S["b"]-120:NaN;return new B(u<0?u+360:u,s,r,e.opacity)}function L(e,t,n,i){return 1===arguments.length?P(e):new B(e,t,n,null==i?1:i)}function B(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function I(e){return function t(n){function i(t,i){var r=e((t=L(t)).h,(i=L(i)).h),o=Object(c["a"])(t.s,i.s),a=Object(c["a"])(t.l,i.l),s=Object(c["a"])(t.opacity,i.opacity);return function(e){return t.h=r(e),t.s=o(e),t.l=a(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,i.gamma=t,i}(1)}Object(D["a"])(B,L,Object(D["b"])(y["a"],{brighter:function(e){return e=null==e?y["c"]:Math.pow(y["c"],e),new B(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?y["d"]:Math.pow(y["d"],e),new B(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*S["a"],t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new y["b"](255*(t+n*(C*i+F*r)),255*(t+n*(M*i+$*r)),255*(t+n*(N*i)),this.opacity)}}));var U=I(c["c"]),q=I(c["a"]),W=n("ac0c"),H=function(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}},a4bd:function(e,t,n){"use strict";function i(e){return e<0?-1:1}function r(e,t,n){var r=e._x1-e._x0,o=t-e._x1,a=(e._y1-e._y0)/(r||o<0&&-0),s=(n-e._y1)/(o||r<0&&-0),u=(a*o+s*r)/(r+o);return(i(a)+i(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(u))||0}function o(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function a(e,t,n){var i=e._x0,r=e._y0,o=e._x1,a=e._y1,s=(o-i)/3;e._context.bezierCurveTo(i+s,r+s*t,o-s,a-s*n,o,a)}function s(e){this._context=e}function u(e){this._context=new c(e)}function c(e){this._context=e}function l(e){return new s(e)}function f(e){return new u(e)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),s.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:a(this,this._t0,o(this,this._t0));break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,e!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,a(this,o(this,n=r(this,e,t)),n);break;default:a(this,this._t0,n=r(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(u.prototype=Object.create(s.prototype)).point=function(e,t){s.prototype.point.call(this,t,e)},c.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,o){this._context.bezierCurveTo(t,e,i,n,o,r)}}},a84d:function(e,t,n){"use strict";function i(e){this._context=e}function r(e){var t,n,i=e.length-1,r=new Array(i),o=new Array(i),a=new Array(i);for(r[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<i-1;++t)r[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(r[i-1]=2,o[i-1]=7,a[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)n=r[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(r[i-1]=a[i-1]/o[i-1],t=i-2;t>=0;--t)r[t]=(a[t]-r[t+1])/o[t];for(o[i-1]=(e[i]+r[i-1])/2,t=0;t<i-1;++t)o[t]=2*e[t+1]-r[t+1];return[r,o]}i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=r(e),o=r(t),a=0,s=1;s<n;++a,++s)this._context.bezierCurveTo(i[0][a],o[0][a],i[1][a],o[1][a],e[s],t[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},t["a"]=function(e){return new i(e)}},a87b:function(e){e.exports=JSON.parse('{"name":"vega-lite","author":"Dominik Moritz, Kanit \\"Ham\\" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer","version":"4.13.1","collaborators":["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],"homepage":"https://vega.github.io/vega-lite/","description":"Vega-Lite is a concise high-level language for interactive visualization.","main":"build/vega-lite.js","unpkg":"build/vega-lite.min.js","jsdelivr":"build/vega-lite.min.js","module":"build/src/index","types":"build/src/index.d.ts","bin":{"vl2png":"./bin/vl2png","vl2svg":"./bin/vl2svg","vl2pdf":"./bin/vl2pdf","vl2vg":"./bin/vl2vg"},"directories":{"test":"test"},"scripts":{"changelog":"conventional-changelog -p angular -r 2","build":"yarn build:only","build:only":"yarn tsc:src && rollup -c","postbuild":"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh","clean":"find build ! -name \'vega-lite-schema.json\' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name \'index.md\' ! -name \'data\' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site","data":"rsync -r node_modules/vega-datasets/data/* site/data","schema":"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/","renameschema":"scripts/rename-schema.sh","presite":"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh","site":"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json","prettierbase":"prettier \'**/*.{md,css,yml}\'","eslintbase":"eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","test":"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup \'yarn tsc:src -w\' \'rollup -c -w\'","watch:site":"concurrently --kill-others -n Typescript,Rollup \'yarn tsc:site -w\' \'rollup -c site/rollup.config.js -w\'","watch:test":"jest --watch"},"repository":{"type":"git","url":"https://github.com/vega/vega-lite.git"},"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-lite/issues"},"devDependencies":{"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2","ajv":"^6.12.2","chai":"^4.2.0","cheerio":"^1.0.0-rc.3","codecov":"^3.7.0","concurrently":"^5.2.0","conventional-changelog-cli":"^2.0.34","d3":"^5.16.0","eslint":"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3","jest":"^26.0.1","jest-puppeteer":"^4.4.0","mkdirp":"^1.0.4","prettier":"^2.0.5","puppeteer":"^3.1.0","rollup":"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7","terser":"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1","typescript":"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},"dependencies":{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1","clone":"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0","tslib":"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0","yargs":"~15.3.1"},"peerDependencies":{"vega":"^5.12.1"},"jest":{"preset":"jest-puppeteer","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],"coverageDirectory":"./coverage/","collectCoverage":false}}')},ab0f:function(e){e.exports=JSON.parse('{"name":"vega-themes","version":"2.8.3","description":"Themes for stylized Vega and Vega-Lite visualizations.","keywords":["vega","vega-lite","themes","style"],"license":"BSD-3-Clause","author":{"name":"UW Interactive Data Lab","url":"https://idl.cs.washington.edu"},"contributors":[{"name":"Emily Gu","url":"https://github.com/emilygu"},{"name":"Arvind Satyanarayan","url":"http://arvindsatya.com"},{"name":"Jeffrey Heer","url":"https://idl.cs.washington.edu"},{"name":"Dominik Moritz","url":"https://www.domoritz.de"}],"main":"build/vega-themes.js","module":"build/src/index.js","unpkg":"build/vega-themes.min.js","jsdelivr":"build/vega-themes.min.js","typings":"build/src/index.d.ts","repository":{"type":"git","url":"https://github.com/vega/vega-themes.git"},"scripts":{"prepare":"beemo create-config --silent","clean":"rm -rf build examples/build","prettierbase":"beemo prettier \'examples/*.{html,scss,css}\'","eslintbase":"beemo eslint \'src/**/*.ts\'","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","prebuild":"mkdir -p build","build":"tsc && rollup -c","postbuild":"terser build/vega-themes.js -cm > build/vega-themes.min.js","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples","prepublishOnly":"yarn clean && yarn build","preversion":"yarn lint","serve":"browser-sync start -s -f build examples --serveStatic examples","start":"yarn build && concurrently --kill-others -n Server,Typescript,Rollup \'yarn serve\' \'tsc -w\' \'rollup -c -w\'"},"devDependencies":{"@rollup/plugin-json":"^4.0.2","browser-sync":"^2.26.7","concurrently":"^5.1.0","gh-pages":"^2.2.0","rollup":"^2.1.0","terser":"^4.6.7","typescript":"^3.8.3","vega":"^5.10.0","vega-lite":"^4.8.1","vega-lite-dev-config":"^0.5.0"},"peerDependencies":{"vega":"*","vega-lite":"*"},"beemo":{"module":"vega-lite-dev-config","drivers":["prettier","eslint"]}}')},ac0c:function(e,t,n){"use strict";function i(e,t){var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);while(n<i)o[n]=e(r,r=t[++n]);return function(e){var t=Math.max(0,Math.min(i-1,Math.floor(e*=i)));return o[t](e-t)}}n.d(t,"a",(function(){return i}))},acef6:function(e,t,n){const i=n("a236"),r=(e,t)=>{const n=i(e,t);return n?n.version:null};e.exports=r},ae40:function(e,t,n){"use strict";var i=Math.sqrt(3);t["a"]={draw:function(e,t){var n=-Math.sqrt(t/(3*i));e.moveTo(0,2*n),e.lineTo(-i*n,-n),e.lineTo(i*n,-n),e.closePath()}}},b00b:function(e,t,n){const i=n("3034"),r=(e,t)=>i(e,t,!0);e.exports=r},b0ad:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("7792");function r(e,t){this._context=e,this._k=(1-t)/6}r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Object(i["c"])(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}},t["b"]=function e(t){function n(e){return new r(e,t)}return n.tension=function(t){return e(+t)},n}(0)},b15c:function(e,t){const n="2.0.0",i=256,r=Number.MAX_SAFE_INTEGER||9007199254740991,o=16;e.exports={SEMVER_SPEC_VERSION:n,MAX_LENGTH:i,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:o}},b639:function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n("1fb5"),r=n("9152"),o=n("e3db");function a(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=c.prototype):(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,n)}function l(e,t,n,i){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?m(e,t,n,i):"string"===typeof t?p(e,t,n):v(e,t)}function f(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t,n,i){return f(t),t<=0?u(e,t):void 0!==n?"string"===typeof i?u(e,t).fill(n,i):u(e,t).fill(n):u(e,t)}function h(e,t){if(f(t),e=u(e,t<0?0:0|b(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t,n){if("string"===typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|x(t,n);e=u(e,i);var r=e.write(t,n);return r!==i&&(e=e.slice(0,r)),e}function g(e,t){var n=t.length<0?0:0|b(t.length);e=u(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function m(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),c.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=c.prototype):e=g(e,t),e}function v(e,t){if(c.isBuffer(t)){var n=0|b(t.length);return e=u(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||te(t.length)?u(e,0):g(e,t);if("Buffer"===t.type&&o(t.data))return g(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function y(e){return+e!=e&&(e=0),c.alloc(+e)}function x(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return K(e).length;default:if(i)return X(e).length;t=(""+t).toLowerCase(),i=!0}}function O(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return z(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return F(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function _(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function w(e,t,n,i,r){if(0===e.length)return-1;if("string"===typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"===typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:j(e,t,n,i,r);if("number"===typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):j(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function j(e,t,n,i,r){var o,a=1,s=e.length,u=t.length;if(void 0!==i&&(i=String(i).toLowerCase(),"ucs2"===i||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var l=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,d=0;d<u;d++)if(c(e,o+d)!==c(t,d)){f=!1;break}if(f)return o}return-1}function k(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i),i>r&&(i=r)):i=r;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function E(e,t,n,i){return ee(X(t,e.length-n),e,n,i)}function A(e,t,n,i){return ee(J(t),e,n,i)}function D(e,t,n,i){return A(e,t,n,i)}function S(e,t,n,i){return ee(K(t),e,n,i)}function C(e,t,n,i){return ee(Q(t,e.length-n),e,n,i)}function F(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);var i=[],r=t;while(r<n){var o,a,s,u,c=e[r],l=null,f=c>239?4:c>223?3:c>191?2:1;if(r+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:o=e[r+1],128===(192&o)&&(u=(31&c)<<6|63&o,u>127&&(l=u));break;case 3:o=e[r+1],a=e[r+2],128===(192&o)&&128===(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a,u>2047&&(u<55296||u>57343)&&(l=u));break;case 4:o=e[r+1],a=e[r+2],s=e[r+3],128===(192&o)&&128===(192&a)&&128===(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s,u>65535&&u<1114112&&(l=u))}null===l?(l=65533,f=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),r+=f}return N(i)}t.Buffer=c,t.SlowBuffer=y,t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:a(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return d(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=c.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},c.byteLength=x,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):O.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,i,r){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,r>>>=0,this===e)return 0;for(var o=r-i,a=n-t,s=Math.min(o,a),u=this.slice(i,r),l=e.slice(t,n),f=0;f<s;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return w(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return w(this,e,t,n,!1)},c.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return k(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return D(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;function N(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);var n="",i=0;while(i<t)n+=String.fromCharCode.apply(String,e.slice(i,i+=$));return n}function T(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function R(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function z(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=Z(e[o]);return r}function P(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function L(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,i,r,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function I(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function U(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function q(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(e,t,n,i,o){return o||q(e,t,n,4,34028234663852886e22,-34028234663852886e22),r.write(e,t,n,i,23,4),n+4}function H(e,t,n,i,o){return o||q(e,t,n,8,17976931348623157e292,-17976931348623157e292),r.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){var n,i=this.length;if(e=~~e,t=void 0===t?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=c.prototype;else{var r=t-e;n=new c(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);var i=this[e],r=1,o=0;while(++o<t&&(r*=256))i+=this[e+o]*r;return i},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);var i=this[e+--t],r=1;while(t>0&&(r*=256))i+=this[e+--t]*r;return i},c.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);var i=this[e],r=1,o=0;while(++o<t&&(r*=256))i+=this[e+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);var i=t,r=1,o=this[e+--i];while(i>0&&(r*=256))o+=this[e+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;B(this,e,t,n,r,0)}var o=1,a=0;this[t]=255&e;while(++a<n&&(o*=256))this[t+a]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;B(this,e,t,n,r,0)}var o=n-1,a=1;this[t+o]=255&e;while(--o>=0&&(a*=256))this[t+o]=e/a&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);B(this,e,t,n,r-1,-r)}var o=0,a=1,s=0;this[t]=255&e;while(++o<n&&(a*=256))e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);B(this,e,t,n,r-1,-r)}var o=n-1,a=1,s=0;this[t+o]=255&e;while(--o>=0&&(a*=256))e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return W(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return W(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return H(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return H(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,i){if("string"===typeof e){if("string"===typeof t?(i=t,t=0,n=this.length):"string"===typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!==typeof i)throw new TypeError("encoding must be a string");if("string"===typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=c.isBuffer(e)?e:X(new c(e,i).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var G=/[^+\/0-9A-Za-z-_]/g;function V(e){if(e=Y(e).replace(G,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function Y(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Z(e){return e<16?"0"+e.toString(16):e.toString(16)}function X(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],a=0;a<i;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function J(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Q(e,t){for(var n,i,r,o=[],a=0;a<e.length;++a){if((t-=2)<0)break;n=e.charCodeAt(a),i=n>>8,r=n%256,o.push(r),o.push(i)}return o}function K(e){return i.toByteArray(V(e))}function ee(e,t,n,i){for(var r=0;r<i;++r){if(r+n>=t.length||r>=e.length)break;t[r+n]=e[r]}return r}function te(e){return e!==e}}).call(this,n("c8ba"))},b6f4:function(e,t,n){"use strict";var i=n("0dd4"),r=n("2388"),o=n("21e5"),a=n("092b");t["a"]=function(){var e=r["a"],t=!1,n=1,s=1,u=[0],c=a["a"],l=a["a"],f=a["a"],d=a["a"],h=a["a"];function p(e){return e.x0=e.y0=0,e.x1=n,e.y1=s,e.eachBefore(g),u=[0],t&&e.eachBefore(i["a"]),e}function g(t){var n=u[t.depth],i=t.x0+n,r=t.y0+n,o=t.x1-n,a=t.y1-n;o<i&&(i=o=(i+o)/2),a<r&&(r=a=(r+a)/2),t.x0=i,t.y0=r,t.x1=o,t.y1=a,t.children&&(n=u[t.depth+1]=c(t)/2,i+=h(t)-n,r+=l(t)-n,o-=f(t)-n,a-=d(t)-n,o<i&&(i=o=(i+o)/2),a<r&&(r=a=(r+a)/2),e(t,i,r,o,a))}return p.round=function(e){return arguments.length?(t=!!e,p):t},p.size=function(e){return arguments.length?(n=+e[0],s=+e[1],p):[n,s]},p.tile=function(t){return arguments.length?(e=Object(o["b"])(t),p):e},p.padding=function(e){return arguments.length?p.paddingInner(e).paddingOuter(e):p.paddingInner()},p.paddingInner=function(e){return arguments.length?(c="function"===typeof e?e:Object(a["b"])(+e),p):c},p.paddingOuter=function(e){return arguments.length?p.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):p.paddingTop()},p.paddingTop=function(e){return arguments.length?(l="function"===typeof e?e:Object(a["b"])(+e),p):l},p.paddingRight=function(e){return arguments.length?(f="function"===typeof e?e:Object(a["b"])(+e),p):f},p.paddingBottom=function(e){return arguments.length?(d="function"===typeof e?e:Object(a["b"])(+e),p):d},p.paddingLeft=function(e){return arguments.length?(h="function"===typeof e?e:Object(a["b"])(+e),p):h},p}},b802:function(e,t,n){(function(t){const n="object"===typeof t&&Object({NODE_ENV:"production",BASE_URL:"/vue-vuetify-admin/"})&&Object({NODE_ENV:"production",BASE_URL:"/vue-vuetify-admin/"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production",BASE_URL:"/vue-vuetify-admin/"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n("4362"))},b805:function(e,t,n){const i=n("3034"),r=(e,t,n)=>i(t,e,n);e.exports=r},bac4:function(e,t,n){const i=n("3034"),r=(e,t,n)=>i(e,t,n)>0;e.exports=r},bbfd:function(e,t,n){const i=n("b802"),{MAX_LENGTH:r,MAX_SAFE_INTEGER:o}=n("b15c"),{re:a,t:s}=n("8cb5"),{compareIdentifiers:u}=n("2cdf");class c{constructor(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!==typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>r)throw new TypeError(`version is longer than ${r} characters`);i("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(i("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"===typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],r=e.prerelease[t];if(i("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return u(n,r)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const n=this.build[t],r=e.build[t];if(i("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return u(n,r)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;while(--e>=0)"number"===typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=c},bca0:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("de20"),r="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const o="vg-tooltip-element",a={offsetX:10,offsetY:10,id:o,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:s,maxDepth:2};function s(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function u(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return r.toString().replace(o,e)}var c=n("276f"),l=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function f(e,t,n){if(Object(c["A"])(e))return`[${e.map(e=>t(Object(c["H"])(e)?e:h(e,n))).join(", ")}]`;if(Object(c["F"])(e)){let i="";const r=e,{title:o,image:a}=r,s=l(r,["title","image"]);o&&(i+=`<h2>${t(o)}</h2>`),a&&(i+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){i+="<table>";for(const e of u){let r=s[e];void 0!==r&&(Object(c["F"])(r)&&(r=h(r,n)),i+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(r)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function d(e){const t=[];return function(n,i){if("object"!==typeof i||null===i)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function h(e,t){return JSON.stringify(e,d(t))}function p(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let o=e.clientY+i;return o+t.height>window.innerHeight&&(o=+e.clientY-i-t.height),{x:r,y:o}}class g{constructor(e){this.options=Object.assign(Object.assign({},a),e);const t=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=u(t);const n=document.head;n.childNodes.length>0?n.insertBefore(e,n.childNodes[0]):n.appendChild(e)}this.el=document.getElementById(t),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",t),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltipHandler(e,t,n,i){if(null==i||""===i)return void this.el.classList.remove("visible",this.options.theme+"-theme");this.el.innerHTML=f(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",this.options.theme+"-theme");const{x:r,y:o}=p(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${r}px`)}}i.version},c2d5:function(e,t,n){const i=n("bbfd"),r=(e,t)=>new i(e,t).minor;e.exports=r},c494:function(e,t,n){"use strict";var i=-.5,r=Math.sqrt(3)/2,o=1/Math.sqrt(12),a=3*(o/2+1);t["a"]={draw:function(e,t){var n=Math.sqrt(t/a),s=n/2,u=n*o,c=s,l=n*o+n,f=-c,d=l;e.moveTo(s,u),e.lineTo(c,l),e.lineTo(f,d),e.lineTo(i*s-r*u,r*s+i*u),e.lineTo(i*c-r*l,r*c+i*l),e.lineTo(i*f-r*d,r*f+i*d),e.lineTo(i*s+r*u,i*u-r*s),e.lineTo(i*c+r*l,i*l-r*c),e.lineTo(i*f+r*d,i*d-r*f),e.closePath()}}},c4be:function(e,t,n){const i=n("4392"),r=n("f195"),o=n("bac4"),a=n("a2a3"),s=n("38fa"),u=n("68d3"),c=(e,t,n,c)=>{switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return i(e,n,c);case"!=":return r(e,n,c);case">":return o(e,n,c);case">=":return a(e,n,c);case"<":return s(e,n,c);case"<=":return u(e,n,c);default:throw new TypeError("Invalid operator: "+t)}};e.exports=c},c628:function(e,t,n){const i=n("3fce"),{ANY:r}=n("6d43"),o=n("2a86"),a=n("3034"),s=(e,t,n)=>{e=new i(e,n),t=new i(t,n);let r=!1;e:for(const i of e.set){for(const e of t.set){const t=u(i,e,n);if(r=r||null!==t,t)continue e}if(r)return!1}return!0},u=(e,t,n)=>{if(1===e.length&&e[0].semver===r)return 1===t.length&&t[0].semver===r;const i=new Set;let s,u,f,d,h,p,g;for(const r of e)">"===r.operator||">="===r.operator?s=c(s,r,n):"<"===r.operator||"<="===r.operator?u=l(u,r,n):i.add(r.semver);if(i.size>1)return null;if(s&&u){if(f=a(s.semver,u.semver,n),f>0)return null;if(0===f&&(">="!==s.operator||"<="!==u.operator))return null}for(const r of i){if(s&&!o(r,String(s),n))return null;if(u&&!o(r,String(u),n))return null;for(const e of t)if(!o(r,String(e),n))return!1;return!0}for(const r of t){if(g=g||">"===r.operator||">="===r.operator,p=p||"<"===r.operator||"<="===r.operator,s)if(">"===r.operator||">="===r.operator){if(d=c(s,r,n),d===r)return!1}else if(">="===s.operator&&!o(s.semver,String(r),n))return!1;if(u)if("<"===r.operator||"<="===r.operator){if(h=l(u,r,n),h===r)return!1}else if("<="===u.operator&&!o(u.semver,String(r),n))return!1;if(!r.operator&&(u||s)&&0!==f)return!1}return!(s&&p&&!u&&0!==f)&&!(u&&g&&!s&&0!==f)},c=(e,t,n)=>{if(!e)return t;const i=a(e.semver,t.semver,n);return i>0?e:i<0||">"===t.operator&&">="===e.operator?t:e},l=(e,t,n)=>{if(!e)return t;const i=a(e.semver,t.semver,n);return i<0?e:i>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=s},c98b:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("037c");function r(e,...t){for(const n of t)o(e,n);return e}function o(e,t){for(const n of Object.keys(t))Object(i["writeConfig"])(e,n,t[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e})},cc3e:function(e,t,n){"use strict";var i=n("d0ae");function r(e){this._context=e}r.prototype={areaStart:i["a"],areaEnd:i["a"],lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},t["a"]=function(e){return new r(e)}},ce97:function(e,t,n){"use strict";function i(e,t){return e.parent===t.parent?1:2}function r(e){return e.reduce(o,0)/e.length}function o(e,t){return e+t.x}function a(e){return 1+e.reduce(s,0)}function s(e,t){return Math.max(e,t.y)}function u(e){var t;while(t=e.children)e=t[0];return e}function c(e){var t;while(t=e.children)e=t[t.length-1];return e}t["a"]=function(){var e=i,t=1,n=1,o=!1;function s(i){var s,l=0;i.eachAfter((function(t){var n=t.children;n?(t.x=r(n),t.y=a(n)):(t.x=s?l+=e(t,s):0,t.y=0,s=t)}));var f=u(i),d=c(i),h=f.x-e(f,d)/2,p=d.x+e(d,f)/2;return i.eachAfter(o?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-h)/(p-h)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return s.separation=function(t){return arguments.length?(e=t,s):e},s.size=function(e){return arguments.length?(o=!1,t=+e[0],n=+e[1],s):o?null:[t,n]},s.nodeSize=function(e){return arguments.length?(o=!0,t=+e[0],n=+e[1],s):o?[t,n]:null},s}},d0ae:function(e,t,n){"use strict";t["a"]=function(){}},d2ef:function(e,t,n){const i=n("a236"),r=(e,t)=>{const n=i(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};e.exports=r},d426:function(e,t,n){"use strict";var i=n("14f3"),r=n("ec83"),o=n("2388");t["a"]=function e(t){function n(e,n,a,s,u){if((c=e._squarify)&&c.ratio===t){var c,l,f,d,h,p=-1,g=c.length,m=e.value;while(++p<g){for(l=c[p],f=l.children,d=l.value=0,h=f.length;d<h;++d)l.value+=f[d].value;l.dice?Object(i["a"])(l,n,a,s,a+=(u-a)*l.value/m):Object(r["a"])(l,n,a,n+=(s-n)*l.value/m,u),m-=l.value}}else e._squarify=c=Object(o["c"])(t,e,n,a,s,u),c.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(o["b"])},d5a7:function(e,t,n){"use strict";t["a"]={draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}}},d675:function(e,t,n){"use strict";var i=n("8c80");function r(e){this._context=e}r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Object(i["c"])(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},t["a"]=function(e){return new r(e)}},d733:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i={};n.r(i),n.d(i,"JsonPatchError",(function(){return m})),n.d(i,"deepClone",(function(){return v})),n.d(i,"getValueByPointer",(function(){return x})),n.d(i,"applyOperation",(function(){return O})),n.d(i,"applyPatch",(function(){return _})),n.d(i,"applyReducer",(function(){return w})),n.d(i,"validator",(function(){return j})),n.d(i,"validate",(function(){return k})),n.d(i,"_areEquals",(function(){return E}));var r={};n.r(r),n.d(r,"unobserve",(function(){return $})),n.d(r,"observe",(function(){return N})),n.d(r,"generate",(function(){return T})),n.d(r,"compare",(function(){return z}));
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var o=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),a=Object.prototype.hasOwnProperty;function s(e,t){return a.call(e,t)}function u(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var i in e)s(e,i)&&t.push(i);return t}function c(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function l(e){var t,n=0,i=e.length;while(n<i){if(t=e.charCodeAt(n),!(t>=48&&t<=57))return!1;n++}return!0}function f(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function d(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function h(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(h(e[t]))return!0}else if("object"===typeof e){var i=u(e),r=i.length;for(t=0;t<r;t++)if(h(e[i[t]]))return!0}return!1}function p(e,t){var n=[e];for(var i in t){var r="object"===typeof t[i]?JSON.stringify(t[i],null,2):t[i];"undefined"!==typeof r&&n.push(i+": "+r)}return n.join("\n")}var g=function(e){function t(t,n,i,r,o){var a=this.constructor,s=e.call(this,p(t,{name:n,index:i,operation:r,tree:o}))||this;return s.name=n,s.index=i,s.operation=r,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=p(t,{name:n,index:i,operation:r,tree:o}),s}return o(t,e),t}(Error),m=g,v=c,b={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=x(n,this.path);i&&(i=c(i));var r=O(n,{op:"remove",path:this.from}).removed;return O(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=x(n,this.from);return O(n,{op:"add",path:this.path,value:c(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:E(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},y={add:function(e,t,n){return l(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:b.move,copy:b.copy,test:b.test,_get:b._get};function x(e,t){if(""==t)return e;var n={op:"_get",path:t};return O(e,n),n.value}function O(e,t,n,i,r,o){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(t,0,e,t.path):j(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=x(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=E(e,t.value),!1===a.test)throw new m("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new m("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}i||(e=c(e));var s=t.path||"",u=s.split("/"),f=e,h=1,p=u.length,g=void 0,v=void 0,O=void 0;O="function"==typeof n?n:j;while(1){if(v=u[h],r&&"__proto__"==v)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===g&&(void 0===f[v]?g=u.slice(0,h).join("/"):h==p-1&&(g=t.path),void 0!==g&&O(t,0,e,g)),h++,Array.isArray(f)){if("-"===v)v=f.length;else{if(n&&!l(v))throw new m("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);l(v)&&(v=~~v)}if(h>=p){if(n&&"add"===t.op&&v>f.length)throw new m("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);a=y[t.op].call(t,f,v,e);if(!1===a.test)throw new m("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(v&&-1!=v.indexOf("~")&&(v=d(v)),h>=p){a=b[t.op].call(t,f,v,e);if(!1===a.test)throw new m("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}f=f[v]}}function _(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new m("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=c(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=O(e,t[a],n,!0,r,a),e=o[a].newDocument;return o.newDocument=e,o}function w(e,t,n){var i=O(e,t);if(!1===i.test)throw new m("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function j(e,t,n,i){if("object"!==typeof e||null===e||Array.isArray(e))throw new m("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!b[e.op])throw new m("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new m("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new m('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new m("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new m("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&h(e.value))throw new m("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new m("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new m("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a={op:"_get",path:e.from,value:void 0},s=k([a],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new m("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function k(e,t,n){try{if(!Array.isArray(e))throw new m("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)_(c(t),c(e),n||!0);else{n=n||j;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof m)return r;throw r}}function E(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,i,r,o=Array.isArray(e),a=Array.isArray(t);if(o&&a){if(i=e.length,i!=t.length)return!1;for(n=i;0!==n--;)if(!E(e[n],t[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(e);if(i=s.length,i!==Object.keys(t).length)return!1;for(n=i;0!==n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=i;0!==n--;)if(r=s[n],!E(e[r],t[r]))return!1;return!0}return e!==e&&t!==t}
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var A=new WeakMap,D=function(){function e(e){this.observers=new Map,this.obj=e}return e}(),S=function(){function e(e,t){this.callback=e,this.observer=t}return e}();function C(e){return A.get(e)}function F(e,t){return e.observers.get(t)}function M(e,t){e.observers.delete(t.callback)}function $(e,t){t.unobserve()}function N(e,t){var n,i=[],r=C(e);if(r){var o=F(r,t);n=o&&o.observer}else r=new D(e),A.set(e,r);if(n)return n;if(n={},r.value=c(e),t){n.callback=t,n.next=null;var a=function(){T(n)},s=function(){clearTimeout(n.next),n.next=setTimeout(a)};"undefined"!==typeof window&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return n.patches=i,n.object=e,n.unobserve=function(){T(n),clearTimeout(n.next),M(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},r.observers.set(t,new S(t,n)),n}function T(e,t){void 0===t&&(t=!1);var n=A.get(e.object);R(n.value,e.object,e.patches,"",t),e.patches.length&&_(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function R(e,t,n,i,r){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var o=u(t),a=u(e),l=!1,d=a.length-1;d>=0;d--){var h=a[d],p=e[h];if(!s(t,h)||void 0===t[h]&&void 0!==p&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+f(h),value:c(p)}),n.push({op:"remove",path:i+"/"+f(h)}),l=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}),!0);else{var g=t[h];"object"==typeof p&&null!=p&&"object"==typeof g&&null!=g?R(p,g,n,i+"/"+f(h),r):p!==g&&(!0,r&&n.push({op:"test",path:i+"/"+f(h),value:c(p)}),n.push({op:"replace",path:i+"/"+f(h),value:c(g)}))}}if(l||o.length!=a.length)for(d=0;d<o.length;d++){h=o[d];s(e,h)||void 0===t[h]||n.push({op:"add",path:i+"/"+f(h),value:c(t[h])})}}}function z(e,t,n){void 0===n&&(n=!1);var i=[];return R(e,t,i,"",n),i}Object.assign({},i,r,{JsonPatchError:g,deepClone:c,escapePathComponent:f,unescapePathComponent:d})},d748:function(e,t,n){"use strict";t["a"]='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n'},de20:function(e){e.exports=JSON.parse('{"name":"vega-tooltip","version":"0.23.0","description":"A tooltip plugin for Vega-Lite and Vega visualizations.","main":"build/vega-tooltip.js","module":"build/src/index.js","unpkg":"build/vega-tooltip.min.js","jsdelivr":"build/vega-tooltip.min.js","typings":"build/src/index.d.ts","repository":{"type":"git","url":"https://github.com/vega/vega-tooltip.git"},"keywords":["vega-lite","vega","tooltip"],"author":{"name":"UW Interactive Data Lab","url":"https://idl.cs.washington.edu"},"collaborators":["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-tooltip/issues"},"homepage":"https://github.com/vega/vega-tooltip#readme","scripts":{"prepare":"beemo create-config --silent","tsc:src":"tsc -b tsconfig.src.json","build":"yarn tsc:src && rollup -c","clean":"rm -rf build examples/data && rm -f src/style.ts","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && yarn copy:build && gh-pages -d examples && yarn clean","prettierbase":"beemo prettier \'examples/*.{html,scss,css}\'","eslintbase":"beemo eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","postbuild":"terser build/vega-tooltip.js -c -m -o build/vega-tooltip.min.js","prebuild":"mkdir -p build && yarn copy:data && ./build-style.sh","prepublishOnly":"yarn clean && yarn build","preversion":"yarn lint","start":"yarn build && concurrently --kill-others -n Server,Typescript,Rollup \'browser-sync start -s -f build examples --serveStatic examples\' \'yarn tsc:src -w\' \'rollup -c -w\'","pretest":"./build-style.sh","test":"jest"},"devDependencies":{"@rollup/plugin-commonjs":"11.1.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^7.1.3","@types/jest":"^25.2.1","browser-sync":"^2.26.7","concurrently":"^5.2.0","gh-pages":"^2.2.0","jest":"^26.0.1","node-sass":"^4.14.1","path":"^0.12.7","rollup":"^2.8.2","terser":"^4.6.13","ts-jest":"^25.5.0","typescript":"^3.8.3","vega-datasets":"^1.30.2","vega-lite-dev-config":"^0.10.0","vega-typings":"^0.16.0"},"dependencies":{"vega-util":"^1.13.2"},"beemo":{"module":"vega-lite-dev-config","drivers":["prettier","eslint"]},"jest":{"testURL":"http://localhost/","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["node_modules","<rootDir>/build","src"]}}')},e38c:function(e,t,n){"use strict";var i=n("eadc"),r=n("d8ad"),o=n("4830"),a=n("fae8"),s=n("fda4");t["a"]=function(){var e=s["a"],t=null,n=Object(r["a"])(0),u=s["b"],c=Object(r["a"])(!0),l=null,f=o["a"],d=null;function h(r){var o,a,s,h,p,g=r.length,m=!1,v=new Array(g),b=new Array(g);for(null==l&&(d=f(p=Object(i["a"])())),o=0;o<=g;++o){if(!(o<g&&c(h=r[o],o,r))===m)if(m=!m)a=o,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),s=o-1;s>=a;--s)d.point(v[s],b[s]);d.lineEnd(),d.areaEnd()}m&&(v[o]=+e(h,o,r),b[o]=+n(h,o,r),d.point(t?+t(h,o,r):v[o],u?+u(h,o,r):b[o]))}if(p)return d=null,p+""||null}function p(){return Object(a["a"])().defined(c).curve(f).context(l)}return h.x=function(n){return arguments.length?(e="function"===typeof n?n:Object(r["a"])(+n),t=null,h):e},h.x0=function(t){return arguments.length?(e="function"===typeof t?t:Object(r["a"])(+t),h):e},h.x1=function(e){return arguments.length?(t=null==e?null:"function"===typeof e?e:Object(r["a"])(+e),h):t},h.y=function(e){return arguments.length?(n="function"===typeof e?e:Object(r["a"])(+e),u=null,h):n},h.y0=function(e){return arguments.length?(n="function"===typeof e?e:Object(r["a"])(+e),h):n},h.y1=function(e){return arguments.length?(u=null==e?null:"function"===typeof e?e:Object(r["a"])(+e),h):u},h.lineX0=h.lineY0=function(){return p().x(e).y(n)},h.lineY1=function(){return p().x(e).y(u)},h.lineX1=function(){return p().x(t).y(n)},h.defined=function(e){return arguments.length?(c="function"===typeof e?e:Object(r["a"])(!!e),h):c},h.curve=function(e){return arguments.length?(f=e,null!=l&&(d=f(l)),h):f},h.context=function(e){return arguments.length?(null==e?l=d=null:d=f(l=e),h):l},h}},e3db:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},eae9:function(e,t,n){},eb73:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-row",e._l(e.chartList,(function(t,i){return n("v-col",{key:i,attrs:{cols:"12",xs:"12",sm:"6",md:"4",xl:"3"}},[n("v-card",{staticClass:"pa-2 card-height overflow-auto"},[n("v-card-title",[e._v(e._s(t.cardTitle))]),n("div",{staticClass:"chart-size",attrs:{id:t.domId}})],1)],1)})),1)],1)},r=[],o=(n("6b54"),n("2397"),n("96cf"),n("3b8d")),a=n("d225"),s=n("b0b4"),u=n("308d"),c=n("6bb5"),l=n("4e2b"),f=n("9ab4"),d=n("60a3"),h=n("037c"),p=n("7ad3");function g(e){return function(){var t,n=Object(c["a"])(e);if(m()){var i=Object(c["a"])(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Object(u["a"])(this,t)}}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var v=function(e){Object(l["a"])(n,e);var t=g(n);function n(){var e;return Object(a["a"])(this,n),e=t.apply(this,arguments),e.chartList=[{domId:"viewBar1",cardTitle:"Vega"},{domId:"viewLine1",cardTitle:"Vega"},{domId:"viewPie1",cardTitle:"Vega"},{domId:"simpleBarChart",cardTitle:"Vega-Lite"},{domId:"sineCurveChart",cardTitle:"Vega-Lite"},{domId:"linearRegression",cardTitle:"Vega-Lite"}],e.bar1Spec={$schema:"https://vega.github.io/schema/vega/v5.json",width:300,height:400,padding:5,autosize:"pad",signals:[{name:"rangeStep",value:20,bind:{input:"range",min:5,max:50,step:1}},{name:"innerPadding",value:.1,bind:{input:"range",min:0,max:.7,step:.01}},{name:"outerPadding",value:.2,bind:{input:"range",min:0,max:.4,step:.01}},{name:"height",update:"trellisExtent[1]"}],data:[{name:"tuples",values:[{a:0,b:"a",c:6.3},{a:0,b:"a",c:4.2},{a:0,b:"b",c:6.8},{a:0,b:"c",c:5.1},{a:1,b:"b",c:4.4},{a:2,b:"b",c:3.5},{a:2,b:"c",c:6.2}],transform:[{type:"aggregate",groupby:["a","b"],fields:["c"],ops:["average"],as:["c"]}]},{name:"trellis",source:"tuples",transform:[{type:"aggregate",groupby:["a"]},{type:"formula",as:"span",expr:"rangeStep * bandspace(datum.count, innerPadding, outerPadding)"},{type:"stack",field:"span"},{type:"extent",field:"y1",signal:"trellisExtent"}]}],scales:[{name:"xscale",domain:{data:"tuples",field:"c"},nice:!0,zero:!0,round:!0,range:"width"},{name:"color",type:"ordinal",range:"category",domain:{data:"trellis",field:"a"}}],axes:[{orient:"bottom",scale:"xscale",domain:!0}],marks:[{type:"group",from:{data:"trellis",facet:{name:"faceted_tuples",data:"tuples",groupby:"a"}},encode:{enter:{x:{value:0},width:{signal:"width"}},update:{y:{field:"y0"},y2:{field:"y1"}}},scales:[{name:"yscale",type:"band",paddingInner:{signal:"innerPadding"},paddingOuter:{signal:"outerPadding"},round:!0,domain:{data:"faceted_tuples",field:"b"},range:{step:{signal:"rangeStep"}}}],axes:[{orient:"left",scale:"yscale",ticks:!1,domain:!1,labelPadding:4}],marks:[{type:"rect",from:{data:"faceted_tuples"},encode:{enter:{x:{value:0},x2:{scale:"xscale",field:"c"},fill:{scale:"color",field:"a"},strokeWidth:{value:2}},update:{y:{scale:"yscale",field:"b"},height:{scale:"yscale",band:1},stroke:{value:null},zindex:{value:0}},hover:{stroke:{value:"firebrick"},zindex:{value:1}}}}]}]},e.line1Spec={$schema:"https://vega.github.io/schema/vega/v5.json",description:"A basic line chart example.",width:300,height:200,padding:5,signals:[{name:"interpolate",value:"linear",bind:{input:"select",options:["basis","cardinal","catmull-rom","linear","monotone","natural","step","step-after","step-before"]}}],data:[{name:"table",values:[{x:0,y:28,c:0},{x:0,y:20,c:1},{x:1,y:43,c:0},{x:1,y:35,c:1},{x:2,y:81,c:0},{x:2,y:10,c:1},{x:3,y:19,c:0},{x:3,y:15,c:1},{x:4,y:52,c:0},{x:4,y:48,c:1},{x:5,y:24,c:0},{x:5,y:28,c:1},{x:6,y:87,c:0},{x:6,y:66,c:1},{x:7,y:17,c:0},{x:7,y:27,c:1},{x:8,y:68,c:0},{x:8,y:16,c:1},{x:9,y:49,c:0},{x:9,y:25,c:1}]}],scales:[{name:"x",type:"point",range:"width",domain:{data:"table",field:"x"}},{name:"y",type:"linear",range:"height",nice:!0,zero:!0,domain:{data:"table",field:"y"}},{name:"color",type:"ordinal",range:"category",domain:{data:"table",field:"c"}}],axes:[{orient:"bottom",scale:"x"},{orient:"left",scale:"y"}],marks:[{type:"group",from:{facet:{name:"series",data:"table",groupby:"c"}},marks:[{type:"line",from:{data:"series"},encode:{enter:{x:{scale:"x",field:"x"},y:{scale:"y",field:"y"},stroke:{scale:"color",field:"c"},strokeWidth:{value:2}},update:{interpolate:{signal:"interpolate"},strokeOpacity:{value:1}},hover:{strokeOpacity:{value:.5}}}}]}]},e.pie1Spec={$schema:"https://vega.github.io/schema/vega/v5.json",description:"A basic pie chart example.",width:200,height:300,autosize:"none",signals:[{name:"startAngle",value:0,bind:{input:"range",min:0,max:6.29,step:.01}},{name:"endAngle",value:6.29,bind:{input:"range",min:0,max:6.29,step:.01}},{name:"padAngle",value:0,bind:{input:"range",min:0,max:.1}},{name:"innerRadius",value:0,bind:{input:"range",min:0,max:90,step:1}},{name:"cornerRadius",value:0,bind:{input:"range",min:0,max:10,step:.5}},{name:"sort",value:!1,bind:{input:"checkbox"}}],data:[{name:"table",values:[{id:1,field:4},{id:2,field:6},{id:3,field:10},{id:4,field:3},{id:5,field:7},{id:6,field:8}],transform:[{type:"pie",field:"field",startAngle:{signal:"startAngle"},endAngle:{signal:"endAngle"},sort:{signal:"sort"}}]}],scales:[{name:"color",type:"ordinal",domain:{data:"table",field:"id"},range:{scheme:"category20"}}],marks:[{type:"arc",from:{data:"table"},encode:{enter:{fill:{scale:"color",field:"id"},x:{signal:"width / 2"},y:{signal:"height / 2"}},update:{startAngle:{field:"startAngle"},endAngle:{field:"endAngle"},padAngle:{signal:"padAngle"},innerRadius:{signal:"innerRadius"},outerRadius:{signal:"width / 2"},cornerRadius:{signal:"cornerRadius"}}}}]},e.simpleBarLiteSpec={$schema:"https://vega.github.io/schema/vega-lite/v4.json",description:"A simple bar chart with embedded data.",width:"container",height:"container",data:{values:[{a:"A",b:28},{a:"B",b:55},{a:"C",b:43},{a:"D",b:91},{a:"E",b:81},{a:"F",b:53},{a:"G",b:19},{a:"H",b:87},{a:"I",b:52}]},mark:"bar",encoding:{x:{field:"a",type:"ordinal",axis:{labelAngle:0}},y:{field:"b",type:"quantitative"}}},e.lineLiteSpec={$schema:"https://vega.github.io/schema/vega-lite/v4.json",description:"Plots two functions using a generated sequence.",width:"container",autosize:{type:"fit",contains:"padding"},data:{sequence:{start:0,stop:12.7,step:.1,as:"x"}},transform:[{calculate:"sin(datum.x)",as:"sin(x)"},{calculate:"cos(datum.x)",as:"cos(x)"},{fold:["sin(x)","cos(x)"]}],mark:"line",encoding:{x:{type:"quantitative",field:"x"},y:{field:"value",type:"quantitative"},color:{field:"key",type:"nominal",title:null}}},e.linearRegression={$schema:"https://vega.github.io/schema/vega-lite/v4.json",data:{url:"https://vega.github.io/vega-lite/data/movies.json"},layer:[{mark:{type:"point",filled:!0},encoding:{x:{field:"Rotten_Tomatoes_Rating",type:"quantitative"},y:{field:"IMDB_Rating",type:"quantitative"}}},{mark:{type:"line",color:"firebrick"},transform:[{regression:"IMDB_Rating",on:"Rotten_Tomatoes_Rating"}],encoding:{x:{field:"Rotten_Tomatoes_Rating",type:"quantitative"},y:{field:"IMDB_Rating",type:"quantitative"}}},{transform:[{regression:"IMDB_Rating",on:"Rotten_Tomatoes_Rating",params:!0},{calculate:"'R: '+format(datum.rSquared, '.2f')",as:"R2"}],mark:{type:"text",color:"firebrick",x:"width",align:"right",y:-5},encoding:{text:{type:"nominal",field:"R2"}}}]},e}return Object(s["a"])(n,[{key:"renderVega",value:function(e,t){new h["View"](h["parse"](e)).renderer("canvas").initialize(t).hover().run()}},{key:"mounted",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.renderVega(this.bar1Spec,"#viewBar1"),this.renderVega(this.line1Spec,"#viewLine1"),this.renderVega(this.pie1Spec,"#viewPie1"),Object(p["default"])("#simpleBarChart",this.simpleBarLiteSpec),Object(p["default"])("#sineCurveChart",this.lineLiteSpec),Object(p["default"])("#linearRegression",this.linearRegression);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(d["b"]);v=Object(f["b"])([Object(d["a"])({})],v);var b=v,y=b,x=(n("860b"),n("2877")),O=Object(x["a"])(y,i,r,!1,null,"9ce68454",null);t["default"]=O.exports},ec83:function(e,t,n){"use strict";t["a"]=function(e,t,n,i,r){var o,a=e.children,s=-1,u=a.length,c=e.value&&(r-n)/e.value;while(++s<u)o=a[s],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*c}},eccb:function(e,t,n){"use strict";var i=Array.prototype.slice;function r(e){var t,n,i=e.length;while(i)n=Math.random()*i--|0,t=e[i],e[i]=e[n],e[n]=t;return e}t["a"]=function(e){var t,n,a=0,u=(e=r(i.call(e))).length,l=[];while(a<u)t=e[a],n&&s(n,t)?++a:(n=c(l=o(l,t)),a=0);return n};function o(e,t){var n,i;if(u(t,e))return[t];for(n=0;n<e.length;++n)if(a(t,e[n])&&u(f(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(a(f(e[n],e[i]),t)&&a(f(e[n],t),e[i])&&a(f(e[i],t),e[n])&&u(d(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function a(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function s(e,t){var n=e.r-t.r+1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function u(e,t){for(var n=0;n<t.length;++n)if(!s(e,t[n]))return!1;return!0}function c(e){switch(e.length){case 1:return l(e[0]);case 2:return f(e[0],e[1]);case 3:return d(e[0],e[1],e[2])}}function l(e){return{x:e.x,y:e.y,r:e.r}}function f(e,t){var n=e.x,i=e.y,r=e.r,o=t.x,a=t.y,s=t.r,u=o-n,c=a-i,l=s-r,f=Math.sqrt(u*u+c*c);return{x:(n+o+u/f*l)/2,y:(i+a+c/f*l)/2,r:(f+r+s)/2}}function d(e,t,n){var i=e.x,r=e.y,o=e.r,a=t.x,s=t.y,u=t.r,c=n.x,l=n.y,f=n.r,d=i-a,h=i-c,p=r-s,g=r-l,m=u-o,v=f-o,b=i*i+r*r-o*o,y=b-a*a-s*s+u*u,x=b-c*c-l*l+f*f,O=h*p-d*g,_=(p*x-g*y)/(2*O)-i,w=(g*m-p*v)/O,j=(h*y-d*x)/(2*O)-r,k=(d*v-h*m)/O,E=w*w+k*k-1,A=2*(o+_*w+j*k),D=_*_+j*j-o*o,S=-(E?(A+Math.sqrt(A*A-4*E*D))/(2*E):D/A);return{x:i+_+w*S,y:r+j+k*S,r:S}}},f127:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i,r,o=function(e,t,n){return i=t||a,r=n||m,y(e.trim()).map(x)},a="view",s="[",u="]",c="{",l="}",f=":",d=",",h="@",p=">",g=/[[\]{}]/,m={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function v(e){return r[e]}function b(e,t,n,i,r){for(var o,a=0,s=e.length;t<s;++t){if(o=e[t],!a&&o===n)return t;r&&r.indexOf(o)>=0?--a:i&&i.indexOf(o)>=0&&++a}return t}function y(e){var t=[],n=0,i=e.length,r=0;while(r<i)r=b(e,r,d,s+c,u+l),t.push(e.substring(n,r).trim()),n=++r;if(0===t.length)throw"Empty event selector: "+e;return t}function x(e){return"["===e[0]?O(e):_(e)}function O(e){var t,n,i=e.length,r=1;if(r=b(e,r,u,s,u),r===i)throw"Empty between selector: "+e;if(t=y(e.substring(1,r)),2!==t.length)throw"Between selector must have two elements: "+e;if(e=e.slice(r+1).trim(),e[0]!==p)throw"Expected '>' after between selector: "+e;return t=t.map(x),n=x(e.slice(1).trim()),n.between?{between:t,stream:n}:(n.between=t,n)}function _(e){var t,n,r={source:i},o=[],a=[0,0],d=0,p=0,m=e.length,y=0;if(e[m-1]===l){if(y=e.lastIndexOf(c),!(y>=0))throw"Unmatched right brace: "+e;try{a=w(e.substring(y+1,m-1))}catch(x){throw"Invalid throttle specification: "+e}e=e.slice(0,y).trim(),m=e.length,y=0}if(!m)throw e;if(e[0]===h&&(d=++y),t=b(e,y,f),t<m&&(o.push(e.substring(p,t).trim()),p=y=++t),y=b(e,y,s),y===m)o.push(e.substring(p,m).trim());else if(o.push(e.substring(p,y).trim()),n=[],p=++y,p===m)throw"Unmatched left bracket: "+e;while(y<m){if(y=b(e,y,u),y===m)throw"Unmatched left bracket: "+e;if(n.push(e.substring(p,y).trim()),y<m-1&&e[++y]!==s)throw"Expected left bracket: "+e;p=++y}if(!(m=o.length)||g.test(o[m-1]))throw"Invalid event selector: "+e;return m>1?(r.type=o[1],d?r.markname=o[0].slice(1):v(o[0])?r.marktype=o[0]:r.source=o[0]):r.type=o[0],"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1)),null!=n&&(r.filter=n),a[0]&&(r.throttle=a[0]),a[1]&&(r.debounce=a[1]),r}function w(e){var t=e.split(d);if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}},f161:function(e){e.exports=JSON.parse('{"a":"5.13.0"}')},f195:function(e,t,n){const i=n("3034"),r=(e,t,n)=>0!==i(e,t,n);e.exports=r},f67c:function(e,t,n){const i=n("2a86"),r=n("3034");e.exports=(e,t,n)=>{const o=[];let a=null,s=null;const u=e.sort((e,t)=>r(e,t,n));for(const r of u){const e=i(r,t,n);e?(s=r,a||(a=r)):(s&&o.push([a,s]),s=null,a=null)}a&&o.push([a,null]);const c=[];for(const[i,r]of o)i===r?c.push(i):r||i!==u[0]?r?i===u[0]?c.push("<="+r):c.push(`${i} - ${r}`):c.push(">="+i):c.push("*");const l=c.join(" || "),f="string"===typeof t.raw?t.raw:String(t);return l.length<f.length?l:t}},f71e:function(e,t,n){"use strict";e.exports=function(e,t){t||(t={}),"function"===typeof t&&(t={cmp:t});var n="boolean"===typeof t.cycles&&t.cycles,i=t.cmp&&function(e){return function(t){return function(n,i){var r={key:n,value:t[n]},o={key:i,value:t[i]};return e(r,o)}}}(t.cmp),r=[];return function e(t){if(t&&t.toJSON&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==typeof t)return JSON.stringify(t);var o,a;if(Array.isArray(t)){for(a="[",o=0;o<t.length;o++)o&&(a+=","),a+=e(t[o])||"null";return a+"]"}if(null===t)return"null";if(-1!==r.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=r.push(t)-1,u=Object.keys(t).sort(i&&i(t));for(a="",o=0;o<u.length;o++){var c=u[o],l=e(t[c]);l&&(a&&(a+=","),a+=JSON.stringify(c)+":"+l)}return r.splice(s,1),"{"+a+"}"}}(e)}},f8d7:function(e,t,n){"use strict";var i=n("0dd4"),r=n("14f3");t["a"]=function(){var e=1,t=1,n=0,o=!1;function a(r){var a=r.height+1;return r.x0=r.y0=n,r.x1=e,r.y1=t/a,r.eachBefore(s(t,a)),o&&r.eachBefore(i["a"]),r}function s(e,t){return function(i){i.children&&Object(r["a"])(i,i.x0,e*(i.depth+1)/t,i.x1,e*(i.depth+2)/t);var o=i.x0,a=i.y0,s=i.x1-n,u=i.y1-n;s<o&&(o=s=(o+s)/2),u<a&&(a=u=(a+u)/2),i.x0=o,i.y0=a,i.x1=s,i.y1=u}}return a.round=function(e){return arguments.length?(o=!!e,a):o},a.size=function(n){return arguments.length?(e=+n[0],t=+n[1],a):[e,t]},a.padding=function(e){return arguments.length?(n=+e,a):n},a}},fae8:function(e,t,n){"use strict";var i=n("eadc"),r=n("d8ad"),o=n("4830"),a=n("fda4");t["a"]=function(){var e=a["a"],t=a["b"],n=Object(r["a"])(!0),s=null,u=o["a"],c=null;function l(r){var o,a,l,f=r.length,d=!1;for(null==s&&(c=u(l=Object(i["a"])())),o=0;o<=f;++o)!(o<f&&n(a=r[o],o,r))===d&&((d=!d)?c.lineStart():c.lineEnd()),d&&c.point(+e(a,o,r),+t(a,o,r));if(l)return c=null,l+""||null}return l.x=function(t){return arguments.length?(e="function"===typeof t?t:Object(r["a"])(+t),l):e},l.y=function(e){return arguments.length?(t="function"===typeof e?e:Object(r["a"])(+e),l):t},l.defined=function(e){return arguments.length?(n="function"===typeof e?e:Object(r["a"])(!!e),l):n},l.curve=function(e){return arguments.length?(u=e,null!=s&&(c=u(s)),l):u},l.context=function(e){return arguments.length?(null==e?s=c=null:c=u(s=e),l):s},l}},fcc4:function(e,t,n){"use strict";t["a"]=function(e,t,n){const i=e.open(t),r=1e4,o=250,{origin:a}=new URL(t);let s=~~(r/o);function u(t){t.source===i&&(s=0,e.removeEventListener("message",u,!1))}function c(){s<=0||(i.postMessage(n,a),setTimeout(c,o),s-=1)}e.addEventListener("message",u,!1),setTimeout(c,o)}},fd90:function(e,t,n){const i=n("bbfd"),r=n("3fce"),o=(e,t,n)=>{let o=null,a=null,s=null;try{s=new r(t,n)}catch(u){return null}return e.forEach(e=>{s.test(e)&&(o&&1!==a.compare(e)||(o=e,a=new i(o,n)))}),o};e.exports=o}}]);
//# sourceMappingURL=chunk-a6358860.fcdac0cf.js.map