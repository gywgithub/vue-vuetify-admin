(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9fd95f2"],{"690a":function(e,t,a){e.exports=a.p+"img/avatar.58016327.png"},"7cd3":function(e,t,a){"use strict";var s=a("b12c"),r=a.n(s);r.a},b12c:function(e,t,a){},ed81:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-card",[s("div",{staticClass:"d-flex justify-space-between mb-2 pa-2"},[s("div",[s("v-btn",{attrs:{color:"secondary"},on:{click:e.addUser}},[s("v-icon",{attrs:{left:""}},[e._v("mdi-account-plus-outline")]),e._v("Add User ")],1)],1),s("div",{staticClass:"search-component"},[s("v-select",{staticClass:"select-size",attrs:{items:e.selectItems,label:"Filter",solo:"",dense:"",clearable:""},model:{value:e.filterKey,callback:function(t){e.filterKey=t},expression:"filterKey"}}),e._v(" "),s("v-text-field",{staticClass:"search-text-size",attrs:{label:"Search",solo:"",dense:"","append-icon":"mdi-magnify",clearable:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enter(t)}},model:{value:e.filterValue,callback:function(t){e.filterValue=t},expression:"filterValue"}})],1),s("div",[s("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v("page_sum: "+e._s(e.pageSum)+" , page_index: "+e._s(e.pageIndex)+" , page_num: "+e._s(e.pageNum)+" ,")]),e._v(" "),s("span",{staticClass:"body-2"},[e._v(e._s(e.countStart)+" - "+e._s(e.countEnd)+", total: "+e._s(e.total))]),e._v(" "),s("v-btn",{attrs:{icon:"",disabled:e.lastPageDisabled},on:{click:e.lastPage}},[s("v-icon",[e._v("mdi-chevron-left")])],1),e._v(" "),s("v-btn",{attrs:{icon:"",disabled:e.nextPageDisabled},on:{click:e.nextPage}},[s("v-icon",[e._v("mdi-chevron-right")])],1)],1)])]),e.users.length>0?s("div",[s("v-card",[s("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[s("thead",[s("tr",[s("th",[e._v("user_id")]),s("th",[e._v("username")]),s("th",[e._v("avatar")]),s("th",[e._v("nickname")]),s("th",[e._v("email")]),s("th",[e._v("created_at")]),s("th",[e._v("options")])])]),s("tbody",e._l(e.users,(function(t,r){return s("tr",{key:r},[s("td",{staticClass:"text-align-left"},[e._v(e._s(t.user_id))]),s("td",{staticClass:"text-align-left"},[e._v(e._s(t.username))]),s("td",{staticClass:"text-center"},[t.avatar&&-1!==t.avatar.indexOf("http://")?s("v-avatar",{attrs:{size:"36"}},[s("img",{attrs:{src:t.avatar,alt:"avatar"}})]):t.avatar?s("v-avatar",{attrs:{size:"36"}},[s("img",{attrs:{src:""+e.publicPath+t.avatar,alt:"avatar"}})]):s("v-avatar",{attrs:{size:"36"}},[s("img",{attrs:{src:a("690a"),alt:"avatar"}})])],1),s("td",{staticClass:"text-align-left"},[e._v(e._s(t.nickname))]),s("td",{staticClass:"text-align-left"},[e._v(e._s(t.email))]),s("td",{staticClass:"text-align-left"},[e._v(e._s(t.created_at))]),s("td",{staticClass:"text-align-left"},[s("v-btn",{attrs:{text:"",icon:""},on:{click:function(a){return e.editUser(t)}}},[s("v-icon",[e._v("mdi-pencil-outline")])],1),e._v(" "),s("v-btn",{attrs:{text:"",icon:""},on:{click:function(a){return e.deconsteClick(t)}}},[s("v-icon",[e._v("mdi-trash-can-outline")])],1)],1)])})),0)]},proxy:!0}],null,!1,3013789036)})],1)],1):s("div",{staticClass:"nothing"},[s("div",{staticClass:"ma-5"},[s("v-icon",{attrs:{color:"#dbdbdb",size:"100"}},[e._v("mdi-account-outline")])],1),e._v("No user data, you can create a user. ")]),s("v-dialog",{attrs:{"max-width":"450"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[s("v-card",[s("v-card-title",{staticClass:"headline"},[e._v("Tips")]),s("v-card-text",{staticClass:"subtitle-1 text-align-left"},[e._v("Are you sure you want to deconste the user?")]),s("v-card-actions",[s("v-spacer"),s("v-btn",{attrs:{text:""},on:{click:function(t){e.dialog=!1}}},[e._v("cancel")]),s("v-btn",{attrs:{color:"red",text:""},on:{click:function(t){return e.deconsteUser()}}},[e._v("sure")])],1)],1)],1),s("v-dialog",{attrs:{width:"500px",persistent:"",fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.dialogUser,callback:function(t){e.dialogUser=t},expression:"dialogUser"}},[s("v-card",[s("v-toolbar",{attrs:{dark:"",color:"secondary"}},[s("v-btn",{attrs:{icon:"",dark:""},on:{click:e.closeDialogUser}},[s("v-icon",[e._v("mdi-close")])],1),s("v-toolbar-title",[e._v(e._s(e.dialogUserTitle))]),s("v-spacer")],1),s("v-container",{attrs:{fluid:"","fill-height":""}},[s("v-layout",{attrs:{"align-center":"","justify-center":""}},[s("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[s("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.hover;return[s("v-card",{staticClass:"mx-auto img-card text-center cursor-pointer",attrs:{elevation:r?6:2}},[e.userInfo.avatar?s("img",{staticClass:"img-size avatar",attrs:{src:e.userInfo.avatar,alt:"avatar"},on:{click:function(t){return e.changeFile()}}}):s("img",{staticClass:"img-size avatar",attrs:{src:a("690a"),alt:"avatar"},on:{click:function(t){return e.changeFile()}}})])]}}])}),s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[s("input",{ref:"fileInput",attrs:{type:"file",accept:"image/*"},on:{change:function(t){return e.fileChange()}}})]),s("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.userInfo.user_id,expression:"userInfo.user_id"}],attrs:{label:"编号",disabled:""},model:{value:e.userInfo.user_id,callback:function(t){e.$set(e.userInfo,"user_id",t)},expression:"userInfo.user_id"}}),s("v-text-field",{attrs:{counter:"25",label:"用户名*",required:"",maxlength:"25",error:e.nameError,messages:e.nameErrorsMsg,rules:e.nameRules,disabled:"Edit User"===e.dialogUserTitle},on:{blur:function(t){return e.checkUsername(e.userInfo.username)}},model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}}),s("v-text-field",{attrs:{type:e.showPassword?"text":"password",label:"密码*",rules:e.passwordRules,counter:"",maxlength:"25",required:"","append-icon":e.showPassword?"mdi-eye":"mdi-eye-off"},on:{"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.userInfo.password,callback:function(t){e.$set(e.userInfo,"password",t)},expression:"userInfo.password"}}),s("v-text-field",{attrs:{counter:"25",label:"姓名*",required:"",maxlength:"50",rules:e.nicknameRules},model:{value:e.userInfo.nickname,callback:function(t){e.$set(e.userInfo,"nickname",t)},expression:"userInfo.nickname"}}),s("v-text-field",{attrs:{rules:e.emailRules,label:"邮箱*",counter:"50",maxlength:"50",required:"",error:e.emailError,messages:e.emailErrorsMsg},on:{blur:function(t){return e.checkEmail(e.userInfo.email)}},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}}),e.userInfo.created_at?s("v-text-field",{attrs:{label:"created_at",disabled:""},model:{value:e.userInfo.created_at,callback:function(t){e.$set(e.userInfo,"created_at",t)},expression:"userInfo.created_at"}}):e._e(),s("v-btn",{staticClass:"btn-submit",attrs:{color:"primary",disabled:e.btnDisabled,loading:e.btnLoading},on:{click:e.submit}},[e._v("submit")])],1)],1)],1)],1)],1)],1)],1)},r=[],n=(a("6b54"),a("2397"),a("28a5"),a("7f7f"),a("96cf"),a("3b8d")),i=a("d225"),o=a("b0b4"),l=a("308d"),u=a("6bb5"),c=a("4e2b"),d=a("9ab4"),f=a("60a3"),v=a("0613");function h(e){return function(){var t,a=Object(u["a"])(e);if(m()){var s=Object(u["a"])(this).constructor;t=Reflect.construct(a,arguments,s)}else t=a.apply(this,arguments);return Object(l["a"])(this,t)}}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var g=function(e){Object(c["a"])(a,e);var t=h(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.publicPath="/vue-vuetify-admin/",e.selectItems=["user_id","username","nickname","email","created_at"],e.filterKey="",e.filterValue="",e.pageNum=20,e.pageSum=0,e.pageIndex=1,e.countStart=0,e.countEnd=0,e.total=0,e.lastPageDisabled=!0,e.nextPageDisabled=!0,e.users=[],e.dialogUser=!1,e.dialogUserTitle="Add User",e.dialog=!1,e.userInfo={},e.file=null,e.nameError=!1,e.nameErrorsMsg="",e.emailError=!1,e.emailErrorsMsg="",e.oldInfo={},e.showPassword=!1,e.emailRules=[function(e){return!!e||"Email is required"},function(e){return/.+@.+\..+/.test(e)||"Email format is invalid"}],e.valid=!1,e.nameRules=[function(e){return!!e||"Username is required"}],e.nicknameRules=[function(e){return!!e||"Nickname is required"}],e.passwordRules=[function(e){return!!e||"Password is required"},function(e){return e&&e.length>=8||"Min 8 characters"},function(e){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(e)||"The password must contain at least one letter and one number"}],e.btnDisabled=!1,e.btnLoading=!1,e}return Object(o["a"])(a,[{key:"created",value:function(){"/"===this.publicPath?this.publicPath="":this.publicPath="/vue-vuetify-admin"}},{key:"mounted",value:function(){console.info("mounted"),console.info(this.publicPath),this.getUsers()}},{key:"checkUsername",value:function(e){var t=this;e&&this.axios({url:"/api/v1/get/username/"+e,method:"GET"}).then((function(e){e.data.status?(t.nameError=!1,t.nameErrorsMsg=""):(t.nameError=!0,t.nameErrorsMsg="Username already exists")}))}},{key:"checkEmail",value:function(e){var t=this;""!==e&&e!==this.oldInfo.email&&this.axios({url:"/api/v1/get/email/"+e,method:"GET"}).then((function(e){e.data.status?(t.emailError=!1,t.emailErrorsMsg=""):(t.emailError=!0,t.emailErrorsMsg="Email already exists")}))}},{key:"formValidate",value:function(){return!!this.$refs.form.validate()}},{key:"submit",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.formValidate()||this.nameError||this.emailError){e.next=17;break}if(this.btnDisabled=!0,this.btnLoading=!0,t=JSON.parse(JSON.stringify(this.userInfo)),console.info("this.userInfo: ",this.userInfo),!this.file){e.next=12;break}return e.next=8,this.uploadFile();case 8:a=e.sent,a&&(t.avatar=a),e.next=13;break;case 12:t.avatar="/img/avatar.png";case 13:console.info("info submit: ",t),"Add User"===this.dialogUserTitle?this.axios({url:"/api/v1/users",method:"POST",data:t}).then((function(e){e.data.status?(console.info("success"),s.btnDisabled=!1,s.btnLoading=!1,s.dialogUser=!1,v["a"].dispatch("updateShowAlert",{showAlert:!0,alertMessage:"add user success",alertType:"success"}),s.getUsers()):v["a"].dispatch("updateShowAlert",{showAlert:!0,alertMessage:"add user error",alertType:"error"})})):this.axios({url:"/api/v1/users",method:"PUT",data:{user_id:this.userInfo.user_id,user_info:t}}).then((function(e){e.data.status?(s.btnDisabled=!1,s.btnLoading=!1,s.dialogUser=!1,v["a"].dispatch("updateShowAlert",{showAlert:!0,alertMessage:"add user success",alertType:"success"}),s.getUsers()):(console.info("error"),v["a"].dispatch("updateShowAlert",{showAlert:!0,alertMessage:"edit user error",alertType:"error"}))})),e.next=18;break;case 17:console.error("validate false");case 18:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"uploadFile",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.file.name,this.file.type.split("/")[1],e.next=4,this.axios({url:"/api/v1/get_upload_url",data:{filename:t,upload_method:"post"},method:"get"}).then((function(e){return e}));case 4:return a=e.sent,s=new FormData,s.append("file",this.file),console.info(a.data.data.url),e.next=10,fetch(a.data.data.url,{method:"POST",body:s}).then((function(e){return e})).catch((function(e){return e}));case 10:return e.abrupt("return",a.data.data.file_address);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"formReset",value:function(){this.$refs.form.reset()}},{key:"fileChange",value:function(){if(this.$refs.fileInput.files.length>0){var e=this.$refs.fileInput.files;this.file=e[0];var t=new FileReader,a=this;t.readAsDataURL(this.file),t.onload=function(e){var s=t.result;a.userInfo.avatar=s}}}},{key:"changeFile",value:function(){this.$refs.fileInput.click()}},{key:"getUsers",value:function(){var e=this,t={pageIndex:this.pageIndex,pageNum:this.pageNum,filterKey:this.filterKey,filterValue:this.filterValue};this.axios.get("/api/v1/users",{params:t}).then((function(t){if(console.info(t.data),t&&t.data.status&&t.data.data.users.length>0){var a=t.data.data;e.users=a.users,e.pageSum=a.page_sum,e.pageIndex=a.page_index,e.total=a.total,e.pageIndex===a.page_sum?e.nextPageDisabled=!0:a.page_sum>1&&(e.nextPageDisabled=!1),1===e.pageIndex?(e.countStart=1,e.countEnd=0+e.users.length):(e.countStart=(e.pageIndex-1)*e.pageNum+1,e.countEnd=e.countStart+e.users.length-1)}else e.users=[],e.pageSum=0,e.pageIndex=0,e.total=0}))}},{key:"addUser",value:function(){var e=this;this.dialogUserTitle="Add User",this.dialogUser=!0,this.userInfo={},setTimeout((function(){e.formReset()}),50)}},{key:"enter",value:function(){this.pageIndex=1,this.getUsers()}},{key:"lastPage",value:function(){console.info("lastPage"),this.pageIndex--,1===this.pageIndex&&(this.lastPageDisabled=!0),this.getUsers()}},{key:"nextPage",value:function(){console.info("nextPage"),this.pageIndex++,this.pageIndex===this.pageSum&&(this.nextPageDisabled=!0),this.lastPageDisabled=!1,this.getUsers()}},{key:"closeDialogUser",value:function(){console.info("closeDialogUser"),this.dialogUser=!1}},{key:"deconsteClick",value:function(e){this.dialog=!0,this.userInfo=e,console.info(e)}},{key:"deconsteUser",value:function(){var e=this;console.info("deconsteUser");var t=this.userInfo.user_id;this.axios({url:"/api/v1/users/"+t,method:"DELETE"}).then((function(a){a.status&&(console.info("deconste user success, id: "+t),e.dialog=!1,e.getUsers())}))}},{key:"editUser",value:function(e){console.info("eidtUser"),console.info(e),console.info("i"),this.userInfo=e,this.dialogUserTitle="Edit User",this.dialogUser=!0}}]),a}(f["b"]);g=Object(d["b"])([Object(f["a"])({})],g);var p=g,b=p,x=(a("7cd3"),a("2877")),_=Object(x["a"])(b,s,r,!1,null,"f3f13ca0",null);t["default"]=_.exports}}]);
//# sourceMappingURL=chunk-c9fd95f2.23154fdf.js.map